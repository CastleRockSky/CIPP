"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3385],{18602:(e,t,n)=>{n.d(t,{a:()=>c});var l=n(37876),i=n(22875),a=n(41055),s=n(7159),r=n(97216),o=n(37460),d=n(80700);let c=()=>{let{checkPermissions:e}=(0,d.S)(),t=e(["CIPP.Scheduler.ReadWrite"]),n=e(["CIPP.Scheduler.Read","CIPP.Scheduler.ReadWrite"]);return[{label:"View Task Details",link:"/cipp/scheduler/task?id=[RowKey]",icon:(0,l.jsx)(i.A,{}),condition:()=>n},{label:"Run Now",type:"POST",url:"/api/AddScheduledItem",data:{RowKey:"RowKey",RunNow:!0},icon:(0,l.jsx)(s.A,{}),confirmText:"Are you sure you want to run [Name]?",allowResubmit:!0,condition:()=>t},{label:"Edit Job",link:"/cipp/scheduler/job?id=[RowKey]",multiPost:!1,icon:(0,l.jsx)(r.A,{}),color:"success",showInActionsMenu:!0,condition:()=>t},{label:"Clone and Edit Job",link:"/cipp/scheduler/job?id=[RowKey]&Clone=True",multiPost:!1,icon:(0,l.jsx)(o.A,{}),color:"success",showInActionsMenu:!0,condition:()=>t},{label:"Delete Job",icon:(0,l.jsx)(a.A,{}),type:"POST",url:"/api/RemoveScheduledItem",data:{id:"RowKey"},confirmText:"Are you sure you want to delete this job?",multiPost:!1,condition:()=>t}]}},26459:(e,t,n)=>{n.d(t,{_m:()=>s,hf:()=>r,kM:()=>d,zl:()=>o});var l=n(37876),i=n(47737),a=n(80700);let s=(e,t)=>!!(e&&t&&Array.isArray(e)&&Array.isArray(t))&&(0===t.length||e.some(e=>t.some(t=>{if(e===t)return!0;if(t.includes("*")){let n=t.replace(/\./g,"\\.").replace(/\*/g,".*");return new RegExp("^".concat(n,"$")).test(e)}return!1}))),r=(e,t)=>!!(e&&t&&Array.isArray(e)&&Array.isArray(t))&&(0===t.length||t.some(t=>e.includes(t))),o=e=>{let{userPermissions:t,userRoles:n,requiredPermissions:l=[],requiredRoles:i=[]}=e;return(!(i.length>0)||!!r(n,i))&&(!(l.length>0)||!!s(t,l))},d=e=>{let{requiredPermissions:t=[],requiredRoles:n=[],hideIfNoAccess:s=!1,children:r,...d}=e,{userPermissions:c,userRoles:u,isAuthenticated:h}=(0,a.S)(),x=h&&o({userPermissions:c,userRoles:u,requiredPermissions:t,requiredRoles:n});return!x&&s?null:(0,l.jsx)(i.A,{disabled:!x,...d,children:r})}},41055:(e,t,n)=>{n.d(t,{A:()=>i});var l=n(14232);let i=l.forwardRef(function(e,t){let{title:n,titleId:i,...a}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},a),n?l.createElement("title",{id:i},n):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})},53385:(e,t,n)=>{n.d(t,{A:()=>I});var l=n(37876),i=n(14232),a=n(22474),s=n(77018),r=n(76776),o=n(67578),d=n(22430),c=n(70946),u=n(7881),h=n(88326),x=n(37746),m=n(68284),p=n(75720),v=n(59017),j=n(22322),A=n(41412),g=n(5419),y=n(79259),b=n(87505),w=n(16652),f=n(48504),R=n(35936),k=n(31540),C=n(43225),S=n(95449),T=n(18602);let I=e=>{var t,n,I,P;let{data:L,showActions:E=!0}=e,[F,K]=(0,i.useState)(null),[D,N]=(0,i.useState)(!1),[z,O]=(0,i.useState)(""),_=e=>(t,n)=>{N(!!n&&e)},M=(0,j.R_)({url:"/api/ListScheduledItemDetails",data:{RowKey:L.RowKey},queryKey:"ListScheduledItemDetails-".concat(L.RowKey)});(0,i.useEffect)(()=>{if(M.isSuccess&&(null==M?void 0:M.data)){var e;K(M.data),(null===(e=M.data.Details)||void 0===e?void 0:e.length)===1&&N("execution-results-0")}},[L.RowKey,M.isSuccess,M.data]);let J=null==F?void 0:null===(t=F.Details)||void 0===t?void 0:t.filter(e=>{if(!z)return!0;let t=z.toLowerCase(),n=(e.TenantName||e.Tenant||"").toLowerCase().includes(t),l=!1;return"object"==typeof e.Results&&null!==e.Results&&(l=JSON.stringify(e.Results).toLowerCase().includes(t)),n||l});return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(a.A,{spacing:2,children:[(0,l.jsxs)(a.A,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,l.jsx)(s.A,{variant:"h5",children:M.isLoading?(0,l.jsx)(r.A,{width:"250px"}):null==F?void 0:null===(n=F.Task)||void 0===n?void 0:n.Name}),E&&(0,l.jsx)(o.A,{children:(0,l.jsx)(S.$,{actions:(0,T.a)(),data:null==F?void 0:F.Task,disabled:M.isLoading})})]}),(0,l.jsx)(g.a,{actionButton:(0,l.jsx)(d.A,{title:"Refresh",children:(0,l.jsx)(c.A,{size:"small",onClick:()=>M.refetch(),children:(0,l.jsx)(y.A,{})})}),layout:"dual",title:"Details",variant:"outlined",showDivider:!1,propertyItems:["TaskState","Command","Tenant","Recurrence","ScheduledTime","ExecutedTime","PostExecution"].filter(e=>{var t,n;return(null==F?void 0:null===(t=F.Task)||void 0===t?void 0:t[e])!=null&&(null==F?void 0:null===(n=F.Task)||void 0===n?void 0:n[e])!==""}).map(e=>{var t;return{label:(0,A.i)(e),value:(0,R.i)(null==F?void 0:null===(t=F.Task)||void 0===t?void 0:t[e],e)}}),isFetching:M.isFetching}),M.isFetching?(0,l.jsx)(r.A,{variant:"rectangular",width:"100%",height:200}):(0,l.jsx)(l.Fragment,{children:(null==F?void 0:null===(I=F.Task)||void 0===I?void 0:I.Parameters)&&(0,l.jsxs)(u.A,{variant:"outlined",expanded:"task-parameters"===D,onChange:_("task-parameters"),children:[(0,l.jsx)(h.A,{expandIcon:(0,l.jsx)(b.A,{}),children:(0,l.jsx)(s.A,{variant:"h6",children:"Task Parameters"})}),(0,l.jsx)(x.A,{children:(0,l.jsx)(g.a,{showDivider:!1,layout:"dual",propertyItems:Object.entries(F.Task.Parameters).map(e=>{let[t,n]=e;return{label:t,value:(0,R.i)(n,t)}}),isFetching:M.isFetching})})]})}),M.isFetching?(0,l.jsx)(r.A,{variant:"rectangular",width:"100%",height:400}):(0,l.jsx)(l.Fragment,{children:(null==F?void 0:null===(P=F.Details)||void 0===P?void 0:P.length)>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mt:4,mb:2},children:[(0,l.jsxs)(s.A,{variant:"h6",children:["Execution Results"," ",J&&(0,l.jsxs)(s.A,{component:"span",variant:"body2",color:"text.secondary",children:["(",J.length," of ",F.Details.length,")"]})]}),(0,l.jsx)(m.A,{size:"small",variant:"outlined",sx:{width:250},placeholder:"Search results...",value:z,onChange:e=>O(e.target.value),InputProps:{startAdornment:(0,l.jsx)(p.A,{position:"start",children:(0,l.jsx)(w.A,{})}),endAdornment:z&&(0,l.jsx)(p.A,{position:"end",children:(0,l.jsx)(d.A,{title:"Clear search",children:(0,l.jsx)(c.A,{size:"small",onClick:()=>O(""),"aria-label":"Clear search",children:(0,l.jsx)(f.A,{})})})})}})]}),(0,l.jsxs)(a.A,{children:[J&&J.map((e,t)=>(0,l.jsxs)(u.A,{variant:"outlined",expanded:D==="execution-results-".concat(t),onChange:_("execution-results-".concat(t)),sx:{mb:2},children:[(0,l.jsxs)(h.A,{expandIcon:(0,l.jsx)(b.A,{}),sx:{"& .MuiAccordionSummary-content":{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"}},children:[(0,l.jsx)(o.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,R.i)(e.TenantName||e.Tenant,"Tenant")}),(0,l.jsx)(v.A,{size:"small",color:"info",variant:"outlined",label:(0,l.jsx)(C.z,{data:e.Timestamp}),sx:{mx:1}})]}),(0,l.jsx)(x.A,{children:"null"!==e.Results&&e.Results?Array.isArray(e.Results)?(0,l.jsx)(k.x,{noCard:!0,data:e.Results,disablePagination:e.Results.length<=10}):"object"==typeof e.Results?(0,l.jsx)(g.a,{propertyItems:Object.entries(e.Results).map(e=>{let[t,n]=e;return{label:t,value:"object"==typeof n?JSON.stringify(n):n}})}):(0,l.jsx)(o.A,{sx:{p:2,bgcolor:"background.paper",borderRadius:1},children:(0,l.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e.Results})}):(0,l.jsx)(s.A,{color:"text.secondary",children:"No data available"})})]},"result-".concat(t))),J&&0===J.length&&(0,l.jsx)(o.A,{sx:{p:2,bgcolor:"background.paper",borderRadius:1,textAlign:"center"},children:(0,l.jsx)(s.A,{color:"text.secondary",children:"No results match your search criteria"})})]})]})})]})})}},80700:(e,t,n)=>{n.d(t,{S:()=>s});var l=n(14232),i=n(22322),a=n(26459);let s=()=>{var e,t,n;let s=(0,i.R_)({url:"/api/me",queryKey:"authmecipp"}),r=(null===(t=s.data)||void 0===t?void 0:null===(e=t.clientPrincipal)||void 0===e?void 0:e.userRoles)||[],o=(null===(n=s.data)||void 0===n?void 0:n.permissions)||[],d=s.isLoading,c=s.isSuccess&&r.length>0,u=(0,l.useCallback)(e=>!!c&&(0,a._m)(o,e),[o,c]),h=(0,l.useCallback)(e=>!!c&&(0,a.hf)(r,e),[r,c]),x=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!c)return!1;let{requiredPermissions:t=[],requiredRoles:n=[]}=e;return(0,a.zl)({userPermissions:o,userRoles:r,requiredPermissions:t,requiredRoles:n})},[o,r,c]);return{userPermissions:o,userRoles:r,isLoading:d,isAuthenticated:c,checkPermissions:u,checkRoles:h,checkAccess:x}}},95449:(e,t,n)=>{n.d(t,{$:()=>v});var l=n(37876),i=n(54550),a=n(95062),s=n.n(a),r=n(47737),o=n(94810),d=n(52808),c=n(6003),u=n(93256),h=n(50221),x=n(14232),m=n(82836),p=n(79803);let v=e=>{var t;let{actions:n=[],label:a="Actions",data:s,queryKeys:v,...j}=e,A=(0,h.f)(),[g,y]=(0,x.useState)({data:{},action:{},ready:!1}),b=(0,m.s)(),w=(e,t)=>!e||null!=t&&!!t.condition&&!(null==t?void 0:t.condition(e));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.A,{onClick:A.handleOpen,ref:A.anchorRef,startIcon:(0,l.jsx)(o.A,{fontSize:"small",children:(0,l.jsx)(i.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap"},children:"Actions"}),(0,l.jsx)(d.A,{anchorEl:A.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:A.handleClose,open:A.open,transformOrigin:{horizontal:"right",vertical:"top"},children:null==n?void 0:n.filter(e=>!e.link||e.showInActionsMenu).map((e,t)=>(0,l.jsxs)(c.A,{disabled:w(s,e),onClick:()=>{y({data:s,action:e,ready:!0}),(null==e?void 0:e.noConfirm)&&e.customFunction?e.customFunction(s,e,{}):(b.handleOpen(),A.handleClose())},children:[(0,l.jsx)(o.A,{fontSize:"small",sx:{minWidth:"30px"},children:e.icon}),(0,l.jsx)(u.A,{children:e.label})]},t))}),g.ready&&(0,l.jsx)(p.B,{createDialog:b,title:"Confirmation",fields:null===(t=g.action)||void 0===t?void 0:t.fields,api:g.action,row:g.data,relatedQueryKeys:v})]})};v.propTypes={actions:s().array,label:s().string}}}]);