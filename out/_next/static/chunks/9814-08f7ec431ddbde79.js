"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9814],{49814:(e,t,i)=>{i.d(t,{A:()=>G});var l=i(37876),n=i(14232),a=i(47737),s=i(22430),r=i(7957),o=i(77018),c=i(7881),d=i(88326),u=i(22474),p=i(37746),h=i(70946),v=i(59568),x=i(87505),f=i(25052),g=i(65897),y=i(20908),j=i(78e3),m=i(41412),N=i(35936),S=i(24921),b=i(5918),A=i(22322),D=i(17825);let I=e=>{if(Array.isArray(e))return e.map(e=>I(e)).filter(e=>null!=e&&""!==e);if("object"!=typeof e||null===e)return e;{let t={};return Object.entries(e).forEach(e=>{let[i,l]=e,n=I(l);null!=n&&""!==n&&(t[i]=n)}),Object.keys(t).length>0?t:null}},w=e=>"string"==typeof e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e),E=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;return e&&("string"==typeof e&&w(e)?t.add(e):Array.isArray(e)?e.forEach(e=>E(e,t)):"object"==typeof e&&Object.values(e).forEach(e=>E(e,t))),t},O=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.entries(e).map(e=>{let[o,c]=e;return Array.isArray(c)?(0,l.jsx)(y.N,{label:(0,m.i)(o),disabled:0===c.length,value:(0,l.jsxs)(a.A,{variant:"text",onClick:()=>t(c),children:[c.length," item",c.length>1?"s":""]})},o):"object"==typeof c&&null!==c?(0,l.jsx)(y.N,{label:(0,m.i)(o),value:(0,l.jsx)(a.A,{variant:"text",onClick:()=>t(c),children:"View Details"})},o):"string"==typeof c&&w(c)&&i[c]?(0,l.jsx)(y.N,{label:(0,m.i)(o),value:(0,l.jsx)(s.A,{title:"GUID: ".concat(c),placement:"top",children:(0,l.jsx)("div",{children:i[c]})})},o):"string"==typeof c&&w(c)&&n?(0,l.jsx)(y.N,{label:(0,m.i)(o),value:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(r.A,{size:16,sx:{mr:1}}),(0,l.jsx)("span",{children:(0,N.i)(c,o)})]})},o):(0,l.jsx)(y.N,{label:(0,m.i)(o),value:(0,N.i)(c,o)},o)})},G=function(e){let{object:t={"No Data Selected":"No Data Selected"},type:i,defaultOpen:a=!1}=e,[G,U]=(0,n.useState)(!1),[V,C]=(0,n.useState)(a),[P,k]=(0,n.useState)([]),[T,z]=(0,n.useState)({}),[R,_]=(0,n.useState)(new Set),[J,L]=(0,n.useState)(!1),[$,F]=(0,n.useState)([]),[B,K]=(0,n.useState)(0),M=(0,D.t)().currentTenant,Q=(0,A.nN)({relatedQueryKeys:["directoryObjects"],onResult:e=>{if(e&&Array.isArray(e.value)){let t={};e.value.forEach(e=>{e.id&&(e.displayName||e.userPrincipalName||e.mail)&&(t[e.id]=e.displayName||e.userPrincipalName||e.mail)});let i=new Set($),l=new Set(e.value.map(e=>e.id)),n=[...i].filter(e=>!l.has(e));n.length>0&&_(e=>{let t=new Set(e);return n.forEach(e=>t.add(e)),t}),z(e=>({...e,...t})),F([]),L(!1)}}}),W=e=>{let t=E(e);if(0===t.size)return;let i=Array.from(t).filter(e=>!T[e]&&!R.has(e));if(0===i.length)return;let l=[...new Set([...$,...i])];F(l),L(!0);let n=Date.now();if(n-B<2e3)return;K(n);let a=l.slice(0,1e3);a.length>0?Q.mutate({url:"/api/ListDirectoryObjects",data:{tenantFilter:M,ids:a,$select:"id,displayName,userPrincipalName,mail"}}):L(!1)},q=e=>{let t=[],i=["Name","DisplayName","displayName","name"].find(t=>t in e);return i&&t.push((0,l.jsx)(y.N,{label:"Policy Name",value:e[i]},"policyName")),e.omaSettings?e.omaSettings.forEach((e,i)=>{let n="string"==typeof e.value&&w(e.value)&&T[e.value]?(0,l.jsx)(s.A,{title:"GUID: ".concat(e.value),placement:"top",children:(0,l.jsxs)("div",{children:[T[e.value],(0,l.jsx)(o.A,{variant:"caption",sx:{fontStyle:"italic",ml:1,color:"text.secondary"},children:"(GUID)"})]})}):e.value;t.push((0,l.jsx)(y.N,{label:"".concat(e.displayName," (").concat(e.omaUri,")"),value:n},"omaSetting-".concat(i)))}):e.settings?e.settings.forEach((e,i)=>{var n,a,r,c;let d=e.settingInstance,u=b.find(e=>e.id===d.settingDefinitionId);if("#microsoft.graph.deviceManagementConfigurationGroupSettingCollectionInstance"===d["@odata.type"]&&d.groupSettingCollectionValue)d.groupSettingCollectionValue.forEach((e,n)=>{e.children&&Array.isArray(e.children)&&e.children.forEach((e,a)=>{let s;let r=b.find(t=>t.id===e.settingDefinitionId),o=(null==r?void 0:r.displayName)||e.settingDefinitionId;if(e.choiceSettingValue&&e.choiceSettingValue.value){var c,d;s=(null==r?void 0:null===(d=r.options)||void 0===d?void 0:null===(c=d.find(t=>t.id===e.choiceSettingValue.value))||void 0===c?void 0:c.displayName)||e.choiceSettingValue.value}t.push((0,l.jsx)(y.N,{label:o,value:s},"setting-".concat(i,"-group-").concat(n,"-child-").concat(a)))})});else if(null==d?void 0:null===(n=d.simpleSettingValue)||void 0===n?void 0:n.value){let e=(null==u?void 0:u.displayName)||d.settingDefinitionId,n=d.simpleSettingValue.value,a="string"==typeof n&&w(n)&&T[n]?(0,l.jsx)(s.A,{title:"GUID: ".concat(n),placement:"top",children:(0,l.jsxs)("div",{children:[T[n],(0,l.jsx)(o.A,{variant:"caption",sx:{fontStyle:"italic",ml:1,color:"text.secondary"},children:"(GUID)"})]})}):n;t.push((0,l.jsx)(y.N,{label:e,value:a},"setting-".concat(i)))}else if(null==d?void 0:null===(a=d.choiceSettingValue)||void 0===a?void 0:a.value){let e=(null==u?void 0:u.displayName)||d.settingDefinitionId,n=d.choiceSettingValue.value,a=(null==u?void 0:null===(c=u.options)||void 0===c?void 0:null===(r=c.find(e=>e.id===n))||void 0===r?void 0:r.displayName)||n;"string"==typeof a&&w(a)&&T[a]&&(a=(0,l.jsx)(s.A,{title:"GUID: ".concat(a),placement:"top",children:(0,l.jsxs)("div",{children:[T[a],(0,l.jsx)(o.A,{variant:"caption",sx:{fontStyle:"italic",ml:1,color:"text.secondary"},children:"(GUID)"})]})})),t.push((0,l.jsx)(y.N,{label:e,value:a},"setting-".concat(i)))}else{let e=(null==u?void 0:u.displayName)||d.settingDefinitionId;t.push((0,l.jsx)(y.N,{label:e,value:"This setting could not be resolved"},"setting-".concat(i)))}}):e.added?t.push((0,l.jsx)(y.N,{label:"Legacy Policy",value:"This is a legacy policy and the settings can only be shown in JSON format. Press the eye icon to view the JSON."},"legacyPolicy")):Object.entries(e).forEach(e=>{let[i,n]=e;"string"==typeof n&&w(n)&&T[n]?t.push((0,l.jsx)(y.N,{label:(0,m.i)(i),value:(0,l.jsx)(s.A,{title:"GUID: ".concat(n),placement:"top",children:(0,l.jsxs)("div",{children:[T[n],(0,l.jsx)(o.A,{variant:"caption",sx:{fontStyle:"italic",ml:1,color:"text.secondary"},children:"(GUID)"})]})})},i)):"string"==typeof n&&w(n)&&J?t.push((0,l.jsx)(y.N,{label:(0,m.i)(i),value:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(r.A,{size:16,sx:{mr:1}}),(0,l.jsx)("span",{children:(0,N.i)(n,i)})]})},i)):t.push((0,l.jsx)(y.N,{label:(0,m.i)(i),value:(0,N.i)(n,i)},i))}),t};(0,n.useEffect)(()=>{!i&&((null==t?void 0:t.omaSettings)||(null==t?void 0:t.settings)||(null==t?void 0:t.added))&&(i="intune");let e=["selectedOption","GUID","ID","id","noSubmitButton","createdDateTime","modifiedDateTime"],l=I(t);k([Object.fromEntries(Object.entries(l).filter(t=>{let[i]=t;return!e.includes(i)}))]),W(l)},[t,M]),(0,n.useEffect)(()=>{if($.length>0&&!J){let e=Date.now();if(e-B>=2e3){let t=$.slice(0,1e3);K(e),L(!0),Q.mutate({url:"/api/ListDirectoryObjects",data:{tenantFilter:M,ids:t,$select:"id,displayName,userPrincipalName,mail"}})}}},[T,R,$,B,J,Q,M]);let H=(e,t)=>{let i=P.slice(0,t+1);i[t+1]=e,k(i),W(e)};return(0,l.jsxs)(c.A,{variant:"outlined",expanded:V,onChange:()=>C(!V),children:[(0,l.jsx)(d.A,{expandIcon:(0,l.jsx)(x.A,{}),sx:{display:"flex",alignItems:"center"},children:(0,l.jsxs)(u.A,{direction:"row",spacing:1,alignItems:"space-between",sx:{width:"100%"},children:[(0,l.jsx)(o.A,{variant:"h6",sx:{flexGrow:1},children:"Policy Details"}),J&&(0,l.jsxs)(o.A,{variant:"caption",sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(r.A,{size:16,sx:{mr:1}})," Resolving object identifiers..."]})]})}),(0,l.jsxs)(p.A,{children:[(0,l.jsx)(h.A,{onClick:()=>U(!G),sx:{ml:1},children:G?(0,l.jsx)(g.A,{}):(0,l.jsx)(f.A,{})}),G?(0,l.jsx)(S.x,{type:"editor",code:JSON.stringify(I(t),null,2)}):(0,l.jsx)(v.A,{container:!0,spacing:2,children:null==P?void 0:P.filter(e=>null!=e).map((e,t)=>(0,l.jsxs)(v.A,{size:{sm:"intune"===i?12:3,xs:12},sx:{paddingTop:2*(0!==t),borderTop:t>=4&&"intune"!==i?"1px solid lightgrey":"none",borderRight:t<P.length-1?"1px solid lightgrey":"none",overflowWrap:"anywhere",whiteSpace:"pre-line",paddingRight:2},children:["intune"!==i&&(0,l.jsx)(j.g,{children:O(e,e=>H(e,t),T,J)}),"intune"===i&&(0,l.jsx)(j.g,{children:q(e)})]},t))})]})]})}}}]);