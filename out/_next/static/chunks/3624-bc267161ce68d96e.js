(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3624],{36577:(e,s,i)=>{"use strict";i.d(s,{A:()=>p});var n=i(37876),a=i(89099),t=i(67578),l=i(86650),r=i(22474),o=i(47737),d=i(94810),c=i(77018),u=i(54538),m=i(42120),h=i(2303);let p=e=>{let{title:s,backButtonTitle:i="Back",children:p,cardSize:x="xl",hideTitleText:f=!1,hideBackButton:g=!1,noTenantInHead:j=!1,infoBar:v}=e,A=(0,a.useRouter)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.v,{title:s,noTenant:j}),(0,n.jsx)(t.A,{sx:{flexGrow:1,py:4},children:(0,n.jsx)(l.A,{maxWidth:x,children:(0,n.jsxs)(r.A,{spacing:2,children:[(0,n.jsxs)(r.A,{spacing:2,children:[(0,n.jsx)("div",{children:!g&&(0,n.jsx)(o.A,{color:"inherit",onClick:()=>{A.back()},startIcon:(0,n.jsx)(d.A,{fontSize:"small",children:(0,n.jsx)(m.A,{})}),children:i})}),!0!==f&&(0,n.jsx)("div",{children:(0,n.jsx)(c.A,{variant:"h4",children:s})})]}),v,(0,n.jsx)(u.A,{children:p})]})})})]})}},37242:(e,s,i)=>{"use strict";i.d(s,{g:()=>m});var n=i(37876),a=i(95062),t=i.n(a),l=i(30236),r=i(14563),o=i(67578),d=i(24422),c=i(94810),u=i(77018);let m=e=>{let{accept:s,caption:i,maxFiles:a,maxSize:t,minSize:m,onDrop:h,sx:p}=e,{getRootProps:x,getInputProps:f,isDragActive:g}=(0,l.VB)({accept:s,maxFiles:a,maxSize:t,minSize:m,onDrop:h});return(0,n.jsxs)(o.A,{sx:{alignItems:"center",borderColor:e=>"dark"===e.palette.mode?"neutral.800":"neutral.200",borderRadius:1,borderStyle:"dashed",borderWidth:1,cursor:"pointer",display:"flex",flexDirection:"column",flexWrap:"wrap",justifyContent:"center",outline:"none",width:"100%",py:2,...g&&{borderColor:"primary.main",backgroundColor:"action.hover"},"&:hover":{borderColor:"primary.main",backgroundColor:"action.hover"},...p},...x(),children:[(0,n.jsx)(d.A,{sx:{backgroundColor:"neutral.200",color:"text.secondary",height:42,width:42},children:(0,n.jsx)(c.A,{fontSize:"small",children:(0,n.jsx)(r.A,{})})}),i&&(0,n.jsx)(u.A,{align:"center",color:"text.secondary",sx:{mt:1},variant:"caption",children:i}),(0,n.jsx)("input",{...f()})]})};m.propTypes={accept:t().objectOf(t().arrayOf(t().string)),caption:t().string,maxFiles:t().number,maxSize:t().number,minSize:t().number,onDrop:t().func,sx:t().object}},53311:(e,s,i)=>{"use strict";i.d(s,{q:()=>ei,A:()=>en});var n=i(37876),a=i(14232),t=i(97728),l=i(24280),r=i(47737),o=i(94810),d=i(54538),c=i(24933),u=i(1073),m=i(77018),h=i(22430),p=i(52808),x=i(6003),f=i(70946),g=i(5596),j=i(47866),v=i(3034),A=i(82179),b=i(59568),S=i(89037),y=i(21874),w=i(39413),k=i(41361),C=i(44347),I=i(97801),T=i(74467),L=i(19736),P=i(62050),R=i(7222),E=i(24180),N=i(30052),D=i(50625),z=i(77e3),F=i(60662),H=i(50371),M=i(80580),O=i(25052),U=i(48504),B=i(43225),V=i(24921),K=i(12227),W=i(13042),J=i(37242),_=i(36577),G=i(62423),q=i(81514),Y=i(30155),Q=i(4004),X=i(17825),Z=i(33862);let $={ARC:{label:"ARC Protocol",values:{AAR:"Records the content of the Authentication-results header from DMARC.",AMS:"Includes cryptographic signatures of the message.",AS:"Includes cryptographic signatures of the message headers"}},CAT:{label:"The category of protection policy",values:{BULK:"Bulk",DIMP:"Domain Impersonation",GIMP:"Mailbox intelligence based impersonation",HPHSH:"High confidence phishing",HPHISH:"High confidence phishing",HSPM:"High confidence spam",MALW:"Malware",PHSH:"Phishing",SPM:"Spam",SPOOF:"Spoofing",UIMP:"User Impersonation",AMP:"Anti-malware",SAP:"Safe attachments",OSPM:"Outbound spam",NONE:"Clean message"}},CIP:{label:"Connecting IP Address"},CTRY:{label:"The source country as determined by the connecting IP address"},H:{label:"The HELO or EHLO string of the connecting email server"},IPV:{label:"Ingress Peer Verification status",values:{CAL:"Source IP address was Configured in Allowed List (CAL)",NLI:"The IP address was not found on any IP reputation list."}},EFV:{label:"Egress Verification status",values:{CAL:"Source IP address was Configured in Allowed List (CAL)",NLI:"The IP address was not found on any IP reputation list."}},DIR:{label:"Direction of email verification",values:{INB:"Inbound email verification",OUT:"Outbound email verification",OUB:"Outbound email verification",OTB:"Outbound email verification"}},LANG:{label:"The language in which the message was written"},PTR:{label:"Reverse DNS of the Connecting IP peer's address"},SFTY:{label:"The message was identified as phishing",values:{"9.19":"Domain impersonation. The sending domain is attempting to impersonate a protected domain","9.20":"User impersonation. The sending user is attempting to impersonate a user in the recipient's organization"}},SRV:{label:"Bulk Email analysis results",values:{BULK:"The message was identified as bulk email by spam filtering and the bulk complaint level (BCL) threshold"}},SFV:{label:"Message Filtering",values:{BLK:"Filtering was skipped and the message was blocked because it was sent from an address in a user's Blocked Senders list.",NSPM:"Spam filtering marked the message as non-spam and the message was sent to the intended recipients.",SFE:"Filtering was skipped and the message was allowed because it was sent from an address in a user's Safe Senders list.",SKA:"The message skipped spam filtering and was delivered to the Inbox because the sender was in the allowed senders list or allowed domains list in an anti-spam policy.",SKB:"The message was marked as spam because it matched a sender in the blocked senders list or blocked domains list in an anti-spam policy.",SKI:"Similar to SFV:SKN, the message skipped spam filtering for another reason (for example, an intra-organizational email within a tenant).",SKN:"The message was marked as non-spam prior to being processed by spam filtering. For example, the message was marked as SCL -1 or Bypass spam filtering by a mail flow rule.",SKQ:"The message was released from the quarantine and was sent to the intended recipients.",SKS:"The message was marked as spam prior to being processed by spam filtering. For example, the message was marked as SCL 5 to 9 by a mail flow rule.",SPM:"The message was marked as spam by spam filtering."}},SCL:{label:"Spam Confidence Level",values:{"-1":"-1: The message skipped spam filtering. Deliver the message to recipient Inbox folders.",0:"0: Spam filtering determined the message wasn't spam. Deliver the message to recipient Inbox folders.",1:"1: Spam filtering determined the message wasn't spam. Deliver the message to recipient Inbox folders.",5:"5: Spam filtering marked the message as Spam. Deliver the message to recipient Junk Email folders.",6:"6: Spam filtering marked the message as Spam. Deliver the message to recipient Junk Email folders.",7:"7: Spam filtering marked the message as High confidence spam. Deliver the message to recipient Junk Email folders.",8:"8: Spam filtering marked the message as High confidence spam. Deliver the message to recipient Junk Email folders.",9:"9: Spam filtering marked the message as High confidence spam. Deliver the message to recipient Junk Email folders."}}},ee=e=>e.split(";").map(e=>{let[s,i]=e.split(":");return{key:s.trim(),value:null==i?void 0:i.trim()}}),es=e=>{let{open:s,onClose:i,header:a}=e,t=ee(a).filter(e=>e.key&&e.value&&"SFS"!==e.key).map(e=>{var s,i,n;return{label:(null===(s=$[e.key])||void 0===s?void 0:s.label)||e.key,value:(null===(n=$[e.key])||void 0===n?void 0:null===(i=n.values)||void 0===i?void 0:i[e.value])||e.value||"N/A"}});return(0,n.jsxs)(g.A,{open:s,onClose:i,maxWidth:"md",fullWidth:!0,children:[(0,n.jsxs)(j.A,{sx:{py:2},children:[(0,n.jsx)(F.A,{})," Anti-Spam Report",(0,n.jsx)(f.A,{"aria-label":"close",onClick:i,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,n.jsx)(U.A,{})})]}),(0,n.jsx)(v.A,{dividers:!0,children:(0,n.jsx)(Z.E,{propertyItems:t})})]})},ei=e=>{let{emailSource:s}=e,[i,J]=(0,a.useState)(null),[_,Z]=(0,a.useState)(!1),[$,ee]=(0,a.useState)(""),[en,ea]=(0,a.useState)(null),[et,el]=(0,a.useState)({}),[er,eo]=(0,a.useState)(!1),[ed,ec]=(0,a.useState)(null),[eu,em]=(0,a.useState)(""),[eh,ep]=(0,a.useState)(!1),[ex,ef]=(0,a.useState)(""),eg=null===(eT=(0,X.t)())||void 0===eT?void 0:null===(eI=eT.currentTheme)||void 0===eI?void 0:eI.value,[ej,ev]=(0,a.useState)("dark"===eg),eA=(0,n.jsx)(l.A,{styles:{a:{color:ej?"#bb86fc":"#1a73e8"}}}),eb=(0,w.A)({palette:{background:{default:ej?"#121212":"#ffffff",paper:ej?"#1d1d1d":"#f5f5f5"},text:{primary:ej?"#ffffff":"#000000",secondary:ej?"#b0bec5":"#757575"},action:{active:ej?"#ffffff":"#000000"}}}),eS=e=>{if(e.includes("image"))return(0,n.jsx)(k.A,{});if(e.includes("audio"))return(0,n.jsx)(C.A,{});if(e.includes("video"))return(0,n.jsx)(I.A,{});if(e.includes("text"))return(0,n.jsx)(T.A,{});if(e.includes("pdf"))return(0,n.jsx)(L.A,{});else if(e.includes("zip")||e.includes("compressed")||e.includes("tar")||e.includes("gzip"))return(0,n.jsx)(P.A,{});else if(e.includes("msword"))return(0,n.jsx)(R.A,{});else if(e.includes("spreadsheet"))return(0,n.jsx)(E.A,{});else if(e.includes("presentation"))return(0,n.jsx)(N.A,{});else if(e.includes("json")||e.includes("xml"))return(0,n.jsx)(D.A,{});else if(e.includes("rfc822"))return(0,n.jsx)(z.A,{});else return(0,n.jsx)(T.A,{})},ey=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var i,a,t,l=null!==(a=null==e?void 0:null===(i=e.contentType)||void 0===i?void 0:i.split(";")[0])&&void 0!==a?a:"text/plain",r=e.data;r instanceof Uint8Array&&(null==e?void 0:e.data64)&&(r=new Uint8Array(atob(e.data64).split("").map(e=>e.charCodeAt(0))));var o=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"attachment";let d=new Blob([r],{type:null!=l?l:"application/octet-stream"}),c=URL.createObjectURL(d),u=document.createElement("a");if(s){if(l.includes("rfc822")){var m=r;ec((0,n.jsx)(ei,{emailSource:m})),em(o),eo(!0)}else if(l.includes("pdf"))ec((0,n.jsx)("object",{data:c,type:"application/pdf",width:"100%",height:"600px"})),em(o),eo(!0);else if(l.includes("image"))ec((0,n.jsx)("img",{src:c,alt:o,style:{maxWidth:"100%"}})),em(o),eo(!0);else if(l.includes("text")){let e=r;ec((0,n.jsx)(V.x,{code:e,language:"plain",showLineNumbers:!1})),em(o),eo(!0),setTimeout(()=>{URL.revokeObjectURL(c)},1e3)}else window.open().location.href=c,URL.revokeObjectURL(c)}else u.href=c,u.download=o,u.click(),URL.revokeObjectURL(c)};function ew(e){return e instanceof Date&&!isNaN(e)}let ek=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Email Source";ec((0,n.jsx)(V.x,{code:e,language:"plain",showLineNumbers:!1})),em(s),eo(!0)},eC=e=>{ef(e),ep(!0)};(0,a.useEffect)(()=>{(0,t.bZ)(s,(e,i)=>{if(e)Z(!0),J(null),ee(null),ea(null);else{if(J(i),Z(!1),i.html){var t=K.default.sanitize(i.html),l=(0,W.Ay)(t);i.attachments&&i.attachments.forEach(e=>{if(e.id){var s=e.id.match(/<(.*)>/)[1],i=e.data64;if(i){let e=t=>{if("object"==typeof t&&null!==t){if(t.props.src==="cid:"+s)return(0,n.jsx)("img",{src:"data:image/png;base64,"+i,alt:s});if(t.props.children)return a.cloneElement(t,{children:a.Children.map(t.props.children,e)})}return t};l=l.map(e)}}}),ee(l)}else ee(null);let e=s.match(/(?:^[\w-]+:\s?.*(?:\r?\n[ \t].*)*\r?\n?)+/gm);ea(e?e[0]:null)}})},[s,ee,Z,J,ea]);var eI,eT,eL,eP,eR,eE,eN,eD=((e,s)=>{var i;let a=new Blob([new TextEncoder().encode(s)],{type:"message/rfc822"});URL.createObjectURL(a);let t=null==e?void 0:null===(i=e.match(/X-Forefront-Antispam-Report: (.*)/))||void 0===i?void 0:i[1];return(0,n.jsxs)(A.A,{spacing:1,direction:"row",sx:{mt:1.5,mr:1},children:[e&&(0,n.jsx)(r.A,{size:"small",variant:"contained",onClick:()=>ek(e,"Email Headers"),startIcon:(0,n.jsx)(o.A,{fontSize:"small",children:(0,n.jsx)(D.A,{})}),children:"View Headers"}),t&&(0,n.jsx)(r.A,{size:"small",variant:"contained",onClick:()=>eC(t),startIcon:(0,n.jsx)(o.A,{fontSize:"small",children:(0,n.jsx)(F.A,{})}),children:"Anti-Spam Report"}),(0,n.jsx)(r.A,{size:"small",variant:"contained",onClick:()=>ek(s),startIcon:(0,n.jsx)(o.A,{fontSize:"small",children:(0,n.jsx)(z.A,{})}),children:"View Source"})]})})(en,s);return(0,n.jsxs)(n.Fragment,{children:[_&&(0,n.jsx)(d.A,{className:"mt-2 mb-4",children:(0,n.jsxs)(c.A,{children:[(0,n.jsx)("h2",{children:"Error"}),"Unable to parse the EML file, email source is displayed below.",(0,n.jsx)(V.x,{code:s,language:"plain",showLineNumbers:!1})]})}),i&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(d.A,{sx:{mt:2,mb:4},children:[(0,n.jsx)(u.A,{noTypography:!0,title:(0,n.jsx)(m.A,{variant:"h4",children:null!==(eE=null==i?void 0:i.subject)&&void 0!==eE?eE:"No subject"}),action:eD,sx:{py:0,my:0}}),(0,n.jsxs)(c.A,{children:[(0,n.jsxs)(b.A,{container:!0,spacing:2,sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsxs)(b.A,{size:{xs:12,md:9},children:[(0,n.jsxs)(S.A,{display:"flex",alignItems:"center",children:[(0,n.jsx)(H.A,{fontSize:"large",sx:{mr:1}}),(0,n.jsxs)(A.A,{direction:"row",spacing:.5,alignItems:"center",display:"flex",children:[(0,n.jsx)("b",{children:null==i?void 0:null===(eL=i.from)||void 0===eL?void 0:eL.name}),(0,n.jsxs)(m.A,{variant:"subtitle2",color:"textSecondary",children:["<",null==i?void 0:null===(eP=i.from)||void 0===eP?void 0:eP.email,">"]}),(()=>{var e;let s=(null==i?void 0:null===(e=i.headers)||void 0===e?void 0:e["Authentication-Results"])||"",a=!!s&&s.includes("dmarc=pass"),t=!!s&&s.includes("dkim=pass"),l=!!s&&s.includes("spf=pass"),r=!!s&&s.includes("arc=pass"),d=a&&t&&l&&r,c=a||t||l||r,u=""===s,m=u?(0,n.jsx)(G.A,{}):d?(0,n.jsx)(q.A,{}):(0,n.jsx)(G.A,{});return(0,n.jsx)(h.A,{title:u?"No authentication results available":"".concat(d?"All authentication checks successful":c?"Some authentication checks failed":"None of the authentication checks passed"," - DMARC: ").concat(a?"pass":"fail",", DKIM: ").concat(t?"pass":"fail",", SPF: ").concat(l?"pass":"fail",", ARC: ").concat(r?"pass":"fail"),placement:"top",children:(0,n.jsx)(o.A,{fontSize:"small",sx:{color:u?"":d?"green":c?"orange":"red"},style:{cursor:"pointer"},children:m})})})()]})]}),(null==i?void 0:i.to)&&(0,n.jsx)(S.A,{children:(0,n.jsxs)(m.A,{variant:"subtitle2",children:[(0,n.jsx)("b",{children:"To:"})," ",Array.isArray(i.to)?i.to.map(e=>e.name+" <"+e.email+">").join(", "):i.to.name+" <"+i.to.email+">"]})}),(null==i?void 0:i.cc)&&(0,n.jsx)("div",{children:(0,n.jsxs)("small",{children:[(0,n.jsx)("b",{children:"CC:"})," ",Array.isArray(i.cc)?i.cc.map(e=>e.name+" <"+e.email+">").join(", "):i.cc.name+" <"+i.cc.email+">"]})})]}),(0,n.jsx)(b.A,{size:{xs:12,md:3},children:(0,n.jsxs)(A.A,{direction:"row",spacing:.5,justifyContent:"flex-end",children:[(0,n.jsx)(m.A,{variant:"subtitle2",children:i.date&&ew(i.date)?i.date.toLocaleDateString():"Invalid Date"}),i.date&&ew(i.date)&&(0,n.jsxs)(m.A,{variant:"subtitle2",color:"textSecondary",children:[" ","(",(0,n.jsx)(B.z,{data:i.date}),")"]})]})})]}),i.attachments&&i.attachments.length>0&&(0,n.jsx)(b.A,{container:!0,spacing:2,sx:{mb:2},children:(0,n.jsx)(b.A,{size:12,children:(0,n.jsx)(A.A,{spacing:1,direction:"row",children:null==i?void 0:null===(eR=i.attachments)||void 0===eR?void 0:eR.map((e,s)=>{var i,t,l,d,c,u;return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)(r.A,{variant:"contained",size:"small",onClick:e=>el({...et,[s]:e.currentTarget}),startIcon:(0,n.jsx)(o.A,{fontSize:"small",children:eS(null!==(c=null==e?void 0:e.contentType)&&void 0!==c?c:"text/plain")}),children:null!==(u=e.name)&&void 0!==u?u:"No name"}),(0,n.jsxs)(p.A,{anchorEl:et[s],open:!!et[s],onClose:()=>el({...et,[s]:null}),children:[(0,n.jsxs)(x.A,{onClick:()=>ey(e),children:[(0,n.jsx)(M.A,{sx:{mr:1}}),"Download"]}),((null==e?void 0:e.contentType)===void 0||(null==e?void 0:null===(i=e.contentType)||void 0===i?void 0:i.includes("text"))||(null==e?void 0:null===(t=e.contentType)||void 0===t?void 0:t.includes("pdf"))||(null==e?void 0:null===(l=e.contentType)||void 0===l?void 0:l.includes("image"))||(null==e?void 0:null===(d=e.contentType)||void 0===d?void 0:d.includes("rfc822")))&&(0,n.jsxs)(x.A,{onClick:()=>ey(e,!0),children:[(0,n.jsx)(O.A,{sx:{mr:1}}),"View"]})]})]},s)})})})}),((null==i?void 0:i.text)||(null==i?void 0:i.html))&&(0,n.jsx)(b.A,{container:!0,spacing:2,children:(0,n.jsx)(b.A,{size:12,children:$?(0,n.jsxs)(y.A,{theme:eb,children:[eA,(0,n.jsx)(d.A,{variant:"outlined",children:(0,n.jsxs)(c.A,{children:[(0,n.jsx)(S.A,{display:"flex",justifyContent:"flex-end",mb:1,children:(0,n.jsx)(f.A,{variant:"text",onClick:()=>{ev(e=>!e)},children:(0,n.jsx)(o.A,{children:ej?(0,n.jsx)(Y.A,{}):(0,n.jsx)(Q.A,{})})})}),$]})})]}):(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(V.x,{code:null!==(eN=null==i?void 0:i.text)&&void 0!==eN?eN:"No text",language:"plain",showLineNumbers:!1})})})})]})]})}),(0,n.jsxs)(g.A,{open:er,onClose:()=>eo(!1),maxWidth:"lg",fullWidth:!0,children:[(0,n.jsxs)(j.A,{sx:{py:2},children:[eu,(0,n.jsx)(f.A,{"aria-label":"close",onClick:()=>eo(!1),sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,n.jsx)(U.A,{})})]}),(0,n.jsx)(v.A,{dividers:!0,children:ed})]}),(0,n.jsx)(es,{open:eh,onClose:()=>ep(!1),header:ex})]})},en=()=>{let[e,s]=(0,a.useState)(null),i=(0,a.useCallback)(e=>{e.forEach(e=>{let i=new FileReader;i.onabort=()=>console.log("file reading was aborted"),i.onerror=()=>console.log("file reading has failed"),i.onload=()=>{s(i.result)},i.readAsText(e)})},[]);return(0,n.jsxs)(_.A,{title:"Message Viewer",hideBackButton:!0,children:[(0,n.jsx)(J.g,{onDrop:i,accept:{"message/rfc822":[".eml"]},caption:"Drag an EML file or click to add",maxFiles:1}),e&&(0,n.jsx)(ei,{emailSource:e})]})}},95098:()=>{}}]);