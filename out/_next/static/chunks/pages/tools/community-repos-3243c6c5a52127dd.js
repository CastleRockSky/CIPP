(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7427],{41055:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(14232);let i=a.forwardRef(function(e,t){let{title:r,titleId:i,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},l),r?a.createElement("title",{id:i},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})},46091:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(93944),i=r(37876);let l=(0,a.A)((0,i.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"OpenInNew")},47928:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(93944),i=r(37876);let l=(0,a.A)((0,i.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddBox")},76613:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tools/community-repos",function(){return r(88279)}])},88279:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>B});var a=r(37876),i=r(14232),l=r(12435),s=r(29390),n=r(47737),o=r(94810),c=r(5596),d=r(47866),u=r(3034),h=r(22474),m=r(78523),p=r(68284),x=r(71538),A=r(77018),j=r(54538),y=r(76776),v=r(46061),g=r(24933),f=r(22430),b=r(70946),C=r(59017),w=r(41055),R=r(73362),T=r(22322),N=r(88992),O=r(15319),S=r(35656),k=r(63664),F=r(46402),E=r(95339),V=r(89037),I=r(46091);let _=(0,r(93944).A)((0,a.jsx)("path",{d:"M9.41 15.59 8 17l-4-4 4-4 1.41 1.41L7.83 12c1.51-.33 3.73.08 5.17 1.36V6.83l-1.59 1.59L10 7l4-4 4 4-1.41 1.41L15 6.83V21h-2v-4c-.73-2.58-3.07-3.47-5.17-3z"}),"ForkLeft");var P=r(47928),L=r(48504),D=r(68723),G=r(58105);let H=()=>{var e,t;let[r,l]=(0,i.useState)(!1),[H,B]=(0,i.useState)([]),[q,W]=(0,i.useState)(""),[z,K]=(0,i.useState)(""),[U,M]=(0,i.useState)(""),[Q,X]=(0,i.useState)(!1),Y=(0,N.mN)({mode:"onChange",defaultValues:{Type:"user"}}),J=(0,T.R_)({url:"/api/ListExtensionsConfig",queryKey:"Integrations",refetchOnMount:!1,refetchOnReconnect:!1}),Z=(0,T.nN)({urlFromData:!0,relatedQueryKeys:["CommunityRepos"]}),$=[{label:"View Templates",link:"/tools/community-repos/repo?name=[FullName]&branch=[DefaultBranch]",icon:(0,a.jsx)(I.A,{})},{label:"Delete",type:"POST",url:"/api/ExecCommunityRepo",data:{Action:"Delete",Id:"Id"},confirmText:"Are you sure you want to delete this repo?",icon:(0,a.jsx)(w.A,{}),multiPost:!1,queryKey:"CommunityRepos"},{label:"Set Upload Branch",type:"POST",url:"/api/ExecCommunityRepo",data:{Action:"SetBranch",Id:"Id"},icon:(0,a.jsx)(_,{}),fields:[{type:"select",name:"Branch",label:"Branch",api:{url:"/api/ExecGitHubAction",type:"GET",data:{Action:"GetBranches",FullName:"FullName"},dataKey:"Results",labelField:"name",valueField:"name",processFieldData:!0}}],hideBulk:!0,confirmText:"Are you sure you want to set the branch for this repository?",condition:e=>!0===e.WriteAccess}],ee=(0,T.nN)({urlFromData:!0,onResult:e=>{B((null==e?void 0:e.Results)||[])}}),et=(0,N.mN)({defaultValues:{searchType:"user",searchTerm:[]}}),er=et.watch("searchTerm"),ea=()=>{var e;let t=null!==(e=er.map(e=>e.value))&&void 0!==e?e:[];ee.mutate({url:"/api/ExecGitHubAction",data:{Action:"Search",Repository:q||"",User:z||"",Org:U||"",SearchTerm:t,Type:"repositories"}})},ei=(0,T.nN)({urlFromData:!0,relatedQueryKeys:["CommunityRepos"]}),el=e=>{ei.mutate({url:"/api/ExecCommunityRepo",data:{Action:"Add",Id:e}})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.a,{title:"Community Repositories",tenantInTitle:!1,apiUrl:"/api/ListCommunityRepos",apiDataKey:"Results",queryKey:"CommunityRepos",actions:$,offCanvas:{extendedInfoFields:["Owner","Name","Description","URL","Visibility","DefaultBranch","UploadBranch","Permissions"],actions:$},simpleColumns:["Name","Owner","URL","Visibility","WriteAccess","UploadBranch"],cardButton:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.A,{onClick:()=>l(!0),startIcon:(0,a.jsx)(o.A,{children:(0,a.jsx)(R.A,{})}),children:"Find a Repository"}),(0,a.jsx)(n.A,{onClick:()=>X(!0),startIcon:(0,a.jsx)(P.A,{}),disabled:!J.isSuccess||!(null==J?void 0:null===(t=J.data)||void 0===t?void 0:null===(e=t.GitHub)||void 0===e?void 0:e.Enabled),children:"Create Repository"})]})}),(0,a.jsxs)(c.A,{fullWidth:!0,maxWidth:"md",open:Q,onClose:()=>X(!1),children:[(0,a.jsx)(d.A,{children:"Create New Repository"}),(0,a.jsxs)(u.A,{children:[(0,a.jsxs)(N.Op,{...Y,children:[(0,a.jsxs)(O.A,{row:!0,value:Y.watch("type"),onChange:e=>{Y.setValue("type",e.target.value)},children:[(0,a.jsx)(S.A,{value:"user",control:(0,a.jsx)(k.A,{}),label:"User"}),(0,a.jsx)(S.A,{value:"org",control:(0,a.jsx)(k.A,{}),label:"Org"})]}),(0,a.jsxs)(h.A,{spacing:1,sx:{mt:2},children:[(0,a.jsx)(F.A,{field:"type",compareType:"is",compareValue:"org",formControl:Y,children:(0,a.jsx)(G.A,{type:"autoComplete",name:"orgName",formControl:Y,label:"Organization",api:{url:"/api/ExecGitHubAction",data:{Action:"GetOrgs"},queryKey:"GitHubOrgs",dataKey:"Results",labelField:"login",valueField:"login"},multiple:!1,required:!0,validators:{required:{value:!0,message:"Organization is required"}}})}),(0,a.jsx)(G.A,{type:"textField",name:"repoName",label:"Repository Name",formControl:Y,required:!0}),(0,a.jsx)(G.A,{type:"textField",name:"Description",label:"Description",formControl:Y}),(0,a.jsx)(G.A,{type:"switch",name:"Private",label:"Private",formControl:Y})]})]}),(0,a.jsx)(D.v,{apiObject:Z})]}),(0,a.jsxs)(m.A,{children:[(0,a.jsx)(n.A,{variant:"outlined",onClick:()=>X(!1),startIcon:(0,a.jsx)(L.A,{}),children:"Close"}),(0,a.jsx)(n.A,{variant:"contained",type:"submit",onClick:Y.handleSubmit(e=>{var t;Z.mutate({url:"/api/ExecGitHubAction",data:{Action:"CreateRepo",Type:e.type,Name:e.repoName,Org:null===(t=e.orgName)||void 0===t?void 0:t.value,Description:e.Description,Private:e.Private}})}),startIcon:(0,a.jsx)(E.A,{}),disabled:Z.isPending,children:"Create"})]})]}),(0,a.jsxs)(c.A,{fullWidth:!0,maxWidth:"md",open:r,onClose:()=>l(!1),children:[(0,a.jsx)(d.A,{children:"Add Community Repositories from GitHub"}),(0,a.jsxs)(u.A,{children:[(0,a.jsxs)(N.Op,{...et,children:[(0,a.jsxs)(O.A,{row:!0,value:et.watch("searchType"),onChange:e=>et.setValue("searchType",e.target.value),children:[(0,a.jsx)(S.A,{value:"user",control:(0,a.jsx)(k.A,{}),label:"User"}),(0,a.jsx)(S.A,{value:"org",control:(0,a.jsx)(k.A,{}),label:"Org"}),(0,a.jsx)(S.A,{value:"repository",control:(0,a.jsx)(k.A,{}),label:"Repository"})]}),(0,a.jsxs)(h.A,{spacing:1.5,sx:{mt:2,mb:2},children:[(0,a.jsx)(F.A,{field:"searchType",compareType:"is",compareValue:"repository",formControl:et,children:(0,a.jsx)(p.A,{fullWidth:!0,label:"Repository in 'owner/repo' format (e.g. KelvinTegelaar/CIPP)",value:q,onChange:e=>W(e.target.value),required:!0})}),(0,a.jsxs)(F.A,{field:"searchType",compareType:"is",compareValue:"user",formControl:et,children:[(0,a.jsx)(p.A,{fullWidth:!0,label:"User",value:z,onChange:e=>K(e.target.value),required:!0}),(0,a.jsx)(G.A,{type:"autoComplete",name:"searchTerm",formControl:et,freeSolo:!0,fullWidth:!0,options:[],label:"Search Terms"})]}),(0,a.jsxs)(F.A,{field:"searchType",compareType:"is",compareValue:"org",formControl:et,children:[(0,a.jsx)(p.A,{fullWidth:!0,label:"Organization",value:U,onChange:e=>M(e.target.value),required:!0}),(0,a.jsx)(G.A,{type:"autoComplete",name:"searchTerm",formControl:et,freeSolo:!0,fullWidth:!0,options:[],label:"Search Terms"})]})]})]}),ee.isPending||ee.isSuccess&&(0,a.jsxs)(h.A,{spacing:2,children:[(0,a.jsx)(x.A,{}),(0,a.jsx)(A.A,{variant:"h6",children:"Search Results"})]}),ee.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.A,{spacing:2,children:[(0,a.jsx)(x.A,{}),(0,a.jsx)(A.A,{variant:"h6",children:"Searching..."})]}),(0,a.jsx)(j.A,{variant:"outlined",sx:{p:1,mt:1.5},children:(0,a.jsx)(y.A,{height:80,variant:"rectangular"})}),(0,a.jsx)(j.A,{variant:"outlined",sx:{p:1,mt:1.5},children:(0,a.jsx)(y.A,{height:80,variant:"rectangular"})}),(0,a.jsx)(j.A,{variant:"outlined",sx:{p:1,mt:1.5},children:(0,a.jsx)(y.A,{height:80,variant:"rectangular"})})]}):(0,a.jsxs)(a.Fragment,{children:[ee.isSuccess&&0===H.length||ee.isError&&(0,a.jsx)(v.A,{severity:"warning",children:"No search results found. Refine your query and try again."}),(0,a.jsx)(V.A,{sx:{overflowY:"scroll",maxHeight:300,mb:1.5},children:H.map(e=>(0,a.jsx)(j.A,{variant:"outlined",sx:{mt:1.5,mr:1},children:(0,a.jsx)(g.A,{children:(0,a.jsxs)(h.A,{direction:"row",spacing:1.5,alignItems:"center",children:[(0,a.jsx)(f.A,{title:"Add Repository",children:(0,a.jsx)(b.A,{size:"small",onClick:()=>el(e.id),children:(0,a.jsx)(E.A,{})})}),(0,a.jsx)(f.A,{title:"Open GitHub",children:(0,a.jsx)(b.A,{size:"small",onClick:()=>window.open(e.html_url,"_blank"),children:(0,a.jsx)(I.A,{})})}),(0,a.jsxs)(V.A,{sx:{flexGrow:1},children:[(0,a.jsxs)(V.A,{sx:{width:"100%",display:"flex",alignItems:"center",flexGrow:1},children:[(0,a.jsx)(A.A,{variant:"h6",sx:{flexGrow:1},children:e.full_name}),(0,a.jsx)(C.A,{size:"small",color:"private"===e.visibility?"error":"public"===e.visibility?"success":"primary",variant:"outlined",label:e.visibility,sx:{textTransform:"capitalize"}})]}),(0,a.jsx)(A.A,{variant:"body2",color:"textSecondary",children:e.html_url})]})]})})},e.id))})]}),(0,a.jsx)(V.A,{children:(0,a.jsx)(D.v,{apiObject:ei})})]}),(0,a.jsxs)(m.A,{children:[(0,a.jsx)(n.A,{variant:"outlined",onClick:()=>l(!1),startIcon:(0,a.jsx)(L.A,{}),children:"Close"}),(0,a.jsx)(n.A,{variant:"contained",onClick:()=>ea(),startIcon:(0,a.jsx)(o.A,{children:(0,a.jsx)(R.A,{})}),children:"Search"})]})]})]})};H.getLayout=e=>(0,a.jsx)(l.P,{children:e});let B=H}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(76613)),_N_E=e.O()}]);