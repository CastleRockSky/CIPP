(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8874],{717:(e,l,t)=>{"use strict";t.d(l,{A:()=>i});var a=t(93944),n=t(37876);let i=(0,a.A)((0,n.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M17 13l-5 5-5-5h3V9h4v4z"}),"CloudDownload")},54312:(e,l,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tools/community-repos/repo",function(){return t(89556)}])},89556:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>f});var a=t(37876),n=t(89099),i=t(12435),u=t(29390),s=t(14232),o=t(22322),r=t(5596),c=t(47866),h=t(3034),d=t(67578),m=t(76776),p=t(78523),v=t(47737),x=t(59568),y=t(49814),b=t(22875),A=t(67310),F=t(717);let j=()=>{let e=(0,n.useRouter)(),{name:l,branch:t}=e.query,[i,j]=(0,s.useState)(!1),[f,g]=(0,s.useState)([]),[C,R]=(0,s.useState)({}),[_,w]=(0,s.useState)([]),[N,S]=(0,s.useState)(t),[T,E]=(0,s.useState)(l),P=(0,o.nN)({onResult:e=>{var l,t;let a=(null==e?void 0:null===(t=e.Results)||void 0===t?void 0:null===(l=t.content)||void 0===l?void 0:l.trim())||"{}";a=a.replace(/^[\u0000-\u001F\u007F-\u009F]+|[\u0000-\u001F\u007F-\u009F]+$/g,"");try{R(JSON.parse(a))}catch(e){console.error("Invalid JSON content:",e),R({})}}}),q=(0,o.R_)({url:"/api/ExecGitHubAction",data:{Action:"GetBranches",FullName:T},onResult:e=>{let l=(null==e?void 0:e.Results)||[];w(l),1===l.length&&(S(l[0].name),k(l[0].name));let t=l.find(e=>["main","master"].includes(e.name));t&&(S(t.name),k(t.name))},queryKey:"".concat(T,"-branches"),waiting:""!==T}),B=(0,o.R_)({url:"/api/ExecGitHubAction",data:{Action:"GetFileTree",FullName:T,Branch:N},onResult:e=>{g((null==e?void 0:e.Results)||[])},queryKey:"".concat(T,"-").concat(N,"-filetree"),waiting:""!==T&&""!==N}),k=e=>{""!==T&&""!==e&&(B.waiting||(B.waiting=!0),B.refetch())},G=e=>{P.mutate({url:"/api/ExecGitHubAction",data:{Action:"GetFileContents",FullName:T,Path:e,Branch:t}}),j(!0)};(0,s.useEffect)(()=>{T&&q.refetch()},[T]),(0,s.useEffect)(()=>{N&&k(N)},[N]);let K=(l,t)=>{let a={...e.query};a[l]!==t&&(a[l]=t,e.replace({pathname:e.pathname,query:a},void 0,{shallow:!0}))},O=s.memo(e=>(0,a.jsx)(A.V,{...e}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.a,{title:"Templates for ".concat(T),tenantInTitle:!1,tableFilter:(0,a.jsxs)(x.A,{container:!0,spacing:2,children:[(0,a.jsx)(x.A,{size:{xs:12,md:4},children:(0,a.jsx)(O,{fullWidth:!0,value:{label:T,value:T},onChange:e=>{e.value!==T&&(E(e.value),K(e.value))},api:{url:"/api/ListCommunityRepos",queryKey:"CommunityRepos",dataKey:"Results",valueField:"FullName",labelField:"FullName"},multiple:!1,label:"Select Repository",placeholder:"Select Repository",disableClearable:!0})}),(0,a.jsx)(x.A,{size:{xs:12,md:3},children:(0,a.jsx)(O,{fullWidth:!0,value:N?{label:N,value:N}:{label:"Loading branches",value:""},onChange:e=>{e.value!==N&&(S(e.value),K("branch",e.value))},options:_.map(e=>({label:e.name,value:e.name})),multiple:!1,label:"Select Branch",placeholder:"Select Branch",disableClearable:!0,isFetching:q.isPending})})]}),data:f,apiDataKey:"Results",queryKey:"JsonTemplates",simpleColumns:["path","html_url"],actions:[{label:"View Template",customFunction:e=>G(e.path),noConfirm:!0,icon:(0,a.jsx)(b.A,{}),hideBulk:!0},{label:"Import Template",url:"/api/ExecCommunityRepo",icon:(0,a.jsx)(F.A,{}),type:"POST",data:{Action:"ImportTemplate",FullName:T,Path:"path",Branch:N},confirmText:"Are you sure you want to import [path]?"}],isFetching:B.isFetching,refreshFunction:()=>k(N)}),(0,a.jsxs)(r.A,{fullWidth:!0,maxWidth:"xl",open:i,onClose:()=>j(!1),children:[(0,a.jsx)(c.A,{children:"Template Details"}),(0,a.jsx)(h.A,{children:P.isPending?(0,a.jsx)(d.A,{children:(0,a.jsx)(m.A,{height:300,variant:"rectangular"})}):(0,a.jsx)(y.A,{object:C,defaultOpen:!0})}),(0,a.jsx)(p.A,{children:(0,a.jsx)(v.A,{variant:"outlined",onClick:()=>j(!1),children:"Close"})})]})]})};j.getLayout=e=>(0,a.jsx)(i.P,{children:e});let f=j}},e=>{var l=l=>e(e.s=l);e.O(0,[5918,9814,636,6593,8792],()=>l(54312)),_N_E=e.O()}]);