(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4385],{2998:(e,t,n)=>{"use strict";n.d(t,{v:()=>C});var i=n(37876),s=n(22474),l=n(94760),r=n(47737),o=n(5596),a=n(47866),d=n(3034),c=n(78523),p=n(59568),u=n(37832),m=n(58105),x=n(31540),h=n(88992),j=n(60455),A=n(14232),f=n(41412);let C=e=>{let{onNextStep:t,formControl:n,currentStep:C,onPreviousStep:w,fields:S,name:v,manualFields:g=!1,nameToCSVMapping:k,fileName:y="BulkUser"}=e,_=(0,h.FH)({control:n.control,name:v}),[N,b]=(0,A.useState)([]),[E,F]=(0,A.useState)(!1);n.register(v,{validate:e=>Array.isArray(e)&&e.length>0});let T=()=>{let e=n.getValues("addrow");if(void 0===e)return!1;b([..._,e]),F(!1)};(0,A.useEffect)(()=>{n.setValue(v,N,{shouldValidate:!0})},[N]);let V=[{icon:(0,i.jsx)(j.A,{}),label:"Delete Row",confirmText:"Are you sure you want to delete this row?",customFunction:e=>{if(void 0===e)return!1;let t=null==_?void 0:_.findIndex(t=>t===e),n=[..._];n.splice(t,1),b(n)},noConfirm:!0}];return(0,i.jsxs)(s.A,{spacing:3,children:[(0,i.jsx)(l.A,{href:"data:text/csv;charset=utf-8,%EF%BB%BF".concat(encodeURIComponent(S.join(",")+"\n")),download:"".concat(y,".csv"),children:"Download Example CSV"}),(0,i.jsx)(m.A,{nameToCSVMapping:k,type:"CSVReader",name:v,formControl:n}),g&&(0,i.jsxs)(p.A,{container:!0,spacing:2,children:[S.map(e=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(p.A,{size:{md:4,sm:6,xs:12},children:(0,i.jsx)(m.A,{name:"addrow.".concat(e),label:(0,f.i)(e),type:"textField",formControl:n,onKeyDown:t=>{if("Enter"===t.key){if(""===t.target.value)return!1;T(),setTimeout(()=>{n.setValue("addrow.".concat(e),"")},500)}}})},e)})),(0,i.jsx)(p.A,{size:{md:4,sm:6,xs:12},children:(0,i.jsx)(r.A,{size:"small",onClick:()=>T(),children:"Add Item"})})]}),!g&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.A,{container:!0,spacing:2,children:(0,i.jsx)(p.A,{size:{xs:12},children:(0,i.jsx)(r.A,{size:"small",onClick:()=>F(!0),children:"Add Item"})})}),(0,i.jsxs)(o.A,{open:E,onClose:()=>F(!1),children:[(0,i.jsx)(a.A,{children:"Add a new row"}),(0,i.jsx)(d.A,{children:(0,i.jsx)(p.A,{container:!0,spacing:2,sx:{py:1},children:S.map(e=>(0,i.jsx)(p.A,{size:{xs:12},children:(0,i.jsx)(m.A,{name:"addrow.".concat(e),label:(0,f.i)(e),type:"textField",formControl:n})},e))})}),(0,i.jsxs)(c.A,{children:[(0,i.jsx)(r.A,{variant:"outlined",onClick:()=>F(!1),children:"Cancel"}),(0,i.jsx)(r.A,{variant:"contained",onClick:T,children:"Add"})]})]})]}),(0,i.jsx)(x.x,{actions:V,title:"CSV Preview",data:_,simple:!1,simpleColumns:S,noCard:!0}),(0,i.jsx)(u.L,{currentStep:C,onPreviousStep:w,onNextStep:t,formControl:n})]})}},25537:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var i=n(37876),s=n(12435),l=n(17825),r=n(63968),o=n(40971),a=n(31748),d=n(2998);let c=()=>{let e=(0,l.t)().currentTenant,t=[{title:"Step 1",description:"Tenant Selection",component:a.d,componentProps:{allTenants:!1,type:"single"}},{title:"Step 2",description:"Upload CSV",component:d.v,componentProps:{name:"bulkSites",fileName:"BulkSites",fields:["siteName","siteDescription","siteOwner","templateName","siteDesign","sensitivityLabel"],manualFields:!1}},{title:"Step 3",description:"Review and Confirm",component:r.J}];return(0,i.jsx)(o.A,{initialState:{tenantFilter:e},steps:t,postUrl:"/api/AddSiteBulk",wizardTitle:"Bulk Add Site Wizard"})},p=()=>(0,i.jsx)(c,{});p.getLayout=e=>(0,i.jsx)(s.P,{children:e});let u=p},31748:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var i=n(37876),s=n(22474),l=n(37832),r=n(35764);let o=e=>{let{allTenants:t,type:n="single",valueField:o="defaultDomainName",onNextStep:a,formControl:d,currentStep:c,onPreviousStep:p,preText:u}=e;return(0,i.jsxs)(s.A,{spacing:3,children:[u,(0,i.jsx)("label",{children:"Select a tenant"}),(0,i.jsx)(r.w,{valueField:o,formControl:d,allTenants:t,type:n,preselectedEnabled:!0}),(0,i.jsx)(l.L,{currentStep:c,onPreviousStep:p,onNextStep:a,formControl:d})]})}},43092:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/teams-share/sharepoint/bulk-add-site",function(){return n(25537)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(43092)),_N_E=e.O()}]);