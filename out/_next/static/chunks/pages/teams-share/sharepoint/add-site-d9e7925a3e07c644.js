(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5250],{20636:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>m});var l=i(37876),s=i(12435),a=i(59568),r=i(88992),n=i(58105),d=i(90240),o=i(17825);let c=()=>{let e=(0,o.t)(),t=(0,r.mN)({mode:"onChange",defaultValues:{tenantFilter:e.currentTenant}});return(0,l.jsx)(d.A,{title:"SharePoint Site",postUrl:"/api/AddSite",formControl:t,backButtonTitle:"Back to Sites",children:(0,l.jsxs)(a.A,{container:!0,spacing:2,sx:{mb:2},children:[(0,l.jsx)(a.A,{size:{xs:12},children:(0,l.jsx)(n.A,{name:"siteName",label:"Site Name",formControl:t,required:!0})}),(0,l.jsx)(a.A,{size:{xs:12},children:(0,l.jsx)(n.A,{name:"siteDescription",label:"Site Description",formControl:t,required:!0})}),(0,l.jsx)(a.A,{size:{xs:12},children:(0,l.jsx)(n.A,{name:"SiteOwner",label:"Add Owner",formControl:t,required:!0,multiple:!1,type:"autoComplete",api:{url:"/api/ListGraphRequest",data:{Endpoint:"users",$filter:"accountEnabled eq true",$top:999,$count:!0,$orderby:"displayName",$select:"id,displayName,userPrincipalName"},dataKey:"Results",labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:"userPrincipalName",addedField:{id:"id"}},validators:{validate:e=>!!e||"Required"}})}),(0,l.jsx)(a.A,{size:{xs:12},children:(0,l.jsx)(n.A,{name:"TemplateName",label:"Template Name",formControl:t,required:!0,type:"autoComplete",multiple:!1,options:[{label:"Team (No Microsoft365 Group)",value:"team"},{label:"Communication",value:"communication"}],validators:{validate:e=>!!e||"Required"}})}),(0,l.jsx)(a.A,{size:{xs:12},children:(0,l.jsx)(n.A,{name:"siteDesign",label:"Site Design Template",formControl:t,required:!0,type:"autoComplete",multiple:!1,options:[{label:"Blank",value:"blank"},{label:"Showcase",value:"Showcase"},{label:"Topic",value:"Topic"}],validators:{validate:e=>!!e||"Required"}})})]})})},u=()=>(0,l.jsx)(c,{});u.getLayout=e=>(0,l.jsx)(s.P,{children:e});let m=u},42120:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var l=i(93944),s=i(37876);let a=(0,l.A)((0,s.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},59296:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/teams-share/sharepoint/add-site",function(){return i(20636)}])},90240:(e,t,i)=>{"use strict";i.d(t,{A:()=>v});var l=i(37876),s=i(89099),a=i(67578),r=i(86650),n=i(22474),d=i(47737),o=i(94810),c=i(77018),u=i(54538),m=i(24933),p=i(17675),x=i(42120),h=i(22322),j=i(68723),A=i(14232),f=i(88992),b=i(2303);let v=e=>{let{title:t,backButtonTitle:i,titleButton:v,formPageType:y="Add",children:N,queryKey:g,formControl:C,postUrl:S,customDataformatter:w,resetForm:q=!1,hideBackButton:k=!1,hidePageType:_=!1,hideTitle:E=!1,hideSubmit:T=!1,allowResubmit:P=!1,addedButtons:z,...F}=e,O=(0,s.useRouter)(),R=(0,h.nN)({datafromUrl:!0,relatedQueryKeys:g}),{isValid:$,isDirty:D}=(0,f.lN)({control:C.control});return(0,A.useEffect)(()=>{if(delete O.query.tenantFilter,O.query){let e={...C.getValues(),...O.query};C.reset(e)}},[O]),(0,A.useEffect)(()=>{R.isSuccess&&q&&C.reset()},[R.isSuccess]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.v,{title:t}),(0,l.jsx)(a.A,{sx:{flexGrow:1,py:4},children:(0,l.jsx)(r.A,{maxWidth:"lg",children:(0,l.jsxs)(n.A,{spacing:4,children:[!E&&(0,l.jsxs)(n.A,{spacing:2,children:[!k&&(0,l.jsx)("div",{children:(0,l.jsx)(d.A,{color:"inherit",onClick:()=>{O.back()},startIcon:(0,l.jsx)(o.A,{fontSize:"small",children:(0,l.jsx)(x.A,{})}),children:i})}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)(c.A,{variant:"h4",children:[!_&&(0,l.jsxs)(l.Fragment,{children:[y," - "]}),t]}),v&&v]})]}),(0,l.jsxs)(u.A,{children:[(0,l.jsxs)(m.A,{children:[N,(0,l.jsx)(j.v,{apiObject:R})]}),!T&&(0,l.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,l.jsxs)(n.A,{spacing:2,direction:"row",children:[z&&z,(0,l.jsx)(d.A,{disabled:R.isPending||!$||!P&&!D,onClick:C.handleSubmit(()=>{if(C.trigger(),!$)return;let e=w?w(C.getValues()):C.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),R.mutate({url:S,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(59296)),_N_E=e.O()}]);