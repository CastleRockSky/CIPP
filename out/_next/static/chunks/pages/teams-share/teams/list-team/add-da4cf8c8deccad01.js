(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8676],{42120:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var l=i(93944),s=i(37876);let a=(0,l.A)((0,s.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},47860:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>p});var l=i(37876);i(14232);var s=i(71538),a=i(59568),r=i(88992),n=i(12435),d=i(90240),c=i(58105),o=i(58181),u=i(17825);let m=()=>{let e=(0,u.t)().currentTenant,t=(0,r.mN)({mode:"onChange",defaultValues:{displayName:"",description:"",owner:null,visibility:"public"}});return(0,l.jsx)(d.A,{formControl:t,queryKey:"Teams-AddTeam",title:"Add Team",backButtonTitle:"Teams Overview",postUrl:"/api/AddTeam",resetForm:!0,customDataformatter:t=>{var i;return{tenantID:e,displayName:t.displayName,description:t.description,owner:null===(i=t.owner)||void 0===i?void 0:i.value,visibility:t.visibility}},children:(0,l.jsxs)(a.A,{container:!0,spacing:2,children:[(0,l.jsx)(a.A,{size:{md:6,xs:12},children:(0,l.jsx)(c.A,{type:"textField",label:"Display Name",name:"displayName",formControl:t,validators:{required:"Display Name is required"}})}),(0,l.jsx)(a.A,{size:{md:6,xs:12},children:(0,l.jsx)(c.A,{type:"textField",label:"Description",name:"description",formControl:t})}),(0,l.jsx)(s.A,{sx:{my:2,width:"100%"}}),(0,l.jsx)(a.A,{size:{xs:12},children:(0,l.jsx)(o.H,{formControl:t,name:"owner",label:"Select owner (must have a Teams license)",multiple:!1,validators:{required:"Please select an owner"}})}),(0,l.jsx)(s.A,{sx:{my:2,width:"100%"}}),(0,l.jsx)(a.A,{size:{xs:12},children:(0,l.jsx)(c.A,{type:"radio",name:"visibility",label:"Team Visibility",formControl:t,options:[{label:"Public Team",value:"public"},{label:"Private Team",value:"private"}]})})]})})};m.getLayout=e=>(0,l.jsx)(n.P,{children:e});let p=m},58181:(e,t,i)=>{"use strict";i.d(t,{H:()=>n});var l=i(37876),s=i(58105),a=i(88992),r=i(17825);let n=e=>{let{formControl:t,name:i,label:n,allTenants:d=!1,multiple:c=!1,type:o="multiple",select:u,addedField:m,valueField:p,dataFilter:x=null,...h}=e,y=(0,a.FH)({control:t.control,name:"tenantFilter"}),j=(0,r.t)().currentTenant;return(0,l.jsx)(s.o,{name:i,label:n,type:"autoComplete",formControl:t,multiple:c,api:{addedField:m,tenantFilter:y?y.value:j,url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:p||"id",queryKey:"ListUsers-".concat((null==y?void 0:y.value)?y.value:j,"-").concat(u||"default"),data:{Endpoint:"users",manualPagination:!0,$select:u||"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999},dataFilter:e=>x?e.filter(x):e},creatable:!1,...h})}},58530:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/teams-share/teams/list-team/add",function(){return i(47860)}])},90240:(e,t,i)=>{"use strict";i.d(t,{A:()=>b});var l=i(37876),s=i(89099),a=i(67578),r=i(86650),n=i(22474),d=i(47737),c=i(94810),o=i(77018),u=i(54538),m=i(24933),p=i(17675),x=i(42120),h=i(22322),y=i(68723),j=i(14232),v=i(88992),A=i(2303);let b=e=>{let{title:t,backButtonTitle:i,titleButton:b,formPageType:f="Add",children:w,queryKey:N,formControl:g,postUrl:C,customDataformatter:T,resetForm:F=!1,hideBackButton:_=!1,hidePageType:P=!1,hideTitle:k=!1,hideSubmit:q=!1,allowResubmit:E=!1,addedButtons:z,...S}=e,D=(0,s.useRouter)(),O=(0,h.nN)({datafromUrl:!0,relatedQueryKeys:N}),{isValid:V,isDirty:K}=(0,v.lN)({control:g.control});return(0,j.useEffect)(()=>{if(delete D.query.tenantFilter,D.query){let e={...g.getValues(),...D.query};g.reset(e)}},[D]),(0,j.useEffect)(()=>{O.isSuccess&&F&&g.reset()},[O.isSuccess]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(A.v,{title:t}),(0,l.jsx)(a.A,{sx:{flexGrow:1,py:4},children:(0,l.jsx)(r.A,{maxWidth:"lg",children:(0,l.jsxs)(n.A,{spacing:4,children:[!k&&(0,l.jsxs)(n.A,{spacing:2,children:[!_&&(0,l.jsx)("div",{children:(0,l.jsx)(d.A,{color:"inherit",onClick:()=>{D.back()},startIcon:(0,l.jsx)(c.A,{fontSize:"small",children:(0,l.jsx)(x.A,{})}),children:i})}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)(o.A,{variant:"h4",children:[!P&&(0,l.jsxs)(l.Fragment,{children:[f," - "]}),t]}),b&&b]})]}),(0,l.jsxs)(u.A,{children:[(0,l.jsxs)(m.A,{children:[w,(0,l.jsx)(y.v,{apiObject:O})]}),!q&&(0,l.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,l.jsxs)(n.A,{spacing:2,direction:"row",children:[z&&z,(0,l.jsx)(d.A,{disabled:O.isPending||!V||!E&&!K,onClick:g.handleSubmit(()=>{if(g.trigger(),!V)return;let e=T?T(g.getValues()):g.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),O.mutate({url:C,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(58530)),_N_E=e.O()}]);