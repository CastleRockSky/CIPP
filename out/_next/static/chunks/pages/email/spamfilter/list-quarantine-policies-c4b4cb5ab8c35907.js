(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5485],{2555:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>z});var a=n(37876),t=n(12435),l=n(29390),s=n(84064),r=n(45297),o=n(79803),c=n(47737),d=n(22430),u=n(70946),m=n(94810),h=n(77018),p=n(46061),x=n(22474),g=n(59568),y=n(48230),v=n.n(y),f=n(97216),A=n(79259),j=n(60455),b=n(58578),N=n(93944);let S=(0,N.A)([(0,a.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,a.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"AccessTime"),C=(0,N.A)((0,a.jsx)("path",{d:"M12 7V3H2v18h20V7zm-2 12H4v-2h6zm0-4H4v-2h6zm0-4H4V9h6zm0-4H4V5h6zm10 12h-8V9h8zm-2-8h-4v2h4zm0 4h-4v2h4z"}),"CorporateFare");var P=n(3286),E=n(7055),F=n(17825),w=n(82836),M=n(22322);let D=()=>{var e;let{currentTenant:i}=(0,F.t)(),n=(0,w.s)(),t=(0,M.R_)({url:"/api/ListQuarantinePolicy",data:{tenantFilter:i,type:"GlobalQuarantinePolicy"},queryKey:"GlobalQuarantinePolicy-".concat(i)}),y=Array.isArray(t.data)?t.data[0]:t.data,N=!!y;N&&(y.EndUserSpamNotificationFrequency=(null==y?void 0:y.EndUserSpamNotificationFrequency)==="P1D"?"Daily":(null==y?void 0:y.EndUserSpamNotificationFrequency)==="P7D"?"Weekly":(null==y?void 0:y.EndUserSpamNotificationFrequency)==="PT4H"?"4 hours":null==y?void 0:y.EndUserSpamNotificationFrequency);let D=N?Array.isArray(null==y?void 0:y.MultiLanguageSetting)&&y.MultiLanguageSetting.length>0?y.MultiLanguageSetting.map((e,i)=>({language:"Default"==e?"English_USA":"English"==e?"English_GB":e,senderDisplayName:y.MultiLanguageSenderName[i]&&""!==y.MultiLanguageSenderName[i].trim()?y.MultiLanguageSenderName[i]:"None",subject:y.EsnCustomSubject[i]&&""!==y.EsnCustomSubject[i].trim()?y.EsnCustomSubject[i]:"None",disclaimer:y.MultiLanguageCustomDisclaimer[i]&&""!==y.MultiLanguageCustomDisclaimer[i].trim()?y.MultiLanguageCustomDisclaimer[i]:"None"})):[{language:"None",senderDisplayName:"None",subject:"None",disclaimer:"None"}]:[],z=[(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{onClick:n.handleOpen,startIcon:(0,a.jsx)(f.A,{}),children:"Edit Settings"}),(0,a.jsx)(d.A,{title:"Refresh Data",children:(0,a.jsx)(u.A,{className:"MuiIconButton",disabled:(null==t?void 0:t.isLoading)||(null==t?void 0:t.isFetching),onClick:()=>{t.refetch()},children:(0,a.jsx)(m.A,{fontSize:"small",sx:{animation:(null==t?void 0:t.isFetching)?"spin 1s linear infinite":"none","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}},children:(0,a.jsx)(A.A,{})})})})]})],Q=[{label:"Edit Policy",type:"POST",url:"/api/EditQuarantinePolicy?type=QuarantinePolicy",setDefaultValues:!0,fields:[{type:"textField",name:"Name",label:"Policy Name",disabled:!0},{type:"autoComplete",name:"ReleaseActionPreference",label:"Select release action preference",multiple:!1,creatable:!1,options:[{label:"Release",value:"Release"},{label:"Request Release",value:"RequestRelease"}]},{type:"switch",name:"Delete",label:"Delete"},{type:"switch",name:"Preview",label:"Preview"},{type:"switch",name:"BlockSender",label:"Block Sender"},{type:"switch",name:"AllowSender",label:"Allow Sender"},{type:"switch",name:"QuarantineNotification",label:"Quarantine Notification"},{type:"switch",name:"IncludeMessagesFromBlockedSenderAddress",label:"Include Messages From Blocked Sender Address"}],data:{Identity:"Guid",Action:"!Edit"},confirmText:"Update Quarantine Policy '[Name]'? Policy Name cannot be changed.",multiPost:!1,icon:(0,a.jsx)(f.A,{}),color:"info",condition:e=>"00000000-0000-0000-0000-000000000000"!=e.Guid},{label:"Delete Policy",type:"POST",icon:(0,a.jsx)(j.A,{}),url:"/api/RemoveQuarantinePolicy",data:{Name:"Name",Identity:"Guid"},confirmText:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{variant:"body1",children:"Are you sure you want to delete this policy?"}),(0,a.jsxs)(h.A,{variant:"body2",children:[(0,a.jsx)("strong",{children:"Note:"})," This will delete the Quarantine policy, even if it is currently in use.",(0,a.jsx)("br",{}),"Removing the Admin and User Access it applies to emails."]}),(0,a.jsxs)(p.A,{severity:"warning",children:["Confirm the Quarantine is not applied in any of the following policies:",(0,a.jsxs)("ul",{style:{paddingLeft:"15px"},children:[(0,a.jsx)("li",{children:"Anti-phishing"}),(0,a.jsx)("li",{children:"Anti-spam"}),(0,a.jsx)("li",{children:"Anti-malware"}),(0,a.jsx)("li",{children:"Safe Attachments"})]})]})]}),condition:e=>"00000000-0000-0000-0000-000000000000"!=e.Guid}],B=D&&D.length>0?{offcanvas:{title:"Custom Language Settings",propertyItems:D.map((e,i)=>({label:"",value:(0,a.jsx)(s.A,{title:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,a.jsx)(b.A,{style:{marginRight:"8px"}}),e.language]}),cardSx:{mb:2},children:(0,a.jsx)(x.A,{spacing:2,children:Object.entries(e).filter(e=>{let[i]=e;return"language"!==i}).map(e=>{let[i,n]=e;return(0,a.jsxs)(x.A,{spacing:.5,children:[(0,a.jsx)(h.A,{variant:"subtitle2",color:"text.secondary",children:i.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())}),(0,a.jsx)(h.A,{variant:"body2",children:n})]},i)})})})}))}}:{},L=[{icon:(0,a.jsx)(S,{}),data:null!==(e=null==y?void 0:y.EndUserSpamNotificationFrequency)&&void 0!==e?e:"n/a",name:"Notification Frequency"},{icon:(0,a.jsx)(C,{}),data:N?(null==y?void 0:y.OrganizationBrandingEnabled)?"Enabled":"Disabled":"n/a",name:"Branding"},{icon:(0,a.jsx)(P.A,{}),data:N?(null==y?void 0:y.EndUserSpamNotificationCustomFromAddress)?null==y?void 0:y.EndUserSpamNotificationCustomFromAddress:"None":"n/a",name:"Custom Sender Address"},{icon:(0,a.jsx)(b.A,{}),toolTip:"More Info",data:N?D.length>0?D.map(e=>e.language).join(", "):"None":"n/a",name:"Custom Language",...B}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{spacing:2,sx:{p:3,mt:1},children:(0,a.jsx)(s.A,{component:"card",title:"Global Quarantine Settings - ".concat(i),cardActions:z,children:(0,a.jsx)(g.A,{container:!0,spacing:2,children:(0,a.jsx)(g.A,{size:12,children:(0,a.jsx)(r.s,{isFetching:t.isFetching,data:L})})})})}),(0,a.jsx)(l.a,{title:"Quarantine Policies",apiUrl:"/api/ListQuarantinePolicy",apiData:{tenantFilter:i,type:"QuarantinePolicy"},actions:Q,offCanvas:{extendedInfoFields:["Id","Name","EndUserQuarantinePermissions","Guid","Builtin","WhenCreated","WhenChanged"],actions:Q},filters:[{filterName:"Custom Policies",value:[{id:"Builtin",value:"No"}],type:"column"},{filterName:"Built-in Policies",value:[{id:"Builtin",value:"Yes"}],type:"column"}],simpleColumns:["Name","ReleaseActionPreference","Delete","Preview","BlockSender","AllowSender","QuarantineNotification","IncludeMessagesFromBlockedSenderAddress","WhenCreated","WhenChanged"],cardButton:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(c.A,{component:v(),href:"/email/spamfilter/list-quarantine-policies/add",startIcon:(0,a.jsx)(E.A,{}),children:"Deploy Custom Policy"})})}),(0,a.jsx)(o.B,{title:"Edit - Global Quarantine Settings",createDialog:n,api:{type:"POST",url:"/api/EditQuarantinePolicy?type=GlobalQuarantinePolicy",setDefaultValues:!0,data:{Name:"Name",Identity:"Guid"},relatedQueryKeys:["GlobalQuarantinePolicy-".concat(i)],confirmText:"Are you sure you want to update Global Quarantine settings?"},row:y,setDefaultValues:!0,fields:[{type:"autoComplete",name:"EndUserSpamNotificationFrequency",label:"Notification Frequency",multiple:!1,creatable:!1,required:!0,options:[{label:"4 hours",value:"PT4H"},{label:"Daily",value:"P1D"},{label:"Weekly",value:"P7D"}]},{type:"textField",name:"EndUserSpamNotificationCustomFromAddress",label:"Custom Sender Address (Optional)",placeholder:"Enter custom sender address",required:!1},{type:"switch",name:"OrganizationBrandingEnabled",label:"Organization Branding"}]})]})};D.getLayout=e=>(0,a.jsx)(t.P,{children:e});let z=D},3286:(e,i,n)=>{"use strict";n.d(i,{A:()=>l});var a=n(93944),t=n(37876);let l=(0,a.A)((0,t.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10h5v-2h-5c-4.34 0-8-3.66-8-8s3.66-8 8-8 8 3.66 8 8v1.43c0 .79-.71 1.57-1.5 1.57s-1.5-.78-1.5-1.57V12c0-2.76-2.24-5-5-5s-5 2.24-5 5 2.24 5 5 5c1.38 0 2.64-.56 3.54-1.47.65.89 1.77 1.47 2.96 1.47 1.97 0 3.5-1.6 3.5-3.57V12c0-5.52-4.48-10-10-10m0 13c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3"}),"AlternateEmail")},7055:(e,i,n)=>{"use strict";n.d(i,{A:()=>l});var a=n(93944),t=n(37876);let l=(0,a.A)((0,t.jsx)("path",{d:"M9.19 6.35c-2.04 2.29-3.44 5.58-3.57 5.89L2 10.69l4.05-4.05c.47-.47 1.15-.68 1.81-.55zM11.17 17s3.74-1.55 5.89-3.7c5.4-5.4 4.5-9.62 4.21-10.57-.95-.3-5.17-1.19-10.57 4.21C8.55 9.09 7 12.83 7 12.83zm6.48-2.19c-2.29 2.04-5.58 3.44-5.89 3.57L13.31 22l4.05-4.05c.47-.47.68-1.15.55-1.81zM9 18c0 .83-.34 1.58-.88 2.12C6.94 21.3 2 22 2 22s.7-4.94 1.88-6.12C4.42 15.34 5.17 15 6 15c1.66 0 3 1.34 3 3m4-9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2"}),"RocketLaunch")},45297:(e,i,n)=>{"use strict";n.d(i,{s:()=>x});var a=n(37876),t=n(14232),l=n(54538),s=n(22474),r=n(94810),o=n(22430),c=n(67578),d=n(77018),u=n(76776),m=n(59568),h=n(57016),p=n(5419);let x=e=>{let{data:i,isFetching:n}=e,[x,g]=(0,t.useState)(null);return(0,a.jsx)(l.A,{children:(0,a.jsx)(m.A,{container:!0,children:i.map((e,i)=>{var t,l,y,v,f;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A,{size:{md:3,sm:6,xs:12},onClick:e.offcanvas?()=>g(i):void 0,sx:{cursor:e.offcanvas?"pointer":"default",borderBottom:e=>({xs:"1px solid ".concat(e.palette.divider),md:"none"}),borderRight:e=>({md:"1px solid ".concat(e.palette.divider)}),"&:nth-of-type(3)":{borderBottom:e=>({xs:"1px solid ".concat(e.palette.divider),sm:"none"})},"&:nth-of-type(4)":{borderBottom:"none",borderRight:"none"}},children:(0,a.jsxs)(s.A,{alignItems:"center",direction:"row",spacing:2,sx:{p:2},children:[(null==e?void 0:e.icon)&&(0,a.jsx)(r.A,{color:e.color?e.color:"primary",fontSize:"small",children:e.icon}),(null==e?void 0:e.toolTip)?(0,a.jsx)(o.A,{title:e.toolTip,children:(0,a.jsxs)(c.A,{sx:()=>{if(!(null==e?void 0:e.icon))return{pl:2}},children:[(0,a.jsx)(d.A,{color:"text.secondary",variant:"overline",children:e.name}),(0,a.jsx)(d.A,{variant:"h6",children:n?(0,a.jsx)(u.A,{width:"100%"}):e.data})]})}):(0,a.jsxs)(c.A,{sx:()=>{if(!(null==e?void 0:e.icon))return{pl:2}},children:[(0,a.jsx)(d.A,{color:"text.secondary",variant:"overline",children:e.name}),(0,a.jsx)(d.A,{variant:"h6",children:n?(0,a.jsx)(u.A,{width:"100%"}):e.data})]})]})},e.name),e.offcanvas&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(h.w,{title:(null==e?void 0:null===(t=e.offcanvas)||void 0===t?void 0:t.title)||"Details",size:"md",visible:x===i,onClose:()=>g(null),children:(0,a.jsx)(c.A,{sx:{overflowY:"auto",maxHeight:"100%",display:"flex",flexDirection:"column"},children:(0,a.jsx)(m.A,{container:!0,spacing:1,children:(0,a.jsx)(m.A,{size:{xs:12},children:(null==e?void 0:null===(y=e.offcanvas)||void 0===y?void 0:null===(l=y.propertyItems)||void 0===l?void 0:l.length)>0&&(0,a.jsx)(p.a,{isFetching:n,align:"vertical",title:null==e?void 0:null===(v=e.offcanvas)||void 0===v?void 0:v.title,propertyItems:null!==(f=e.offcanvas.propertyItems)&&void 0!==f?f:[]})})})})})})]})})})})}},58578:(e,i,n)=>{"use strict";n.d(i,{A:()=>l});var a=n(93944),t=n(37876);let l=(0,a.A)((0,t.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2m6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56M12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96M4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56m2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8M12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96M14.34 14H9.66c-.09-.66-.16-1.32-.16-2s.07-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2m.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2z"}),"Language")},63929:(e,i,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/email/spamfilter/list-quarantine-policies",function(){return n(2555)}])}},e=>{var i=i=>e(e.s=i);e.O(0,[636,6593,8792],()=>i(63929)),_N_E=e.O()}]);