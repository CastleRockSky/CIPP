(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2892],{42120:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(93944),i=a(37876);let s=(0,r.A)((0,i.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},58656:(e,t,a)=>{"use strict";a.d(t,{w:()=>n});var r=a(37876),i=a(58105),s=a(88992),l=a(17825);let n=e=>{let{formControl:t,name:a,label:n,allTenants:o=!1,type:d="multiple",multiple:c=!1,...u}=e,m=(0,s.FH)({control:t.control,name:"tenantFilter"}),x=(0,l.t)().currentTenant;return(0,r.jsx)(i.o,{name:a,label:n,type:"autoComplete",formControl:t,multiple:c,api:{autoSelectFirstItem:!0,tenantFilter:m?m.value:x,queryKey:"listDomains-".concat((null==m?void 0:m.value)?m.value:x),url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.id),valueField:"id",data:{Endpoint:"domains",manualPagination:!0,$count:!0,$top:99}},...u})}},78362:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/email/resources/management/list-rooms/add",function(){return a(97948)}])},90240:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});var r=a(37876),i=a(89099),s=a(67578),l=a(86650),n=a(22474),o=a(47737),d=a(94810),c=a(77018),u=a(54538),m=a(24933),x=a(17675),p=a(42120),j=a(22322),y=a(68723),h=a(14232),A=a(88992),v=a(2303);let f=e=>{let{title:t,backButtonTitle:a,titleButton:f,formPageType:b="Add",children:C,queryKey:g,formControl:w,postUrl:N,customDataformatter:F,resetForm:_=!1,hideBackButton:q=!1,hidePageType:k=!1,hideTitle:E=!1,hideSubmit:P=!1,allowResubmit:R=!1,addedButtons:z,...D}=e,O=(0,i.useRouter)(),S=(0,j.nN)({datafromUrl:!0,relatedQueryKeys:g}),{isValid:T,isDirty:I}=(0,A.lN)({control:w.control});return(0,h.useEffect)(()=>{if(delete O.query.tenantFilter,O.query){let e={...w.getValues(),...O.query};w.reset(e)}},[O]),(0,h.useEffect)(()=>{S.isSuccess&&_&&w.reset()},[S.isSuccess]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.v,{title:t}),(0,r.jsx)(s.A,{sx:{flexGrow:1,py:4},children:(0,r.jsx)(l.A,{maxWidth:"lg",children:(0,r.jsxs)(n.A,{spacing:4,children:[!E&&(0,r.jsxs)(n.A,{spacing:2,children:[!q&&(0,r.jsx)("div",{children:(0,r.jsx)(o.A,{color:"inherit",onClick:()=>{O.back()},startIcon:(0,r.jsx)(d.A,{fontSize:"small",children:(0,r.jsx)(p.A,{})}),children:a})}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)(c.A,{variant:"h4",children:[!k&&(0,r.jsxs)(r.Fragment,{children:[b," - "]}),t]}),f&&f]})]}),(0,r.jsxs)(u.A,{children:[(0,r.jsxs)(m.A,{children:[C,(0,r.jsx)(y.v,{apiObject:S})]}),!P&&(0,r.jsx)(x.A,{sx:{justifyContent:"flex-end"},children:(0,r.jsxs)(n.A,{spacing:2,direction:"row",children:[z&&z,(0,r.jsx)(o.A,{disabled:S.isPending||!T||!R&&!I,onClick:w.handleSubmit(()=>{if(w.trigger(),!T)return;let e=F?F(w.getValues()):w.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),S.mutate({url:N,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}},97948:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var r=a(37876);a(14232);var i=a(71538),s=a(59568),l=a(88992),n=a(12435),o=a(90240),d=a(58105),c=a(58656),u=a(17825);let m=()=>{let e=(0,u.t)().currentTenant,t=(0,l.mN)({mode:"onChange",defaultValues:{displayName:"",username:"",domain:null,resourceCapacity:""}});return(0,r.jsx)(o.A,{formControl:t,queryKey:"RoomMailbox-Add",title:"Add Room Mailbox",backButtonTitle:"Room Mailboxes Overview",postUrl:"/api/AddRoomMailbox",customDataformatter:t=>{var a,r;let i={tenantID:e,domain:null===(a=t.domain)||void 0===a?void 0:a.value,displayName:t.displayName.trim(),username:t.username.trim(),userPrincipalName:t.username.trim()+"@"+((null===(r=t.domain)||void 0===r?void 0:r.value)||"").trim()};return t.resourceCapacity&&""!==t.resourceCapacity.trim()&&(i.resourceCapacity=t.resourceCapacity.trim()),i},children:(0,r.jsxs)(s.A,{container:!0,spacing:2,children:[(0,r.jsx)(s.A,{size:{md:8,xs:12},children:(0,r.jsx)(d.A,{type:"textField",label:"Display Name",name:"displayName",formControl:t,validators:{required:"Display Name is required"}})}),(0,r.jsx)(i.A,{sx:{my:2,width:"100%"}}),(0,r.jsx)(s.A,{size:{md:4,xs:12},children:(0,r.jsx)(d.A,{type:"textField",label:"Username",name:"username",formControl:t,validators:{required:"Username is required"}})}),(0,r.jsx)(s.A,{size:{md:4,xs:12},children:(0,r.jsx)(c.w,{formControl:t,name:"domain",label:"Primary Domain name",validators:{required:"Please select a domain"}})}),(0,r.jsx)(i.A,{sx:{my:2,width:"100%"}}),(0,r.jsx)(s.A,{size:{xs:12},children:(0,r.jsx)(d.A,{type:"textField",label:"Resource Capacity (Optional)",name:"resourceCapacity",formControl:t})})]})})};m.getLayout=e=>(0,r.jsx)(n.P,{children:e});let x=m}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(78362)),_N_E=e.O()}]);