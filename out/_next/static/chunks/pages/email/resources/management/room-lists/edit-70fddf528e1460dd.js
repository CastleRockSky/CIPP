(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73],{12377:(e,i,a)=>{"use strict";a.r(i),a.d(i,{default:()=>j});var t=a(37876),l=a(14232),s=a(47737),r=a(67578),n=a(77018),d=a(71538),o=a(59568),c=a(88992),m=a(12435),u=a(90240),p=a(58105);a(58181);var h=a(89099),x=a(22322),y=a(17825),A=a(31540);let v=()=>{var e,i,a,m,v,j;let b=(0,h.useRouter)(),{groupId:g}=b.query,[F,f]=(0,l.useState)(!1),[N,w]=(0,l.useState)(!1),[R,P]=(0,l.useState)([]),[C,E]=(0,l.useState)(null),L=(0,y.t)().currentTenant,k=(0,x.R_)({url:"/api/ListRoomLists?groupID=".concat(g,"&tenantFilter=").concat(L,"&members=true&owners=true"),queryKey:"ListRoomLists-".concat(g),waiting:F});(0,l.useEffect)(()=>{g&&(f(!0),k.refetch())},[b.query,g,L]);let S=(0,c.mN)({mode:"onChange",defaultValues:{tenantFilter:L,AddMember:[],RemoveMember:[],AddOwner:[],RemoveOwner:[]}});return(0,l.useEffect)(()=>{if(k.isSuccess){var e,i,a,t;let l=null===(e=k.data)||void 0===e?void 0:e.groupInfo;if(l){let e=Array.isArray(null===(i=k.data)||void 0===i?void 0:i.owners)?k.data.owners:[],s=Array.isArray(null===(a=k.data)||void 0===a?void 0:a.members)?k.data.members:[];P([...e.map(e=>({type:"Owner",userPrincipalName:e.userPrincipalName,displayName:e.displayName})),...s.map(e=>({type:"Room",userPrincipalName:e.PrimarySmtpAddress||e.userPrincipalName||e.mail,displayName:e.DisplayName||e.displayName}))]);let r=null==k?void 0:null===(t=k.data)||void 0===t?void 0:t.allowExternal;E(r),S.reset({tenantFilter:L,mail:l.PrimarySmtpAddress||l.mail,mailNickname:l.Alias||l.mailNickname||"",allowExternal:r,displayName:l.DisplayName||l.displayName,description:l.Description||l.description||"",groupId:l.Guid||l.id,groupType:"Room List",AddMember:[],RemoveMember:[],AddOwner:[],RemoveOwner:[]})}}},[k.isSuccess,b.query,k.isFetching]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(u.A,{formControl:S,queryKey:["ListRoomLists-".concat(g)],title:"Room List: ".concat((null===(i=k.data)||void 0===i?void 0:null===(e=i.groupInfo)||void 0===e?void 0:e.DisplayName)||(null===(m=k.data)||void 0===m?void 0:null===(a=m.groupInfo)||void 0===a?void 0:a.displayName)||""),formPageType:"Edit",backButtonTitle:"Room Lists",postUrl:"/api/EditRoomList",customDataformatter:e=>{let i={...e};return null!==C&&e.allowExternal===C&&delete i.allowExternal,i},titleButton:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(s.A,{variant:"outlined",color:"primary",onClick:()=>w(!N),sx:{mb:2},children:N?"Edit Membership":"View members"})}),children:N?(0,t.jsx)(r.A,{sx:{my:2},children:(0,t.jsx)(A.x,{data:R,isFetching:k.isFetching,simpleColumns:["type","userPrincipalName","displayName"],refreshFunction:k.refetch})}):(0,t.jsx)(r.A,{sx:{my:2},children:(0,t.jsxs)(o.A,{container:!0,spacing:2,children:[(0,t.jsx)(o.A,{size:{xs:12},children:(0,t.jsx)(n.A,{variant:"h6",children:"Room List Properties"})}),(0,t.jsx)(o.A,{size:{md:6,xs:12},children:(0,t.jsx)(p.A,{type:"textField",fullWidth:!0,label:"Display Name",name:"displayName",formControl:S,isFetching:k.isFetching,disabled:k.isFetching})}),(0,t.jsx)(o.A,{size:{md:6,xs:12},children:(0,t.jsx)(p.A,{type:"textField",fullWidth:!0,label:"Description",name:"description",formControl:S,isFetching:k.isFetching,disabled:k.isFetching})}),(0,t.jsx)(o.A,{size:{md:6,xs:12},children:(0,t.jsx)(p.A,{type:"textField",fullWidth:!0,label:"Mail Nickname",name:"mailNickname",formControl:S,isFetching:k.isFetching,disabled:k.isFetching})}),(0,t.jsxs)(o.A,{size:{xs:12},children:[(0,t.jsx)(d.A,{sx:{my:2}}),(0,t.jsx)(n.A,{variant:"h6",children:"Add Members"})]}),(0,t.jsx)(o.A,{size:{xs:12},children:(0,t.jsx)(p.A,{type:"autoComplete",name:"AddMember",label:"Add Room Mailboxes",formControl:S,multiple:!0,creatable:!1,isFetching:k.isFetching,disabled:k.isFetching,api:{url:"/api/ListRooms",labelField:e=>"".concat(e.displayName||"Unknown"," (").concat(e.mail||e.userPrincipalName||"No email",")"),valueField:"mail",addedField:{roomType:"bookingType",capacity:"capacity",id:"id"},queryKey:"rooms-".concat(L),showRefresh:!0,dataFilter:e=>{var i;let a=(Array.isArray(null===(i=k.data)||void 0===i?void 0:i.members)?k.data.members:[]).map(e=>e.mail||e.userPrincipalName).filter(Boolean);return e.filter(e=>{let i=e.value;return!a.includes(i)})}}})}),(0,t.jsx)(o.A,{size:{xs:12},children:(0,t.jsx)(p.A,{type:"autoComplete",name:"AddOwner",label:"Add Owners",formControl:S,multiple:!0,creatable:!1,isFetching:k.isFetching,disabled:k.isFetching,api:{url:"/api/ListUsers",labelField:e=>"".concat(e.displayName||"Unknown"," (").concat(e.userPrincipalName||e.mail||"No email",")"),valueField:"userPrincipalName",addedField:{id:"id"},queryKey:"users-".concat(L),showRefresh:!0,dataFilter:e=>{var i;let a=(Array.isArray(null===(i=k.data)||void 0===i?void 0:i.owners)?k.data.owners:[]).map(e=>e.userPrincipalName).filter(Boolean);return e.filter(e=>{let i=e.value;return!a.includes(i)})}}})}),(0,t.jsxs)(o.A,{size:{xs:12},children:[(0,t.jsx)(d.A,{sx:{my:2}}),(0,t.jsx)(n.A,{variant:"h6",children:"Remove Members"})]}),(0,t.jsx)(o.A,{size:{xs:12},children:(0,t.jsx)(p.A,{type:"autoComplete",name:"RemoveMember",label:"Remove Room Mailboxes",formControl:S,multiple:!0,isFetching:k.isFetching,disabled:k.isFetching,options:Array.isArray(null===(v=k.data)||void 0===v?void 0:v.members)?k.data.members.map(e=>({label:"".concat(e.DisplayName||e.displayName||"Unknown"," (").concat(e.PrimarySmtpAddress||e.userPrincipalName||e.mail,")"),value:e.PrimarySmtpAddress||e.userPrincipalName||e.mail,addedFields:{id:e.ExternalDirectoryObjectId||e.id}})):[]})}),(0,t.jsx)(o.A,{size:{xs:12},children:(0,t.jsx)(p.A,{type:"autoComplete",name:"RemoveOwner",label:"Remove Owners",formControl:S,multiple:!0,isFetching:k.isFetching,disabled:k.isFetching,options:Array.isArray(null===(j=k.data)||void 0===j?void 0:j.owners)?k.data.owners.map(e=>({label:"".concat(e.displayName," (").concat(e.userPrincipalName,")"),value:e.userPrincipalName,addedFields:{id:e.id}})):[]})}),(0,t.jsxs)(o.A,{size:{xs:12},children:[(0,t.jsx)(d.A,{sx:{my:2}}),(0,t.jsx)(n.A,{variant:"h6",children:"Room List Settings"})]}),(0,t.jsx)(o.A,{size:{xs:12},children:(0,t.jsx)(p.A,{type:"switch",label:"Let people outside the organization email the room list",name:"allowExternal",formControl:S,isFetching:k.isFetching,disabled:k.isFetching})})]})})})})};v.getLayout=e=>(0,t.jsx)(m.P,{children:e});let j=v},37248:(e,i,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/email/resources/management/room-lists/edit",function(){return a(12377)}])},42120:(e,i,a)=>{"use strict";a.d(i,{A:()=>s});var t=a(93944),l=a(37876);let s=(0,t.A)((0,l.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},58181:(e,i,a)=>{"use strict";a.d(i,{H:()=>n});var t=a(37876),l=a(58105),s=a(88992),r=a(17825);let n=e=>{let{formControl:i,name:a,label:n,allTenants:d=!1,multiple:o=!1,type:c="multiple",select:m,addedField:u,valueField:p,dataFilter:h=null,...x}=e,y=(0,s.FH)({control:i.control,name:"tenantFilter"}),A=(0,r.t)().currentTenant;return(0,t.jsx)(l.o,{name:a,label:n,type:"autoComplete",formControl:i,multiple:o,api:{addedField:u,tenantFilter:y?y.value:A,url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:p||"id",queryKey:"ListUsers-".concat((null==y?void 0:y.value)?y.value:A,"-").concat(m||"default"),data:{Endpoint:"users",manualPagination:!0,$select:m||"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999},dataFilter:e=>h?e.filter(h):e},creatable:!1,...x})}},90240:(e,i,a)=>{"use strict";a.d(i,{A:()=>b});var t=a(37876),l=a(89099),s=a(67578),r=a(86650),n=a(22474),d=a(47737),o=a(94810),c=a(77018),m=a(54538),u=a(24933),p=a(17675),h=a(42120),x=a(22322),y=a(68723),A=a(14232),v=a(88992),j=a(2303);let b=e=>{let{title:i,backButtonTitle:a,titleButton:b,formPageType:g="Add",children:F,queryKey:f,formControl:N,postUrl:w,customDataformatter:R,resetForm:P=!1,hideBackButton:C=!1,hidePageType:E=!1,hideTitle:L=!1,hideSubmit:k=!1,allowResubmit:S=!1,addedButtons:z,...O}=e,_=(0,l.useRouter)(),q=(0,x.nN)({datafromUrl:!0,relatedQueryKeys:f}),{isValid:M,isDirty:D}=(0,v.lN)({control:N.control});return(0,A.useEffect)(()=>{if(delete _.query.tenantFilter,_.query){let e={...N.getValues(),..._.query};N.reset(e)}},[_]),(0,A.useEffect)(()=>{q.isSuccess&&P&&N.reset()},[q.isSuccess]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.v,{title:i}),(0,t.jsx)(s.A,{sx:{flexGrow:1,py:4},children:(0,t.jsx)(r.A,{maxWidth:"lg",children:(0,t.jsxs)(n.A,{spacing:4,children:[!L&&(0,t.jsxs)(n.A,{spacing:2,children:[!C&&(0,t.jsx)("div",{children:(0,t.jsx)(d.A,{color:"inherit",onClick:()=>{_.back()},startIcon:(0,t.jsx)(o.A,{fontSize:"small",children:(0,t.jsx)(h.A,{})}),children:a})}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)(c.A,{variant:"h4",children:[!E&&(0,t.jsxs)(t.Fragment,{children:[g," - "]}),i]}),b&&b]})]}),(0,t.jsxs)(m.A,{children:[(0,t.jsxs)(u.A,{children:[F,(0,t.jsx)(y.v,{apiObject:q})]}),!k&&(0,t.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,t.jsxs)(n.A,{spacing:2,direction:"row",children:[z&&z,(0,t.jsx)(d.A,{disabled:q.isPending||!M||!S&&!D,onClick:N.handleSubmit(()=>{if(N.trigger(),!M)return;let e=R?R(N.getValues()):N.getValues();Object.keys(e).forEach(i=>{(""===e[i]||null===e[i])&&delete e[i]}),q.mutate({url:w,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var i=i=>e(e.s=i);e.O(0,[636,6593,8792],()=>i(37248)),_N_E=e.O()}]);