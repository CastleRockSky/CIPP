(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{23741:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var i=a(37876);a(14232);var n=a(71538),r=a(59568),l=a(88992),s=a(12435),d=a(90240),o=a(58105),u=a(58656),m=a(17825);let c=()=>{let e=(0,m.t)().currentTenant,t=(0,l.mN)({mode:"onChange",defaultValues:{displayName:"",username:"",domain:null,location:"",department:"",company:""}});return(0,i.jsx)(d.A,{formControl:t,queryKey:"EquipmentMailbox-Add",title:"Add Equipment Mailbox",backButtonTitle:"Equipment Mailboxes Overview",postUrl:"/api/AddEquipmentMailbox",customDataformatter:t=>{var a,i;return{tenantID:e,domain:null===(a=t.domain)||void 0===a?void 0:a.value,displayName:t.displayName.trim(),username:t.username.trim(),userPrincipalName:t.username.trim()+"@"+((null===(i=t.domain)||void 0===i?void 0:i.value)||"").trim()}},children:(0,i.jsxs)(r.A,{container:!0,spacing:2,children:[(0,i.jsx)(r.A,{size:{md:8,xs:12},children:(0,i.jsx)(o.A,{type:"textField",label:"Display Name",name:"displayName",formControl:t,validators:{required:"Display Name is required"}})}),(0,i.jsx)(n.A,{sx:{my:2,width:"100%"}}),(0,i.jsx)(r.A,{size:{md:6,xs:12},children:(0,i.jsx)(o.A,{type:"textField",label:"Username",name:"username",formControl:t,validators:{required:"Username is required"}})}),(0,i.jsx)(r.A,{size:{md:6,xs:12},children:(0,i.jsx)(u.w,{formControl:t,name:"domain",label:"Primary Domain name",validators:{required:"Please select a domain"}})})]})})};c.getLayout=e=>(0,i.jsx)(s.P,{children:e});let x=c},42120:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var i=a(93944),n=a(37876);let r=(0,i.A)((0,n.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},58656:(e,t,a)=>{"use strict";a.d(t,{w:()=>s});var i=a(37876),n=a(58105),r=a(88992),l=a(17825);let s=e=>{let{formControl:t,name:a,label:s,allTenants:d=!1,type:o="multiple",multiple:u=!1,...m}=e,c=(0,r.FH)({control:t.control,name:"tenantFilter"}),x=(0,l.t)().currentTenant;return(0,i.jsx)(n.o,{name:a,label:s,type:"autoComplete",formControl:t,multiple:u,api:{autoSelectFirstItem:!0,tenantFilter:c?c.value:x,queryKey:"listDomains-".concat((null==c?void 0:c.value)?c.value:x),url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.id),valueField:"id",data:{Endpoint:"domains",manualPagination:!0,$count:!0,$top:99}},...m})}},74184:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/email/resources/management/equipment/add",function(){return a(23741)}])},90240:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});var i=a(37876),n=a(89099),r=a(67578),l=a(86650),s=a(22474),d=a(47737),o=a(94810),u=a(77018),m=a(54538),c=a(24933),x=a(17675),p=a(42120),h=a(22322),j=a(68723),y=a(14232),v=a(88992),A=a(2303);let f=e=>{let{title:t,backButtonTitle:a,titleButton:f,formPageType:b="Add",children:g,queryKey:q,formControl:N,postUrl:w,customDataformatter:C,resetForm:E=!1,hideBackButton:_=!1,hidePageType:F=!1,hideTitle:k=!1,hideSubmit:P=!1,allowResubmit:D=!1,addedButtons:S,...z}=e,O=(0,n.useRouter)(),T=(0,h.nN)({datafromUrl:!0,relatedQueryKeys:q}),{isValid:I,isDirty:K}=(0,v.lN)({control:N.control});return(0,y.useEffect)(()=>{if(delete O.query.tenantFilter,O.query){let e={...N.getValues(),...O.query};N.reset(e)}},[O]),(0,y.useEffect)(()=>{T.isSuccess&&E&&N.reset()},[T.isSuccess]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(A.v,{title:t}),(0,i.jsx)(r.A,{sx:{flexGrow:1,py:4},children:(0,i.jsx)(l.A,{maxWidth:"lg",children:(0,i.jsxs)(s.A,{spacing:4,children:[!k&&(0,i.jsxs)(s.A,{spacing:2,children:[!_&&(0,i.jsx)("div",{children:(0,i.jsx)(d.A,{color:"inherit",onClick:()=>{O.back()},startIcon:(0,i.jsx)(o.A,{fontSize:"small",children:(0,i.jsx)(p.A,{})}),children:a})}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)(u.A,{variant:"h4",children:[!F&&(0,i.jsxs)(i.Fragment,{children:[b," - "]}),t]}),f&&f]})]}),(0,i.jsxs)(m.A,{children:[(0,i.jsxs)(c.A,{children:[g,(0,i.jsx)(j.v,{apiObject:T})]}),!P&&(0,i.jsx)(x.A,{sx:{justifyContent:"flex-end"},children:(0,i.jsxs)(s.A,{spacing:2,direction:"row",children:[S&&S,(0,i.jsx)(d.A,{disabled:T.isPending||!I||!D&&!K,onClick:N.handleSubmit(()=>{if(N.trigger(),!I)return;let e=C?C(N.getValues()):N.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),T.mutate({url:w,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(74184)),_N_E=e.O()}]);