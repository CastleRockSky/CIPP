(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2407],{42120:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(93944),o=l(37876);let s=(0,a.A)((0,o.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},58791:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>b});var a=l(37876),o=l(14232),s=l(59568),i=l(88992),r=l(12435),n=l(90240),d=l(58105),c=l(17825),u=l(41412),m=l(46061),x=l(77018),p=l(71538);let A=["Inbox","SentItems","DeletedItems","Calendar","Contacts","Drafts","Journal","Tasks","Notes","JunkEmail","CommunicationHistory","Voicemail","Fax","Conflicts","SyncIssues","LocalFailures","ServerFailures"].map(e=>({value:"#".concat(e,"#"),label:(0,u.i)(e)})),h=()=>{let e=(0,c.t)().currentTenant,t=(0,i.mN)({mode:"onChange"}),l=(0,i.FH)({control:t.control,name:"SourceMailbox"}),r=(0,i.FH)({control:t.control,name:"TargetMailbox"});return(0,o.useEffect)(()=>{if(l&&r){let e=l.value,a=r.value,o=crypto.randomUUID();t.setValue("RequestName","Restore ".concat(e," to ").concat(a," (").concat(o,")"))}},[l,r,t]),(0,a.jsx)(n.A,{formControl:t,queryKey:"MailboxRestore",title:"Mailbox Restore",backButtonTitle:"Mailbox Overview",postUrl:"/api/ExecMailboxRestore",customDataformatter:t=>{var l,a,o,s,i,r,n,d;return{TenantFilter:e,RequestName:t.RequestName,SourceMailbox:null!==(n=null===(a=t.SourceMailbox)||void 0===a?void 0:null===(l=a.addedFields)||void 0===l?void 0:l.ExchangeGuid)&&void 0!==n?n:null===(o=t.SourceMailbox)||void 0===o?void 0:o.value,TargetMailbox:null!==(d=null===(i=t.TargetMailbox)||void 0===i?void 0:null===(s=i.addedFields)||void 0===s?void 0:s.ExchangeGuid)&&void 0!==d?d:null===(r=t.TargetMailbox)||void 0===r?void 0:r.value,BadItemLimit:t.BadItemLimit,LargeItemLimit:t.LargeItemLimit,AcceptLargeDataLoss:t.AcceptLargeDataLoss,AssociatedMessagesCopyOption:t.AssociatedMessagesCopyOption,ExcludeFolders:t.ExcludeFolders,IncludeFolders:t.IncludeFolders,BatchName:t.BatchName,CompletedRequestAgeLimit:t.CompletedRequestAgeLimit,ConflictResolutionOption:t.ConflictResolutionOption,SourceRootFolder:t.SourceRootFolder,TargetRootFolder:t.TargetRootFolder,TargetType:t.TargetType,ExcludeDumpster:t.ExcludeDumpster,SourceIsArchive:t.SourceIsArchive,TargetIsArchive:t.TargetIsArchive}},children:(0,a.jsxs)(s.A,{container:!0,spacing:2,children:[(0,a.jsx)(s.A,{size:12,children:(0,a.jsx)(m.A,{severity:"info",children:"Use this form to restore a mailbox from a soft-deleted state to the target mailbox. Use the optional settings tailor the restore request for your needs."})}),(0,a.jsx)(s.A,{size:12,children:(0,a.jsx)(x.A,{variant:"h6",children:"Restore Settings"})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{name:"SourceMailbox",label:"Source Mailbox",type:"autoComplete",formControl:t,multiple:!1,creatable:!0,required:!0,api:{labelField:e=>"".concat(e.displayName," (").concat(e.UPN,")"),valueField:"UPN",addedField:{displayName:"displayName",ExchangeGuid:"ExchangeGuid"},url:"/api/ListMailboxes?SoftDeletedMailbox=true",queryKey:"ListMailboxes-".concat(e,"-SoftDeleted")},validators:{validate:e=>!!e||"Please select a source mailbox."}})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{name:"TargetMailbox",label:"Restore Target",type:"autoComplete",formControl:t,multiple:!1,creatable:!0,required:!0,api:{queryKey:"ListMailboxes-".concat(e),labelField:e=>"".concat(e.displayName," (").concat(e.UPN,")"),valueField:"UPN",addedField:{displayName:"displayName",ExchangeGuid:"ExchangeGuid"},url:"/api/ListMailboxes"},validators:{validate:e=>!!e||"Please select a target mailbox."}})}),(0,a.jsx)(s.A,{size:12,children:(0,a.jsx)(d.A,{type:"textField",label:"Restore Request Name",name:"RequestName",required:!0,formControl:t,validators:{required:"Please enter a request name."}})}),(0,a.jsx)(s.A,{size:12,children:(0,a.jsx)(p.A,{})}),(0,a.jsx)(s.A,{size:12,children:(0,a.jsx)(x.A,{variant:"h6",children:"Optional Settings"})}),(0,a.jsx)(s.A,{size:{xs:6,md:2},children:(0,a.jsx)(d.A,{type:"number",label:"Bad Item Limit",name:"BadItemLimit",formControl:t})}),(0,a.jsx)(s.A,{size:{xs:6,md:2},children:(0,a.jsx)(d.A,{type:"number",label:"Large Item Limit",name:"LargeItemLimit",formControl:t})}),(0,a.jsx)(s.A,{size:{xs:6,md:2},children:(0,a.jsx)(d.A,{type:"number",label:"Completed Request Age Limit",name:"CompletedRequestAgeLimit",formControl:t})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"autoComplete",label:"Associated Messages Copy Option",name:"AssociatedMessagesCopyOption",formControl:t,options:[{value:"DoNotCopy",label:"Do Not Copy"},{value:"MapByMessageClass",label:"Map By Message Class"},{value:"Copy",label:"Copy"}]})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"autoComplete",label:"Exclude Folders",name:"ExcludeFolders",formControl:t,multiple:!0,creatable:!0,options:A})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"autoComplete",label:"Include Folders",name:"IncludeFolders",formControl:t,multiple:!0,creatable:!0,options:A})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"textField",label:"Batch Name",name:"BatchName",formControl:t})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"autoComplete",label:"Conflict Resolution Option",name:"ConflictResolutionOption",formControl:t,multiple:!1,options:[{value:"ForceCopy",label:"Force Copy"},{value:"KeepAll",label:"Keep All"},{value:"KeepLatestItem",label:"Keep Latest Item"},{value:"KeepSourceItem",label:"Keep Source Item"},{value:"KeepTargetItem",label:"Keep Target Item"},{value:"UpdateFromSource",label:"Update From Source"}]})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"textField",label:"Source Root Folder",name:"SourceRootFolder",formControl:t})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"textField",label:"Target Root Folder",name:"TargetRootFolder",formControl:t})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"autoComplete",label:"Target Type",name:"TargetType",multiple:!1,formControl:t,options:[{value:"Archive",label:"Archive"},{value:"MailboxLocation",label:"Mailbox Location"},{value:"Primary",label:"Primary"}]})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"switch",label:"Exclude Dumpster",name:"ExcludeDumpster",formControl:t})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"switch",label:"Source Is Archive",name:"SourceIsArchive",formControl:t})}),(0,a.jsx)(s.A,{size:{xs:12,md:6},children:(0,a.jsx)(d.A,{type:"switch",label:"Target Is Archive",name:"TargetIsArchive",formControl:t})})]})})};h.getLayout=e=>(0,a.jsx)(r.P,{children:e});let b=h},73996:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/email/tools/mailbox-restores/add",function(){return l(58791)}])},90240:(e,t,l)=>{"use strict";l.d(t,{A:()=>y});var a=l(37876),o=l(89099),s=l(67578),i=l(86650),r=l(22474),n=l(47737),d=l(94810),c=l(77018),u=l(54538),m=l(24933),x=l(17675),p=l(42120),A=l(22322),h=l(68723),b=l(14232),j=l(88992),v=l(2303);let y=e=>{let{title:t,backButtonTitle:l,titleButton:y,formPageType:g="Add",children:C,queryKey:f,formControl:F,postUrl:I,customDataformatter:L,resetForm:M=!1,hideBackButton:N=!1,hidePageType:S=!1,hideTitle:T=!1,hideSubmit:R=!1,allowResubmit:E=!1,addedButtons:z,...q}=e,w=(0,o.useRouter)(),D=(0,A.nN)({datafromUrl:!0,relatedQueryKeys:f}),{isValid:O,isDirty:P}=(0,j.lN)({control:F.control});return(0,b.useEffect)(()=>{if(delete w.query.tenantFilter,w.query){let e={...F.getValues(),...w.query};F.reset(e)}},[w]),(0,b.useEffect)(()=>{D.isSuccess&&M&&F.reset()},[D.isSuccess]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.v,{title:t}),(0,a.jsx)(s.A,{sx:{flexGrow:1,py:4},children:(0,a.jsx)(i.A,{maxWidth:"lg",children:(0,a.jsxs)(r.A,{spacing:4,children:[!T&&(0,a.jsxs)(r.A,{spacing:2,children:[!N&&(0,a.jsx)("div",{children:(0,a.jsx)(n.A,{color:"inherit",onClick:()=>{w.back()},startIcon:(0,a.jsx)(d.A,{fontSize:"small",children:(0,a.jsx)(p.A,{})}),children:l})}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)(c.A,{variant:"h4",children:[!S&&(0,a.jsxs)(a.Fragment,{children:[g," - "]}),t]}),y&&y]})]}),(0,a.jsxs)(u.A,{children:[(0,a.jsxs)(m.A,{children:[C,(0,a.jsx)(h.v,{apiObject:D})]}),!R&&(0,a.jsx)(x.A,{sx:{justifyContent:"flex-end"},children:(0,a.jsxs)(r.A,{spacing:2,direction:"row",children:[z&&z,(0,a.jsx)(n.A,{disabled:D.isPending||!O||!E&&!P,onClick:F.handleSubmit(()=>{if(F.trigger(),!O)return;let e=L?L(F.getValues()):F.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),D.mutate({url:I,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(73996)),_N_E=e.O()}]);