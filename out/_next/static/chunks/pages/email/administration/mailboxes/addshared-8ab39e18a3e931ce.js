(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8295],{42120:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var l=a(93944),i=a(37876);let r=(0,l.A)((0,i.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},58656:(e,t,a)=>{"use strict";a.d(t,{w:()=>n});var l=a(37876),i=a(58105),r=a(88992),s=a(17825);let n=e=>{let{formControl:t,name:a,label:n,allTenants:d=!1,type:o="multiple",multiple:u=!1,...c}=e,m=(0,r.FH)({control:t.control,name:"tenantFilter"}),x=(0,s.t)().currentTenant;return(0,l.jsx)(i.o,{name:a,label:n,type:"autoComplete",formControl:t,multiple:u,api:{autoSelectFirstItem:!0,tenantFilter:m?m.value:x,queryKey:"listDomains-".concat((null==m?void 0:m.value)?m.value:x),url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.id),valueField:"id",data:{Endpoint:"domains",manualPagination:!0,$count:!0,$top:99}},...c})}},64103:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var l=a(37876),i=a(71538),r=a(59568),s=a(88992),n=a(12435),d=a(90240),o=a(58105),u=a(17825),c=a(58656);let m=()=>{let e=(0,u.t)().currentTenant,t=(0,s.mN)({mode:"onChange",defaultValues:{displayName:"",firstName:"",lastName:"",email:"",hidefromGAL:!1}});return(0,l.jsx)(d.A,{formControl:t,queryKey:"AddSharedMailbox",title:"Shared Mailbox",backButtonTitle:"Mailbox Overview",postUrl:"/api/AddSharedMailbox",resetForm:!0,customDataformatter:t=>{var a;return{tenantID:e,displayName:t.displayName,username:t.username,domain:null===(a=t.domain)||void 0===a?void 0:a.value}},children:(0,l.jsxs)(r.A,{container:!0,spacing:2,children:[(0,l.jsx)(r.A,{size:{md:10,xs:12},children:(0,l.jsx)(o.A,{type:"textField",label:"Display Name",name:"displayName",formControl:t,validators:{required:"Display Name is required"}})}),(0,l.jsx)(i.A,{sx:{my:2,width:"100%"}}),(0,l.jsx)(r.A,{size:{md:6,xs:6},children:(0,l.jsx)(o.A,{type:"textField",label:"username",name:"username",formControl:t})}),(0,l.jsx)(r.A,{size:{md:6,xs:6},children:(0,l.jsx)(c.w,{formControl:t,name:"domain",label:"Domain",required:!0})})]})})};m.getLayout=e=>(0,l.jsx)(n.P,{children:e});let x=m},90240:(e,t,a)=>{"use strict";a.d(t,{A:()=>v});var l=a(37876),i=a(89099),r=a(67578),s=a(86650),n=a(22474),d=a(47737),o=a(94810),u=a(77018),c=a(54538),m=a(24933),x=a(17675),h=a(42120),j=a(22322),p=a(68723),A=a(14232),f=a(88992),y=a(2303);let v=e=>{let{title:t,backButtonTitle:a,titleButton:v,formPageType:b="Add",children:g,queryKey:N,formControl:w,postUrl:C,customDataformatter:F,resetForm:_=!1,hideBackButton:k=!1,hidePageType:q=!1,hideTitle:E=!1,hideSubmit:S=!1,allowResubmit:D=!1,addedButtons:z,...O}=e,P=(0,i.useRouter)(),T=(0,j.nN)({datafromUrl:!0,relatedQueryKeys:N}),{isValid:I,isDirty:K}=(0,f.lN)({control:w.control});return(0,A.useEffect)(()=>{if(delete P.query.tenantFilter,P.query){let e={...w.getValues(),...P.query};w.reset(e)}},[P]),(0,A.useEffect)(()=>{T.isSuccess&&_&&w.reset()},[T.isSuccess]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.v,{title:t}),(0,l.jsx)(r.A,{sx:{flexGrow:1,py:4},children:(0,l.jsx)(s.A,{maxWidth:"lg",children:(0,l.jsxs)(n.A,{spacing:4,children:[!E&&(0,l.jsxs)(n.A,{spacing:2,children:[!k&&(0,l.jsx)("div",{children:(0,l.jsx)(d.A,{color:"inherit",onClick:()=>{P.back()},startIcon:(0,l.jsx)(o.A,{fontSize:"small",children:(0,l.jsx)(h.A,{})}),children:a})}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)(u.A,{variant:"h4",children:[!q&&(0,l.jsxs)(l.Fragment,{children:[b," - "]}),t]}),v&&v]})]}),(0,l.jsxs)(c.A,{children:[(0,l.jsxs)(m.A,{children:[g,(0,l.jsx)(p.v,{apiObject:T})]}),!S&&(0,l.jsx)(x.A,{sx:{justifyContent:"flex-end"},children:(0,l.jsxs)(n.A,{spacing:2,direction:"row",children:[z&&z,(0,l.jsx)(d.A,{disabled:T.isPending||!I||!D&&!K,onClick:w.handleSubmit(()=>{if(w.trigger(),!I)return;let e=F?F(w.getValues()):w.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),T.mutate({url:C,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}},96884:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/email/administration/mailboxes/addshared",function(){return a(64103)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(96884)),_N_E=e.O()}]);