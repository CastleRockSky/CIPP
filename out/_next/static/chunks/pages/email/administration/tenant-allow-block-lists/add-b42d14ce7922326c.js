(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1032],{42120:(e,l,t)=>{"use strict";t.d(l,{A:()=>i});var r=t(93944),n=t(37876);let i=(0,r.A)((0,n.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},63848:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>v});var r=t(37876),n=t(14232),i=t(59568),o=t(88992),s=t(12435),a=t(90240),d=t(58105),c=t(17825),u=t(66113);let m=()=>{let e=(0,c.t)().currentTenant,l=(0,o.mN)({mode:"onChange",defaultValues:{entries:"",notes:"",listType:null,listMethod:null,NoExpiration:!1,RemoveAfter:!1}}),t=(0,o.FH)({control:l.control,name:"NoExpiration"}),s=(0,o.FH)({control:l.control,name:"RemoveAfter"}),m=(0,o.FH)({control:l.control,name:"listMethod"}),v=(0,o.FH)({control:l.control,name:"listType"}),f=(null==m?void 0:m.value)==="Block",h=(null==v?void 0:v.value)==="FileHash",x=["Sender","Url","FileHash"].includes(null==v?void 0:v.value),p=f||(null==m?void 0:m.value)==="Allow"&&((null==v?void 0:v.value)==="Url"||(null==v?void 0:v.value)==="IP");return(0,n.useEffect)(()=>{t&&l.setValue("RemoveAfter",!1),s&&l.setValue("NoExpiration",!1),f&&l.setValue("RemoveAfter",!1),v&&!x&&l.setValue("RemoveAfter",!1),h&&l.setValue("listMethod",{label:"Block",value:"Block"}),(m||v)&&!p&&t&&l.setValue("NoExpiration",!1)},[t,s,f,v,x,h,p,l]),(0,r.jsx)(a.A,{formControl:l,queryKey:"TenantAllowBlockList",title:"Add Tenant Allow/Block List",backButtonTitle:"Overview",postUrl:"/api/AddTenantAllowBlockList",customDataformatter:l=>{var t,r;return{tenantID:e,entries:l.entries,listType:null===(t=l.listType)||void 0===t?void 0:t.value,notes:l.notes,listMethod:null===(r=l.listMethod)||void 0===r?void 0:r.value,NoExpiration:l.NoExpiration,RemoveAfter:l.RemoveAfter}},children:(0,r.jsxs)(i.A,{container:!0,spacing:2,children:[(0,r.jsx)(i.A,{size:{md:12,xs:12},children:(0,r.jsx)(d.A,{type:"textField",label:"Entries",name:"entries",formControl:l,validators:{required:"Entries field is required",validate:e=>{if(!e)return!0;let l=e.split(/[,;]/).map(e=>e.trim()),t=null==v?void 0:v.value;if("FileHash"===t)for(let e of l){if(64!==e.length)return"File hash entries must be exactly 64 characters";let l=(0,u.n)(e,"sha256");if(!0!==l)return l}else if("IP"===t)for(let e of l){let l=(0,u.n)(e,"ipv6"),t=(0,u.n)(e,"ipv6cidr");if(!0!==l&&!0!==t)return"Invalid IPv6 address format. Use colon-hexadecimal or CIDR notation"}else if("Url"===t)for(let e of l){if(e.length>250)return"URL entries must be 250 characters or less";if(e.includes("*")||e.includes("~")){let l=(0,u.n)(e,"wildcardUrl"),t=(0,u.n)(e,"wildcardDomain");if(!0!==l&&!0!==t){if(!/^[a-zA-Z0-9\.\-\*\~\/]+$/.test(e))return"Invalid wildcard pattern. Use only letters, numbers, dots, hyphens, slashes, and wildcards (* or ~)";return"Invalid wildcard format. Common formats are *.domain.com or domain.*"}continue}let l=(0,u.n)(e,"ip"),t=(0,u.n)(e,"ipv4cidr"),r=(0,u.n)(e,"ipv6"),n=(0,u.n)(e,"ipv6cidr"),i=(0,u.n)(e,"hostname"),o=(0,u.n)(e,"url");if(!0!==l&&!0!==t&&!0!==r&&!0!==n&&!0!==i&&!0!==o)return"Invalid URL format. Enter hostnames, IPv4, or IPv6 addresses"}else if("Sender"===t)for(let e of l){if(e.includes("*")||e.includes("~")){if(!0!==(0,u.n)(e,"wildcardDomain"))return"Invalid sender wildcard pattern. Common format is *.domain.com";continue}let l=(0,u.n)(e,"senderEntry");if(!0!==l)return l}return!0}},helperText:(null==v?void 0:v.value)==="FileHash"?"Enter SHA256 hash values separated by commas or semicolons (e.g., 768a813668695ef2483b2bde7cf5d1b2db0423a0d3e63e498f3ab6f2eb13ea3e)":(null==v?void 0:v.value)==="Url"?"Enter URLs, IPv4, or IPv6 addresses with optional wildcards separated by commas or semicolons":(null==v?void 0:v.value)==="Sender"?"Enter domains or email addresses separated by commas or semicolons (e.g., contoso.com,user@example.com)":(null==v?void 0:v.value)==="IP"?"Enter IPv6 addresses only in colon-hexadecimal format or CIDR notation":""})}),(0,r.jsx)(i.A,{size:{md:4,xs:12},children:(0,r.jsx)(d.A,{type:"textField",label:"Notes",name:"notes",formControl:l})}),(0,r.jsx)(i.A,{size:{md:4,xs:12},children:(0,r.jsx)(d.A,{type:"autoComplete",label:"List Type",name:"listType",formControl:l,multiple:!1,creatable:!1,options:[{label:"Sender",value:"Sender"},{label:"Url/IPv4",value:"Url"},{label:"FileHash",value:"FileHash"},{label:"IPv6",value:"IP"}],validators:{required:"Please choose a List Type."}})}),(0,r.jsx)(i.A,{size:{md:4,xs:12},children:(0,r.jsx)(d.A,{type:"autoComplete",label:"Block or Allow Entry",name:"listMethod",formControl:l,multiple:!1,creatable:!1,options:[{label:"Block",value:"Block"},{label:"Allow",value:"Allow"}],validators:{required:"Please select Block or Allow."},disabled:h,helperText:h?"FileHash entries can only be Blocked":"Choose whether to block or allow the entries"})}),(0,r.jsx)(i.A,{size:{md:4,xs:12},children:(0,r.jsx)(d.A,{type:"switch",label:"No Expiration",name:"NoExpiration",formControl:l,helperText:f?"Block entries will never expire":"Available only for Block entries or specific Allow entries (URL/IP)",disabled:s||!(f||(null==m?void 0:m.value)==="Allow"&&((null==v?void 0:v.value)==="Url"||(null==v?void 0:v.value)==="IP"))})}),(0,r.jsx)(i.A,{size:{md:4,xs:12},children:(0,r.jsx)(d.A,{type:"switch",label:"Remove After 45 Days",name:"RemoveAfter",formControl:l,helperText:"If checked, allow entries will be removed after 45 days of last use",disabled:t||(null==m?void 0:m.value)!=="Allow"||!["Sender","FileHash","Url"].includes(null==v?void 0:v.value)})})]})})};m.getLayout=e=>(0,r.jsx)(s.P,{children:e});let v=m},69218:(e,l,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/email/administration/tenant-allow-block-lists/add",function(){return t(63848)}])},90240:(e,l,t)=>{"use strict";t.d(l,{A:()=>y});var r=t(37876),n=t(89099),i=t(67578),o=t(86650),s=t(22474),a=t(47737),d=t(94810),c=t(77018),u=t(54538),m=t(24933),v=t(17675),f=t(42120),h=t(22322),x=t(68723),p=t(14232),A=t(88992),b=t(2303);let y=e=>{let{title:l,backButtonTitle:t,titleButton:y,formPageType:j="Add",children:w,queryKey:E,formControl:k,postUrl:I,customDataformatter:C,resetForm:g=!1,hideBackButton:P=!1,hidePageType:F=!1,hideTitle:T=!1,hideSubmit:N=!1,allowResubmit:U=!1,addedButtons:R,...B}=e,H=(0,n.useRouter)(),S=(0,h.nN)({datafromUrl:!0,relatedQueryKeys:E}),{isValid:_,isDirty:L}=(0,A.lN)({control:k.control});return(0,p.useEffect)(()=>{if(delete H.query.tenantFilter,H.query){let e={...k.getValues(),...H.query};k.reset(e)}},[H]),(0,p.useEffect)(()=>{S.isSuccess&&g&&k.reset()},[S.isSuccess]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.v,{title:l}),(0,r.jsx)(i.A,{sx:{flexGrow:1,py:4},children:(0,r.jsx)(o.A,{maxWidth:"lg",children:(0,r.jsxs)(s.A,{spacing:4,children:[!T&&(0,r.jsxs)(s.A,{spacing:2,children:[!P&&(0,r.jsx)("div",{children:(0,r.jsx)(a.A,{color:"inherit",onClick:()=>{H.back()},startIcon:(0,r.jsx)(d.A,{fontSize:"small",children:(0,r.jsx)(f.A,{})}),children:t})}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)(c.A,{variant:"h4",children:[!F&&(0,r.jsxs)(r.Fragment,{children:[j," - "]}),l]}),y&&y]})]}),(0,r.jsxs)(u.A,{children:[(0,r.jsxs)(m.A,{children:[w,(0,r.jsx)(x.v,{apiObject:S})]}),!N&&(0,r.jsx)(v.A,{sx:{justifyContent:"flex-end"},children:(0,r.jsxs)(s.A,{spacing:2,direction:"row",children:[R&&R,(0,r.jsx)(a.A,{disabled:S.isPending||!_||!U&&!L,onClick:k.handleSubmit(()=>{if(k.trigger(),!_)return;let e=C?C(k.getValues()):k.getValues();Object.keys(e).forEach(l=>{(""===e[l]||null===e[l])&&delete e[l]}),S.mutate({url:I,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var l=l=>e(e.s=l);e.O(0,[636,6593,8792],()=>l(69218)),_N_E=e.O()}]);