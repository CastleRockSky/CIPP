(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5931],{34124:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var s=i(93944),a=i(37876);let n=(0,s.A)((0,a.jsx)("path",{d:"M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12.01 3c-1.98 0-3.86.47-5.57 1.41-.24.13-.54.04-.68-.2-.13-.24-.04-.55.2-.68C7.82 2.52 9.86 2 12.01 2c2.13 0 3.99.47 6.03 1.52.25.13.34.43.21.67-.09.18-.26.28-.44.28M3.5 9.72c-.1 0-.2-.03-.29-.09-.23-.16-.28-.47-.12-.7.99-1.4 2.25-2.5 3.75-3.27C9.98 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.86 3.75 3.25.16.22.11.54-.12.7s-.54.11-.7-.12c-.9-1.26-2.04-2.25-3.39-2.94-2.87-1.47-6.54-1.47-9.4.01-1.36.7-2.5 1.7-3.4 2.96-.08.14-.23.21-.39.21m6.25 12.07c-.13 0-.26-.05-.35-.15-.87-.87-1.34-1.43-2.01-2.64-.69-1.23-1.05-2.73-1.05-4.34 0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39c0 .28-.22.5-.5.5s-.5-.22-.5-.5c0-2.42-2.09-4.39-4.66-4.39s-4.66 1.97-4.66 4.39c0 1.44.32 2.77.93 3.85.64 1.15 1.08 1.64 1.85 2.42.19.2.19.51 0 .71-.11.1-.24.15-.37.15m7.17-1.85c-1.19 0-2.24-.3-3.1-.89-1.49-1.01-2.38-2.65-2.38-4.39 0-.28.22-.5.5-.5s.5.22.5.5c0 1.41.72 2.74 1.94 3.56.71.48 1.54.71 2.54.71.24 0 .64-.03 1.04-.1.27-.05.53.13.58.41.05.27-.13.53-.41.58-.57.11-1.07.12-1.21.12M14.91 22c-.04 0-.09-.01-.13-.02-1.59-.44-2.63-1.03-3.72-2.1-1.4-1.39-2.17-3.24-2.17-5.22 0-1.62 1.38-2.94 3.08-2.94s3.08 1.32 3.08 2.94c0 1.07.93 1.94 2.08 1.94s2.08-.87 2.08-1.94c0-3.77-3.25-6.83-7.25-6.83-2.84 0-5.44 1.58-6.61 4.03-.39.81-.59 1.76-.59 2.8 0 .78.07 2.01.67 3.61.1.26-.03.55-.29.64-.26.1-.55-.04-.64-.29-.49-1.31-.73-2.61-.73-3.96 0-1.2.23-2.29.68-3.24 1.33-2.79 4.28-4.6 7.51-4.6 4.55 0 8.25 3.51 8.25 7.83 0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51.95.94 1.86 1.46 3.27 1.85.27.07.42.35.35.61-.05.23-.26.38-.47.38"}),"Fingerprint")},34295:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var s=i(93944),a=i(37876);let n=(0,s.A)((0,a.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"Launch")},46041:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var s=i(14232);let a=s.forwardRef(function(e,t){let{title:i,titleId:a,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),i?s.createElement("title",{id:a},i):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))})},49259:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var s=i(14232);let a=s.forwardRef(function(e,t){let{title:i,titleId:a,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),i?s.createElement("title",{id:a},i):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))})},50387:(e,t,i)=>{"use strict";i.d(t,{f:()=>b});var s=i(37876),a=i(14232),n=i(14e3),r=i(89099),l=i(95062),d=i.n(l),o=i(46041),c=i(67578),h=i(86650),u=i(22474),x=i(47737),A=i(94810),j=i(77018),p=i(76776),g=i(8578),v=i(76626),m=i(71538),w=i(95449),f=i(89273);let b=e=>{let{children:t,tabOptions:i,title:l,subtitle:d,actions:b,actionsData:y,isFetching:C=!1,backUrl:N}=e,k=(0,f.A)(e=>e.breakpoints.down("md")),R=(0,r.useRouter)(),P=(0,n.usePathname)(),F=R.query,M=(0,a.useCallback)((e,t)=>{R.push({pathname:t,query:F},void 0,{shallow:!0})},[R]),E=i.find(e=>e.path===P);return(0,s.jsx)(c.A,{sx:{flexGrow:1,py:4},children:(0,s.jsx)(h.A,{maxWidth:"xl",sx:{height:"100%"},children:(0,s.jsxs)(u.A,{spacing:1,sx:{height:"100%"},children:[(0,s.jsxs)(u.A,{spacing:2,children:[(0,s.jsx)("div",{children:(0,s.jsx)(x.A,{color:"inherit",onClick:()=>N?R.push(N):R.back(),startIcon:(0,s.jsx)(A.A,{fontSize:"small",children:(0,s.jsx)(o.A,{})}),children:"Back to previous page"})}),(0,s.jsxs)(u.A,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:1,children:[(0,s.jsxs)(u.A,{spacing:1,children:[(0,s.jsx)(u.A,{alignItems:"center",direction:"row",spacing:1,justifyContent:"space-between",children:(0,s.jsx)(j.A,{variant:k?"h6":"h4",children:l})}),C?(0,s.jsx)(p.A,{variant:"text",width:200}):d&&(0,s.jsx)(u.A,{alignItems:"center",flexWrap:"wrap",direction:"row",spacing:2,children:d.map((e,t)=>(0,s.jsxs)(u.A,{alignItems:"center",direction:"row",spacing:1,children:[(0,s.jsx)(A.A,{fontSize:"small",children:e.icon}),(0,s.jsx)(j.A,{color:"text.secondary",variant:"body2",children:e.text})]},t))})]}),b&&b.length>0&&(0,s.jsx)(w.$,{actions:b,data:y,disabled:C})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(g.A,{onChange:M,value:null==E?void 0:E.path,variant:"scrollable",children:i.map(e=>(0,s.jsx)(v.A,{label:e.label,value:e.path},e.path))}),(0,s.jsx)(m.A,{})]})]}),(0,s.jsx)(c.A,{sx:!k&&{flexGrow:1,overflow:"auto",height:"calc(100vh - 400px)"},children:t})]})})})};b.propTypes={children:d().node,tabOptions:d().arrayOf(d().shape({label:d().string.isRequired,path:d().string.isRequired})).isRequired,title:d().string.isRequired,subtitle:d().arrayOf(d().shape({icon:d().node.isRequired,text:d().string.isRequired})),actions:d().arrayOf(d().shape({label:d().string.isRequired,handler:d().func.isRequired})),isFetching:d().bool}},77288:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/identity/administration/users/user/bec",function(){return i(83382)}])},81514:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var s=i(14232);let a=s.forwardRef(function(e,t){let{title:i,titleId:a,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),i?s.createElement("title",{id:a},i):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))})},81699:e=>{"use strict";e.exports=JSON.parse('[{"label":"View User","path":"/identity/administration/users/user"},{"label":"Edit User","path":"/identity/administration/users/user/edit"},{"label":"Exchange Settings","path":"/identity/administration/users/user/exchange"},{"label":"Compromise Remediation","path":"/identity/administration/users/user/bec"},{"label":"Conditional Access","path":"/identity/administration/users/user/conditional-access"}]')},83382:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>L});var s=i(37876),a=i(14232),n=i(12435),r=i(17825),l=i(89099),d=i(22322),o=i(49259),c=i(86795),h=i(34124),u=i(34295),x=i(14628),A=i(80580),j=i(50387),p=i(81699),g=i(6706),v=i(84177),m=i(89037),w=i(82179),f=i(59568),b=i(77018),y=i(47737),C=i(94810),N=i(63009),k=i(34126),R=i(84064),P=i(79803),F=i(82836),M=i(79259),E=i(81514);function B(e){let{userPrincipalName:t,isFetching:i,userId:a,tenantFilter:n,restartProcess:r}=e,l=(0,F.s)();return(0,s.jsxs)(R.A,{title:(0,s.jsxs)(b.A,{variant:"h6",children:["Business Email Compromise Overview - ",t]}),cardActions:(0,s.jsx)(y.A,{variant:"outlined",size:"small",onClick:()=>r(),disabled:i,startIcon:(0,s.jsx)(C.A,{fontSize:"small",children:(0,s.jsx)(M.A,{})}),children:"Refresh Data"}),CardButton:(0,s.jsx)(y.A,{variant:"contained",color:"primary",onClick:()=>l.handleOpen(),startIcon:(0,s.jsx)(C.A,{fontSize:"small",children:(0,s.jsx)(E.A,{})}),children:"Remediate User"}),isFetching:i,children:[(0,s.jsx)(b.A,{children:"Use this information as a guide to check if a tenant or e-mail address might have been compromised. All data is retrieved from the last 7 days of logs."}),(0,s.jsx)(b.A,{color:"text.secondary",children:"Hit the button below to execute the following tasks:"}),(0,s.jsxs)(N.A,{children:[(0,s.jsx)(k.Ay,{children:"Block user sign-in"}),(0,s.jsx)(k.Ay,{children:"Reset user password"}),(0,s.jsx)(k.Ay,{children:"Disconnect all current sessions"}),(0,s.jsx)(k.Ay,{children:"Remove all MFA methods for the user"}),(0,s.jsx)(k.Ay,{children:"Disable all inbox rules for the user"})]}),(0,s.jsx)(P.B,{title:"Remediate User",createDialog:l,api:{url:"/api/execBecRemediate",confirmText:"This will remediate this user, blocking their signin, resetting their password, disconnecting their sessions, and disabling all their inbox rules. Are you sure you want to continue?",type:"POST",data:{tenantFilter:n,userId:"userId",username:"userPrincipalName"},replacementBehaviour:"removeNulls"},row:e})]})}var T=i(7957),D=i(78e3),S=i(20908);let U=()=>{var e,t,i,n,N,k,P,F,M,E,U,L,O,I,_,z;let q=(0,r.t)(),{userId:G}=(0,l.useRouter)().query,[W,V]=(0,a.useState)(!0),[K,H]=(0,a.useState)(!1),[J,X]=(0,a.useState)(!1),[$,Q]=(0,a.useState)(!1),Z=(0,d.R_)({url:"/api/ListUsers?UserId=".concat(G,"&tenantFilter=").concat(q.currentTenant),queryKey:"ListUsers-".concat(G),waiting:J});(0,a.useEffect)(()=>{G&&X(!0)},[G]),(0,a.useEffect)(()=>{var e,t;Z.isSuccess&&(null===(t=Z.data)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.userPrincipalName)&&Q(!0)},[Z]);let Y=(0,d.R_)({url:"/api/execBECCheck",data:{userId:G,tenantFilter:q.currentTenant,username:null===(t=Z.data)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.userPrincipalName,...K&&{Overwrite:!0}},queryKey:"execBECCheck-initial-".concat(G,"-").concat(q.currentTenant,"-").concat(null===(n=Z.data)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:i.userPrincipalName),waiting:$}),ee=(0,d.R_)({url:"/api/execBECCheck",data:{GUID:null===(N=Y.data)||void 0===N?void 0:N.GUID,tenantFilter:q.currentTenant},queryKey:"execBECCheck-polling-".concat(null===(k=Y.data)||void 0===k?void 0:k.GUID),waiting:!1});(0,a.useEffect)(()=>{var e,t,i;(null===(e=Y.data)||void 0===e?void 0:e.GUID)&&(V(!0),(!ee.data||(null===(i=ee.data)||void 0===i?void 0:i.Waiting))&&setTimeout(()=>{ee.refetch()},1e4)),ee.isSuccess&&ee.data&&!(null===(t=ee.data)||void 0===t?void 0:t.Waiting)&&V(!1)},[ee.dataUpdatedAt,Y]);let et=()=>{H(!0),ee.refetch(),setTimeout(()=>{Y.refetch(),ee.refetch()},500)},ei=Z.isLoading||Y.isLoading||ee.isLoading||W,es=Z.isSuccess?[{icon:(0,s.jsx)(c.A,{}),text:(0,s.jsx)(v.R,{type:"chip",text:null===(F=Z.data)||void 0===F?void 0:null===(P=F[0])||void 0===P?void 0:P.userPrincipalName})},{icon:(0,s.jsx)(h.A,{}),text:(0,s.jsx)(v.R,{type:"chip",text:null===(E=Z.data)||void 0===E?void 0:null===(M=E[0])||void 0===M?void 0:M.id})},{icon:(0,s.jsx)(o.A,{}),text:(0,s.jsxs)(s.Fragment,{children:["Created: ",(0,s.jsx)(g.A,{date:new Date(null===(L=Z.data)||void 0===L?void 0:null===(U=L[0])||void 0===U?void 0:U.createdDateTime)})]})},{icon:(0,s.jsx)(u.A,{style:{color:"#667085"}}),text:(0,s.jsx)(y.A,{color:"muted",style:{paddingLeft:0},size:"small",href:"https://entra.microsoft.com/".concat(q.currentTenant,"/#view/Microsoft_AAD_UsersAndTenants/UserProfileMenuBlade/~/overview/userId/").concat(G),target:"_blank",rel:"noopener noreferrer",children:"View in Entra"})}]:[];return(0,s.jsxs)(j.f,{tabOptions:p,title:Z.isSuccess?null===(I=Z.data)||void 0===I?void 0:null===(O=I[0])||void 0===O?void 0:O.displayName:"",subtitle:es,isFetching:Z.isFetching,children:[ei&&Z.isSuccess&&(0,s.jsx)(m.A,{sx:{flexGrow:1,py:4},children:(0,s.jsxs)(f.A,{container:!0,spacing:2,children:[(0,s.jsx)(f.A,{size:5,children:(0,s.jsx)(B,{userPrincipalName:Z.data[0].userPrincipalName,userId:Z.data[0].id,tenantFilter:q.currentTenant,restartProcess:et,isFetching:!1})}),(0,s.jsx)(f.A,{size:7,children:(0,s.jsx)(R.A,{variant:"outlined",isFetching:!1,title:(0,s.jsxs)(w.A,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(m.A,{children:"Loading data"}),(0,s.jsx)(T.A,{size:20})]}),children:(0,s.jsx)(b.A,{variant:"body2",gutterBottom:!0,children:"This Analysis can take up to 10 minutes to complete depending on the amount of logs. Please wait for the process to finish."})})})]})}),!ei&&Z.isSuccess&&(0,s.jsx)(m.A,{sx:{flexGrow:1,py:4},children:(0,s.jsxs)(f.A,{container:!0,spacing:2,children:[(0,s.jsx)(f.A,{size:5,children:(0,s.jsx)(B,{userPrincipalName:Z.data[0].userPrincipalName,userId:Z.data[0].id,tenantFilter:q.currentTenant,isFetching:!1,restartProcess:et})}),(0,s.jsx)(f.A,{size:7,children:(0,s.jsxs)(w.A,{spacing:3,children:[(0,s.jsxs)(R.A,{variant:"outlined",isFetching:!1,title:(0,s.jsxs)(w.A,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(m.A,{children:"Log information"}),(0,s.jsx)(w.A,{direction:"row",spacing:2,children:(0,s.jsx)(C.A,{color:"success",children:(0,s.jsx)(x.A,{})})})]}),children:[(0,s.jsxs)(b.A,{variant:"body2",gutterBottom:!0,children:[null===(_=ee.data)||void 0===_?void 0:_.ExtractResult,". The data of this log was extracted at"," ",new Date(null===(z=ee.data)||void 0===z?void 0:z.ExtractedAt).toLocaleString(),". This data might be cached. To get the latest version of the data, click the Refresh Data button."]}),ee.data&&ee.data.NewRules&&ee.data.NewRules.length>0&&(0,s.jsx)(m.A,{mt:2})]}),(0,s.jsxs)(R.A,{variant:"outlined",isFetching:!1,title:(0,s.jsxs)(w.A,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(m.A,{children:"Check 1: Mailbox Rules"}),(0,s.jsx)(w.A,{direction:"row",spacing:2,children:ee.data&&ee.data.NewRules&&ee.data.NewRules.length>0?(0,s.jsx)(C.A,{color:"success",children:(0,s.jsx)(x.A,{})}):(0,s.jsx)(C.A,{color:"disabled",children:(0,s.jsx)(x.A,{})})})]}),children:[(0,s.jsx)(b.A,{variant:"body2",gutterBottom:!0,children:ee.data?ee.data.NewRules&&ee.data.NewRules.length>0?ee.data.NewRules.some(e=>{var t;return null===(t=e.MoveToFolder)||void 0===t?void 0:t.includes("RSS")})?"Potential Breach found. The rules for this user contain classic signs of a breach.":"Rules have been found. Please review the list below and take action as needed.":"No new rules found.":null}),ee.data&&ee.data.NewRules&&ee.data.NewRules.length>0&&(0,s.jsx)(m.A,{mt:2,children:(0,s.jsx)(D.g,{children:ee.data.NewRules.map((e,t)=>(0,s.jsx)(S.N,{label:e.Name,value:e.Description},t))})})]}),(0,s.jsxs)(R.A,{variant:"outlined",isFetching:!1,title:(0,s.jsxs)(w.A,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(m.A,{children:"Check 2: Recently added users"}),(0,s.jsx)(w.A,{direction:"row",spacing:2,children:ee.data&&ee.data.NewUsers&&ee.data.NewUsers.length>0?(0,s.jsx)(C.A,{color:"success",children:(0,s.jsx)(x.A,{})}):(0,s.jsx)(C.A,{color:"disabled",children:(0,s.jsx)(x.A,{})})})]}),children:[(0,s.jsx)(b.A,{variant:"body2",gutterBottom:!0,children:ee.data?ee.data.NewUsers&&ee.data.NewUsers.length>0?"New users have been found in the last 14 days. Please review the list below and take action as needed.":"No new users found.":null}),ee.data&&ee.data.NewUsers&&ee.data.NewUsers.length>0&&(0,s.jsx)(m.A,{mt:2,children:(0,s.jsx)(D.g,{children:ee.data.NewUsers.map((e,t)=>(0,s.jsx)(S.N,{label:e.userPrincipalName,value:e.createdDateTime},t))})})]}),(0,s.jsxs)(R.A,{variant:"outlined",isFetching:!1,title:(0,s.jsxs)(w.A,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(m.A,{children:"Check 3: New Applications"}),(0,s.jsx)(w.A,{direction:"row",spacing:2,children:ee.data&&ee.data.AddedApps&&ee.data.AddedApps.length>0?(0,s.jsx)(C.A,{color:"success",children:(0,s.jsx)(x.A,{})}):(0,s.jsx)(C.A,{color:"disabled",children:(0,s.jsx)(x.A,{})})})]}),children:[(0,s.jsx)(b.A,{variant:"body2",gutterBottom:!0,children:ee.data?ee.data.AddedApps&&ee.data.AddedApps.length>0?ee.data.AddedApps.some(e=>!1)?"Potential Breach found.":"New applications have been found. Please review the list below and take action as needed.":"No new applications found.":null}),ee.data&&ee.data.AddedApps&&ee.data.AddedApps.length>0&&(0,s.jsx)(m.A,{mt:2,children:(0,s.jsx)(D.g,{children:ee.data.AddedApps.map((e,t)=>(0,s.jsx)(S.N,{label:"".concat(e.displayName," - ").concat(e.appId),value:e.createdDateTime},t))})})]}),(0,s.jsxs)(R.A,{variant:"outlined",isFetching:!1,title:(0,s.jsxs)(w.A,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(m.A,{children:"Check 4: Mailbox permission changes"}),(0,s.jsx)(w.A,{direction:"row",spacing:2,children:ee.data&&ee.data.MailboxPermissionChanges&&ee.data.MailboxPermissionChanges.length>0?(0,s.jsx)(C.A,{color:"success",children:(0,s.jsx)(x.A,{})}):(0,s.jsx)(C.A,{color:"disabled",children:(0,s.jsx)(x.A,{})})})]}),children:[(0,s.jsx)(b.A,{variant:"body2",gutterBottom:!0,children:ee.data?ee.data.MailboxPermissionChanges&&ee.data.MailboxPermissionChanges.length>0?"Mailbox permission changes have been found.":"No mailbox permission changes found.":null}),ee.data&&ee.data.MailboxPermissionChanges&&ee.data.MailboxPermissionChanges.length>0&&(0,s.jsx)(m.A,{mt:2,children:(0,s.jsx)(D.g,{children:ee.data.MailboxPermissionChanges.map((e,t)=>(0,s.jsx)(S.N,{label:e.UserKey,value:"".concat(e.Operation," - ").concat(e.Permissions)},t))})})]}),(0,s.jsxs)(R.A,{variant:"outlined",isFetching:!1,title:(0,s.jsxs)(w.A,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(m.A,{children:"Check 5: MFA Devices"}),(0,s.jsx)(w.A,{direction:"row",spacing:2,children:ee.data&&ee.data.MFADevices&&ee.data.MFADevices.length>0?(0,s.jsx)(C.A,{color:"success",children:(0,s.jsx)(x.A,{})}):(0,s.jsx)(C.A,{color:"disabled",children:(0,s.jsx)(x.A,{})})})]}),children:[(0,s.jsx)(b.A,{variant:"body2",gutterBottom:!0,children:"MFA Devices have been found. Please review the list below and take action as required"}),ee.data&&ee.data.MFADevices&&ee.data.MFADevices.length>0&&(0,s.jsx)(m.A,{mt:2,children:(0,s.jsx)(D.g,{children:ee.data.MFADevices.map((e,t)=>(0,s.jsx)(S.N,{label:e["@odata.type"],value:"".concat(e.displayName," - Registered at ").concat(e.createdDateTime)},t))})})]}),(0,s.jsxs)(R.A,{variant:"outlined",isFetching:!1,title:(0,s.jsxs)(w.A,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(m.A,{children:"Check 6: Password Changes"}),(0,s.jsx)(w.A,{direction:"row",spacing:2,children:ee.data&&ee.data.ChangedPasswords&&ee.data.ChangedPasswords.length>0?(0,s.jsx)(C.A,{color:"success",children:(0,s.jsx)(x.A,{})}):(0,s.jsx)(C.A,{color:"disabled",children:(0,s.jsx)(x.A,{})})})]}),children:[(0,s.jsx)(b.A,{variant:"body2",gutterBottom:!0,children:"Latest password changes for the tenant can be seen below"}),ee.data&&ee.data.ChangedPasswords&&ee.data.ChangedPasswords.length>0&&(0,s.jsx)(m.A,{mt:2,children:(0,s.jsx)(D.g,{children:ee.data.ChangedPasswords.map((e,t)=>(0,s.jsx)(S.N,{label:e.displayName,value:"".concat(e.lastPasswordChangeDateTime)},t))})})]}),(0,s.jsxs)(R.A,{variant:"outlined",isFetching:!1,title:(0,s.jsxs)(w.A,{direction:"row",justifyContent:"space-between",children:[(0,s.jsx)(m.A,{children:"Report"}),(0,s.jsx)(w.A,{direction:"row",spacing:2,children:ee.data?(0,s.jsx)(C.A,{color:"success",children:(0,s.jsx)(x.A,{})}):(0,s.jsx)(C.A,{color:"disabled",children:(0,s.jsx)(x.A,{})})})]}),children:[(0,s.jsx)(b.A,{variant:"body2",gutterBottom:!0,children:"Click this button to download a report of all the data found during this research to perform your own analysis."}),ee.data&&(0,s.jsx)(m.A,{sx:{mt:2},children:(0,s.jsx)(y.A,{onClick:()=>{let e=new Blob([JSON.stringify(ee.data,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download="BEC_Report_".concat(Z.data[0].userPrincipalName,".json"),i.click(),URL.revokeObjectURL(t)},variant:"contained",startIcon:(0,s.jsx)(C.A,{fontSize:"small",children:(0,s.jsx)(A.A,{})}),children:"Download Report"})})]})]})})]})})]})};U.getLayout=e=>(0,s.jsx)(n.P,{children:e});let L=U},95449:(e,t,i)=>{"use strict";i.d(t,{$:()=>p});var s=i(37876),a=i(54550),n=i(95062),r=i.n(n),l=i(47737),d=i(94810),o=i(52808),c=i(6003),h=i(93256),u=i(50221),x=i(14232),A=i(82836),j=i(79803);let p=e=>{var t;let{actions:i=[],label:n="Actions",data:r,queryKeys:p,...g}=e,v=(0,u.f)(),[m,w]=(0,x.useState)({data:{},action:{},ready:!1}),f=(0,A.s)(),b=(e,t)=>!e||null!=t&&!!t.condition&&!(null==t?void 0:t.condition(e));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.A,{onClick:v.handleOpen,ref:v.anchorRef,startIcon:(0,s.jsx)(d.A,{fontSize:"small",children:(0,s.jsx)(a.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap"},children:"Actions"}),(0,s.jsx)(o.A,{anchorEl:v.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:v.handleClose,open:v.open,transformOrigin:{horizontal:"right",vertical:"top"},children:null==i?void 0:i.filter(e=>!e.link||e.showInActionsMenu).map((e,t)=>(0,s.jsxs)(c.A,{disabled:b(r,e),onClick:()=>{w({data:r,action:e,ready:!0}),(null==e?void 0:e.noConfirm)&&e.customFunction?e.customFunction(r,e,{}):(f.handleOpen(),v.handleClose())},children:[(0,s.jsx)(d.A,{fontSize:"small",sx:{minWidth:"30px"},children:e.icon}),(0,s.jsx)(h.A,{children:e.label})]},t))}),m.ready&&(0,s.jsx)(j.B,{createDialog:f,title:"Confirmation",fields:null===(t=m.action)||void 0===t?void 0:t.fields,api:m.action,row:m.data,relatedQueryKeys:p})]})};p.propTypes={actions:r().array,label:r().string}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(77288)),_N_E=e.O()}]);