(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1648],{3286:(e,i,a)=>{"use strict";a.d(i,{A:()=>r});var l=a(93944),t=a(37876);let r=(0,l.A)((0,t.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10h5v-2h-5c-4.34 0-8-3.66-8-8s3.66-8 8-8 8 3.66 8 8v1.43c0 .79-.71 1.57-1.5 1.57s-1.5-.78-1.5-1.57V12c0-2.76-2.24-5-5-5s-5 2.24-5 5 2.24 5 5 5c1.38 0 2.64-.56 3.54-1.47.65.89 1.77 1.47 2.96 1.47 1.97 0 3.5-1.6 3.5-3.57V12c0-5.52-4.48-10-10-10m0 13c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3"}),"AlternateEmail")},34124:(e,i,a)=>{"use strict";a.d(i,{A:()=>r});var l=a(93944),t=a(37876);let r=(0,l.A)((0,t.jsx)("path",{d:"M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12.01 3c-1.98 0-3.86.47-5.57 1.41-.24.13-.54.04-.68-.2-.13-.24-.04-.55.2-.68C7.82 2.52 9.86 2 12.01 2c2.13 0 3.99.47 6.03 1.52.25.13.34.43.21.67-.09.18-.26.28-.44.28M3.5 9.72c-.1 0-.2-.03-.29-.09-.23-.16-.28-.47-.12-.7.99-1.4 2.25-2.5 3.75-3.27C9.98 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.86 3.75 3.25.16.22.11.54-.12.7s-.54.11-.7-.12c-.9-1.26-2.04-2.25-3.39-2.94-2.87-1.47-6.54-1.47-9.4.01-1.36.7-2.5 1.7-3.4 2.96-.08.14-.23.21-.39.21m6.25 12.07c-.13 0-.26-.05-.35-.15-.87-.87-1.34-1.43-2.01-2.64-.69-1.23-1.05-2.73-1.05-4.34 0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39c0 .28-.22.5-.5.5s-.5-.22-.5-.5c0-2.42-2.09-4.39-4.66-4.39s-4.66 1.97-4.66 4.39c0 1.44.32 2.77.93 3.85.64 1.15 1.08 1.64 1.85 2.42.19.2.19.51 0 .71-.11.1-.24.15-.37.15m7.17-1.85c-1.19 0-2.24-.3-3.1-.89-1.49-1.01-2.38-2.65-2.38-4.39 0-.28.22-.5.5-.5s.5.22.5.5c0 1.41.72 2.74 1.94 3.56.71.48 1.54.71 2.54.71.24 0 .64-.03 1.04-.1.27-.05.53.13.58.41.05.27-.13.53-.41.58-.57.11-1.07.12-1.21.12M14.91 22c-.04 0-.09-.01-.13-.02-1.59-.44-2.63-1.03-3.72-2.1-1.4-1.39-2.17-3.24-2.17-5.22 0-1.62 1.38-2.94 3.08-2.94s3.08 1.32 3.08 2.94c0 1.07.93 1.94 2.08 1.94s2.08-.87 2.08-1.94c0-3.77-3.25-6.83-7.25-6.83-2.84 0-5.44 1.58-6.61 4.03-.39.81-.59 1.76-.59 2.8 0 .78.07 2.01.67 3.61.1.26-.03.55-.29.64-.26.1-.55-.04-.64-.29-.49-1.31-.73-2.61-.73-3.96 0-1.2.23-2.29.68-3.24 1.33-2.79 4.28-4.6 7.51-4.6 4.55 0 8.25 3.51 8.25 7.83 0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51.95.94 1.86 1.46 3.27 1.85.27.07.42.35.35.61-.05.23-.26.38-.47.38"}),"Fingerprint")},34295:(e,i,a)=>{"use strict";a.d(i,{A:()=>r});var l=a(93944),t=a(37876);let r=(0,l.A)((0,t.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"Launch")},49259:(e,i,a)=>{"use strict";a.d(i,{A:()=>t});var l=a(14232);let t=l.forwardRef(function(e,i){let{title:a,titleId:t,...r}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),a?l.createElement("title",{id:t},a):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))})},73820:(e,i,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/identity/administration/users/user/exchange",function(){return a(93819)}])},81699:e=>{"use strict";e.exports=JSON.parse('[{"label":"View User","path":"/identity/administration/users/user"},{"label":"Edit User","path":"/identity/administration/users/user/edit"},{"label":"Exchange Settings","path":"/identity/administration/users/user/exchange"},{"label":"Compromise Remediation","path":"/identity/administration/users/user/bec"},{"label":"Conditional Access","path":"/identity/administration/users/user/conditional-access"}]')},86508:(e,i,a)=>{"use strict";a.d(i,{A:()=>n});var l=a(37876),t=a(67578),r=a(76776),s=a(59568);let n=e=>{let{layout:i}=e;return(0,l.jsx)(t.A,{sx:{width:"100%",my:2},children:i.map((e,i)=>(0,l.jsx)(s.A,{container:!0,spacing:2,sx:{mb:2},children:Array.from({length:e}).map((a,t)=>(0,l.jsx)(s.A,{size:{xs:12/e},children:(0,l.jsx)(r.A,{variant:"rectangular",width:"100%"})},"skeleton-".concat(i,"-").concat(t)))},"row-".concat(i)))})}},93819:(e,i,a)=>{"use strict";a.r(i),a.d(i,{default:()=>eg});var l=a(37876),t=a(12435),r=a(17825),s=a(89099),n=a(22322),o=a(86508),d=a(49259),c=a(86795),u=a(34124),m=a(34295),v=a(60455),x=a(15692),p=a(83198),h=a(26996),A=a(93944);let b=(0,A.A)((0,l.jsx)("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 18H4V8h16z"}),"CalendarToday");var y=a(7159),j=a(71609);let g=(0,A.A)((0,l.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star");var f=a(3286),w=a(50387),P=a(81699),E=a(43225),M=a(84177),F=a(89037),C=a(82179),R=a(59568),S=a(15698),T=a(95062),N=a.n(T),L=a(54538),I=a(1073),U=a(77018),O=a(7957),D=a(70946),B=a(46061),z=a(71538),V=a(76776),k=a(59017),H=a(78e3),_=a(20908),K=a(35936),q=a(79259),G=a(48504),Q=a(91422);let W=e=>{let{exchangeData:i,isLoading:a=!1,isFetching:t=!1,handleRefresh:r,...s}=e,n=[{name:"EWS",enabled:null==i?void 0:i.EWSEnabled},{name:"MAPI",enabled:null==i?void 0:i.MailboxMAPIEnabled},{name:"OWA",enabled:null==i?void 0:i.MailboxOWAEnabled},{name:"IMAP",enabled:null==i?void 0:i.MailboxImapEnabled},{name:"POP",enabled:null==i?void 0:i.MailboxPopEnabled},{name:"ActiveSync",enabled:null==i?void 0:i.MailboxActiveSyncEnabled}],o=[{name:"Compliance Tag Hold",enabled:null==i?void 0:i.ComplianceTagHold},{name:"Retention Hold",enabled:null==i?void 0:i.RetentionHold},{name:"Litigation Hold",enabled:null==i?void 0:i.LitigationHold},{name:"In-Place Hold",enabled:null==i?void 0:i.InPlaceHold},{name:"eDiscovery Hold",enabled:null==i?void 0:i.EDiscoveryHold},{name:"Purview Retention Hold",enabled:null==i?void 0:i.PurviewRetentionHold},{name:"Excluded from Org-Wide Hold",enabled:null==i?void 0:i.ExcludedFromOrgWideHold}];return(0,l.jsxs)(L.A,{...s,children:[(0,l.jsx)(I.A,{title:(0,l.jsxs)(C.A,{direction:"row",sx:{alignItems:"center",display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)(U.A,{variant:"h6",children:"Exchange Information"}),t?(0,l.jsx)(O.A,{size:20}):(0,l.jsx)(D.A,{onClick:r,size:"small",children:(0,l.jsx)(q.A,{})})]})}),(null==i?void 0:i.BlockedForSpam)?(0,l.jsx)(B.A,{severity:"warning",sx:{mx:2,mt:2,mb:2},children:"This mailbox is currently blocked for spam."}):null,(0,l.jsx)(z.A,{}),(0,l.jsxs)(H.g,{children:[(0,l.jsx)(_.N,{divider:!0,value:a?(0,l.jsx)(V.A,{variant:"text",width:200}):(0,l.jsxs)(R.A,{container:!0,spacing:2,children:[(0,l.jsxs)(R.A,{size:{xs:12,md:4},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Mailbox Type:"}),(0,l.jsx)(U.A,{variant:"inherit",children:(null==i?void 0:i.RecipientTypeDetails)||"N/A"})]}),(0,l.jsxs)(R.A,{size:{xs:12,md:4},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Hidden from GAL:"}),(0,l.jsx)(U.A,{variant:"inherit",children:(0,K.i)(null==i?void 0:i.HiddenFromAddressLists,"HiddenFromAddressLists")})]}),(0,l.jsxs)(R.A,{size:{xs:12,md:4},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Blocked For Spam:"}),(0,l.jsx)(U.A,{variant:"inherit",children:(0,K.i)(null==i?void 0:i.BlockedForSpam,"BlockedForSpam")})]})]})}),(0,l.jsx)(_.N,{divider:!0,label:"Mailbox Usage",value:a?(0,l.jsx)(V.A,{variant:"text",width:80}):(null==i?void 0:i.TotalItemSize)!=null?(0,l.jsx)(Q.d,{sx:{width:"100%"},variant:"determinate",addedLabel:"(".concat(Math.round(i.TotalItemSize)," GB of ").concat(Math.round(null==i?void 0:i.ProhibitSendReceiveQuota),"GB)"),value:Math.round((null==i?void 0:i.TotalItemSize)/(null==i?void 0:i.ProhibitSendReceiveQuota)*1e4)/100}):"N/A"}),(0,l.jsx)(_.N,{divider:!0,value:a?(0,l.jsx)(V.A,{variant:"text",width:200}):(()=>{let e=null==i?void 0:i.ForwardingAddress,a=null==i?void 0:i.ForwardAndDeliver,t="None",r="";return e&&(e.startsWith("smtp:")?(t="External",r=e.replace("smtp:","")):(t="Internal",r=e)),(0,l.jsxs)(R.A,{container:!0,spacing:2,children:[(0,l.jsxs)(R.A,{size:{xs:12,md:6},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Forwarding Status:"}),(0,l.jsx)(U.A,{variant:"inherit",children:"None"===t?(0,K.i)(!1,"ForwardingStatus"):"".concat(t," Forwarding")})]}),"None"!==t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(R.A,{size:{xs:12,md:6},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Keep Copy in Mailbox:"}),(0,l.jsx)(U.A,{variant:"inherit",children:(0,K.i)(a,"ForwardAndDeliver")})]}),(0,l.jsxs)(R.A,{size:{xs:12,md:12},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Forwarding Address:"}),(0,l.jsx)(U.A,{variant:"inherit",children:r})]})]})]})})()}),(0,l.jsx)(_.N,{divider:!0,value:a?(0,l.jsx)(V.A,{variant:"text",width:200}):(0,l.jsxs)(R.A,{container:!0,spacing:2,children:[(0,l.jsxs)(R.A,{size:{xs:12,md:6},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Archive Mailbox Enabled:"}),(0,l.jsx)(U.A,{variant:"inherit",children:(0,K.i)(null==i?void 0:i.ArchiveMailBox,"ArchiveMailBox")})]}),(null==i?void 0:i.ArchiveMailBox)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(R.A,{size:{xs:12,md:6},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Auto Expanding Archive:"}),(0,l.jsx)(U.A,{variant:"inherit",children:(0,K.i)(null==i?void 0:i.AutoExpandingArchive,"AutoExpandingArchive")})]}),(0,l.jsxs)(R.A,{size:{xs:12,md:6},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Total Archive Item Size:"}),(0,l.jsx)(U.A,{variant:"inherit",children:(null==i?void 0:i.TotalArchiveItemSize)!=null?"".concat(i.TotalArchiveItemSize," GB"):"N/A"})]}),(0,l.jsxs)(R.A,{size:{xs:12,md:6},children:[(0,l.jsx)(U.A,{variant:"inherit",color:"text.primary",gutterBottom:!0,children:"Total Archive Item Count:"}),(0,l.jsx)(U.A,{variant:"inherit",children:(null==i?void 0:i.TotalArchiveItemCount)!=null?i.TotalArchiveItemCount:"N/A"})]})]})]})}),(0,l.jsx)(_.N,{divider:!0,label:"Mailbox Holds",value:a?(0,l.jsx)(V.A,{variant:"text",width:200}):(0,l.jsx)("div",{children:o.map(e=>(0,l.jsx)(k.A,{label:e.name,icon:e.enabled?(0,l.jsx)(x.A,{}):(0,l.jsx)(G.A,{}),color:e.enabled?"success":"default",variant:"outlined",size:"small",sx:{mr:1,mb:1}},e.name))})}),(0,l.jsx)(_.N,{divider:!0,label:"Mailbox Protocols",value:a?(0,l.jsx)(V.A,{variant:"text",width:200}):(0,l.jsx)("div",{children:n.map(e=>(0,l.jsx)(k.A,{label:e.name,icon:e.enabled?(0,l.jsx)(x.A,{}):(0,l.jsx)(G.A,{}),color:e.enabled?"success":"default",variant:"outlined",size:"small",sx:{mr:1,mb:1}},e.name))})})]})]})};W.propTypes={exchangeData:N().object,isLoading:N().bool,isFetching:N().bool,handleRefresh:N().func};var $=a(14232),X=a(22474),J=a(22430),Y=a(67578),Z=a(47737),ee=a(94810),ei=a(37224),ea=a(58105),el=a(68723),et=a(88992),er=a(54550),es=a(46402),en=a(66113);let eo=e=>{var i,a,t,r;let{formControl:s,usersList:n,contactsList:o,postRequest:d,handleSubmit:c}=e,u=[...(null==n?void 0:null===(a=n.data)||void 0===a?void 0:null===(i=a.Results)||void 0===i?void 0:i.map(e=>({value:e.userPrincipalName,label:"".concat(e.displayName," (").concat(e.userPrincipalName,") - User")})))||[],...(null==o?void 0:null===(r=o.data)||void 0===r?void 0:null===(t=r.Results)||void 0===t?void 0:t.map(e=>({value:e.mail||e.emailAddress,label:"".concat(e.displayName," (").concat(e.mail||e.emailAddress,") - Contact")})))||[]];return(0,l.jsxs)(X.A,{spacing:2,children:[(0,l.jsx)(ea.A,{type:"radio",name:"forwarding.forwardOption",formControl:s,options:[{label:"Forward to Internal Address",value:"internalAddress"},{label:"Forward to External Address (Tenant must allow this)",value:"ExternalAddress"},{label:"Disable Email Forwarding",value:"disabled"}]}),(0,l.jsx)(es.A,{formControl:s,field:"forwarding.forwardOption",compareType:"is",compareValue:"internalAddress",children:(0,l.jsx)(ea.A,{type:"autoComplete",label:"Select User",name:"forwarding.ForwardInternal",multiple:!1,options:u,formControl:s,creatable:!1})}),(0,l.jsx)(es.A,{formControl:s,field:"forwarding.forwardOption",compareType:"is",compareValue:"ExternalAddress",children:(0,l.jsx)(ea.A,{type:"textField",label:"External Email Address",name:"forwarding.ForwardExternal",formControl:s,validators:{required:"Email is required",validate:e=>(0,en.n)(e,"email")}})}),(0,l.jsx)(ea.A,{type:"switch",label:"Keep a Copy of the Forwarded Mail in the Source Mailbox",name:"forwarding.KeepCopy",formControl:s}),(0,l.jsx)(R.A,{size:12,children:(0,l.jsx)(el.v,{apiObject:d})}),(0,l.jsx)(R.A,{children:(0,l.jsx)(Z.A,{onClick:()=>c("forwarding"),variant:"contained",disabled:!s.formState.isValid||d.isPending,children:"Submit"})})]})},ed=e=>{var i,a;let t=(0,r.t)(),{formControl:s,currentSettings:o,userId:d,calPermissions:c,isFetching:u,oooRequest:m}=e,[v,h]=(0,$.useState)(null),[A,b]=(0,$.useState)([]),y=(0,et.FH)({control:s.control,name:"ooo.AutoReplyState"}),j=(null==y?void 0:y.value)!=="Scheduled",g=e=>{h(i=>i===e?null:e)},f=(0,n.R_)({url:"/api/ListGraphRequest",data:{Endpoint:"users",tenantFilter:t.currentTenant,$select:"id,displayName,userPrincipalName,mail",$top:999},queryKey:"UserNames-".concat(t.currentTenant)}),w=(0,n.R_)({url:"/api/ListGraphRequest",data:{Endpoint:"contacts",tenantFilter:t.currentTenant,$select:"displayName,mail,mailNickname",$top:999},queryKey:"TenantContacts-".concat(t.currentTenant)}),P=(0,n.nN)({datafromUrl:!0,relatedQueryKeys:A});(0,$.useEffect)(()=>{if(P.isSuccess){if(A.includes("ooo-".concat(d))){let e=s.getValues();s.reset(),["AutoReplyState","InternalMessage","ExternalMessage","StartTime","EndTime"].forEach(i=>{var a;let l=null===(a=e.ooo)||void 0===a?void 0:a[i];void 0!==l&&s.setValue("ooo.".concat(i),l)})}else s.reset()}},[P.isSuccess,A,d,s]);let E=e=>{"calendar"===e?b(["CalendarPermissions-".concat(d)]):"forwarding"===e?b(["Mailbox-".concat(d)]):"ooo"===e?b(["ooo-".concat(d)]):"recipientLimits"===e&&b(["Mailbox-".concat(d)]);let i=s.getValues(),a={tenantFilter:t.currentTenant,userid:o.Mailbox[0].UserPrincipalName,...i[e]};"recipientLimits"===e&&(a.Identity=o.Mailbox[0].Identity,a.recipientLimit=i[e].MaxRecipients,delete a.MaxRecipients),Object.keys(a).forEach(e=>{(""===a[e]||null===a[e])&&delete a[e]}),P.mutate({url:{calendar:"/api/ExecEditCalendarPermissions",forwarding:"/api/ExecEmailForward",ooo:"/api/ExecSetOoO",recipientLimits:"/api/ExecSetRecipientLimits"}[e],data:a,queryKey:"MailboxPermissions"})},M=[{id:"mailboxForwarding",cardLabelBox:{cardLabelBoxHeader:u?(0,l.jsx)(O.A,{size:"25px",color:"inherit"}):(null==o?void 0:o.ForwardingAddress)?(0,l.jsx)(x.A,{}):(0,l.jsx)(p.A,{})},text:"Mailbox Forwarding",subtext:(null==o?void 0:o.ForwardingAddress)?"Email forwarding is configured for this mailbox":"No email forwarding configured for this mailbox",formContent:(0,l.jsx)(eo,{formControl:s,usersList:f,contactsList:w,postRequest:P,handleSubmit:E})},{id:"outOfOffice",cardLabelBox:{cardLabelBoxHeader:(0,l.jsx)(U.A,{variant:"subtitle2",children:"OOO"})},text:"Out Of Office",subtext:"Set automatic replies for when you are away",formContent:(0,l.jsx)(X.A,{spacing:2,children:(0,l.jsxs)(R.A,{container:!0,spacing:2,children:[(0,l.jsx)(R.A,{size:12,children:(0,l.jsx)(ea.A,{type:"autoComplete",name:"ooo.AutoReplyState",label:"Auto Reply State",multiple:!1,formControl:s,creatable:!1,options:[{label:"Enabled",value:"Enabled"},{label:"Disabled",value:"Disabled"},{label:"Scheduled",value:"Scheduled"}]})}),(0,l.jsx)(R.A,{size:6,children:(0,l.jsx)(J.A,{title:j?"Scheduling is only available when Auto Reply State is set to Scheduled":"",placement:"bottom",children:(0,l.jsx)(Y.A,{children:(0,l.jsx)(ea.A,{type:"datePicker",label:"Start Date/Time",name:"ooo.StartTime",formControl:s,disabled:j})})})}),(0,l.jsx)(R.A,{size:6,children:(0,l.jsx)(J.A,{title:j?"Scheduling is only available when Auto Reply State is set to Scheduled":"",placement:"bottom",children:(0,l.jsx)(Y.A,{children:(0,l.jsx)(ea.A,{type:"datePicker",label:"End Date/Time",name:"ooo.EndTime",formControl:s,disabled:j})})})}),(0,l.jsx)(R.A,{size:12,children:(0,l.jsx)(ea.A,{type:"richText",label:"Internal Message",name:"ooo.InternalMessage",formControl:s,multiline:!0,rows:4})}),(0,l.jsx)(R.A,{size:12,children:(0,l.jsx)(ea.A,{type:"richText",label:"External Message",name:"ooo.ExternalMessage",formControl:s,multiline:!0,rows:4})}),(0,l.jsx)(R.A,{size:12,children:(0,l.jsx)(el.v,{apiObject:P})}),(0,l.jsx)(R.A,{children:(0,l.jsx)(Z.A,{onClick:()=>E("ooo"),variant:"contained",disabled:!s.formState.isValid||P.isPending,children:"Submit"})})]})})},{id:"recipientLimits",cardLabelBox:{cardLabelBoxHeader:(0,l.jsx)(U.A,{variant:"subtitle2",children:"RL"})},text:"Recipient Limits",subtext:"Set the maximum number of recipients per message",formContent:(0,l.jsx)(X.A,{spacing:2,children:(0,l.jsxs)(R.A,{container:!0,spacing:2,children:[(0,l.jsx)(R.A,{size:12,children:(0,l.jsx)(ea.A,{type:"number",label:"Maximum Recipients",name:"recipientLimits.MaxRecipients",formControl:s,defaultValue:(null==o?void 0:null===(a=o.Mailbox)||void 0===a?void 0:null===(i=a[0])||void 0===i?void 0:i.RecipientLimits)||500,validators:{required:"Please enter a number",min:{value:1,message:"The minimum is 1"},max:{value:1e3,message:"The maximum is 1000"}}})}),(0,l.jsx)(R.A,{size:12,children:(0,l.jsx)(el.v,{apiObject:P})}),(0,l.jsx)(R.A,{children:(0,l.jsx)(Z.A,{onClick:()=>E("recipientLimits"),variant:"contained",disabled:!s.formState.isValid||P.isPending,children:"Submit"})})]})})}];return(0,l.jsx)(X.A,{spacing:3,children:M.map(e=>{let i=v===e.id;return(0,l.jsxs)(L.A,{children:[(0,l.jsxs)(Y.A,{sx:{alignItems:"center",display:"flex",justifyContent:"space-between",py:3,pl:2,pr:4,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},onClick:()=>g(e.id),children:[(0,l.jsxs)(X.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,l.jsx)(Y.A,{sx:{alignItems:"center",borderRadius:1,color:"text.secondary",display:"flex",height:40,justifyContent:"center",width:40},children:e.cardLabelBox.cardLabelBoxHeader}),(0,l.jsxs)(Y.A,{children:[(0,l.jsx)(U.A,{color:"textPrimary",variant:"h6",children:e.text}),(0,l.jsx)(U.A,{color:"textSecondary",variant:"body2",children:e.subtext})]})]}),(0,l.jsx)(ee.A,{fontSize:"small",sx:{transition:"transform 150ms",transform:i?"rotate(180deg)":"rotate(0deg)"},children:(0,l.jsx)(er.A,{})})]}),(0,l.jsxs)(ei.A,{in:i,unmountOnExit:!0,children:[(0,l.jsx)(z.A,{}),(0,l.jsx)(Y.A,{sx:{p:2},children:e.formContent})]})]},e.id)})})};var ec=a(5419),eu=a(41412),em=a(16545),ev=a(79803),ex=a(82836),ep=a(68284),eh=a(95339);let eA=e=>{let{formHook:i}=e,[a,t]=(0,$.useState)("");(0,$.useEffect)(()=>{i.getValues("AddedAliases")||i.setValue("AddedAliases",[])},[i]);let r=(0,et.FH)({control:i.control,name:"AddedAliases",defaultValue:[]}),s=i.formState.isSubmitting,n=()=>{if(a.trim()){let e=[...i.getValues("AddedAliases")||[],a.trim()];i.setValue("AddedAliases",e,{shouldValidate:!0}),t("")}},o=e=>{let a=(i.getValues("AddedAliases")||[]).filter(i=>i!==e);i.setValue("AddedAliases",a,{shouldValidate:!0})};return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(X.A,{spacing:3,sx:{mt:1},children:[(0,l.jsx)(U.A,{variant:"body2",color:"text.secondary",children:"Add proxy addresses (aliases) for this user. Enter each alias and click Add or press Enter."}),(0,l.jsxs)(Y.A,{sx:{display:"flex",gap:1},children:[(0,l.jsx)(ep.A,{fullWidth:!0,value:a,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),n())},placeholder:"Enter an alias",variant:"outlined",disabled:s,size:"small",sx:{"& .MuiOutlinedInput-root":{fontFamily:"monospace","& .MuiOutlinedInput-input":{px:2}}}}),(0,l.jsx)(Z.A,{onClick:n,variant:"contained",disabled:!a.trim()||s,startIcon:(0,l.jsx)(eh.A,{}),size:"small",children:"Add"})]}),(0,l.jsx)(Y.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,minHeight:"40px",p:1,border:"1px dashed",borderColor:"divider",borderRadius:1,alignItems:"center",justifyContent:"center"},children:0===r.length?(0,l.jsx)(U.A,{variant:"body2",color:"text.secondary",sx:{px:2,py:1,textAlign:"center",width:"100%"},children:"No aliases added yet"}):r.map(e=>(0,l.jsx)(k.A,{label:e,onDelete:()=>o(e),color:"primary",variant:"outlined"},e))})]})})},eb=e=>{let{formHook:i,combinedOptions:a,isUserGroupLoading:t,defaultAutoMap:r=!1}=e,s=(0,et.FH)({control:i.control,name:"permissions.AddFullAccess"});return(0,$.useEffect)(()=>{i.setValue("permissions.AutoMap",r)},[i,r]),(0,l.jsxs)(X.A,{spacing:2,sx:{mt:1},children:[(0,l.jsx)(Y.A,{children:(0,l.jsx)(ea.A,{type:"autoComplete",label:"Add Full Access",name:"permissions.AddFullAccess",formControl:i,isFetching:t,creatable:!1,options:a})}),(0,l.jsx)(Y.A,{children:(0,l.jsx)(ea.A,{type:"switch",label:"Enable Automapping",name:"permissions.AutoMap",formControl:i,disabled:!(null==s?void 0:s.length),sx:{ml:1.5,mt:0,mb:0}})}),(0,l.jsx)(Y.A,{children:(0,l.jsx)(ea.A,{type:"autoComplete",label:"Add Send-as Permissions",name:"permissions.AddSendAs",formControl:i,isFetching:t,creatable:!1,options:a})}),(0,l.jsx)(Y.A,{children:(0,l.jsx)(ea.A,{type:"autoComplete",label:"Add Send On Behalf Permissions",name:"permissions.AddSendOnBehalf",formControl:i,isFetching:t,creatable:!1,options:a})})]})},ey=e=>{let{formHook:i,combinedOptions:a,isUserGroupLoading:t}=e,r=(0,et.FH)({control:i.control,name:"Permissions"}),s=(null==r?void 0:r.value)==="Editor";return(0,$.useEffect)(()=>{s||i.setValue("CanViewPrivateItems",!1)},[s,i]),(0,l.jsxs)(X.A,{spacing:3,sx:{mt:1},children:[(0,l.jsx)(Y.A,{children:(0,l.jsx)(ea.A,{type:"autoComplete",label:"Add Access",name:"UserToGetPermissions",multiple:!1,formControl:i,isFetching:t,options:a,creatable:!1,required:!0,validators:{validate:e=>!!e||"Select a user or group to assign permissions to"},placeholder:"Select a user or group to assign permissions to"})}),(0,l.jsx)(Y.A,{children:(0,l.jsx)(ea.A,{type:"autoComplete",label:"Permission Level",name:"Permissions",required:!0,creatable:!1,validators:{validate:e=>!!e||"Select the permission level for the calendar"},options:[{value:"Author",label:"Author"},{value:"Contributor",label:"Contributor"},{value:"Editor",label:"Editor"},{value:"Owner",label:"Owner"},{value:"NonEditingAuthor",label:"Non Editing Author"},{value:"PublishingAuthor",label:"Publishing Author"},{value:"PublishingEditor",label:"Publishing Editor"},{value:"Reviewer",label:"Reviewer"},{value:"LimitedDetails",label:"Limited Details"},{value:"AvailabilityOnly",label:"Availability Only"}],multiple:!1,formControl:i})}),(0,l.jsx)(Y.A,{children:(0,l.jsx)(J.A,{title:s?"":"Only usable when permission level is Editor",followCursor:!0,placement:"right",children:(0,l.jsx)("span",{children:(0,l.jsx)(ea.A,{type:"switch",label:"Can view Private items",name:"CanViewPrivateItems",formControl:i,disabled:!s,sx:{ml:1.5,mt:0,mb:0}})})})})]})},ej=()=>{var e,i,a,t,A,T,N,L,I,D,z,V,k,H,_,q,G,Q,X,J,Y,ee,ea,er,es,en,eo,ep,eh,ej,eg,ef,ew,eP,eE,eM,eF,eC,eR,eS,eT,eN,eL,eI,eU,eO,eD,eB,ez,eV,ek,eH,e_,eK,eq,eG,eQ,eW,e$,eX,eJ;let eY=(0,r.t)(),[eZ,e0]=(0,$.useState)(!1),[e1,e2]=(0,$.useState)(!1),[e5,e3]=(0,$.useState)({ready:!1}),e4=(0,ex.s)(),e9=(0,ex.s)(),e7=(0,ex.s)(),e6=(0,ex.s)(),{userId:e8}=(0,s.useRouter)().query,ie=(0,et.mN)({mode:"onChange",defaultValues:{tenantFilter:eY.currentTenant}}),ii=(0,n.R_)({url:"/api/ListUsers?UserId=".concat(e8,"&tenantFilter=").concat(eY.currentTenant),queryKey:"ListUsers-".concat(e8),waiting:eZ}),ia=(0,n.R_)({url:"/api/ListUserMailboxDetails?UserId=".concat(e8,"&tenantFilter=").concat(eY.currentTenant,"&userMail=").concat(null===(i=ii.data)||void 0===i?void 0:null===(e=i[0])||void 0===e?void 0:e.userPrincipalName),queryKey:"Mailbox-".concat(e8),waiting:eZ}),il=(0,n.R_)({url:"/api/ListGraphRequest",data:{Endpoint:"users",tenantFilter:eY.currentTenant,$select:"id,displayName,userPrincipalName,mail",$top:999},queryKey:"UserNames-".concat(eY.currentTenant)}),it=(0,n.R_)({url:"/api/ListOoO?UserId=".concat(e8,"&tenantFilter=").concat(eY.currentTenant),queryKey:"ooo-".concat(e8),waiting:eZ}),ir=(0,n.R_)({url:"/api/ListCalendarPermissions?UserId=".concat(e8,"&tenantFilter=").concat(eY.currentTenant),queryKey:"CalendarPermissions-".concat(e8),waiting:eZ}),is=(0,n.R_)({url:"/api/ListUserMailboxRules?UserId=".concat(e8,"&tenantFilter=").concat(eY.currentTenant),queryKey:"MailboxRules-".concat(e8),waiting:eZ}),io=(0,n.R_)({url:"/api/ListGraphRequest",data:{Endpoint:"groups",tenantFilter:eY.currentTenant,$filter:"securityEnabled eq true and mailEnabled eq true",$select:"id,displayName,mail,description",$top:999},queryKey:"MailEnabledSecurityGroups-".concat(eY.currentTenant)}),id=(e,i)=>{var a,l;if(!e)return{type:"Unknown",displayName:"Unknown User"};if("Default"===e||"Anonymous"===e)return{type:"System",displayName:e};let t=null==i?void 0:null===(l=i.data)||void 0===l?void 0:null===(a=l.Results)||void 0===a?void 0:a.find(i=>!!i&&(i.mail&&i.mail===e||i.displayName&&i.displayName===e||i.displayName&&e.startsWith(i.displayName)));return t?{type:"Group",displayName:t.displayName}:{type:"User",displayName:e}};(0,$.useEffect)(()=>{e7.open&&il.refetch()},[e7.open]),(0,$.useEffect)(()=>{if(it.isSuccess){var e,i,a,l,t,r;ie.setValue("ooo.ExternalMessage",null===(e=it.data)||void 0===e?void 0:e.ExternalMessage),ie.setValue("ooo.InternalMessage",null===(i=it.data)||void 0===i?void 0:i.InternalMessage),ie.setValue("ooo.AutoReplyState",{value:null===(a=it.data)||void 0===a?void 0:a.AutoReplyState,label:null===(l=it.data)||void 0===l?void 0:l.AutoReplyState}),ie.setValue("ooo.StartTime",new Date(null===(t=it.data)||void 0===t?void 0:t.StartTime).getTime()/1e3||null),ie.setValue("ooo.EndTime",new Date(null===(r=it.data)||void 0===r?void 0:r.EndTime).getTime()/1e3||null)}},[it.isSuccess]),(0,$.useEffect)(()=>{e8&&e0(!0)},[e8]),(0,$.useEffect)(()=>{var e,i;if(ia.isSuccess&&(null===(e=ia.data)||void 0===e?void 0:e[0])){let e=ia.data[0],a=e.ForwardingAddress,l=null===(i=e.MailboxActionsData)||void 0===i?void 0:i.ForwardingSmtpAddress,t=e.ForwardAndDeliver,r="disabled",s="";l?(r="ExternalAddress",s=l):a&&(r="internalAddress",s=a),ie.setValue("forwarding.forwardOption",r),ie.setValue("forwarding.KeepCopy",!0===t),"internalAddress"===r?(ie.setValue("forwarding.ForwardInternal",s),ie.setValue("forwarding.ForwardExternal","")):"ExternalAddress"===r?(ie.setValue("forwarding.ForwardExternal",s),ie.setValue("forwarding.ForwardInternal","")):(ie.setValue("forwarding.ForwardInternal",""),ie.setValue("forwarding.ForwardExternal",""))}},[ia.isSuccess,ia.dataUpdatedAt,ie]);let ic=ii.isSuccess?null===(t=ii.data)||void 0===t?void 0:null===(a=t[0])||void 0===a?void 0:a.displayName:"Loading...",iu=(0,$.useMemo)(()=>{var e,i;let a=[];return(null==il?void 0:null===(e=il.data)||void 0===e?void 0:e.Results)&&il.data.Results.forEach(e=>{a.push({value:e.userPrincipalName,label:"".concat(e.displayName," (").concat(e.userPrincipalName,")"),type:"user"})}),(null==io?void 0:null===(i=io.data)||void 0===i?void 0:i.Results)&&io.data.Results.forEach(e=>{a.push({value:e.mail,label:"".concat(e.displayName," (").concat(e.mail,")"),type:"group"})}),a.sort((e,i)=>e.label.localeCompare(i.label))},[null==il?void 0:null===(A=il.data)||void 0===A?void 0:A.Results,null==io?void 0:null===(T=io.data)||void 0===T?void 0:T.Results]),im=(0,$.useMemo)(()=>{var e,i;let a=[];return a.push({value:"Default",label:"Default",type:"system"}),(null==il?void 0:null===(e=il.data)||void 0===e?void 0:e.Results)&&il.data.Results.forEach(e=>{a.push({value:e.userPrincipalName,label:"".concat(e.displayName," (").concat(e.userPrincipalName,")"),type:"user"})}),(null==io?void 0:null===(i=io.data)||void 0===i?void 0:i.Results)&&io.data.Results.forEach(e=>{a.push({value:e.mail,label:"".concat(e.displayName," (").concat(e.mail,")"),type:"group"})}),a.sort((e,i)=>"system"===e.type&&"system"!==i.type?-1:"system"===i.type&&"system"!==e.type?1:e.label.localeCompare(i.label))},[null==il?void 0:null===(N=il.data)||void 0===N?void 0:N.Results,null==io?void 0:null===(L=io.data)||void 0===L?void 0:L.Results]),iv=il.isFetching||io.isFetching,ix=ii.isSuccess?[{icon:(0,l.jsx)(c.A,{}),text:(0,l.jsx)(M.R,{type:"chip",text:null===(D=ii.data)||void 0===D?void 0:null===(I=D[0])||void 0===I?void 0:I.userPrincipalName})},{icon:(0,l.jsx)(u.A,{}),text:(0,l.jsx)(M.R,{type:"chip",text:null===(V=ii.data)||void 0===V?void 0:null===(z=V[0])||void 0===z?void 0:z.id})},{icon:(0,l.jsx)(d.A,{}),text:(0,l.jsxs)(l.Fragment,{children:["Created: ",(0,l.jsx)(E.z,{data:null===(H=ii.data)||void 0===H?void 0:null===(k=H[0])||void 0===k?void 0:k.createdDateTime})]})},{icon:(0,l.jsx)(m.A,{style:{color:"#667085"}}),text:(0,l.jsx)(Z.A,{color:"muted",style:{paddingLeft:0},size:"small",href:"https://entra.microsoft.com/".concat(eY.currentTenant,"/#view/Microsoft_AAD_UsersAndTenants/UserProfileMenuBlade/~/overview/userId/").concat(e8),target:"_blank",rel:"noopener noreferrer",children:"View in Entra"})}]:[],ip=null===(_=ia.data)||void 0===_?void 0:_[0],ih=[{label:"Remove Permission",type:"POST",icon:(0,l.jsx)(v.A,{}),url:"/api/ExecModifyMBPerms",customDataformatter:(e,i,a)=>{var l,t,r,s=[];if(Array.isArray(e))e.forEach(e=>{var i;let a=(null==e?void 0:null===(i=e._raw)||void 0===i?void 0:i.User)||(null==e?void 0:e.User);a&&s.push({UserID:a,PermissionLevel:(null==e?void 0:e.AccessRights)||"Unknown",Modification:"Remove"})});else{let i=(null==e?void 0:null===(r=e._raw)||void 0===r?void 0:r.User)||(null==e?void 0:e.User);i&&s.push({UserID:i,PermissionLevel:(null==e?void 0:e.AccessRights)||"Unknown",Modification:"Remove"})}return{userID:null===(t=ii.data)||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.userPrincipalName,tenantFilter:eY.currentTenant,permissions:s}},confirmText:"Are you sure you want to remove this permission?",multiPost:!1,relatedQueryKeys:"Mailbox-".concat(e8)}],iA=[{id:1,cardLabelBox:{cardLabelBoxHeader:ia.isFetching?(0,l.jsx)(O.A,{size:"25px",color:"inherit"}):(null===(Q=ia.data)||void 0===Q?void 0:null===(G=Q[0])||void 0===G?void 0:null===(q=G.Permissions)||void 0===q?void 0:q.length)!==0?(0,l.jsx)(x.A,{}):(0,l.jsx)(p.A,{})},text:"Mailbox Permissions",subtext:(null===(Y=ia.data)||void 0===Y?void 0:null===(J=Y[0])||void 0===J?void 0:null===(X=J.Permissions)||void 0===X?void 0:X.length)!==0?"Other users or groups have access to this mailbox":"No other users or groups have access to this mailbox",statusColor:"green.main",cardLabelBoxActions:(0,l.jsx)(Z.A,{startIcon:(0,l.jsx)(h.A,{}),onClick:()=>e7.handleOpen(),variant:"outlined",color:"primary",size:"small",children:"Add Permissions"}),table:{title:"Mailbox Permissions",hideTitle:!0,data:(null===(er=ia.data)||void 0===er?void 0:null===(ea=er[0])||void 0===ea?void 0:null===(ee=ea.Permissions)||void 0===ee?void 0:ee.map(e=>{null==e||e.User;let i=id(e.User,io);return{User:i.displayName,AccessRights:e.AccessRights,Type:i.type,_raw:e}}))||[],refreshFunction:()=>ia.refetch(),isFetching:ia.isFetching,simpleColumns:["User","AccessRights","Type"],actions:ih,offCanvas:{children:e=>{var i;let a=id((null==e?void 0:null===(i=e._raw)||void 0===i?void 0:i.User)||(null==e?void 0:e.User),io);return(0,l.jsx)(ec.a,{cardSx:{p:0,m:-2},title:"Permission Details",propertyItems:[{label:"User/Group",value:a.displayName},{label:"Type",value:a.type},{label:"Access Rights",value:(null==e?void 0:e.AccessRights)||"Unknown"}],actionItems:ih})}}}}],ib=[{id:1,cardLabelBox:{cardLabelBoxHeader:ir.isFetching?(0,l.jsx)(O.A,{size:"25px",color:"inherit"}):(null===(es=ir.data)||void 0===es?void 0:es.length)!==0?(0,l.jsx)(x.A,{}):(0,l.jsx)(p.A,{})},text:"Calendar permissions",subtext:(null===(en=ir.data)||void 0===en?void 0:en.length)!==0?"Other users or groups have access to this calendar":"No other users or groups have access to this calendar",statusColor:"green.main",cardLabelBoxActions:(0,l.jsx)(Z.A,{startIcon:(0,l.jsx)(b,{}),onClick:()=>e6.handleOpen(),variant:"outlined",color:"primary",size:"small",children:"Add Permissions"}),table:{title:"Calendar Permissions",hideTitle:!0,data:(null===(eo=ir.data)||void 0===eo?void 0:eo.map(e=>{var i;null==e||e.User;let a=id(e.User,io);return{User:a.displayName,AccessRights:(null==e?void 0:null===(i=e.AccessRights)||void 0===i?void 0:i.join(", "))||"Unknown",FolderName:(null==e?void 0:e.FolderName)||"Unknown",Type:a.type,_raw:e}}))||[],refreshFunction:()=>ir.refetch(),isFetching:ir.isFetching,simpleColumns:["User","AccessRights","FolderName","Type"],actions:[{label:"Remove Permission",type:"POST",icon:(0,l.jsx)(v.A,{}),url:"/api/ExecModifyCalPerms",customDataformatter:(e,i,a)=>{var l,t,r=[];if(Array.isArray(e))e.forEach(e=>{let i=e._raw?e._raw.User:e.User;r.push({UserID:i,PermissionLevel:e.AccessRights,FolderName:e.FolderName,Modification:"Remove"})});else{let i=e._raw?e._raw.User:e.User;r.push({UserID:i,PermissionLevel:e.AccessRights,FolderName:e.FolderName,Modification:"Remove"})}return{userID:null===(t=ii.data)||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.userPrincipalName,tenantFilter:eY.currentTenant,permissions:r}},confirmText:"Are you sure you want to remove this calendar permission?",multiPost:!1,relatedQueryKeys:"CalendarPermissions-".concat(e8),condition:e=>"Default"!==e.User&&"Anonymous"!==e.User}],offCanvas:{children:e=>{var i,a;let t=e._raw?e._raw.User:e.User,r=id(t,io);return(0,l.jsx)(ec.a,{cardSx:{p:0,m:-2},title:"Permission Details",propertyItems:[{label:"User/Group",value:r.displayName},{label:"Type",value:r.type},{label:"Access Rights",value:e.AccessRights},{label:"Folder Name",value:e.FolderName}],actionItems:[{label:"Remove Permission",type:"POST",icon:(0,l.jsx)(v.A,{}),url:"/api/ExecModifyCalPerms",data:{userID:null===(a=ii.data)||void 0===a?void 0:null===(i=a[0])||void 0===i?void 0:i.userPrincipalName,tenantFilter:eY.currentTenant,permissions:[{UserID:t,PermissionLevel:e.AccessRights,FolderName:e.FolderName,Modification:"Remove"}]},confirmText:"Are you sure you want to remove this calendar permission?",multiPost:!1,relatedQueryKeys:"CalendarPermissions-".concat(e8)}]})}}}}],iy=[{label:"Enable Mailbox Rule",type:"POST",icon:(0,l.jsx)(y.A,{}),url:"/api/ExecSetMailboxRule",customDataformatter:(e,i,a)=>{var l,t;return{ruleId:null==e?void 0:e.Identity,userPrincipalName:null===(t=ii.data)||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.userPrincipalName,ruleName:null==e?void 0:e.Name,Enable:!0}},condition:e=>e&&!e.Enabled,confirmText:"Are you sure you want to enable this mailbox rule?",multiPost:!1},{label:"Disable Mailbox Rule",type:"POST",icon:(0,l.jsx)(j.A,{}),url:"/api/ExecSetMailboxRule",customDataformatter:(e,i,a)=>{var l,t;return{ruleId:null==e?void 0:e.Identity,userPrincipalName:null===(t=ii.data)||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.userPrincipalName,ruleName:null==e?void 0:e.Name,Disable:!0}},condition:e=>e&&e.Enabled,confirmText:"Are you sure you want to disable this mailbox rule?",multiPost:!1},{label:"Remove Mailbox Rule",type:"POST",icon:(0,l.jsx)(v.A,{}),url:"/api/ExecRemoveMailboxRule",customDataformatter:(e,i,a)=>{var l,t;return{ruleId:null==e?void 0:e.Identity,ruleName:null==e?void 0:e.Name,userPrincipalName:null===(t=ii.data)||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.userPrincipalName}},confirmText:"Are you sure you want to remove this mailbox rule?",multiPost:!1,relatedQueryKeys:"MailboxRules-".concat(e8)}],ij=[{id:1,cardLabelBox:{cardLabelBoxHeader:is.isFetching?(0,l.jsx)(O.A,{size:"25px",color:"inherit"}):(null===(ep=is.data)||void 0===ep?void 0:ep.length)!==0?(0,l.jsx)(x.A,{}):(0,l.jsx)(p.A,{})},text:"Current Mailbox Rules",subtext:(null===(eh=is.data)||void 0===eh?void 0:eh.length)?"Mailbox rules are configured for this user":"No mailbox rules configured for this user",statusColor:"green.main",table:{title:"Mailbox Rules",hideTitle:!0,data:is.data||[],refreshFunction:()=>is.refetch(),isFetching:is.isFetching,simpleColumns:["Enabled","Name","Description","Priority"],actions:iy,offCanvas:{children:e=>{var i,a,t,r,s,n;let o=Object.keys(e).filter(e=>!e.includes("@odata")&&!e.includes("@data")),d=[];return o.forEach(i=>{e[i]&&e[i].length>0&&d.push({label:(0,eu.i)(i),value:(0,K.i)(e[i],i)})}),(0,l.jsx)(ec.a,{cardSx:{p:0,m:-2},title:"Rule Details",propertyItems:d,actionItems:[{label:"Enable Mailbox Rule",type:"POST",icon:(0,l.jsx)(y.A,{}),url:"/api/ExecSetMailboxRule",data:{ruleId:null==e?void 0:e.Identity,userPrincipalName:null===(a=ii.data)||void 0===a?void 0:null===(i=a[0])||void 0===i?void 0:i.userPrincipalName,ruleName:null==e?void 0:e.Name,Enable:!0},confirmText:"Are you sure you want to enable this mailbox rule?",multiPost:!1},{label:"Disable Mailbox Rule",type:"POST",icon:(0,l.jsx)(j.A,{}),url:"/api/ExecSetMailboxRule",data:{ruleId:null==e?void 0:e.Identity,userPrincipalName:null===(r=ii.data)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.userPrincipalName,ruleName:null==e?void 0:e.Name,Disable:!0},confirmText:"Are you sure you want to disable this mailbox rule?",multiPost:!1},{label:"Remove Mailbox Rule",type:"POST",icon:(0,l.jsx)(v.A,{}),url:"/api/ExecRemoveMailboxRule",data:{ruleId:null==e?void 0:e.Identity,ruleName:null==e?void 0:e.Name,userPrincipalName:null===(n=ii.data)||void 0===n?void 0:null===(s=n[0])||void 0===s?void 0:s.userPrincipalName},confirmText:"Are you sure you want to remove this mailbox rule?",multiPost:!1,relatedQueryKeys:"MailboxRules-".concat(e8)}]})}}}}],ig=[{label:"Make Primary",type:"POST",icon:(0,l.jsx)(g,{}),url:"/api/EditUserAliases",data:{id:e8,tenantFilter:eY.currentTenant,MakePrimary:"Address"},confirmText:"Are you sure you want to make this the primary proxy address?",multiPost:!1,relatedQueryKeys:"ListUsers-".concat(e8),condition:e=>e&&"Primary"!==e.Type},{label:"Remove Proxy Address",type:"POST",icon:(0,l.jsx)(v.A,{}),url:"/api/EditUserAliases",data:{id:e8,tenantFilter:eY.currentTenant,RemovedAliases:"Address"},confirmText:"Are you sure you want to remove this proxy address?",multiPost:!1,relatedQueryKeys:"ListUsers-".concat(e8),condition:e=>e&&"Primary"!==e.Type}],iw=[{id:1,cardLabelBox:{cardLabelBoxHeader:ii.isFetching?(0,l.jsx)(O.A,{size:"25px",color:"inherit"}):(null===(ef=ii.data)||void 0===ef?void 0:null===(eg=ef[0])||void 0===eg?void 0:null===(ej=eg.proxyAddresses)||void 0===ej?void 0:ej.length)>1?(0,l.jsx)(x.A,{}):(0,l.jsx)(p.A,{})},text:"Proxy Addresses",subtext:(null===(eE=ii.data)||void 0===eE?void 0:null===(eP=eE[0])||void 0===eP?void 0:null===(ew=eP.proxyAddresses)||void 0===ew?void 0:ew.length)>1?"Proxy addresses are configured for this user":"No proxy addresses configured for this user",statusColor:"green.main",cardLabelBoxActions:(0,l.jsx)(Z.A,{startIcon:(0,l.jsx)(f.A,{}),onClick:()=>e9.handleOpen(),variant:"outlined",color:"primary",size:"small",children:"Add Alias"}),table:{title:"Proxy Addresses",hideTitle:!0,data:(null===(eC=ii.data)||void 0===eC?void 0:null===(eF=eC[0])||void 0===eF?void 0:null===(eM=eF.proxyAddresses)||void 0===eM?void 0:eM.map(e=>({Address:e,Type:e.startsWith("SMTP:")?"Primary":"Alias"})))||[],refreshFunction:()=>ii.refetch(),isFetching:ii.isFetching,simpleColumns:["Address","Type"],actions:ig,offCanvas:{children:e=>(0,l.jsx)(ec.a,{cardSx:{p:0,m:-2},title:"Address Details",propertyItems:[{label:"Address",value:e.Address},{label:"Type",value:e.Type}],actionItems:ig})}}}];return(0,l.jsxs)(w.f,{tabOptions:P,title:ic,subtitle:ix,actions:(0,em.A)(),actionsData:null===(eS=ia.data)||void 0===eS?void 0:null===(eR=eS[0])||void 0===eR?void 0:eR.MailboxActionsData,isFetching:ii.isLoading,children:[(0,l.jsx)(el.v,{apiObject:ia,errorsOnly:!0}),ii.isLoading&&(0,l.jsx)(o.A,{layout:[2,1,2,2]}),ii.isSuccess&&(0,l.jsx)(F.A,{sx:{flexGrow:1,py:4,mr:2},children:(0,l.jsxs)(R.A,{container:!0,spacing:2,children:[(null==ia?void 0:null===(eI=ia.data)||void 0===eI?void 0:null===(eL=eI[0])||void 0===eL?void 0:null===(eN=eL.Mailbox)||void 0===eN?void 0:null===(eT=eN[0])||void 0===eT?void 0:eT.error)&&(0,l.jsx)(R.A,{size:12,children:(0,l.jsxs)(B.A,{severity:"error",children:[(0,l.jsxs)(F.A,{display:"flex",justifyContent:"space-between",children:[(0,l.jsx)(U.A,{variant:"body2",children:(null==ia?void 0:null===(eB=ia.data)||void 0===eB?void 0:null===(eD=eB[0])||void 0===eD?void 0:null===(eO=eD.Mailbox)||void 0===eO?void 0:null===(eU=eO[0])||void 0===eU?void 0:eU.error.includes("Microsoft.Exchange.Configuration.Tasks.ManagementObjectNotFoundException"))?"This user does not have a mailbox, make sure they are licensed for Exchange.":"An error occurred while fetching the mailbox details."}),(0,l.jsx)(Z.A,{size:"small",onClick:()=>e2(!e1),sx:{mr:1},children:e1?"Hide Details":"Show Details"})]}),(0,l.jsx)(ei.A,{in:e1,children:(0,l.jsx)(F.A,{mt:2,children:null==ia?void 0:null===(eH=ia.data)||void 0===eH?void 0:null===(ek=eH[0])||void 0===ek?void 0:null===(eV=ek.Mailbox)||void 0===eV?void 0:null===(ez=eV[0])||void 0===ez?void 0:ez.error})})]})}),!(null==ia?void 0:null===(eQ=ia.data)||void 0===eQ?void 0:null===(eG=eQ[0])||void 0===eG?void 0:null===(eq=eG.Mailbox)||void 0===eq?void 0:null===(eK=eq[0])||void 0===eK?void 0:null===(e_=eK.error)||void 0===e_?void 0:e_.includes("Microsoft.Exchange.Configuration.Tasks.ManagementObjectNotFoundException"))&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(R.A,{size:4,children:(0,l.jsx)(W,{exchangeData:ip,isLoading:ia.isLoading,isFetching:ia.isFetching,handleRefresh:()=>ia.refetch()})}),(0,l.jsx)(R.A,{size:8,children:(0,l.jsxs)(C.A,{spacing:3,children:[(0,l.jsx)(S.L,{isFetching:ii.isLoading,items:iw,isCollapsible:!0}),(0,l.jsx)(S.L,{isFetching:ia.isLoading,items:iA,isCollapsible:!0}),(0,l.jsx)(S.L,{isFetching:ir.isLoading,items:ib,isCollapsible:!0}),(0,l.jsx)(S.L,{isFetching:is.isLoading,items:ij,isCollapsible:!0}),(0,l.jsx)(ed,{userId:e8,calPermissions:ir.data,currentSettings:null===(eW=ia.data)||void 0===eW?void 0:eW[0],isFetching:ia.isFetching,formControl:ie,oooRequest:it})]})})]})]})}),e5.ready&&(0,l.jsx)(ev.B,{createDialog:e4,title:"Confirmation",api:e5.action,row:e5.data}),(0,l.jsx)(ev.B,{createDialog:e9,title:"Add Proxy Addresses",api:{type:"POST",url:"/api/EditUserAliases",relatedQueryKeys:"ListUsers-".concat(e8),confirmText:"Add the specified proxy addresses to this user?",customDataformatter:(e,i,a)=>{var l,t,r;return{id:e8,tenantFilter:eY.currentTenant,AddedAliases:(null==a?void 0:null===(l=a.AddedAliases)||void 0===l?void 0:l.join(","))||"",userPrincipalName:null==ii?void 0:null===(r=ii.data)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.userPrincipalName}}},row:null===(e$=ii.data)||void 0===e$?void 0:e$[0],children:e=>{let{formHook:i}=e;return(0,l.jsx)(eA,{formHook:i})}}),(0,l.jsx)(ev.B,{createDialog:e7,title:"Add Mailbox Permissions",api:{type:"POST",url:"/api/ExecModifyMBPerms",relatedQueryKeys:"Mailbox-".concat(e8),confirmText:"Add the specified permissions to this mailbox?",customDataformatter:(e,i,a)=>{var l,t;let r=[],{permissions:s}=a,n=void 0===s.AutoMap||s.AutoMap;return(null==s?void 0:s.AddFullAccess)&&r.push({UserID:s.AddFullAccess,PermissionLevel:"FullAccess",Modification:"Add",AutoMap:n}),(null==s?void 0:s.AddSendAs)&&r.push({UserID:s.AddSendAs,PermissionLevel:"SendAs",Modification:"Add"}),(null==s?void 0:s.AddSendOnBehalf)&&r.push({UserID:s.AddSendOnBehalf,PermissionLevel:"SendOnBehalf",Modification:"Add"}),{userID:null===(t=ii.data)||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.userPrincipalName,tenantFilter:eY.currentTenant,permissions:r}}},row:null===(eX=ii.data)||void 0===eX?void 0:eX[0],allowResubmit:!0,children:e=>{let{formHook:i}=e;return(0,l.jsx)(eb,{formHook:i,combinedOptions:iu,isUserGroupLoading:iv,defaultAutoMap:!0})}}),(0,l.jsx)(ev.B,{createDialog:e6,title:"Add Calendar Permissions",api:{type:"POST",url:"/api/ExecModifyCalPerms",relatedQueryKeys:"CalendarPermissions-".concat(e8),confirmText:"Add the specified permissions to this calendar?",customDataformatter:(e,i,a)=>{var l,t,r,s,n;if(!a.UserToGetPermissions||!a.Permissions)return null;let o={UserID:a.UserToGetPermissions,PermissionLevel:a.Permissions,FolderName:null!==(n=null===(t=ir.data)||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.FolderName)&&void 0!==n?n:"Calendar",Modification:"Add"};return a.CanViewPrivateItems&&(o.CanViewPrivateItems=!0),{userID:null===(s=ii.data)||void 0===s?void 0:null===(r=s[0])||void 0===r?void 0:r.userPrincipalName,tenantFilter:eY.currentTenant,permissions:[o]}}},row:null===(eJ=ii.data)||void 0===eJ?void 0:eJ[0],allowResubmit:!0,children:e=>{let{formHook:i}=e;return(0,l.jsx)(ey,{formHook:i,combinedOptions:im,isUserGroupLoading:iv})}})]})};ej.getLayout=e=>(0,l.jsx)(t.P,{children:e});let eg=ej}},e=>{var i=i=>e(e.s=i);e.O(0,[2836,6545,636,6593,8792],()=>i(73820)),_N_E=e.O()}]);