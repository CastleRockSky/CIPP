(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9315],{69731:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>k});var l=r(37876),s=r(14232),n=r(89099),i=r(12435),a=r(40971),o=r(22474),p=r(77018),d=r(54538),c=r(24933),u=r(35656),h=r(57212),y=r(68284),g=r(76635),b=r(82260),m=r(59017),x=r(67578),A=r(47737),j=r(37832),f=r(22322),v=r(68723),S=r(31540),P=r(60455);let N=[{property:"city",label:"City",type:"string"},{property:"companyName",label:"Company Name",type:"string"},{property:"country",label:"Country",type:"string"},{property:"department",label:"Department",type:"string"},{property:"employeeType",label:"Employee Type",type:"string"},{property:"jobTitle",label:"Job Title",type:"string"},{property:"officeLocation",label:"Office Location",type:"string"},{property:"postalCode",label:"Postal Code",type:"string"},{property:"preferredDataLocation",label:"Preferred Data Location",type:"string"},{property:"preferredLanguage",label:"Preferred Language",type:"string"},{property:"showInAddressList",label:"Show in Address List",type:"boolean"},{property:"state",label:"State/Province",type:"string"},{property:"streetAddress",label:"Street Address",type:"string"},{property:"usageLocation",label:"Usage Location",type:"string"}],C=e=>{let{onNextStep:t,onPreviousStep:r,formControl:s,currentStep:n,users:i,onUsersChange:a}=e,u=e=>{a(i.filter(t=>t.id!==e.id))},h=(null==i?void 0:i.map(e=>({id:e.id,displayName:e.displayName,userPrincipalName:e.userPrincipalName,jobTitle:e.jobTitle,department:e.department})))||[],y=[{label:"Remove from List",icon:(0,l.jsx)(P.A,{}),color:"error",customFunction:e=>u(e),noConfirm:!0}];return(0,l.jsxs)(o.A,{spacing:3,children:[(0,l.jsxs)(o.A,{spacing:1,children:[(0,l.jsx)(p.A,{variant:"h6",children:"Users to be updated"}),(0,l.jsx)(p.A,{color:"text.secondary",variant:"body2",children:"The following users will be updated with the properties you select in the next step. You can remove users from this list if needed."})]}),i&&i.length>0?(0,l.jsx)(S.x,{title:"Selected Users (".concat(i.length,")"),data:h,simpleColumns:["displayName","userPrincipalName","jobTitle","department"],actions:y,disableFullScreenToggle:!0,disableColumnFilters:!0,disableColumnActions:!0,disablePagination:!0,disableRowSelection:!0,disableExport:!0,disableTopToolbar:i.length<=5}):(0,l.jsx)(d.A,{variant:"outlined",children:(0,l.jsx)(c.A,{children:(0,l.jsx)(p.A,{color:"text.secondary",variant:"body2",sx:{textAlign:"center",py:2},children:"No users selected. Please go back and select users from the main table."})})}),(0,l.jsx)(j.L,{currentStep:n,onPreviousStep:r,onNextStep:i&&i.length>0?t:void 0,formControl:s,noNextButton:!i||0===i.length})]})},w=e=>{let{onNextStep:t,onPreviousStep:r,formControl:n,currentStep:i}=e,[a,x]=(0,s.useState)([]);n.register("selectedProperties",{required:!0}),n.register("propertyValues",{required:!1});let A=(e,t)=>{let r={...n.getValues("propertyValues")||{},[e]:t};n.setValue("propertyValues",r),n.trigger()};return(0,l.jsxs)(o.A,{spacing:3,children:[(0,l.jsxs)(o.A,{spacing:1,children:[(0,l.jsx)(p.A,{variant:"h6",children:"Select Properties to update"}),(0,l.jsx)(p.A,{color:"text.secondary",variant:"body2",children:"Choose which user properties you want to modify and provide the new values."})]}),(0,l.jsx)(g.A,{multiple:!0,disableCloseOnSelect:!0,options:[{property:"select-all",label:"Select All (".concat(N.length," properties)"),isSelectAll:!0},...N],value:N.filter(e=>a.includes(e.property)),onChange:(e,t)=>{if(t.find(e=>e.isSelectAll)){let e=a.length===N.length?[]:N.map(e=>e.property);x(e),n.setValue("selectedProperties",e);let t=n.getValues("propertyValues")||{},r={};e.forEach(e=>{t[e]&&(r[e]=t[e])}),n.setValue("propertyValues",r),n.trigger()}else{let e=t.filter(e=>!e.isSelectAll).map(e=>e.property);x(e),n.setValue("selectedProperties",e);let r=n.getValues("propertyValues")||{},l={};e.forEach(e=>{r[e]&&(l[e]=r[e])}),n.setValue("propertyValues",l),n.trigger()}},getOptionLabel:e=>e.label,isOptionEqualToValue:(e,t)=>e.property===t.property,size:"small",renderOption:(e,t,r)=>{let{selected:s}=r,n=a.length===N.length,i=a.length>0&&a.length<N.length;return t.isSelectAll?(0,l.jsxs)("li",{...e,style:{borderBottom:"1px solid #e0e0e0"},children:[(0,l.jsx)(b.A,{checked:n,indeterminate:i,style:{marginRight:8}}),(0,l.jsx)(p.A,{sx:{fontWeight:"bold"},children:t.label})]}):(0,l.jsxs)("li",{...e,children:[(0,l.jsx)(b.A,{checked:s,style:{marginRight:8}}),t.label]})},renderInput:e=>(0,l.jsx)(y.A,{...e,label:"Properties to update",placeholder:"Select properties to update...",slotProps:{inputLabel:{shrink:!0,sx:{transition:"none"}},input:{...e.InputProps,notched:!0,sx:{transition:"none","& .MuiOutlinedInput-notchedOutline":{transition:"none"}}}}}),renderTags:(e,t)=>e.filter(e=>!e.isSelectAll).map((e,r)=>(0,s.createElement)(m.A,{...t({index:r}),key:e.property,label:e.label,size:"small"}))}),a.length>0&&(0,l.jsx)(d.A,{variant:"outlined",children:(0,l.jsxs)(c.A,{children:[(0,l.jsx)(p.A,{variant:"h6",sx:{mb:2},children:"Properties to update"}),(0,l.jsx)(o.A,{spacing:2,children:a.map(e=>{var t;let r=N.find(t=>t.property===e),s=null===(t=n.getValues("propertyValues"))||void 0===t?void 0:t[e];return(null==r?void 0:r.type)==="boolean"?(0,l.jsx)(u.A,{control:(0,l.jsx)(h.A,{checked:!0===s,onChange:t=>A(e,t.target.checked)}),label:r.label},e):(0,l.jsx)(y.A,{label:(null==r?void 0:r.label)||e,fullWidth:!0,value:s||"",onChange:t=>A(e,t.target.value),placeholder:"Enter new value for ".concat((null==r?void 0:r.label)||e),variant:"filled",size:"small",slotProps:{inputLabel:{shrink:!0,sx:{transition:"none"}},input:{notched:!0,sx:{transition:"none","& .MuiOutlinedInput-notchedOutline":{transition:"none"}}}}},e)})})]})}),(0,l.jsx)(j.L,{currentStep:i,onPreviousStep:r,onNextStep:t,formControl:n})]})},T=e=>{let{lastStep:t,formControl:r,onPreviousStep:s,currentStep:n,users:i}=e,{selectedProperties:a=[],propertyValues:u={}}=r.getValues(),h=(0,f.nN)({relatedQueryKeys:["ListUsers"]}),y=(null==i?void 0:i.map(e=>({id:e.id,displayName:e.displayName,userPrincipalName:e.userPrincipalName,jobTitle:e.jobTitle,department:e.department})))||[];return(0,l.jsxs)(o.A,{spacing:3,children:[(0,l.jsxs)(o.A,{spacing:1,children:[(0,l.jsx)(p.A,{variant:"h6",children:"Confirm User Updates"}),(0,l.jsxs)(p.A,{color:"text.secondary",variant:"body2",children:["Review the users that will be updated with ",a.length," selected"," ",1===a.length?"property":"properties",", then click Submit to apply the changes."]})]}),a.length>0&&(0,l.jsx)(d.A,{variant:"outlined",children:(0,l.jsxs)(c.A,{children:[(0,l.jsx)(p.A,{variant:"h6",sx:{mb:2},children:"Properties to Update"}),(0,l.jsx)(o.A,{spacing:1,children:a.map(e=>{let t=N.find(t=>t.property===e),r=u[e],s=(null==t?void 0:t.type)==="boolean"?r?"Yes":"No":r||"Not set";return(0,l.jsxs)(x.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,l.jsxs)(p.A,{variant:"body2",sx:{fontWeight:"medium",minWidth:"fit-content"},children:[(null==t?void 0:t.label)||e,":"]}),(0,l.jsx)(p.A,{variant:"body2",color:"text.secondary",sx:{flex:1},children:s})]},e)})})]})}),i&&i.length>0?(0,l.jsx)(S.x,{title:"Users to Update (".concat(i.length,")"),data:y,simpleColumns:["displayName","userPrincipalName","jobTitle","department"],disableFullScreenToggle:!0,disableColumnFilters:!0,disableColumnActions:!0,disablePagination:!0,disableRowSelection:!0,disableExport:!0,disableTopToolbar:i.length<=5}):(0,l.jsx)(d.A,{variant:"outlined",children:(0,l.jsx)(c.A,{children:(0,l.jsx)(p.A,{color:"text.secondary",variant:"body2",sx:{textAlign:"center",py:2},children:"No users to update. Please go back and select users."})})}),(0,l.jsx)(v.v,{apiObject:h}),(0,l.jsxs)(o.A,{alignItems:"center",direction:"row",justifyContent:"flex-end",spacing:2,sx:{mt:3},children:[n>0&&(0,l.jsx)(A.A,{color:"inherit",onClick:s,size:"large",type:"button",children:"Back"}),(0,l.jsx)(A.A,{size:"large",type:"button",variant:"contained",disabled:h.isPending||0===a.length||!i||0===i.length,onClick:()=>{if(!i||0===i.length){console.error("No users to patch");return}let e=i.map(e=>{let t={id:e.id,tenantFilter:e.Tenant||e.tenantFilter};return a.forEach(e=>{void 0!==u[e]&&""!==u[e]&&(t[e]=u[e])}),t});h.mutate({url:"/api/PatchUser",data:e})},children:h.isSuccess?"Resubmit":"Submit"})]})]})},V=()=>{let e=(0,n.useRouter)(),[t,r]=(0,s.useState)([]);return(0,s.useEffect)(()=>{try{if(e.query.users){let t=JSON.parse(decodeURIComponent(e.query.users));r(Array.isArray(t)?t:[t])}else{let e=sessionStorage.getItem("patchWizardUsers");if(e){let t=JSON.parse(e);r(Array.isArray(t)?t:[t]),sessionStorage.removeItem("patchWizardUsers")}}}catch(e){console.error("Error parsing users data:",e),r([])}},[e.query.users]),(0,l.jsx)(a.A,{backButton:!0,steps:[{title:"Step 1",description:"Review Users",component:C,componentProps:{users:t,onUsersChange:r}},{title:"Step 2",description:"Select Properties",component:w},{title:"Step 3",description:"Confirmation",component:T,componentProps:{users:t}}],wizardTitle:"Update Users Wizard",postUrl:"",initialState:{selectedProperties:[],propertyValues:{}}})};V.getLayout=e=>(0,l.jsx)(i.P,{children:e});let k=V},84716:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/identity/administration/users/patch-wizard",function(){return r(69731)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(84716)),_N_E=e.O()}]);