(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3749],{42120:(e,i,l)=>{"use strict";l.d(i,{A:()=>a});var t=l(93944),s=l(37876);let a=(0,t.A)((0,s.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},50532:(e,i,l)=>{"use strict";l.r(i),l.d(i,{default:()=>f});var t=l(37876),s=l(14232),a=l(47737),n=l(46061),d=l(67578),r=l(77018),o=l(71538),c=l(59568),u=l(88992),m=l(12435),p=l(90240),h=l(58105),v=l(58181),x=l(89099),y=l(22322),b=l(17825);let g=e=>{let{formControl:i,name:l,label:s,allTenants:a=!1,multiple:n=!1,type:d="multiple",select:r,addedField:o,valueField:c,dataFilter:m=null,...p}=e,v=(0,u.FH)({control:i.control,name:"tenantFilter"}),x=(0,b.t)().currentTenant;return(0,t.jsx)(h.o,{name:l,label:s,type:"autoComplete",formControl:i,multiple:n,api:{addedField:o,tenantFilter:v?v.value:x,url:"/api/ListContacts",labelField:e=>"".concat(e.displayName||e.DisplayName," (").concat(e.mail||e.WindowsEmailAddress,")"),valueField:c||"WindowsEmailAddress",queryKey:"listcontacts-".concat((null==v?void 0:v.value)?v.value:x),dataFilter:e=>m?e.filter(m):e},creatable:!1,...p})};var F=l(31540);let A=()=>{var e,i,l,m,A,f,j,C,N,w,E,P,R,k,z;let M=(0,x.useRouter)(),{groupId:O,groupType:S}=M.query,[T,_]=(0,s.useState)(!1),[q,G]=(0,s.useState)(!1),[L,D]=(0,s.useState)([]),[W,I]=(0,s.useState)({}),H=(0,b.t)().currentTenant,K=(0,y.R_)({url:"/api/ListGroups?groupID=".concat(O,"&tenantFilter=").concat(H,"&members=true&owners=true&groupType=").concat(S),queryKey:"ListGroups-".concat(O),waiting:T});(0,s.useEffect)(()=>{O&&(_(!0),K.refetch())},[M.query,O,H]);let V=(0,u.mN)({mode:"onChange",defaultValues:{tenantFilter:H,AddMember:[],RemoveMember:[],AddOwner:[],RemoveOwner:[],AddContact:[],RemoveContact:[]}});return(0,s.useEffect)(()=>{if(K.isSuccess){var e,i,l,t,s,a,n,d,r,o,c;let u=null===(e=K.data)||void 0===e?void 0:e.groupInfo;if(u){D([...(null===(l=K.data)||void 0===l?void 0:null===(i=l.owners)||void 0===i?void 0:i.map(e=>({type:"Owner",userPrincipalName:e.userPrincipalName,displayName:e.displayName})))||[],...(null===(s=K.data)||void 0===s?void 0:null===(t=s.members)||void 0===t?void 0:t.map(e=>{var i;return{type:(null==e?void 0:e["@odata.type"])==="#microsoft.graph.orgContact"?"Contact":"Member",userPrincipalName:null!==(i=e.userPrincipalName)&&void 0!==i?i:e.mail,displayName:e.displayName}}))||[]]);let e={tenantFilter:H,mail:u.mail,mailNickname:u.mailNickname||"",allowExternal:null==K?void 0:null===(a=K.data)||void 0===a?void 0:a.allowExternal,sendCopies:null==K?void 0:null===(n=K.data)||void 0===n?void 0:n.sendCopies,hideFromOutlookClients:null==K?void 0:null===(d=K.data)||void 0===d?void 0:d.hideFromOutlookClients,displayName:u.displayName,description:u.description||"",membershipRules:u.membershipRule||"",groupId:u.id,groupType:(()=>{var e;return(null===(e=u.groupTypes)||void 0===e?void 0:e.includes("Unified"))?"Microsoft 365":!u.mailEnabled&&u.securityEnabled?"Security":u.mailEnabled&&u.securityEnabled?"Mail-Enabled Security":u.groupTypes&&0!==u.groupTypes.length||!u.mailEnabled||u.securityEnabled?null:"Distribution List"})(),securityEnabled:u.securityEnabled,AddMember:[],RemoveMember:[],AddOwner:[],RemoveOwner:[],AddContact:[],RemoveContact:[]};I({allowExternal:null==K?void 0:null===(r=K.data)||void 0===r?void 0:r.allowExternal,sendCopies:null==K?void 0:null===(o=K.data)||void 0===o?void 0:o.sendCopies,hideFromOutlookClients:null==K?void 0:null===(c=K.data)||void 0===c?void 0:c.hideFromOutlookClients,securityEnabled:u.securityEnabled}),V.reset(e)}}},[K.isSuccess,M.query,K.isFetching]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(p.A,{formControl:V,queryKey:["ListGroups-".concat(O)],title:"Group: ".concat((null===(i=K.data)||void 0===i?void 0:null===(e=i.groupInfo)||void 0===e?void 0:e.displayName)||""),formPageType:"Edit",backButtonTitle:"Group Overview",postUrl:"/api/EditGroup",customDataformatter:e=>{let i={...e};return["allowExternal","sendCopies","hideFromOutlookClients","securityEnabled"].forEach(l=>{e[l]===W[l]&&delete i[l]}),i},titleButton:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(a.A,{variant:"outlined",color:"primary",onClick:()=>G(!q),sx:{mb:2},children:q?"Edit Membership":"View members"})}),children:[K.isSuccess&&(null===(m=K.data)||void 0===m?void 0:null===(l=m.groupInfo)||void 0===l?void 0:l.onPremisesSyncEnabled)&&(0,t.jsx)(n.A,{severity:"error",sx:{mb:1},children:"This group is synced from on-premises Active Directory. Changes should be made in the on-premises environment instead."}),q?(0,t.jsx)(d.A,{sx:{my:2},children:(0,t.jsx)(F.x,{data:L,isFetching:K.isFetching,simpleColumns:["type","userPrincipalName","displayName"],refreshFunction:K.refetch})}):(0,t.jsx)(d.A,{sx:{my:2},children:(0,t.jsxs)(c.A,{container:!0,spacing:2,children:[(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(r.A,{variant:"h6",children:"Group Properties"})}),(0,t.jsx)(c.A,{size:{md:6,xs:12},children:(0,t.jsx)(h.A,{type:"textField",fullWidth:!0,label:"Display Name",name:"displayName",formControl:V,isFetching:K.isFetching,disabled:K.isFetching})}),(0,t.jsx)(c.A,{size:{md:6,xs:12},children:(0,t.jsx)(h.A,{type:"textField",fullWidth:!0,label:"Description",name:"description",formControl:V,isFetching:K.isFetching,disabled:K.isFetching})}),(0,t.jsx)(c.A,{size:{md:6,xs:12},children:(0,t.jsx)(h.A,{type:"textField",fullWidth:!0,label:"Mail Nickname",name:"mailNickname",formControl:V,isFetching:K.isFetching,disabled:K.isFetching})}),(null===(j=K.data)||void 0===j?void 0:null===(f=j.groupInfo)||void 0===f?void 0:null===(A=f.groupTypes)||void 0===A?void 0:A.includes("DynamicMembership"))&&(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(h.A,{type:"textField",fullWidth:!0,label:"Membership Rules",name:"membershipRules",formControl:V,isFetching:K.isFetching,disabled:K.isFetching})}),(0,t.jsxs)(c.A,{size:{xs:12},children:[(0,t.jsx)(o.A,{sx:{my:2}}),(0,t.jsx)(r.A,{variant:"h6",children:"Add Members"})]}),(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(v.H,{formControl:V,name:"AddMember",label:"Add Members",multiple:!0,isFetching:K.isFetching,disabled:K.isFetching,addedField:{id:"id",displayName:"displayName",userPrincipalName:"userPrincipalName"},dataFilter:e=>{var i,l;return!(null===(l=K.data)||void 0===l?void 0:null===(i=l.members)||void 0===i?void 0:i.some(i=>i.id===e.value))}})}),(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(v.H,{formControl:V,name:"AddOwner",label:"Add Owners",multiple:!0,isFetching:K.isFetching,disabled:K.isFetching,addedField:{id:"id",displayName:"displayName",userPrincipalName:"userPrincipalName"},dataFilter:e=>{var i,l;return!(null===(l=K.data)||void 0===l?void 0:null===(i=l.owners)||void 0===i?void 0:i.some(i=>i.id===e.value))}})}),(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(g,{formControl:V,name:"AddContact",label:"Add Contacts",multiple:!0,addedField:{id:"Guid",displayName:"displayName",WindowsEmailAddress:"WindowsEmailAddress"},isFetching:K.isFetching,disabled:K.isFetching,dataFilter:e=>{var i,l,t;return!(null===(t=K.data)||void 0===t?void 0:null===(l=t.members)||void 0===l?void 0:null===(i=l.filter(e=>(null==e?void 0:e["@odata.type"])==="#microsoft.graph.orgContact"))||void 0===i?void 0:i.some(i=>i.id===e.value))}})}),(0,t.jsxs)(c.A,{size:{xs:12},children:[(0,t.jsx)(o.A,{sx:{my:2}}),(0,t.jsx)(r.A,{variant:"h6",children:"Remove Members"})]}),(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(h.A,{type:"autoComplete",name:"RemoveMember",label:"Remove Members",formControl:V,multiple:!0,isFetching:K.isFetching,disabled:K.isFetching,options:(null===(w=K.data)||void 0===w?void 0:null===(N=w.members)||void 0===N?void 0:null===(C=N.filter(e=>(null==e?void 0:e["@odata.type"])!=="#microsoft.graph.orgContact"))||void 0===C?void 0:C.map(e=>({label:"".concat(e.displayName," (").concat(e.userPrincipalName,")"),value:e.id,addedFields:{userPrincipalName:e.userPrincipalName,displayName:e.displayName,id:e.id}})))||[]})}),(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(h.A,{type:"autoComplete",name:"RemoveOwner",label:"Remove Owners",formControl:V,multiple:!0,isFetching:K.isFetching,disabled:K.isFetching,options:(null===(P=K.data)||void 0===P?void 0:null===(E=P.owners)||void 0===E?void 0:E.map(e=>({label:"".concat(e.displayName," (").concat(e.userPrincipalName,")"),value:e.id,addedFields:{userPrincipalName:e.userPrincipalName,displayName:e.displayName,id:e.id}})))||[]})}),(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(h.A,{type:"autoComplete",name:"RemoveContact",label:"Remove Contacts",formControl:V,multiple:!0,isFetching:K.isFetching,disabled:K.isFetching,options:(null===(z=K.data)||void 0===z?void 0:null===(k=z.members)||void 0===k?void 0:null===(R=k.filter(e=>(null==e?void 0:e["@odata.type"])==="#microsoft.graph.orgContact"))||void 0===R?void 0:R.map(e=>({label:"".concat(e.displayName," (").concat(e.mail,")"),value:e.mail,addedFields:{id:e.id}})))||[]})}),(0,t.jsxs)(c.A,{size:{xs:12},children:[(0,t.jsx)(o.A,{sx:{my:2}}),(0,t.jsx)(r.A,{variant:"h6",children:"Group Settings"})]}),("Microsoft 365"===S||"Distribution List"===S)&&(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(h.A,{type:"switch",label:"Let people outside the organization email the group",name:"allowExternal",formControl:V,isFetching:K.isFetching,disabled:K.isFetching})}),"Microsoft 365"===S&&(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(h.A,{type:"switch",label:"Send Copies of team emails and events to team members inboxes",name:"sendCopies",formControl:V,isFetching:K.isFetching,disabled:K.isFetching})}),"Microsoft 365"===S&&(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(h.A,{type:"switch",label:"Hide group mailbox from Outlook",name:"hideFromOutlookClients",formControl:V,isFetching:K.isFetching,disabled:K.isFetching})}),"Microsoft 365"===S&&(0,t.jsx)(c.A,{size:{xs:12},children:(0,t.jsx)(h.A,{type:"switch",label:"Security Enabled",name:"securityEnabled",formControl:V,isFetching:K.isFetching,disabled:K.isFetching})})]})})]})})};A.getLayout=e=>(0,t.jsx)(m.P,{children:e});let f=A},58181:(e,i,l)=>{"use strict";l.d(i,{H:()=>d});var t=l(37876),s=l(58105),a=l(88992),n=l(17825);let d=e=>{let{formControl:i,name:l,label:d,allTenants:r=!1,multiple:o=!1,type:c="multiple",select:u,addedField:m,valueField:p,dataFilter:h=null,...v}=e,x=(0,a.FH)({control:i.control,name:"tenantFilter"}),y=(0,n.t)().currentTenant;return(0,t.jsx)(s.o,{name:l,label:d,type:"autoComplete",formControl:i,multiple:o,api:{addedField:m,tenantFilter:x?x.value:y,url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:p||"id",queryKey:"ListUsers-".concat((null==x?void 0:x.value)?x.value:y,"-").concat(u||"default"),data:{Endpoint:"users",manualPagination:!0,$select:u||"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999},dataFilter:e=>h?e.filter(h):e},creatable:!1,...v})}},90240:(e,i,l)=>{"use strict";l.d(i,{A:()=>F});var t=l(37876),s=l(89099),a=l(67578),n=l(86650),d=l(22474),r=l(47737),o=l(94810),c=l(77018),u=l(54538),m=l(24933),p=l(17675),h=l(42120),v=l(22322),x=l(68723),y=l(14232),b=l(88992),g=l(2303);let F=e=>{let{title:i,backButtonTitle:l,titleButton:F,formPageType:A="Add",children:f,queryKey:j,formControl:C,postUrl:N,customDataformatter:w,resetForm:E=!1,hideBackButton:P=!1,hidePageType:R=!1,hideTitle:k=!1,hideSubmit:z=!1,allowResubmit:M=!1,addedButtons:O,...S}=e,T=(0,s.useRouter)(),_=(0,v.nN)({datafromUrl:!0,relatedQueryKeys:j}),{isValid:q,isDirty:G}=(0,b.lN)({control:C.control});return(0,y.useEffect)(()=>{if(delete T.query.tenantFilter,T.query){let e={...C.getValues(),...T.query};C.reset(e)}},[T]),(0,y.useEffect)(()=>{_.isSuccess&&E&&C.reset()},[_.isSuccess]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.v,{title:i}),(0,t.jsx)(a.A,{sx:{flexGrow:1,py:4},children:(0,t.jsx)(n.A,{maxWidth:"lg",children:(0,t.jsxs)(d.A,{spacing:4,children:[!k&&(0,t.jsxs)(d.A,{spacing:2,children:[!P&&(0,t.jsx)("div",{children:(0,t.jsx)(r.A,{color:"inherit",onClick:()=>{T.back()},startIcon:(0,t.jsx)(o.A,{fontSize:"small",children:(0,t.jsx)(h.A,{})}),children:l})}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)(c.A,{variant:"h4",children:[!R&&(0,t.jsxs)(t.Fragment,{children:[A," - "]}),i]}),F&&F]})]}),(0,t.jsxs)(u.A,{children:[(0,t.jsxs)(m.A,{children:[f,(0,t.jsx)(x.v,{apiObject:_})]}),!z&&(0,t.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,t.jsxs)(d.A,{spacing:2,direction:"row",children:[O&&O,(0,t.jsx)(r.A,{disabled:_.isPending||!q||!M&&!G,onClick:C.handleSubmit(()=>{if(C.trigger(),!q)return;let e=w?w(C.getValues()):C.getValues();Object.keys(e).forEach(i=>{(""===e[i]||null===e[i])&&delete e[i]}),_.mutate({url:N,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}},95486:(e,i,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/identity/administration/groups/edit",function(){return l(50532)}])}},e=>{var i=i=>e(e.s=i);e.O(0,[636,6593,8792],()=>i(95486)),_N_E=e.O()}]);