(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5258],{42120:(e,t,l)=>{"use strict";l.d(t,{A:()=>n});var r=l(93944),i=l(37876);let n=(0,r.A)((0,i.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},58181:(e,t,l)=>{"use strict";l.d(t,{H:()=>s});var r=l(37876),i=l(58105),n=l(88992),a=l(17825);let s=e=>{let{formControl:t,name:l,label:s,allTenants:o=!1,multiple:u=!1,type:d="multiple",select:c,addedField:m,valueField:p,dataFilter:x=null,...y}=e,h=(0,n.FH)({control:t.control,name:"tenantFilter"}),j=(0,a.t)().currentTenant;return(0,r.jsx)(i.o,{name:l,label:s,type:"autoComplete",formControl:t,multiple:u,api:{addedField:m,tenantFilter:h?h.value:j,url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:p||"id",queryKey:"ListUsers-".concat((null==h?void 0:h.value)?h.value:j,"-").concat(c||"default"),data:{Endpoint:"users",manualPagination:!0,$select:c||"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999},dataFilter:e=>x?e.filter(x):e},creatable:!1,...y})}},58656:(e,t,l)=>{"use strict";l.d(t,{w:()=>s});var r=l(37876),i=l(58105),n=l(88992),a=l(17825);let s=e=>{let{formControl:t,name:l,label:s,allTenants:o=!1,type:u="multiple",multiple:d=!1,...c}=e,m=(0,n.FH)({control:t.control,name:"tenantFilter"}),p=(0,a.t)().currentTenant;return(0,r.jsx)(i.o,{name:l,label:s,type:"autoComplete",formControl:t,multiple:d,api:{autoSelectFirstItem:!0,tenantFilter:m?m.value:p,queryKey:"listDomains-".concat((null==m?void 0:m.value)?m.value:p),url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.id),valueField:"id",data:{Endpoint:"domains",manualPagination:!0,$count:!0,$top:99}},...c})}},62713:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>f});var r=l(37876),i=l(67578),n=l(90240),a=l(12435),s=l(88992),o=l(17825),u=l(14232),d=l(75720),c=l(59568),m=l(58105),p=l(46402),x=l(58656),y=l(58181);let h=e=>{let{formControl:t}=e;return(0,r.jsxs)(c.A,{container:!0,spacing:2,children:[(0,r.jsx)(c.A,{size:{md:12,xs:12},children:(0,r.jsx)(m.A,{type:"textField",label:"Display Name",name:"displayName",formControl:t,fullWidth:!0})}),(0,r.jsx)(c.A,{size:{md:12,xs:12},children:(0,r.jsx)(m.A,{type:"textField",label:"Description",name:"description",formControl:t,fullWidth:!0})}),(0,r.jsx)(c.A,{size:{md:6,xs:12},children:(0,r.jsx)(m.A,{type:"textField",label:"Username",name:"username",formControl:t,fullWidth:!0,InputProps:{endAdornment:(0,r.jsx)(d.A,{position:"end",children:"@"})}})}),(0,r.jsx)(c.A,{size:{md:6,xs:12},children:(0,r.jsx)(x.w,{formControl:t,name:"primDomain",label:"Primary Domain name"})}),(0,r.jsx)(c.A,{size:{xs:12},children:(0,r.jsx)(y.H,{sx:{mb:"1rem"},formControl:t,name:"owners",label:"Owners",multiple:!0,select:"id,userPrincipalName,displayName"})}),(0,r.jsx)(c.A,{size:{xs:12},children:(0,r.jsx)(y.H,{sx:{mb:"1rem"},formControl:t,name:"members",label:"Members",multiple:!0,select:"id,userPrincipalName,displayName"})}),(0,r.jsx)(c.A,{size:{xs:12},children:(0,r.jsx)(m.A,{type:"radio",name:"groupType",formControl:t,options:[{label:"Azure Role Group",value:"azurerole"},{label:"Security Group",value:"generic"},{label:"Microsoft 365 Group",value:"m365"},{label:"Dynamic Group",value:"dynamic"},{label:"Dynamic Distribution Group",value:"dynamicDistribution"},{label:"Distribution List",value:"distribution"},{label:"Mail Enabled Security Group",value:"security"}]})}),(0,r.jsx)(p.A,{formControl:t,field:"groupType",compareType:"is",compareValue:"distribution",children:(0,r.jsx)(c.A,{size:{xs:12},children:(0,r.jsx)(m.A,{type:"switch",label:"Let people outside the organization email the group",name:"allowExternal",formControl:t})})}),(0,r.jsx)(p.A,{formControl:t,field:"groupType",compareType:"contains",compareValue:"dynamic",children:(0,r.jsx)(c.A,{size:{xs:12},children:(0,r.jsx)(m.A,{type:"textField",label:"Dynamic Group Parameters",name:"membershipRules",formControl:t,placeholder:"Enter dynamic group parameters syntax",multiline:!0,rows:4,fullWidth:!0})})})]})},j=()=>{let e=(0,o.t)(),t=(0,s.mN)({mode:"onChange"});return(0,u.useEffect)(()=>{t.setValue("tenantFilter",(null==e?void 0:e.currentTenant)||"")},[e,t]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.A,{queryKey:"Groups-".concat(e.currentTenant),formControl:t,title:"Groups",backButtonTitle:"Group Overview",postUrl:"/api/AddGroup",resetForm:!0,children:(0,r.jsx)(i.A,{sx:{my:2},children:(0,r.jsx)(h,{formControl:t})})})})};j.getLayout=e=>(0,r.jsx)(a.P,{children:e});let f=j},70534:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/identity/administration/groups/add",function(){return l(62713)}])},90240:(e,t,l)=>{"use strict";l.d(t,{A:()=>A});var r=l(37876),i=l(89099),n=l(67578),a=l(86650),s=l(22474),o=l(47737),u=l(94810),d=l(77018),c=l(54538),m=l(24933),p=l(17675),x=l(42120),y=l(22322),h=l(68723),j=l(14232),f=l(88992),b=l(2303);let A=e=>{let{title:t,backButtonTitle:l,titleButton:A,formPageType:v="Add",children:g,queryKey:C,formControl:F,postUrl:N,customDataformatter:w,resetForm:z=!1,hideBackButton:E=!1,hidePageType:G=!1,hideTitle:P=!1,hideSubmit:T=!1,allowResubmit:_=!1,addedButtons:D,...k}=e,q=(0,i.useRouter)(),S=(0,y.nN)({datafromUrl:!0,relatedQueryKeys:C}),{isValid:L,isDirty:R}=(0,f.lN)({control:F.control});return(0,j.useEffect)(()=>{if(delete q.query.tenantFilter,q.query){let e={...F.getValues(),...q.query};F.reset(e)}},[q]),(0,j.useEffect)(()=>{S.isSuccess&&z&&F.reset()},[S.isSuccess]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.v,{title:t}),(0,r.jsx)(n.A,{sx:{flexGrow:1,py:4},children:(0,r.jsx)(a.A,{maxWidth:"lg",children:(0,r.jsxs)(s.A,{spacing:4,children:[!P&&(0,r.jsxs)(s.A,{spacing:2,children:[!E&&(0,r.jsx)("div",{children:(0,r.jsx)(o.A,{color:"inherit",onClick:()=>{q.back()},startIcon:(0,r.jsx)(u.A,{fontSize:"small",children:(0,r.jsx)(x.A,{})}),children:l})}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)(d.A,{variant:"h4",children:[!G&&(0,r.jsxs)(r.Fragment,{children:[v," - "]}),t]}),A&&A]})]}),(0,r.jsxs)(c.A,{children:[(0,r.jsxs)(m.A,{children:[g,(0,r.jsx)(h.v,{apiObject:S})]}),!T&&(0,r.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,r.jsxs)(s.A,{spacing:2,direction:"row",children:[D&&D,(0,r.jsx)(o.A,{disabled:S.isPending||!L||!_&&!R,onClick:F.handleSubmit(()=>{if(F.trigger(),!L)return;let e=w?w(F.getValues()):F.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),S.mutate({url:N,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(70534)),_N_E=e.O()}]);