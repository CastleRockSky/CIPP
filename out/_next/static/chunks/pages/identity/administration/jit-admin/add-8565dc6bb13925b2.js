(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1701],{16366:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/identity/administration/jit-admin/add",function(){return l(57541)}])},42120:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var a=l(93944),i=l(37876);let r=(0,a.A)((0,i.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},57541:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>h});var a=l(37876),i=l(67578),r=l(71538),s=l(59568),n=l(90240),o=l(12435),d=l(35764),u=l(88992),c=l(58105),m=l(46402),x=l(62964),p=l(58656),A=l(58181);let j=()=>{let e=(0,u.mN)({Mode:"onChange"});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.A,{queryKey:"JIT Admin Table",formControl:e,title:"JIT Admin",backButtonTitle:"JIT Admin",postUrl:"/api/ExecJitAdmin",children:(0,a.jsx)(i.A,{sx:{my:2},children:(0,a.jsxs)(s.A,{container:!0,spacing:2,children:[(0,a.jsx)(s.A,{size:{md:12,xs:12},children:(0,a.jsx)(d.w,{label:"Select a tenant to create the JIT Admin in",formControl:e,type:"single",allTenants:!1,preselectedEnabled:!0,validators:{required:"A tenant must be selected"}})}),(0,a.jsxs)(s.A,{size:{md:12,xs:12},children:[(0,a.jsx)(r.A,{sx:{mb:2}}),(0,a.jsx)(c.A,{type:"radio",label:"Would you like to create a new user or assign permissions to an existing user?",name:"userAction",row:!0,formControl:e,options:[{label:"New User",value:"create"},{label:"Existing User",value:"select"}],required:!0}),(0,a.jsx)(r.A,{sx:{my:2}})]}),(0,a.jsxs)(m.A,{formControl:e,field:"userAction",compareType:"is",compareValue:"create",children:[(0,a.jsx)(s.A,{size:{md:6,xs:12},children:(0,a.jsx)(c.A,{type:"textField",fullWidth:!0,label:"First Name",name:"firstName",formControl:e,required:!0})}),(0,a.jsx)(s.A,{size:{md:6,xs:12},children:(0,a.jsx)(c.A,{type:"textField",fullWidth:!0,label:"Last Name",name:"lastName",formControl:e,required:!0})}),(0,a.jsx)(s.A,{size:{md:6,xs:12},children:(0,a.jsx)(c.A,{type:"textField",fullWidth:!0,label:"Username",name:"userName",formControl:e,required:!0})}),(0,a.jsx)(s.A,{size:{md:6,xs:12},children:(0,a.jsx)(p.w,{formControl:e,name:"domain",label:"Domain Name",required:!0,validators:{validate:e=>null!=e&&!!e.value||"Domain is required"}})}),(0,a.jsx)(s.A,{size:{md:12,xs:12},children:(0,a.jsx)(r.A,{sx:{me:2}})})]}),(0,a.jsx)(m.A,{formControl:e,field:"userAction",compareType:"is",compareValue:"select",children:(0,a.jsx)(s.A,{size:{md:12,xs:12},children:(0,a.jsx)(s.A,{size:{md:12,xs:12},children:(0,a.jsx)(A.H,{formControl:e,multiple:!1,name:"existingUser",label:"User",required:!0})})})}),(0,a.jsx)(s.A,{size:{md:6,xs:12},children:(0,a.jsx)(c.A,{type:"datePicker",fullWidth:!0,label:"Start Date",name:"startDate",formControl:e,required:!0,validators:{validate:e=>!!e||"Start date is required"}})}),(0,a.jsx)(s.A,{size:{md:6,xs:12},children:(0,a.jsx)(c.A,{type:"datePicker",fullWidth:!0,label:"End Date",name:"endDate",formControl:e,required:!0,validators:{validate:t=>{let l=e.getValues("startDate");return t?!(new Date(t)<new Date(l))||"End date must be after start date":"End date is required"}}})}),(0,a.jsx)(s.A,{size:{md:12,xs:12},children:(0,a.jsx)(c.A,{type:"autoComplete",fullWidth:!0,label:"Roles",name:"adminRoles",options:x.map(e=>({label:e.Name,value:e.ObjectId})),formControl:e,required:!0,validators:{validate:e=>null!=e&&!!e.length||"At least one role is required"}})}),(0,a.jsx)(s.A,{size:{md:12,xs:12},children:(0,a.jsx)(c.A,{type:"switch",label:"Generate TAP",name:"UseTAP",formControl:e})}),(0,a.jsx)(s.A,{size:{md:6,xs:12},children:(0,a.jsx)(c.A,{type:"autoComplete",fullWidth:!0,label:"Expiration Action",name:"expireAction",multiple:!1,options:[{label:"Delete User",value:"DeleteUser"},{label:"Disable User",value:"DisableUser"},{label:"Remove Roles",value:"RemoveRoles"}],formControl:e,required:!0,validators:{validate:e=>null!=e&&!!e.value||"Expiration action is required"}})}),(0,a.jsx)(s.A,{size:{md:6,xs:12},children:(0,a.jsx)(c.A,{type:"autoComplete",fullWidth:!0,label:"Notification Action",name:"postExecution",multiple:!0,options:[{label:"Webhook",value:"Webhook"},{label:"Email",value:"email"},{label:"PSA",value:"PSA"}],formControl:e})})]})})})})};j.getLayout=e=>(0,a.jsx)(o.P,{children:e});let h=j},58181:(e,t,l)=>{"use strict";l.d(t,{H:()=>n});var a=l(37876),i=l(58105),r=l(88992),s=l(17825);let n=e=>{let{formControl:t,name:l,label:n,allTenants:o=!1,multiple:d=!1,type:u="multiple",select:c,addedField:m,valueField:x,dataFilter:p=null,...A}=e,j=(0,r.FH)({control:t.control,name:"tenantFilter"}),h=(0,s.t)().currentTenant;return(0,a.jsx)(i.o,{name:l,label:n,type:"autoComplete",formControl:t,multiple:d,api:{addedField:m,tenantFilter:j?j.value:h,url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:x||"id",queryKey:"ListUsers-".concat((null==j?void 0:j.value)?j.value:h,"-").concat(c||"default"),data:{Endpoint:"users",manualPagination:!0,$select:c||"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999},dataFilter:e=>p?e.filter(p):e},creatable:!1,...A})}},58656:(e,t,l)=>{"use strict";l.d(t,{w:()=>n});var a=l(37876),i=l(58105),r=l(88992),s=l(17825);let n=e=>{let{formControl:t,name:l,label:n,allTenants:o=!1,type:d="multiple",multiple:u=!1,...c}=e,m=(0,r.FH)({control:t.control,name:"tenantFilter"}),x=(0,s.t)().currentTenant;return(0,a.jsx)(i.o,{name:l,label:n,type:"autoComplete",formControl:t,multiple:u,api:{autoSelectFirstItem:!0,tenantFilter:m?m.value:x,queryKey:"listDomains-".concat((null==m?void 0:m.value)?m.value:x),url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.id),valueField:"id",data:{Endpoint:"domains",manualPagination:!0,$count:!0,$top:99}},...c})}},90240:(e,t,l)=>{"use strict";l.d(t,{A:()=>v});var a=l(37876),i=l(89099),r=l(67578),s=l(86650),n=l(22474),o=l(47737),d=l(94810),u=l(77018),c=l(54538),m=l(24933),x=l(17675),p=l(42120),A=l(22322),j=l(68723),h=l(14232),f=l(88992),b=l(2303);let v=e=>{let{title:t,backButtonTitle:l,titleButton:v,formPageType:y="Add",children:C,queryKey:g,formControl:q,postUrl:N,customDataformatter:F,resetForm:E=!1,hideBackButton:w=!1,hidePageType:z=!1,hideTitle:T=!1,hideSubmit:k=!1,allowResubmit:D=!1,addedButtons:P,...U}=e,W=(0,i.useRouter)(),_=(0,A.nN)({datafromUrl:!0,relatedQueryKeys:g}),{isValid:R,isDirty:S}=(0,f.lN)({control:q.control});return(0,h.useEffect)(()=>{if(delete W.query.tenantFilter,W.query){let e={...q.getValues(),...W.query};q.reset(e)}},[W]),(0,h.useEffect)(()=>{_.isSuccess&&E&&q.reset()},[_.isSuccess]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.v,{title:t}),(0,a.jsx)(r.A,{sx:{flexGrow:1,py:4},children:(0,a.jsx)(s.A,{maxWidth:"lg",children:(0,a.jsxs)(n.A,{spacing:4,children:[!T&&(0,a.jsxs)(n.A,{spacing:2,children:[!w&&(0,a.jsx)("div",{children:(0,a.jsx)(o.A,{color:"inherit",onClick:()=>{W.back()},startIcon:(0,a.jsx)(d.A,{fontSize:"small",children:(0,a.jsx)(p.A,{})}),children:l})}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)(u.A,{variant:"h4",children:[!z&&(0,a.jsxs)(a.Fragment,{children:[y," - "]}),t]}),v&&v]})]}),(0,a.jsxs)(c.A,{children:[(0,a.jsxs)(m.A,{children:[C,(0,a.jsx)(j.v,{apiObject:_})]}),!k&&(0,a.jsx)(x.A,{sx:{justifyContent:"flex-end"},children:(0,a.jsxs)(n.A,{spacing:2,direction:"row",children:[P&&P,(0,a.jsx)(o.A,{disabled:_.isPending||!R||!D&&!S,onClick:q.handleSubmit(()=>{if(q.trigger(),!R)return;let e=F?F(q.getValues()):q.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),_.mutate({url:N,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(16366)),_N_E=e.O()}]);