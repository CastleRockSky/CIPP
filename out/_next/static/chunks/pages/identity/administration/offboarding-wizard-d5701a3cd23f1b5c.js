(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6115],{855:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>N});var l=t(37876),s=t(12435),o=t(63968),n=t(40971),i=t(31748),r=t(22474),d=t(37832),c=t(58105);let m=e=>{let{title:a,type:t="single",name:s,placeholder:o,api:n,onNextStep:i,formControl:m,currentStep:u,onPreviousStep:p}=e,f=m.watch("tenantFilter");return(0,l.jsxs)(r.A,{spacing:3,children:[(0,l.jsx)("label",{children:a}),(0,l.jsx)(c.A,{type:"autoComplete",name:s,formControl:m,placeholder:o,api:{...n,tenantFilter:f?f.value:void 0,queryKey:n.queryKey?n.queryKey.replace("{tenant}",f?f.value:"default"):"".concat(n.url,"-").concat(f?f.value:"default")},multiple:"single"!==t,disableClearable:!0,validators:{required:{value:!0,message:"This field is required"}}},f?f.value:"default"),(0,l.jsx)(d.L,{currentStep:u,onPreviousStep:p,onNextStep:i,formControl:m})]})};var u=t(54538),p=t(1073),f=t(71538),h=t(24933),b=t(77018),x=t(46061),y=t(46402),A=t(88992),v=t(14232),j=t(59568),C=t(17825);let g=e=>{let{postUrl:a,formControl:t,onPreviousStep:s,onNextStep:o,currentStep:n}=e,i=t.watch("tenantFilter"),m=(0,A.FH)({control:t.control,name:"user"}),[g,w]=(0,v.useState)(!1),N=(0,C.t)().userSettingsDefaults,S=(0,A.FH)({control:t.control,name:"disableForwarding"});return(0,v.useEffect)(()=>{m.length>=3&&(w(!0),t.setValue("Scheduled.enabled",!0))},[m]),(0,v.useEffect)(()=>{(null==N?void 0:N.offboardingDefaults)&&N.offboardingDefaults.forEach(e=>{t.setValue(e.name,e.value)})},[N]),(0,v.useEffect)(()=>{S&&(t.setValue("forward",null),t.setValue("KeepCopy",!1))},[S,t]),(0,l.jsxs)(r.A,{spacing:4,children:[(0,l.jsxs)(j.A,{container:!0,spacing:4,children:[(0,l.jsx)(j.A,{size:6,children:(0,l.jsxs)(u.A,{variant:"outlined",children:[(0,l.jsx)(p.A,{title:"Offboarding Settings"}),(0,l.jsx)(f.A,{}),(0,l.jsxs)(h.A,{children:[(0,l.jsx)(c.A,{name:"ConvertToShared",label:"Convert to Shared Mailbox",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"HideFromGAL",label:"Hide from Global Address List",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"removeCalendarInvites",label:"Cancel all calendar invites",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"removePermissions",label:"Remove user's mailbox permissions",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"RemoveRules",label:"Remove all Rules",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"RemoveMobile",label:"Remove all Mobile Devices",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"RemoveGroups",label:"Remove from all groups",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"RemoveLicenses",label:"Remove Licenses",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"RevokeSessions",label:"Revoke all sessions",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"DisableSignIn",label:"Disable Sign in",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"ClearImmutableId",label:"Clear Immutable ID",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"ResetPass",label:"Reset Password",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"RemoveMFADevices",label:"Remove all MFA Devices",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"DeleteUser",label:"Delete user",type:"switch",formControl:t})]})]})}),(0,l.jsx)(j.A,{size:6,children:(0,l.jsxs)(u.A,{variant:"outlined",children:[(0,l.jsx)(p.A,{title:"Permissions and forwarding"}),(0,l.jsx)(f.A,{}),(0,l.jsxs)(h.A,{children:[(0,l.jsx)(b.A,{variant:"subtitle2",gutterBottom:!0,children:"Mailbox Access"}),(0,l.jsx)(c.A,{sx:{m:1},name:"AccessNoAutomap",label:"Grant Full Access (no automap)",type:"autoComplete",placeholder:"Leave blank if not needed",formControl:t,multi:!0,api:{tenantFilter:i?i.value:void 0,url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:"id",queryKey:"Offboarding-Users",data:{Endpoint:"users",manualPagination:!0,$select:"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999}}}),(0,l.jsx)(c.A,{sx:{m:1},name:"AccessAutomap",label:"Grant Full Access (automap)",type:"autoComplete",placeholder:"Leave blank if not needed",formControl:t,multi:!0,api:{labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:"id",url:"/api/ListGraphRequest",dataKey:"Results",tenantFilter:i?i.value:void 0,queryKey:"Offboarding-Users",data:{Endpoint:"users",manualPagination:!0,$select:"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999}}}),(0,l.jsx)(c.A,{sx:{m:1},name:"OnedriveAccess",label:"Grant Onedrive Full Access",type:"autoComplete",placeholder:"Leave blank if not needed",formControl:t,multi:!0,api:{tenantFilter:i?i.value:void 0,labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:"id",url:"/api/ListGraphRequest",dataKey:"Results",queryKey:"Offboarding-Users",data:{Endpoint:"users",manualPagination:!0,$select:"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999}}}),(0,l.jsx)(b.A,{variant:"subtitle2",sx:{mt:3},gutterBottom:!0,children:"Email Forwarding"}),(0,l.jsx)(c.A,{name:"disableForwarding",label:"Disable Email Forwarding",type:"switch",formControl:t}),(0,l.jsxs)(y.A,{formControl:t,field:"disableForwarding",compareType:"isNot",compareValue:!0,children:[(0,l.jsx)(c.A,{sx:{m:1},name:"forward",label:"Forward Email To",type:"autoComplete",placeholder:"Leave blank if not needed",formControl:t,multiple:!1,api:{tenantFilter:i?i.value:void 0,labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:"id",url:"/api/ListGraphRequest",dataKey:"Results",queryKey:"Offboarding-Users",data:{Endpoint:"users",manualPagination:!0,$select:"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999}}}),(0,l.jsx)(c.A,{name:"KeepCopy",label:"Keep a copy of forwarded mail",type:"switch",formControl:t})]}),(0,l.jsx)(c.A,{name:"OOO",label:"Out of Office Message",type:"richText",placeholder:"Leave blank to not set",fullWidth:!0,formControl:t})]})]})})]}),g&&(0,l.jsx)(x.A,{severity:"warning",children:"You have selected more than 2 users. This offboarding must be scheduled."}),(0,l.jsxs)(u.A,{variant:"outlined",children:[(0,l.jsx)(p.A,{title:"Scheduling & Notifications"}),(0,l.jsx)(f.A,{}),(0,l.jsx)(h.A,{children:(0,l.jsxs)(j.A,{container:!0,spacing:3,children:[(0,l.jsx)(j.A,{size:{xs:12},children:(0,l.jsx)(c.A,{name:"Scheduled.enabled",label:"Schedule this offboarding",type:"switch",formControl:t})}),(0,l.jsxs)(y.A,{formControl:t,field:"Scheduled.enabled",compareType:"is",compareValue:!0,children:[(0,l.jsxs)(j.A,{size:{sm:6,xs:12},children:[(0,l.jsx)(b.A,{variant:"subtitle2",children:"Scheduled Offboarding Date"}),(0,l.jsx)(c.A,{name:"Scheduled.date",type:"datePicker",formControl:t,fullWidth:!0})]}),(0,l.jsxs)(j.A,{size:{sm:6,xs:12},children:[(0,l.jsx)(b.A,{variant:"subtitle2",children:"Send results to:"}),(0,l.jsx)(c.A,{name:"postExecution.webhook",label:"Webhook",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"postExecution.email",label:"E-mail",type:"switch",formControl:t}),(0,l.jsx)(c.A,{name:"postExecution.psa",label:"PSA",type:"switch",formControl:t})]})]})]})})]}),(0,l.jsx)(d.A,{postUrl:a,currentStep:n,onPreviousStep:s,onNextStep:o,formControl:t,replacementBehaviour:"removeNulls"})]})},w=()=>{let e=(0,C.t)(),a=[{title:"Step 1",description:"Tenant Selection",component:i.d,componentProps:{allTenants:!1,type:"single"}},{title:"Step 2",description:"User Selection",component:m,componentProps:{title:"Select the users to offboard",name:"user",placeholder:"Select User",type:"multiple",api:{url:"/api/ListGraphRequest",dataKey:"Results",queryKey:"Users - {tenant}",data:{Endpoint:"users",manualPagination:!0,$select:"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999},labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:"userPrincipalName"}}},{title:"Step 3",description:"Offboarding Options",component:g},{title:"Step 4",description:"Confirmation",component:o.J}];return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(n.A,{initialState:{...e.offboardingDefaults,Scheduled:{enabled:!1}},steps:a,postUrl:"/api/ExecOffboardUser",wizardTitle:"User Offboarding Wizard"})})};w.getLayout=e=>(0,l.jsx)(s.P,{children:e});let N=w},31748:(e,a,t)=>{"use strict";t.d(a,{d:()=>i});var l=t(37876),s=t(22474),o=t(37832),n=t(35764);let i=e=>{let{allTenants:a,type:t="single",valueField:i="defaultDomainName",onNextStep:r,formControl:d,currentStep:c,onPreviousStep:m,preText:u}=e;return(0,l.jsxs)(s.A,{spacing:3,children:[u,(0,l.jsx)("label",{children:"Select a tenant"}),(0,l.jsx)(n.w,{valueField:i,formControl:d,allTenants:a,type:t,preselectedEnabled:!0}),(0,l.jsx)(o.L,{currentStep:c,onPreviousStep:m,onNextStep:r,formControl:d})]})}},67713:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/identity/administration/offboarding-wizard",function(){return t(855)}])}},e=>{var a=a=>e(e.s=a);e.O(0,[636,6593,8792],()=>a(67713)),_N_E=e.O()}]);