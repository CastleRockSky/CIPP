(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3483],{35815:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/endpoint/MEM/list-scripts",function(){return i(59898)}])},41055:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});var n=i(14232);let r=n.forwardRef(function(e,t){let{title:i,titleId:r,...s}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),i?n.createElement("title",{id:r},i):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})},59898:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>k});var n=i(37876),r=i(12435),s=i(29390),a=i(65868),o=i(41055),l=i(68417),c=i(5596),d=i(47866),u=i(70946),p=i(7957),h=i(3034),m=i(78523),f=i(47737),y=i(24921),x=i(14232),S=i(31777),g=i(48504),j=i(409),w=i(17825),A=i(82179),v=i(74359),b=i(67768),C=i(88220).Buffer;let T=()=>{let[e,t]=(0,x.useState)(!1),[i,r]=(0,x.useState)(""),[T,k]=(0,x.useState)(null),[E,L]=(0,x.useState)(!1),[I,N]=(0,x.useState)(!1),[_,F]=(0,x.useState)(!1),[O,W]=(0,x.useState)(null),P=(0,S.wA)(),q=(0,x.useMemo)(()=>{var e;return(null==O?void 0:null===(e=O.scriptType)||void 0===e?void 0:e.toLowerCase())==="macos"?"shell":"powershell"},[null==O?void 0:O.scriptType]),D=(0,w.t)().currentTenant,{isLoading:M,isRefetching:B,refetch:R,data:z}=(0,v.I)({queryKey:["script",{scriptId:T}],queryFn:async()=>(await fetch("/api/EditIntuneScript?TenantFilter=".concat(D,"&ScriptId=").concat(T))).json(),refetchOnWindowFocus:!1,enabled:!1});(0,x.useEffect)(()=>{T&&R().then(e=>{let{data:t}=e;W(t),r(C.from(t.scriptContent,"base64").toString("ascii"))})},[T,R]);let J=async(i,n)=>{k(i.id),t(!e)},{refetch:K,isFetching:X}=(0,v.I)({queryKey:["saveScript"],queryFn:async()=>{let e=C.from(i,"ascii"),{runAs32Bit:t,id:n,displayName:r,description:s,scriptContent:a,runAsAccount:o,fileName:c,roleScopeTagIds:d,scriptType:u}=O,p={TenantFilter:D,ScriptId:n,ScriptType:u,IntuneScript:JSON.stringify({runAs32Bit:t,id:n,displayName:r,description:s,scriptContent:e.toString("base64"),runAsAccount:o,fileName:c,roleScopeTagIds:d})},h=await fetch("/api/EditIntuneScript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});return h.ok||P((0,l.P0)({title:"Script Save Error",message:"Your Intune script could not be saved.",type:"error"})),h.json()},enabled:!1,refetchOnWindowFocus:!1});(0,b.jE)();let Y=async()=>{let{data:i}=await K();N(!1),t(!e),P((0,l.P0)({title:"Script Saved",message:"Your Intune script has been saved successfully.",type:"update"}))},H=[{label:"Edit Script",icon:(0,n.jsx)(a.A,{}),color:"primary",noConfirm:!0,customFunction:J},{label:"Delete Script",type:"POST",url:"/api/RemoveIntuneScript",data:{ID:"id",displayName:"displayName",ScriptType:"scriptType"},confirmText:"Are you sure you want to delete this script?",icon:(0,n.jsx)(o.A,{}),color:"danger"}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.a,{title:"Scripts",apiUrl:"/api/ListIntuneScript",actions:H,offCanvas:{extendedInfoFields:["scriptType","id","fileName","displayName","description","lastModifiedDateTime","runAsAccount","createdDateTime","runAs32Bit","executionFrequency","enforceSignatureCheck"],actions:H},simpleColumns:["scriptType","displayName","description","runAsAccount","lastModifiedDateTime"]}),(0,n.jsxs)(c.A,{open:e,maxWidth:"lg",fullWidth:!0,children:[(0,n.jsxs)(d.A,{sx:{py:2},children:["Script Content",!X&&(0,n.jsx)(u.A,{"aria-label":"close",onClick:()=>{I?F(!_):(t(!e),N(!1),k(null),r(""))},sx:{position:"absolute",right:8,top:8},children:(0,n.jsx)(g.A,{})}),!X&&(0,n.jsx)(u.A,{"aria-label":"save",onClick:Y,sx:{position:"absolute",right:50,top:8},children:(0,n.jsx)(j.A,{})}),X&&(0,n.jsx)(p.A,{size:20,sx:{position:"absolute",right:55,top:14}})]}),(0,n.jsxs)(h.A,{dividers:!0,children:[(B||M)&&(0,n.jsx)(p.A,{size:40}),!B&&!M&&(0,n.jsx)(y.x,{open:e,type:"editor",code:i,onChange:(e,t)=>{r(e),N(!0)},language:q})]})]}),(0,n.jsxs)(c.A,{open:_,fullWidth:!0,maxWidth:"sm",children:[(0,n.jsx)(d.A,{children:"Confirmation"}),(0,n.jsx)(h.A,{children:(0,n.jsx)(A.A,{spacing:3,children:"Changes detected, are you sure you want to close?"})}),(0,n.jsxs)(m.A,{children:[(0,n.jsx)(f.A,{color:"inherit",onClick:()=>F(!1),children:"Abort"}),(0,n.jsx)(f.A,{variant:"contained",onClick:()=>{t(!1),F(!1),r(""),k(null),N(!1)},children:"Confirm"})]})]})]})};T.getLayout=e=>(0,n.jsx)(r.P,{allTenantsSupport:!1,children:e});let k=T},65868:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});var n=i(14232);let r=n.forwardRef(function(e,t){let{title:i,titleId:r,...s}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),i?n.createElement("title",{id:r},i):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))})}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(35815)),_N_E=e.O()}]);