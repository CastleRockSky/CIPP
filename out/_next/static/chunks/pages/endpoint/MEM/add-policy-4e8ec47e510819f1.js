(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3756],{31748:(e,t,l)=>{"use strict";l.d(t,{d:()=>i});var o=l(37876),n=l(22474),a=l(37832),s=l(35764);let i=e=>{let{allTenants:t,type:l="single",valueField:i="defaultDomainName",onNextStep:r,formControl:c,currentStep:d,onPreviousStep:p,preText:u}=e;return(0,o.jsxs)(n.A,{spacing:3,children:[u,(0,o.jsx)("label",{children:"Select a tenant"}),(0,o.jsx)(s.w,{valueField:i,formControl:c,allTenants:t,type:l,preselectedEnabled:!0}),(0,o.jsx)(a.L,{currentStep:d,onPreviousStep:p,onNextStep:r,formControl:c})]})}},72387:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/endpoint/MEM/add-policy",function(){return l(72505)}])},72505:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>g});var o=l(37876),n=l(12435),a=l(63968),s=l(40971),i=l(31748),r=l(22474),c=l(59568),d=l(37832),p=l(49814),u=l(58105),m=l(22322),A=l(14232),f=l(88992),v=l(46402);let x=e=>{let{formControl:t,onPreviousStep:l,onNextStep:n,currentStep:a}=e,s=t.getValues(),i=(0,m.R_)({url:"/api/ListIntuneTemplates",queryKey:"IntuneTemplates"}),[x,y]=(0,A.useState)(),g=(0,f.FH)({control:t.control,name:"TemplateList"}),h=(0,f.FH)({control:t.control,name:"RAWJson"}),j=(0,f.FH)({control:t.control,name:"tenantFilter"});return(0,A.useEffect)(()=>{if(i.isSuccess&&(null==g?void 0:g.value)){let e=i.data.find(e=>e.GUID===g.value);e&&(y(e.RAWJson?JSON.parse(e.RAWJson):null),t.setValue("RAWJson",e.RAWJson),t.setValue("displayName",e.Displayname),t.setValue("description",e.Description),t.setValue("TemplateType",e.Type))}},[g]),(0,o.jsxs)(r.A,{spacing:3,children:[(0,o.jsxs)(r.A,{spacing:3,children:[(0,o.jsx)(u.A,{type:"autoComplete",name:"TemplateList",label:"Please choose a template to apply.",isFetching:i.isLoading,multiple:!1,formControl:t,options:i.isSuccess?i.data.map(e=>({label:e.Displayname,value:e.GUID})):[]}),(0,o.jsx)(u.A,{type:"hidden",name:"RAWJson",label:"Conditional Access Parameters",placeholder:"Enter the JSON information to use as parameters, or select from a template",formControl:t}),(0,o.jsx)(p.A,{object:x,type:"intune"}),(0,o.jsx)(c.A,{size:{xs:12},children:(0,o.jsx)(u.A,{type:"radio",name:"AssignTo",options:[{label:"Do not assign",value:"On"},{label:"Assign to all users",value:"allLicensedUsers"},{label:"Assign to all devices",value:"AllDevices"},{label:"Assign to all users and devices",value:"AllDevicesAndUsers"},{label:"Assign to Custom Group",value:"customGroup"}],formControl:t})}),(0,o.jsx)(v.A,{formControl:t,field:"AssignTo",compareType:"is",compareValue:"customGroup",children:(0,o.jsx)(c.A,{size:{xs:12},children:(0,o.jsx)(u.A,{type:"textField",label:"Custom Group Names separated by comma. Wildcards (*) are allowed",name:"customGroup",formControl:t,validators:{required:"Please specify custom group names"}})})}),(0,o.jsx)(v.A,{formControl:t,field:"RAWJson",compareType:"regex",compareValue:/%(\w+)%/,children:(()=>{let e=Array.from(new Set([...(h||"").matchAll(/%(\w+)%/g)].map(e=>e[1])));return 0===e.length||0===j.length?null:e.map(e=>(0,o.jsx)(c.A,{size:{xs:6},children:j.map((l,n)=>{var a,s;return(0,o.jsx)(u.A,{type:"textField",defaultValue:"tenantid"===e?null==l?void 0:null===(a=l.addedFields)||void 0===a?void 0:a.customerId:"tenantdomain"===e?null==l?void 0:null===(s=l.addedFields)||void 0===s?void 0:s.defaultDomainName:"",name:"replacemap.".concat(l.value,".%").concat(e,"%"),label:"Value for '".concat(e,"' in Tenant '").concat(l.addedFields.defaultDomainName,"'"),formControl:t,validators:{required:"Please provide a value for ".concat(e)}},"".concat(l.value,"-").concat(e,"-").concat(n))})},e))})()})]}),(0,o.jsx)(d.L,{currentStep:a,onPreviousStep:l,onNextStep:n,noNextButton:"UpdateTokens"===s.selectedOption,formControl:t,noSubmitButton:!0})]})},y=()=>{let e=[{title:"Step 1",description:"Tenant Selection",component:i.d,componentProps:{type:"multiple"}},{title:"Step 2",description:"Policy Configuration",component:x},{title:"Step 3",description:"Confirmation",component:a.J}];return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(s.A,{queryKeys:[["Configuration Policies"]],steps:e,wizardTitle:"Apply Policy Wizard",postUrl:"/api/AddPolicy"})})};y.getLayout=e=>(0,o.jsx)(n.P,{children:e});let g=y}},e=>{var t=t=>e(e.s=t);e.O(0,[5918,9814,636,6593,8792],()=>t(72387)),_N_E=e.O()}]);