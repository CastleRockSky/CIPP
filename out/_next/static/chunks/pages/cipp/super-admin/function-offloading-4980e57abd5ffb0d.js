(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1927],{17055:(e,n,t)=>{"use strict";t.d(n,{L:()=>c});var i=t(37876),s=t(14e3),a=t(67578),r=t(22474),l=t(8578),o=t(76626),d=t(71538);let c=e=>{let{tabOptions:n,children:t}=e,c=(0,s.useRouter)(),u=(0,s.usePathname)(),f=n.find(e=>e.path===u);return(0,i.jsxs)(a.A,{sx:{flexGrow:1,py:4},children:[(0,i.jsx)(r.A,{spacing:2,children:(0,i.jsxs)("div",{children:[(0,i.jsx)(l.A,{onChange:(e,n)=>{c.push(n)},value:null==f?void 0:f.path,variant:"scrollable",children:n.map(e=>(0,i.jsx)(o.A,{label:e.label,value:e.path},e.path))}),(0,i.jsx)(d.A,{})]})}),t]})}},41055:(e,n,t)=>{"use strict";t.d(n,{A:()=>s});var i=t(14232);let s=i.forwardRef(function(e,n){let{title:t,titleId:s,...a}=e;return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})},42120:(e,n,t)=>{"use strict";t.d(n,{A:()=>a});var i=t(93944),s=t(37876);let a=(0,i.A)((0,s.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},45497:e=>{"use strict";e.exports=JSON.parse('[{"label":"Tenant Mode","path":"/cipp/super-admin/tenant-mode"},{"label":"Function Offloading","path":"/cipp/super-admin/function-offloading"},{"label":"CIPP Roles","path":"/cipp/super-admin/cipp-roles"},{"label":"SAM App Roles","path":"/cipp/super-admin/sam-app-roles"},{"label":"SAM App Permissions","path":"/cipp/super-admin/sam-app-permissions"}]')},59139:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>g});var i=t(37876),s=t(17055),a=t(12435),r=t(45497),l=t(90240),o=t(88992),d=t(94760),c=t(46061),u=t(59568),f=t(58105),p=t(22322),h=t(14232),m=t(48230),x=t.n(m),v=t(31540),A=t(41055);let j=()=>{var e,n,t,s,a,r;let m=(0,o.mN)({mode:"onChange",defaultValues:{OffloadFunctions:!1}}),j=(0,p.R_)({url:"/api/ExecOffloadFunctions?Action=ListCurrent",queryKey:"execOffloadFunctions"}),g=(0,p.nN)({urlFromData:!0,relatedQueryKeys:["execOffloadFunctions"]});return(0,h.useEffect)(()=>{if(j.isSuccess){var e;m.reset({OffloadFunctions:null===(e=j.data)||void 0===e?void 0:e.OffloadFunctions})}},[j.isSuccess,j.data]),(0,i.jsx)(l.A,{title:"Function Offloading",hideBackButton:!0,hidePageType:!0,formControl:m,resetForm:!1,postUrl:"/api/ExecOffloadFunctions",queryKey:"execOffloadFunctions",children:(0,i.jsxs)(u.A,{container:!0,spacing:2,sx:{mb:3},children:[(0,i.jsxs)(u.A,{size:12,children:["This mode enables offloading some of the more processor intensive functions to a separate function app. This can be useful in environments where the CIPP server is under heavy load. Please review"," ",(0,i.jsx)(d.A,{component:x(),href:"https://docs.cipp.app/user-documentation/cipp/settings/superadmin/function-offloading",target:"_blank",rel:"noreferrer",children:"our documentation"})," ","for more information on how to configure this for your environment.",(0,i.jsx)(c.A,{severity:"info",sx:{mt:2},children:"If you are self-hosted, you must deploy the additional function app(s) to your CIPP resource group and enable CI/CD or all background tasks will fail."})]}),(0,i.jsx)(u.A,{size:12,children:(0,i.jsx)(v.x,{cardProps:{variant:"outlined"},title:"Registered Functions Apps",data:null===(e=j.data)||void 0===e?void 0:e.Version,simpleColumns:["Name","Version","Default"],refreshFunction:j.refetch,isFetching:j.isFetching,actions:[{label:"Delete Offloading Entry",icon:(0,i.jsx)(A.A,{}),url:"/api/ExecAzBobbyTables",type:"POST",customFunction:e=>{let n={RowKey:e.Name,PartitionKey:"Version"};g.mutate({url:"/api/ExecAzBobbyTables",data:{FunctionName:"Remove-AzDataTableEntity",TableName:"Version",Parameters:{Entity:n,Force:!0}}})},confirmText:"Are you sure you want to delete the offloaded function entry for [Name]? This does not delete the function app from Azure, this must be done first or it will register again.",condition:e=>!0!==e.Default}]})}),(null===(t=j.data)||void 0===t?void 0:null===(n=t.Alerts)||void 0===n?void 0:n.length)>0&&(0,i.jsx)(u.A,{size:12,children:null===(s=j.data)||void 0===s?void 0:s.Alerts.map((e,n)=>(0,i.jsx)(c.A,{severity:"warning",children:e},n))}),(0,i.jsx)(u.A,{size:12,children:(0,i.jsx)(f.A,{type:"switch",name:"OffloadFunctions",formControl:m,label:"Enable Function Offloading",disabled:j.isFetching||!(null==j?void 0:null===(a=j.data)||void 0===a?void 0:a.CanEnable)&&!(null==j?void 0:null===(r=j.data)||void 0===r?void 0:r.OffloadFunctions)})})]})})};j.getLayout=e=>(0,i.jsx)(a.P,{children:(0,i.jsx)(s.L,{tabOptions:r,children:e})});let g=j},80328:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/cipp/super-admin/function-offloading",function(){return t(59139)}])},90240:(e,n,t)=>{"use strict";t.d(n,{A:()=>g});var i=t(37876),s=t(89099),a=t(67578),r=t(86650),l=t(22474),o=t(47737),d=t(94810),c=t(77018),u=t(54538),f=t(24933),p=t(17675),h=t(42120),m=t(22322),x=t(68723),v=t(14232),A=t(88992),j=t(2303);let g=e=>{let{title:n,backButtonTitle:t,titleButton:g,formPageType:b="Add",children:y,queryKey:w,formControl:F,postUrl:O,customDataformatter:E,resetForm:C=!1,hideBackButton:P=!1,hidePageType:k=!1,hideTitle:N=!1,hideSubmit:_=!1,allowResubmit:T=!1,addedButtons:S,...z}=e,L=(0,s.useRouter)(),R=(0,m.nN)({datafromUrl:!0,relatedQueryKeys:w}),{isValid:V,isDirty:I}=(0,A.lN)({control:F.control});return(0,v.useEffect)(()=>{if(delete L.query.tenantFilter,L.query){let e={...F.getValues(),...L.query};F.reset(e)}},[L]),(0,v.useEffect)(()=>{R.isSuccess&&C&&F.reset()},[R.isSuccess]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.v,{title:n}),(0,i.jsx)(a.A,{sx:{flexGrow:1,py:4},children:(0,i.jsx)(r.A,{maxWidth:"lg",children:(0,i.jsxs)(l.A,{spacing:4,children:[!N&&(0,i.jsxs)(l.A,{spacing:2,children:[!P&&(0,i.jsx)("div",{children:(0,i.jsx)(o.A,{color:"inherit",onClick:()=>{L.back()},startIcon:(0,i.jsx)(d.A,{fontSize:"small",children:(0,i.jsx)(h.A,{})}),children:t})}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)(c.A,{variant:"h4",children:[!k&&(0,i.jsxs)(i.Fragment,{children:[b," - "]}),n]}),g&&g]})]}),(0,i.jsxs)(u.A,{children:[(0,i.jsxs)(f.A,{children:[y,(0,i.jsx)(x.v,{apiObject:R})]}),!_&&(0,i.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,i.jsxs)(l.A,{spacing:2,direction:"row",children:[S&&S,(0,i.jsx)(o.A,{disabled:R.isPending||!V||!T&&!I,onClick:F.handleSubmit(()=>{if(F.trigger(),!V)return;let e=E?E(F.getValues()):F.getValues();Object.keys(e).forEach(n=>{(""===e[n]||null===e[n])&&delete e[n]}),R.mutate({url:O,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var n=n=>e(e.s=n);e.O(0,[636,6593,8792],()=>n(80328)),_N_E=e.O()}]);