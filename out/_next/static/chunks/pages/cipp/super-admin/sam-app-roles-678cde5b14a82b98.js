(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2696],{4673:(e,s,l)=>{"use strict";l.d(s,{A:()=>t});var a=l(93944),n=l(37876);let t=(0,a.A)((0,n.jsx)("path",{d:"M12 5.99 19.53 19H4.47zM12 2 1 21h22zm1 14h-2v2h2zm0-6h-2v4h2z"}),"WarningAmberOutlined")},17055:(e,s,l)=>{"use strict";l.d(s,{L:()=>c});var a=l(37876),n=l(14e3),t=l(67578),i=l(22474),r=l(8578),d=l(76626),o=l(71538);let c=e=>{let{tabOptions:s,children:l}=e,c=(0,n.useRouter)(),u=(0,n.usePathname)(),p=s.find(e=>e.path===u);return(0,a.jsxs)(t.A,{sx:{flexGrow:1,py:4},children:[(0,a.jsx)(i.A,{spacing:2,children:(0,a.jsxs)("div",{children:[(0,a.jsx)(r.A,{onChange:(e,s)=>{c.push(s)},value:null==p?void 0:p.path,variant:"scrollable",children:s.map(e=>(0,a.jsx)(d.A,{label:e.label,value:e.path},e.path))}),(0,a.jsx)(o.A,{})]})}),l]})}},42120:(e,s,l)=>{"use strict";l.d(s,{A:()=>t});var a=l(93944),n=l(37876);let t=(0,a.A)((0,n.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},45212:(e,s,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/cipp/super-admin/sam-app-roles",function(){return l(51318)}])},45497:e=>{"use strict";e.exports=JSON.parse('[{"label":"Tenant Mode","path":"/cipp/super-admin/tenant-mode"},{"label":"Function Offloading","path":"/cipp/super-admin/function-offloading"},{"label":"CIPP Roles","path":"/cipp/super-admin/cipp-roles"},{"label":"SAM App Roles","path":"/cipp/super-admin/sam-app-roles"},{"label":"SAM App Permissions","path":"/cipp/super-admin/sam-app-permissions"}]')},51318:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>b});var a=l(37876),n=l(17055),t=l(12435),i=l(45497),r=l(90240),d=l(24933),o=l(22474),c=l(77018),u=l(46061),p=l(4673),h=l(88992),m=l(22322),x=l(14232),A=l(58105),v=l(62964),j=l(35764);let f=()=>{var e;let s=(0,h.mN)({mode:"onChange"}),l=(0,m.R_)({url:"/api/ExecSAMRoles",queryKey:"ExecSAMRoles"}),{data:n={pages:[]},isSuccess:t}=(0,m.Zs)({url:"/api/ListTenants?AllTenantSelector=true",queryKey:"ListTenants-AllTenantSelector"}),i=(null==n?void 0:null===(e=n.pages)||void 0===e?void 0:e[0])||[];return(0,x.useEffect)(()=>{if(l.isSuccess&&t){var e,a,n=[];null===(e=l.data)||void 0===e||e.Tenants.map(e=>{var s=!1;(s=(null==e?void 0:e.value)?i.find(s=>(null==s?void 0:s.defaultDomainName)===(null==e?void 0:e.value)):i.find(s=>(null==s?void 0:s.defaultDomainName)===e))&&n.push({value:null==s?void 0:s.defaultDomainName,label:null==s?void 0:s.displayName})}),s.reset({Roles:null===(a=l.data)||void 0===a?void 0:a.Roles,Tenants:n})}},[l.isSuccess,t]),(0,a.jsx)(r.A,{title:"SAM App Roles",hideBackButton:!0,hidePageType:!0,formControl:s,resetForm:!1,postUrl:"/api/ExecSAMRoles?Action=Update",queryKey:"execSAMRoles",children:(0,a.jsx)(d.A,{children:(0,a.jsxs)(o.A,{spacing:2,children:[(0,a.jsx)(c.A,{variant:"body2",children:"Add your CIPP-SAM application Service Principal directly to Admin Roles in the tenant. This is an advanced use case where you need access to additional Graph endpoints or Exchange Cmdlets otherwise unavailable via Delegated permissions."}),(0,a.jsx)(u.A,{color:"warning",icon:(0,a.jsx)(p.A,{}),children:"This functionality is in beta and should be treated as such. Roles are added during the Update Permissions process or a CPV refresh."}),(0,a.jsx)(A.A,{formControl:s,type:"autoComplete",name:"Roles",label:"Admin Roles",options:v.map(e=>({value:e.ObjectId,label:e.Name}))}),(0,a.jsx)(j.w,{formControl:s,name:"Tenants",allTenants:!0})]})})})};f.getLayout=e=>(0,a.jsx)(t.P,{children:(0,a.jsx)(n.L,{tabOptions:i,children:e})});let b=f},90240:(e,s,l)=>{"use strict";l.d(s,{A:()=>b});var a=l(37876),n=l(89099),t=l(67578),i=l(86650),r=l(22474),d=l(47737),o=l(94810),c=l(77018),u=l(54538),p=l(24933),h=l(17675),m=l(42120),x=l(22322),A=l(68723),v=l(14232),j=l(88992),f=l(2303);let b=e=>{let{title:s,backButtonTitle:l,titleButton:b,formPageType:g="Add",children:y,queryKey:S,formControl:C,postUrl:R,customDataformatter:w,resetForm:N=!1,hideBackButton:P=!1,hidePageType:T=!1,hideTitle:E=!1,hideSubmit:_=!1,allowResubmit:M=!1,addedButtons:k,...O}=e,q=(0,n.useRouter)(),z=(0,x.nN)({datafromUrl:!0,relatedQueryKeys:S}),{isValid:L,isDirty:F}=(0,j.lN)({control:C.control});return(0,v.useEffect)(()=>{if(delete q.query.tenantFilter,q.query){let e={...C.getValues(),...q.query};C.reset(e)}},[q]),(0,v.useEffect)(()=>{z.isSuccess&&N&&C.reset()},[z.isSuccess]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.v,{title:s}),(0,a.jsx)(t.A,{sx:{flexGrow:1,py:4},children:(0,a.jsx)(i.A,{maxWidth:"lg",children:(0,a.jsxs)(r.A,{spacing:4,children:[!E&&(0,a.jsxs)(r.A,{spacing:2,children:[!P&&(0,a.jsx)("div",{children:(0,a.jsx)(d.A,{color:"inherit",onClick:()=>{q.back()},startIcon:(0,a.jsx)(o.A,{fontSize:"small",children:(0,a.jsx)(m.A,{})}),children:l})}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)(c.A,{variant:"h4",children:[!T&&(0,a.jsxs)(a.Fragment,{children:[g," - "]}),s]}),b&&b]})]}),(0,a.jsxs)(u.A,{children:[(0,a.jsxs)(p.A,{children:[y,(0,a.jsx)(A.v,{apiObject:z})]}),!_&&(0,a.jsx)(h.A,{sx:{justifyContent:"flex-end"},children:(0,a.jsxs)(r.A,{spacing:2,direction:"row",children:[k&&k,(0,a.jsx)(d.A,{disabled:z.isPending||!L||!M&&!F,onClick:C.handleSubmit(()=>{if(C.trigger(),!L)return;let e=w?w(C.getValues()):C.getValues();Object.keys(e).forEach(s=>{(""===e[s]||null===e[s])&&delete e[s]}),z.mutate({url:R,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[636,6593,8792],()=>s(45212)),_N_E=e.O()}]);