(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8954],{14080:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/cipp/advanced/exchange-cmdlets",function(){return l(91172)}])},91172:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>w});var s=l(37876),n=l(12435),a=l(86650),i=l(22474),o=l(47737),c=l(5596),r=l(47866),d=l(70946),u=l(3034),m=l(76776),p=l(59568),x=l(88992),h=l(58105),A=l(22322),j=l(84064),C=l(31540),g=l(14232),v=l(16652),f=l(48504),E=l(35764);let _=["Cmdlet"],R=["Error","Name","Description"],b=()=>{var e,t,l;let n=(0,x.mN)({mode:"onChange"}),[b,w]=(0,g.useState)([]),[y,N]=(0,g.useState)(!1),[P,F]=(0,g.useState)([]),[S,k]=(0,g.useState)(null),q=(0,A.nN)({urlFromData:!0,queryKey:"ExchangeCmdlets",onResult:e=>{w(e)}}),z=(0,A.nN)({urlFromData:!0,queryKey:"ManagementRole",onResult:e=>{F(e)}}),D=()=>{let e=n.getValues();q.mutate({url:"/api/ListExoRequest",data:{availableCmdlets:!0,tenantFilter:e.tenant.value,compliance:e.compliance,asApp:e.asApp}})};(0,g.useEffect)(()=>{z.isSuccess&&F(z.data)},[z.isSuccess]);let L=[{label:"Check Roles",noConfirm:!0,customFunction:e=>{k(e.Cmdlet),z.mutate({url:"/api/ListExoRequest",data:{cmdlet:"Get-ManagementRole",cmdParams:{cmdlet:e.Cmdlet},compliance:n.getValues().compliance,tenantFilter:n.getValues().tenant.value}}),N(!0)}}];return(0,s.jsxs)(a.A,{children:[(0,s.jsxs)(i.A,{spacing:2,sx:{p:3,mt:1},children:[(0,s.jsx)(j.A,{component:"accordion",title:"Cmdlet Search",accordionExpanded:!0,children:(0,s.jsxs)(p.A,{container:!0,spacing:2,children:[(0,s.jsx)(p.A,{size:{md:4,xs:12},children:(0,s.jsx)(E.w,{formControl:n,name:"tenant",multiple:!1})}),(0,s.jsx)(p.A,{size:{md:4,xs:12},children:(0,s.jsx)(h.A,{type:"switch",name:"compliance",label:"Compliance",formControl:n})}),(0,s.jsx)(p.A,{size:{md:4,xs:12},children:(0,s.jsx)(h.A,{type:"switch",name:"asApp",label:"As App",formControl:n})}),(0,s.jsx)(p.A,{size:{xs:12},children:(0,s.jsx)(o.A,{onClick:D,variant:"contained",color:"primary",startIcon:(0,s.jsx)(v.A,{}),children:"Search"})})]})}),(0,s.jsx)(C.x,{title:"Available Exchange Cmdlets",simpleColumns:_,data:null!==(t=null==b?void 0:b.Results)&&void 0!==t?t:[],isFetching:q.isPending,refreshFunction:D,actions:L})]}),(0,s.jsxs)(c.A,{open:y,onClose:()=>N(!1),maxWidth:"lg",fullWidth:!0,children:[(0,s.jsxs)(r.A,{sx:{py:2},children:["Permitted Roles for ",S,(0,s.jsx)(d.A,{"aria-label":"close",onClick:()=>N(!1),sx:{position:"absolute",right:8,top:8},children:(0,s.jsx)(f.A,{})})]}),(0,s.jsx)(u.A,{dividers:!0,children:P.isPending?(0,s.jsx)(m.A,{variant:"rectangular",height:200}):(0,s.jsx)(C.x,{noCard:!0,title:"Permitted Roles",simpleColumns:R,data:null!==(l=null==P?void 0:null===(e=P.data)||void 0===e?void 0:e.Results)&&void 0!==l?l:[],isFetching:z.isPending})})]})]})};b.getLayout=e=>(0,s.jsx)(n.P,{children:e});let w=b}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(14080)),_N_E=e.O()}]);