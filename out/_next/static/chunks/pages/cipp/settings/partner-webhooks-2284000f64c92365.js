(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{17055:(e,l,s)=>{"use strict";s.d(l,{L:()=>u});var t=s(37876),i=s(14e3),n=s(67578),o=s(22474),a=s(8578),d=s(76626),r=s(71538);let u=e=>{let{tabOptions:l,children:s}=e,u=(0,i.useRouter)(),c=(0,i.usePathname)(),v=l.find(e=>e.path===c);return(0,t.jsxs)(n.A,{sx:{flexGrow:1,py:4},children:[(0,t.jsx)(o.A,{spacing:2,children:(0,t.jsxs)("div",{children:[(0,t.jsx)(a.A,{onChange:(e,l)=>{u.push(l)},value:null==v?void 0:v.path,variant:"scrollable",children:l.map(e=>(0,t.jsx)(d.A,{label:e.label,value:e.path},e.path))}),(0,t.jsx)(r.A,{})]})}),s]})}},37035:e=>{"use strict";e.exports=JSON.parse('[{"label":"General","path":"/cipp/settings"},{"label":"Permissions","path":"/cipp/settings/permissions"},{"label":"Tenants","path":"/cipp/settings/tenants"},{"label":"Backend","path":"/cipp/settings/backend"},{"label":"Notifications","path":"/cipp/settings/notifications"},{"label":"Partner Webhooks","path":"/cipp/settings/partner-webhooks"},{"label":"Licenses","path":"/cipp/settings/licenses"},{"label":"Global Variables","path":"/cipp/settings/global-variables"}]')},42120:(e,l,s)=>{"use strict";s.d(l,{A:()=>n});var t=s(93944),i=s(37876);let n=(0,t.A)((0,i.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},57796:(e,l,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/cipp/settings/partner-webhooks",function(){return s(90320)}])},90240:(e,l,s)=>{"use strict";s.d(l,{A:()=>f});var t=s(37876),i=s(89099),n=s(67578),o=s(86650),a=s(22474),d=s(47737),r=s(94810),u=s(77018),c=s(54538),v=s(24933),p=s(17675),h=s(42120),x=s(22322),b=s(68723),m=s(14232),j=s(88992),A=s(2303);let f=e=>{let{title:l,backButtonTitle:s,titleButton:f,formPageType:g="Add",children:y,queryKey:k,formControl:R,postUrl:w,customDataformatter:E,resetForm:S=!1,hideBackButton:C=!1,hidePageType:T=!1,hideTitle:P=!1,hideSubmit:_=!1,allowResubmit:F=!1,addedButtons:N,...W}=e,z=(0,i.useRouter)(),L=(0,x.nN)({datafromUrl:!0,relatedQueryKeys:k}),{isValid:I,isDirty:U}=(0,j.lN)({control:R.control});return(0,m.useEffect)(()=>{if(delete z.query.tenantFilter,z.query){let e={...R.getValues(),...z.query};R.reset(e)}},[z]),(0,m.useEffect)(()=>{L.isSuccess&&S&&R.reset()},[L.isSuccess]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.v,{title:l}),(0,t.jsx)(n.A,{sx:{flexGrow:1,py:4},children:(0,t.jsx)(o.A,{maxWidth:"lg",children:(0,t.jsxs)(a.A,{spacing:4,children:[!P&&(0,t.jsxs)(a.A,{spacing:2,children:[!C&&(0,t.jsx)("div",{children:(0,t.jsx)(d.A,{color:"inherit",onClick:()=>{z.back()},startIcon:(0,t.jsx)(r.A,{fontSize:"small",children:(0,t.jsx)(h.A,{})}),children:s})}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)(u.A,{variant:"h4",children:[!T&&(0,t.jsxs)(t.Fragment,{children:[g," - "]}),l]}),f&&f]})]}),(0,t.jsxs)(c.A,{children:[(0,t.jsxs)(v.A,{children:[y,(0,t.jsx)(b.v,{apiObject:L})]}),!_&&(0,t.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,t.jsxs)(a.A,{spacing:2,direction:"row",children:[N&&N,(0,t.jsx)(d.A,{disabled:L.isPending||!I||!F&&!U,onClick:R.handleSubmit(()=>{if(R.trigger(),!I)return;let e=E?E(R.getValues()):R.getValues();Object.keys(e).forEach(l=>{(""===e[l]||null===e[l])&&delete e[l]}),L.mutate({url:w,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}},90320:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>T});var t=s(37876),i=s(17055),n=s(12435),o=s(37035),a=s(90240),d=s(88992),r=s(47737),u=s(77018),c=s(94760),v=s(54538),p=s(1073),h=s(22474),x=s(67578),b=s(70946),m=s(94810),j=s(24933),A=s(59017),f=s(59568),g=s(58105),y=s(22322),k=s(14232),R=s(33862),w=s(24921),E=s(43225),S=s(48504);let C=()=>{var e,l,s,i,n,o,C,T,P,_,F,N,W,z,L,I,U,q,O,M,V,B,G,K,D,X,J;let[Q,Z]=(0,k.useState)(!1),[H,Y]=(0,k.useState)(null),[$,ee]=(0,k.useState)(!1),el=(0,d.mN)({mode:"onChange"}),es=(0,y.R_)({url:"/api/ExecPartnerWebhook",data:{Action:"ListSubscription"},queryKey:"listSubscription"}),et=(0,y.R_)({url:"/api/ExecPartnerWebhook",data:{Action:"ListEventTypes"},queryKey:"listEventTypes"}),ei=(0,y.nN)({urlFromData:!0}),en=(0,y.R_)({url:"/api/ExecPartnerWebhook",data:{Action:"ValidateTest",CorrelationId:H},waiting:$});return(0,k.useEffect)(()=>{var e,l,s,t,i,n;H&&$&&en.isSuccess&&(null==en?void 0:null===(l=en.data)||void 0===l?void 0:null===(e=l.Results)||void 0===e?void 0:e.status)==="Submitted"?setTimeout(()=>{en.refetch()},1e3):en.isSuccess&&((null==en?void 0:null===(t=en.data)||void 0===t?void 0:null===(s=t.Results)||void 0===s?void 0:s.status)==="completed"||(null==en?void 0:null===(n=en.data)||void 0===n?void 0:null===(i=n.Results)||void 0===i?void 0:i.status)==="failed")?(ee(!1),Y(null)):setTimeout(()=>{en.refetch()},1e3)},[en.isSuccess,null==en?void 0:null===(e=en.data)||void 0===e?void 0:e.Results,$]),(0,k.useEffect)(()=>{if(es.isSuccess&&et.isSuccess){var e,l,s,t,i;el.reset({EventType:null==es?void 0:null===(s=es.data)||void 0===s?void 0:null===(l=s.Results)||void 0===l?void 0:null===(e=l.webhookEvents)||void 0===e?void 0:e.map(e=>{var l,s,t=null==et?void 0:null===(s=et.data)||void 0===s?void 0:null===(l=s.Results)||void 0===l?void 0:l.find(l=>l===e);return{label:t,value:t}}),standardsExcludeAllTenants:null==es?void 0:null===(i=es.data)||void 0===i?void 0:null===(t=i.Results)||void 0===t?void 0:t.standardsExcludeAllTenants})}},[es.isSuccess,et.isSuccess]),(0,t.jsx)(a.A,{title:"Partner Webhooks",hideBackButton:!0,hidePageType:!0,allowResubmit:!0,formControl:el,resetForm:!1,postUrl:"/api/ExecPartnerWebhook?Action=CreateSubscription",queryKey:["listSubscription","listEventTypes"],addedButtons:(0,t.jsx)(r.A,{variant:"outlined",onClick:()=>{Z(!0),ei.mutate({url:"/api/ExecPartnerWebhook?Action=SendTest",data:{}},{onSuccess:e=>{var l,s;(null==e?void 0:null===(s=e.data)||void 0===s?void 0:null===(l=s.Results)||void 0===l?void 0:l.correlationId)&&setTimeout(()=>{var l,s;Y(null==e?void 0:null===(s=e.data)||void 0===s?void 0:null===(l=s.Results)||void 0===l?void 0:l.correlationId),ee(!0),en.refetch()},1e3)}})},children:"Test Webhook"}),children:(0,t.jsxs)(f.A,{container:!0,spacing:2,sx:{mb:3},children:[(0,t.jsx)(f.A,{size:{md:12,xs:12},children:(0,t.jsxs)(u.A,{variant:"body2",color:"textSecondary",sx:{mb:3},children:["Subscribe to Microsoft Partner center webhooks to enable automatic tenant onboarding and alerting. Updating the settings will replace any existing webhook subscription with one pointing to CIPP. Refer to the"," ",(0,t.jsx)(c.A,{href:"https://learn.microsoft.com/en-us/partner-center/developer/partner-center-webhooks",target:"_blank",rel:"noreferrer",children:"Microsoft Partner Center documentation"})," ","for more information on the webhook types."]})}),(0,t.jsx)(f.A,{size:{md:12,xs:12},children:(0,t.jsx)(R.E,{sx:{mb:3,mx:0,p:0},isFetching:es.isFetching,propertyItems:[{label:"Webhook URL",value:(0,t.jsx)(w.x,{code:null==es?void 0:null===(s=es.data)||void 0===s?void 0:null===(l=s.Results)||void 0===l?void 0:l.webhookUrl}),sx:{pl:0}},{label:"Last Updated",value:(0,t.jsx)(E.z,{data:null==es?void 0:null===(n=es.data)||void 0===n?void 0:null===(i=n.Results)||void 0===i?void 0:i.lastModifiedTimestamp})}],layout:"double",showDivider:!1})}),(0,t.jsx)(f.A,{size:{md:12,xs:12},children:(0,t.jsx)(g.A,{type:"autoComplete",fullWidth:!0,label:"Event Types",name:"EventType",isFetching:et.isFetching,options:null==et?void 0:null===(C=et.data)||void 0===C?void 0:null===(o=C.Results)||void 0===o?void 0:o.map(e=>({label:e,value:e})),formControl:el})}),(0,t.jsx)(f.A,{size:{md:12,xs:12},children:(0,t.jsx)(g.A,{type:"switch",label:"Exclude onboarded tenants from top-level standards",name:"standardsExcludeAllTenants",formControl:el})}),Q&&(0,t.jsx)(f.A,{size:{md:12,xs:12},sx:{mt:2},children:(0,t.jsxs)(v.A,{variant:"outlined",children:[(0,t.jsx)(p.A,{title:(0,t.jsxs)(h.A,{direction:"row",sx:{display:"flex"},justifyContent:"space-between",alignItems:"center",children:[(0,t.jsx)(x.A,{children:"Test Results"}),(0,t.jsx)(b.A,{variant:"outlined",onClick:()=>Z(!1),children:(0,t.jsx)(m.A,{fontSize:"small",children:(0,t.jsx)(S.A,{})})})]}),sx:{pb:0}}),(0,t.jsx)(j.A,{sx:{p:0},children:(0,t.jsx)(R.E,{sx:{my:0,mx:0,p:0},isFetching:en.isFetching,propertyItems:[{label:"Response Code",value:(0,t.jsx)(A.A,{color:(null==en?void 0:null===(_=en.data)||void 0===_?void 0:null===(P=_.Results)||void 0===P?void 0:null===(T=P.results)||void 0===T?void 0:T[0].responseCode)?(null==en?void 0:null===(W=en.data)||void 0===W?void 0:null===(N=W.Results)||void 0===N?void 0:null===(F=N.results)||void 0===F?void 0:F[0].responseCode)==="200"?"success":"error":"info",label:null==en?void 0:null===(U=en.data)||void 0===U?void 0:null===(I=U.Results)||void 0===I?void 0:null===(L=I.results)||void 0===L?void 0:null===(z=L[0])||void 0===z?void 0:z.responseCode})},{label:"Status",value:null==en?void 0:null===(O=en.data)||void 0===O?void 0:null===(q=O.Results)||void 0===q?void 0:q.status},{label:"Response Message",value:null==en?void 0:null===(G=en.data)||void 0===G?void 0:null===(B=G.Results)||void 0===B?void 0:null===(V=B.results)||void 0===V?void 0:null===(M=V[0])||void 0===M?void 0:M.responseMessage},{label:"Last Run",value:(0,t.jsx)(E.z,{data:(null==en?void 0:null===(J=en.data)||void 0===J?void 0:null===(X=J.Results)||void 0===X?void 0:null===(D=X.results)||void 0===D?void 0:null===(K=D[0])||void 0===K?void 0:K.dateTimeUtc)+"Z"})}],layout:"double",showDivider:!1})})]})})]})})};C.getLayout=e=>(0,t.jsx)(n.P,{children:(0,t.jsx)(i.L,{tabOptions:o,children:e})});let T=C}},e=>{var l=l=>e(e.s=l);e.O(0,[636,6593,8792],()=>l(57796)),_N_E=e.O()}]);