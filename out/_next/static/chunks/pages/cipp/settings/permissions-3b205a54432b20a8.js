(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9985],{37035:e=>{"use strict";e.exports=JSON.parse('[{"label":"General","path":"/cipp/settings"},{"label":"Permissions","path":"/cipp/settings/permissions"},{"label":"Tenants","path":"/cipp/settings/tenants"},{"label":"Backend","path":"/cipp/settings/backend"},{"label":"Notifications","path":"/cipp/settings/notifications"},{"label":"Partner Webhooks","path":"/cipp/settings/partner-webhooks"},{"label":"Licenses","path":"/cipp/settings/licenses"},{"label":"Global Variables","path":"/cipp/settings/global-variables"}]')},37054:(e,s,i)=>{"use strict";i.d(s,{A:()=>n});var t=i(93944),l=i(37876);let n=(0,t.A)((0,l.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload")},37504:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>T});var t=i(37876),l=i(86650),n=i(59568),a=i(17055),o=i(12435),r=i(37035),c=i(80479),p=i(22474),d=i(47737),u=i(94810),h=i(22430),m=i(37054),v=i(93944);let A=(0,v.A)((0,t.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload"),x=(0,v.A)([(0,t.jsx)("path",{d:"M5 5h2v3h10V5h2v6h2V5c0-1.1-.9-2-2-2h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h5v-2H5zm7-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1"},"0"),(0,t.jsx)("path",{d:"m18.01 13-1.42 1.41 1.58 1.58H12v2h6.17l-1.58 1.59 1.42 1.41 3.99-4z"},"1")],"ContentPasteGo");var j=i(48504),f=i(22322),g=i(82836),P=i(79803),R=i(14232);let y=e=>{let{importReport:s,setImportReport:i}=e,[l,n]=(0,R.useState)(!1),[a,o]=(0,R.useState)(null),r=(0,g.s)(),c=(0,f.R_)({url:"/api/ExecAccessChecks",data:{Type:"Permissions"},queryKey:"ExecAccessChecks-Permissions",waiting:!1}),v=(0,f.R_)({url:"/api/ExecAccessChecks",data:{Type:"GDAP"},queryKey:"ExecAccessChecks-GDAP",waiting:!1}),y=(0,f.R_)({url:"/api/ExecAccessChecks",data:{Type:"Tenants"},queryKey:"ExecAccessChecks-Tenants",waiting:!1}),b=e=>{if(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)){let s=e.split("-");return s.map((e,i)=>i===s.length-1?e:"*".repeat(e.length)).join("-")}{if("string"!=typeof e)return e;if(e.length<=9)return"*".repeat(e.length);let s=e.slice(0,3),i=e.slice(-3),t="*".repeat(6);return"".concat(s).concat(t).concat(i)}},T=async()=>{try{let e=await navigator.clipboard.readText(),s=JSON.parse(e);if(!(null==s?void 0:s.Permissions)&&!(null==s?void 0:s.GDAP)&&!(null==s?void 0:s.Tenants)){n("Invalid report format");return}o({name:"Clipboard Data"}),i(s),n(!1)}catch(e){n("Failed to read from clipboard")}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(p.A,{direction:"row",spacing:2,children:[(0,t.jsx)(d.A,{size:"small",variant:"contained",color:"primary",onClick:r.handleOpen,startIcon:(0,t.jsx)(u.A,{fontSize:"small",children:(0,t.jsx)(m.A,{})}),children:"Export Report"}),(0,t.jsxs)(d.A,{component:"label",size:"small",variant:"contained",color:"primary",startIcon:(0,t.jsx)(u.A,{fontSize:"small",children:(0,t.jsx)(A,{})}),children:["Import Report",(0,t.jsx)("input",{type:"file",hidden:!0,onChange:e=>{let s=e.target.files[0],t=new FileReader;t.onload=e=>{let t=JSON.parse(e.target.result);if(!(null==t?void 0:t.Permissions)&&!(null==t?void 0:t.GDAP)&&!(null==t?void 0:t.Tenants)){n("Invalid report format");return}o(s),i(t),n(!1)},t.readAsText(s),e.target.value=null},accept:".json",id:"report-upload"})]}),(0,t.jsx)(d.A,{size:"small",variant:"contained",color:"primary",onClick:T,startIcon:(0,t.jsx)(u.A,{fontSize:"small",children:(0,t.jsx)(x,{})}),children:"Paste Report"}),s&&(0,t.jsx)(h.A,{title:"Close report",children:(0,t.jsx)(d.A,{size:"small",variant:"outlined",color:"primary",onClick:()=>i(!1),endIcon:(0,t.jsx)(u.A,{fontSize:"small",children:(0,t.jsx)(j.A,{})}),children:a.name})}),l&&(0,t.jsx)(d.A,{size:"small",variant:"outlined",color:"error",onClick:()=>n(!1),endIcon:(0,t.jsx)(u.A,{fontSize:"small",children:(0,t.jsx)(j.A,{})}),children:l})]}),(0,t.jsx)(P.B,{title:"Export Diagnostic Report",createDialog:r,fields:[{type:"switch",name:"redactCustomerData",label:"Redact Customer Data"}],api:{confirmText:"Export a diagnostic report of the current permissions for your SAM application authentication, GDAP and Tenant data. This report will be exported as a JSON file.",customFunction:(e,s,i)=>{c.waiting=!0,v.waiting=!0,y.waiting=!0;let t={Permissions:null==c?void 0:c.data,GDAP:null==v?void 0:v.data,Tenants:null==y?void 0:y.data},l=["AppId","CustomerId","Tenant","TenantName","TenantId","DisplayName","DefaultDomainName","UserPrincipalName","IPAddress","GDAPRoles"];if(i.redactCustomerData){var n,a,o,r,p,d,u,h;t.Tenants.Results=null==t?void 0:null===(a=t.Tenants)||void 0===a?void 0:null===(n=a.Results)||void 0===n?void 0:n.map(e=>(l.forEach(s=>{(null==e?void 0:e[s])&&("GDAPRoles"===s?e[s]=e[s].map(e=>(Array.isArray(null==e?void 0:e.Group)?e.Group=e.Group.map(e=>null==e?void 0:e.split("@")[0]):(null==e?void 0:e.Group)&&(e.Group=e.Group.split("@")[0]),e)):e[s]=b(e[s]))}),e)),null==t||null===(p=t.GDAP)||void 0===p||null===(r=p.Results)||void 0===r||null===(o=r.GDAPIssues)||void 0===o||o.map(e=>(l.forEach(s=>{(null==e?void 0:e[s])&&(e[s]=b(e[s]))}),e)),null==t||null===(h=t.Permissions)||void 0===h||null===(u=h.Results)||void 0===u||null===(d=u.CPVRefreshList)||void 0===d||d.map(e=>(l.forEach(s=>{(null==e?void 0:e[s])&&(e[s]=b(e[s]))}),e)),l.forEach(e=>{var s,i,l,n,a,o;(null==t?void 0:null===(l=t.Permissions)||void 0===l?void 0:null===(i=l.Results)||void 0===i?void 0:null===(s=i.AccessTokenDetails)||void 0===s?void 0:s[e])&&(t.Permissions.Results.AccessTokenDetails[e]=b(t.Permissions.Results.AccessTokenDetails[e])),(null==t?void 0:null===(o=t.Permissions)||void 0===o?void 0:null===(a=o.Results)||void 0===a?void 0:null===(n=a.ApplicationTokenDetails)||void 0===n?void 0:n[e])&&(t.Permissions.Results.ApplicationTokenDetails[e]=b(t.Permissions.Results.ApplicationTokenDetails[e]))})}let m=new Blob([JSON.stringify(t)],{type:"application/json"}),A=URL.createObjectURL(m),x=document.createElement("a");x.href=A,x.download="cipp-permission-report.json",document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(A)}}})]})},b=()=>{let[e,s]=(0,R.useState)(!1);return(0,t.jsx)(l.A,{sx:{pt:3},maxWidth:"xl",children:(0,t.jsxs)(n.A,{container:!0,spacing:2,children:[(0,t.jsx)(n.A,{size:{xs:12},children:(0,t.jsx)(y,{importReport:e,setImportReport:s})}),(0,t.jsx)(n.A,{size:{lg:6,md:12,sm:12,xs:12},children:(0,t.jsx)(c.A,{type:"Permissions",importReport:e})}),(0,t.jsx)(n.A,{size:{lg:6,md:12,sm:12,xs:12},children:(0,t.jsx)(c.A,{type:"GDAP",importReport:e})}),(0,t.jsx)(n.A,{size:{lg:12,md:12,sm:12,xs:12},children:(0,t.jsx)(c.A,{type:"Tenants",importReport:e})})]})})};b.getLayout=e=>(0,t.jsx)(o.P,{children:(0,t.jsx)(a.L,{tabOptions:r,children:e})});let T=b},69826:(e,s,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/cipp/settings/permissions",function(){return i(37504)}])}},e=>{var s=s=>e(e.s=s);e.O(0,[9365,636,6593,8792],()=>s(69826)),_N_E=e.O()}]);