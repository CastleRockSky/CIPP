(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1350],{4649:(e,l,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/security/defender/deployment",function(){return o(46083)}])},42120:(e,l,o)=>{"use strict";o.d(l,{A:()=>t});var s=o(93944),n=o(37876);let t=(0,s.A)((0,n.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},46083:(e,l,o)=>{"use strict";o.r(l),o.d(l,{default:()=>f});var s=o(37876),n=o(77018),t=o(71538),i=o(59568),r=o(88992),a=o(12435),c=o(90240),d=o(58105),m=o(35764),A=o(46402),p=o(15994);let x=()=>{let e=(0,r.mN)({mode:"onChange"});return(0,s.jsxs)(c.A,{title:"Defender Setup",formControl:e,postUrl:"/api/AddDefenderDeployment",backButtonTitle:"Defender Deployment",children:[(0,s.jsx)(n.A,{variant:"body2",sx:{mb:2},children:"Run this wizard to setup the default defender policies for your tenants, or use the standards to create specific policies."}),(0,s.jsxs)(i.A,{container:!0,spacing:2,children:[(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsx)(m.w,{label:"Select Tenants",formControl:e,name:"selectedTenants",type:"multiple",allTenants:!0,preselectedEnabled:!0,validators:{required:"At least one tenant must be selected"}})}),(0,s.jsx)(t.A,{sx:{my:2}}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsx)(d.A,{type:"switch",label:"Show Defender Setup Options",name:"showDefenderSetup",formControl:e})}),(0,s.jsxs)(A.A,{formControl:e,field:"showDefenderSetup",compareType:"is",compareValue:!0,children:[(0,s.jsxs)(i.A,{size:{xs:12},children:[(0,s.jsx)(n.A,{variant:"h6",children:"Defender Setup"}),(0,s.jsx)(n.A,{variant:"subtitle1",children:"Defender and MEM Reporting"})]}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsxs)(i.A,{container:!0,spacing:2,children:[(0,s.jsxs)(i.A,{size:{md:6,xs:12},children:[(0,s.jsx)(d.A,{type:"switch",label:"Allow Microsoft Defender for Endpoint to enforce Endpoint Security Configurations (Compliance)",name:"Compliance.AllowMEMEnforceCompliance",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Connect iOS/iPadOS devices version 13.0 and above to Microsoft Defender for Endpoint (Compliance)",name:"Compliance.ConnectIosCompliance",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Connect Android devices version 6.0.0 and above to Microsoft Defender for Endpoint (Compliance)",name:"Compliance.ConnectAndroidCompliance",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Connect Windows devices version 10.0.15063 and above to Microsoft Defender for Endpoint (Compliance)",name:"Compliance.ConnectWindows",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"EDR: Expedite Telemetry Reporting Frequency",name:"EDR.Telemetry",formControl:e})]}),(0,s.jsxs)(i.A,{size:{md:6,xs:12},children:[(0,s.jsx)(d.A,{type:"switch",label:"Enable App Sync (sending application inventory) for iOS/iPadOS devices",name:"Compliance.AppSync",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block unsupported OS versions",name:"Compliance.BlockunsupportedOS",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Connect Android devices to Microsoft Defender for Endpoint",name:"Compliance.ConnectAndroid",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Connect iOS/iPadOS devices to Microsoft Defender for Endpoint",name:"Compliance.ConnectIos",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"EDR: Connect Defender Configuration Package automatically from Connector",name:"EDR.Config",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"EDR: Enable Sample Sharing",name:"EDR.SampleSharing",formControl:e})]})]})})]}),(0,s.jsx)(t.A,{sx:{my:2}}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsx)(d.A,{type:"switch",label:"Show Defender Defaults Policy Options",name:"showDefenderDefaults",formControl:e})}),(0,s.jsxs)(A.A,{formControl:e,field:"showDefenderDefaults",compareType:"is",compareValue:!0,children:[(0,s.jsxs)(i.A,{size:{xs:12},children:[(0,s.jsx)(n.A,{variant:"h6",children:"Defender Defaults Policy"}),(0,s.jsx)(n.A,{variant:"subtitle1",children:"Select Defender policies to deploy"})]}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsxs)(i.A,{container:!0,spacing:2,children:[(0,s.jsxs)(i.A,{size:{md:6,xs:12},children:[(0,s.jsx)(d.A,{type:"switch",label:"Allow Archive Scanning",name:"Policy.ScanArchives",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow behavior monitoring",name:"Policy.AllowBehavior",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow Cloud Protection",name:"Policy.AllowCloudProtection",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow e-mail scanning",name:"Policy.AllowEmailScanning",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow Full Scan on Network Drives",name:"Policy.AllowFullScanNetwork",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow Full Scan on Removable Drives",name:"Policy.AllowFullScanRemovable",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow Script Scanning",name:"Policy.AllowScriptScan",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow Intrusion Prevention System",name:"Policy.AllowIPS",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Enable Low CPU priority",name:"Policy.LowCPU",formControl:e})]}),(0,s.jsxs)(i.A,{size:{md:6,xs:12},children:[(0,s.jsx)(d.A,{type:"switch",label:"Allow scanning of downloaded files",name:"Policy.AllowDownloadable",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow Realtime monitoring",name:"Policy.AllowRealTime",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow scanning of mapped drives",name:"Policy.AllowNetwork",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Allow users to access UI",name:"Policy.AllowUI",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Enable Network Protection in Block Mode",name:"Policy.NetworkProtectionBlock",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Enable Network Protection in Audit Mode",name:"Policy.NetworkProtectionAudit",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Check Signatures before scan",name:"Policy.CheckSigs",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Disable Catchup Full Scan",name:"Policy.DisableCatchupFullScan",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Disable Catchup Quick Scan",name:"Policy.DisableCatchupQuickScan",formControl:e})]}),(0,s.jsxs)(i.A,{size:{xs:12},children:[(0,s.jsx)(n.A,{variant:"subtitle1",children:"Assign to Group"}),(0,s.jsx)(d.A,{type:"radio",label:"",name:"Policy.AssignTo",options:[{label:"Do not assign",value:"none"},{label:"Assign to all users",value:"allLicensedUsers"},{label:"Assign to all devices",value:"AllDevices"},{label:"Assign to all users and devices",value:"AllDevicesAndUsers"}],formControl:e,validators:{required:"Assignment must be selected"},row:!0})]})]})})]}),(0,s.jsx)(t.A,{sx:{my:2}}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsx)(d.A,{type:"switch",label:"Show Exclusion Policy Options",name:"showExclusionPolicy",formControl:e})}),(0,s.jsxs)(A.A,{formControl:e,field:"showExclusionPolicy",compareType:"is",compareValue:!0,children:[(0,s.jsxs)(i.A,{size:{xs:12},children:[(0,s.jsx)(n.A,{variant:"h6",children:"Exclusion Policy"}),(0,s.jsx)(n.A,{variant:"subtitle1",children:"Configure Defender Exclusions"})]}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsx)(p.q,{formControl:e,name:"Exclusion.excludedExtensions",label:"Excluded Extensions",mode:"simple",placeholder:"e.g., txt, log, tmp",validators:{}})}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsx)(p.q,{formControl:e,name:"Exclusion.excludedPaths",label:"Excluded Paths",mode:"simple",placeholder:"e.g., C:\\temp, C:\\Program Files\\App",validators:{}})}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsx)(p.q,{formControl:e,name:"Exclusion.excludedProcesses",label:"Excluded Processes",mode:"simple",placeholder:"e.g., notepad.exe, chrome.exe",validators:{}})}),(0,s.jsxs)(i.A,{size:{xs:12},children:[(0,s.jsx)(n.A,{variant:"subtitle1",children:"Assign to Group"}),(0,s.jsx)(d.A,{type:"radio",label:"",name:"Exclusion.AssignTo",options:[{label:"Do not assign",value:"none"},{label:"Assign to all users",value:"allLicensedUsers"},{label:"Assign to all devices",value:"AllDevices"},{label:"Assign to all users and devices",value:"AllDevicesAndUsers"}],formControl:e,validators:{required:"Assignment must be selected"},row:!0})]})]}),(0,s.jsx)(t.A,{sx:{my:2}}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsx)(d.A,{type:"switch",label:"Show ASR Options",name:"showASR",formControl:e})}),(0,s.jsxs)(A.A,{formControl:e,field:"showASR",compareType:"is",compareValue:!0,children:[(0,s.jsxs)(i.A,{size:{xs:12},children:[(0,s.jsx)(n.A,{variant:"h6",children:"ASR Rules"}),(0,s.jsx)(n.A,{variant:"subtitle1",children:"Set Attack Surface Reduction Rules"}),(0,s.jsx)(d.A,{type:"radio",label:"",name:"ASR.Mode",options:[{label:"Block mode",value:"block"},{label:"Audit mode",value:"audit"},{label:"Warn mode",value:"warn"}],formControl:e,validators:{required:"Mode must be selected"},row:!0})]}),(0,s.jsx)(i.A,{size:{xs:12},children:(0,s.jsxs)(i.A,{container:!0,spacing:2,children:[(0,s.jsxs)(i.A,{size:{md:6,xs:12},children:[(0,s.jsx)(d.A,{type:"switch",label:"Block execution of potentially obfuscated scripts",name:"ASR.BlockObfuscatedScripts",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block Adobe Reader from creating child processes",name:"ASR.BlockAdobeChild",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block Win32 API calls from Office macros",name:"ASR.BlockWin32Macro",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block credential stealing from the Windows local security authority subsystem",name:"ASR.BlockCredentialStealing",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block process creations originating from PSExec and WMI commands",name:"ASR.BlockPSExec",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block persistence through WMI event subscription",name:"ASR.WMIPersistence",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block use of copied or impersonated system tools",name:"ASR.BlockSystemTools",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block Office applications from creating executable content",name:"ASR.BlockOfficeExes",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block Office applications from injecting code into other processes",name:"ASR.BlockOfficeApps",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block rebooting machine in Safe Mode",name:"ASR.BlockSafeMode",formControl:e})]}),(0,s.jsxs)(i.A,{size:{md:6,xs:12},children:[(0,s.jsx)(d.A,{type:"switch",label:"Block executable files from running unless they meet a prevalence, age, or trusted list criterion",name:"ASR.BlockYoungExe",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block JavaScript or VBScript from launching downloaded executable content",name:"ASR.blockJSVB",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block Webshell creation for Servers",name:"ASR.BlockWebshellForServers",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block Office communication application from creating child processes",name:"ASR.blockOfficeComChild",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block all Office applications from creating child processes",name:"ASR.blockOfficeChild",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block untrusted and unsigned processes that run from USB",name:"ASR.BlockUntrustedUSB",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Use advanced protection against ransomware",name:"ASR.EnableRansomwareVac",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block executable content from email client and webmail",name:"ASR.BlockExesMail",formControl:e}),(0,s.jsx)(d.A,{type:"switch",label:"Block abuse of exploited vulnerable signed drivers (Device)",name:"ASR.BlockUnsignedDrivers",formControl:e})]}),(0,s.jsxs)(i.A,{size:{xs:12},children:[(0,s.jsx)(n.A,{variant:"subtitle1",children:"Assign to Group"}),(0,s.jsx)(d.A,{type:"radio",label:"",name:"ASR.AssignTo",options:[{label:"Do not assign",value:"none"},{label:"Assign to all users",value:"allLicensedUsers"},{label:"Assign to all devices",value:"AllDevices"},{label:"Assign to all users and devices",value:"AllDevicesAndUsers"}],formControl:e,validators:{required:"Assignment must be selected"},row:!0})]})]})})]})]})]})};x.getLayout=e=>(0,s.jsx)(a.P,{children:e});let f=x},90240:(e,l,o)=>{"use strict";o.d(l,{A:()=>y});var s=o(37876),n=o(89099),t=o(67578),i=o(86650),r=o(22474),a=o(47737),c=o(94810),d=o(77018),m=o(54538),A=o(24933),p=o(17675),x=o(42120),f=o(22322),h=o(68723),u=o(14232),b=o(88992),j=o(2303);let y=e=>{let{title:l,backButtonTitle:o,titleButton:y,formPageType:w="Add",children:C,queryKey:v,formControl:S,postUrl:g,customDataformatter:k,resetForm:E=!1,hideBackButton:P=!1,hidePageType:D=!1,hideTitle:R=!1,hideSubmit:B=!1,allowResubmit:z=!1,addedButtons:O,...M}=e,T=(0,n.useRouter)(),U=(0,f.nN)({datafromUrl:!0,relatedQueryKeys:v}),{isValid:N,isDirty:q}=(0,b.lN)({control:S.control});return(0,u.useEffect)(()=>{if(delete T.query.tenantFilter,T.query){let e={...S.getValues(),...T.query};S.reset(e)}},[T]),(0,u.useEffect)(()=>{U.isSuccess&&E&&S.reset()},[U.isSuccess]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.v,{title:l}),(0,s.jsx)(t.A,{sx:{flexGrow:1,py:4},children:(0,s.jsx)(i.A,{maxWidth:"lg",children:(0,s.jsxs)(r.A,{spacing:4,children:[!R&&(0,s.jsxs)(r.A,{spacing:2,children:[!P&&(0,s.jsx)("div",{children:(0,s.jsx)(a.A,{color:"inherit",onClick:()=>{T.back()},startIcon:(0,s.jsx)(c.A,{fontSize:"small",children:(0,s.jsx)(x.A,{})}),children:o})}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)(d.A,{variant:"h4",children:[!D&&(0,s.jsxs)(s.Fragment,{children:[w," - "]}),l]}),y&&y]})]}),(0,s.jsxs)(m.A,{children:[(0,s.jsxs)(A.A,{children:[C,(0,s.jsx)(h.v,{apiObject:U})]}),!B&&(0,s.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,s.jsxs)(r.A,{spacing:2,direction:"row",children:[O&&O,(0,s.jsx)(a.A,{disabled:U.isPending||!N||!z&&!q,onClick:S.handleSubmit(()=>{if(S.trigger(),!N)return;let e=k?k(S.getValues()):S.getValues();Object.keys(e).forEach(l=>{(""===e[l]||null===e[l])&&delete e[l]}),U.mutate({url:g,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var l=l=>e(e.s=l);e.O(0,[636,6593,8792],()=>l(4649)),_N_E=e.O()}]);