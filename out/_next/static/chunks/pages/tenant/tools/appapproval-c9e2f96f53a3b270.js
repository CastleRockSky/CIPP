(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9057],{20371:(e,p,i)=>{"use strict";i.r(p),i.d(p,{default:()=>v});var a=i(37876),l=i(12435),t=i(63968),s=i(40971),n=i(31748),o=i(22474),d=i(46061),r=i(37832),m=i(59568),c=i(58105),A=i(66113),u=i(46402),y=i(68396),f=i(88992),T=i(5419);let h=e=>{var p;let{postUrl:i,formControl:l,onPreviousStep:t,onNextStep:s,currentStep:n}=e,h=(0,f.FH)({control:l.control,name:"selectedTemplate"});return(0,a.jsxs)(o.A,{spacing:2,children:[(0,a.jsx)(c.A,{type:"radio",name:"configMode",label:"Application Configuration Mode",defaultValue:"template",options:[{value:"template",label:"Use App Approval Template"},{value:"manual",label:"Manual Configuration"}],formControl:l}),(0,a.jsx)(u.A,{field:"configMode",compareType:"is",compareValue:"template",formControl:l,children:(0,a.jsxs)(o.A,{spacing:2,children:[(0,a.jsx)(d.A,{severity:"info",children:"Select an app approval template to deploy. Templates contain predefined permissions that will be applied to the application."}),(0,a.jsx)(c.A,{type:"autoComplete",name:"selectedTemplate",label:"Select App Template",api:{url:"/api/ListAppApprovalTemplates",queryKey:"appApprovalTemplates",labelField:e=>"".concat(e.TemplateName),valueField:"TemplateId",addedField:{AppId:"AppId",AppName:"AppName",AppType:"AppType",GalleryTemplateId:"GalleryTemplateId",GalleryInformation:"GalleryInformation",PermissionSetId:"PermissionSetId",PermissionSetName:"PermissionSetName",Permissions:"Permissions",ApplicationManifest:"ApplicationManifest"},showRefresh:!0},validators:{required:"A template is required"},formControl:l,multiple:!1}),(null==h?void 0:null===(p=h.addedFields)||void 0===p?void 0:p.AppName)&&(0,a.jsxs)(o.A,{spacing:2,children:[(0,a.jsx)(T.a,{variant:"outlined",showDivider:!1,propertyItems:[{label:"App Name",value:h.addedFields.AppName},{label:"App ID",value:h.addedFields.AppId},{label:"Template Type",value:"GalleryTemplate"===(h.addedFields.AppType||"EnterpriseApp")?"Gallery Template":"ApplicationManifest"===(h.addedFields.AppType||"EnterpriseApp")?"Application Manifest":"Enterprise App"},{label:"Permission Set",value:"GalleryTemplate"===(h.addedFields.AppType||"EnterpriseApp")?"Auto-Consent":"ApplicationManifest"===(h.addedFields.AppType||"EnterpriseApp")?"Defined in Manifest":h.addedFields.PermissionSetName}],title:"Template Details"}),"EnterpriseApp"===(h.addedFields.AppType||"EnterpriseApp")?(0,a.jsx)(y.A,{permissions:h.addedFields.Permissions,title:"Template Permissions",maxHeight:500,showAppIds:!0}):"ApplicationManifest"===(h.addedFields.AppType||"EnterpriseApp")?(0,a.jsx)(y.A,{permissions:null,title:"Application Manifest",maxHeight:500,showAppIds:!1,applicationManifest:h.addedFields.ApplicationManifest}):(0,a.jsx)(y.A,{permissions:null,title:"Gallery Template Info",maxHeight:500,showAppIds:!0,galleryTemplate:{label:h.addedFields.AppName,value:h.addedFields.GalleryTemplateId||h.addedFields.AppId,addedFields:{displayName:h.addedFields.AppName,applicationId:h.addedFields.AppId,...h.addedFields.GalleryInformation||{description:"Gallery template for ".concat(h.addedFields.AppName||"application"),publisher:"Microsoft Gallery",categories:["Application"],supportedSingleSignOnModes:["saml","password","oidc"],supportedProvisioningTypes:["sync"]}}}})]})]})}),(0,a.jsxs)(u.A,{field:"configMode",compareType:"is",compareValue:"manual",formControl:l,children:[(0,a.jsx)(m.A,{container:!0,spacing:3,children:(0,a.jsx)(m.A,{size:12,children:(0,a.jsx)(c.A,{type:"textField",label:"Application ID",validators:{validate:e=>(0,A.n)(e,"guid")},name:"AppId",formControl:l})})}),(0,a.jsx)(c.A,{type:"switch",label:"Copy permissions from the existing application. This app must have been added to the partner tenant first.",name:"CopyPermissions",formControl:l}),(0,a.jsx)(u.A,{field:"CopyPermissions",compareType:"is",compareValue:!1,formControl:l,children:(0,a.jsx)(c.A,{type:"cippDataTable",name:"permissions",title:"Permissions",label:"Select your permissions",queryKey:"GraphpermissionsList",api:{url:"/permissionsList.json"},simpleColumns:["displayName","description"],formControl:l})})]}),(0,a.jsx)(r.A,{postUrl:i,currentStep:n,onPreviousStep:t,onNextStep:s,formControl:l})]})},x=()=>{let e=[{title:"Step 1",description:"Tenant Selection",component:n.d,componentProps:{preText:(0,a.jsx)(d.A,{severity:"info",children:"Did you know you can also deploy applications by using our standards? Use the standard if you have to deploy an application to all your tenants"}),allTenants:!1,type:"multiple"}},{title:"Step 2",description:"App Selection",component:h},{title:"Step 3",description:"Confirmation",component:t.J}];return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.A,{initialState:{configMode:"template",CopyPermissions:!0},steps:e,postUrl:"/api/ExecAddMultiTenantApp",wizardTitle:"Application Approval Wizard"})})};x.getLayout=e=>(0,a.jsx)(l.P,{children:e});let v=x},31748:(e,p,i)=>{"use strict";i.d(p,{d:()=>n});var a=i(37876),l=i(22474),t=i(37832),s=i(35764);let n=e=>{let{allTenants:p,type:i="single",valueField:n="defaultDomainName",onNextStep:o,formControl:d,currentStep:r,onPreviousStep:m,preText:c}=e;return(0,a.jsxs)(l.A,{spacing:3,children:[c,(0,a.jsx)("label",{children:"Select a tenant"}),(0,a.jsx)(s.w,{valueField:n,formControl:d,allTenants:p,type:i,preselectedEnabled:!0}),(0,a.jsx)(t.L,{currentStep:r,onPreviousStep:m,onNextStep:o,formControl:d})]})}},48789:(e,p,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/tools/appapproval",function(){return i(20371)}])}},e=>{var p=p=>e(e.s=p);e.O(0,[8396,636,6593,8792],()=>p(48789)),_N_E=e.O()}]);