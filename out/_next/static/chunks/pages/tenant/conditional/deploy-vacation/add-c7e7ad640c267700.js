(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4871],{24448:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/conditional/deploy-vacation/add",function(){return a(84023)}])},42120:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var i=a(93944),l=a(37876);let s=(0,i.A)((0,l.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},58181:(e,t,a)=>{"use strict";a.d(t,{H:()=>r});var i=a(37876),l=a(58105),s=a(88992),n=a(17825);let r=e=>{let{formControl:t,name:a,label:r,allTenants:d=!1,multiple:c=!1,type:o="multiple",select:u,addedField:m,valueField:x,dataFilter:p=null,...h}=e,j=(0,s.FH)({control:t.control,name:"tenantFilter"}),y=(0,n.t)().currentTenant;return(0,i.jsx)(l.o,{name:a,label:r,type:"autoComplete",formControl:t,multiple:c,api:{addedField:m,tenantFilter:j?j.value:y,url:"/api/ListGraphRequest",dataKey:"Results",labelField:e=>"".concat(e.displayName," (").concat(e.userPrincipalName,")"),valueField:x||"id",queryKey:"ListUsers-".concat((null==j?void 0:j.value)?j.value:y,"-").concat(u||"default"),data:{Endpoint:"users",manualPagination:!0,$select:u||"id,userPrincipalName,displayName",$count:!0,$orderby:"displayName",$top:999},dataFilter:e=>p?e.filter(p):e},creatable:!1,...h})}},84023:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var i=a(37876);a(14232);var l=a(22474),s=a(77018),n=a(71538),r=a(59568),d=a(90240),c=a(12435),o=a(88992),u=a(58105),m=a(58181),x=a(35764);let p=()=>{let e=(0,o.mN)({mode:"onChange",defaultValues:{vacation:!0}}),t=(0,o.FH)({control:e.control,name:"tenantFilter"}),a=(null==t?void 0:t.value)||t;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(d.A,{queryKey:"CippFormPage",formControl:e,title:"Add Vacation Mode",backButtonTitle:"Vacation Modes",postUrl:"/api/ExecCAExclusion",customDataformatter:e=>{var t,a;return{tenantFilter:(null===(t=e.tenantFilter)||void 0===t?void 0:t.value)||e.tenantFilter,Users:e.Users,PolicyId:null===(a=e.PolicyId)||void 0===a?void 0:a.value,StartDate:e.startDate,EndDate:e.endDate,vacation:!0}},children:(0,i.jsxs)(l.A,{spacing:3,sx:{my:2},children:[(0,i.jsx)(s.A,{variant:"body1",sx:{mb:2},children:"Vacation mode adds scheduled tasks to add and remove users from Conditional Access (CA) exclusions for a specific period of time. Select the CA policy and the date range."}),(0,i.jsxs)(r.A,{container:!0,spacing:2,children:[(0,i.jsx)(r.A,{size:{xs:12},children:(0,i.jsx)(x.w,{label:"Select Tenant",formControl:e,type:"single",allTenants:!0,required:!0,preselectedEnabled:!0})}),(0,i.jsx)(r.A,{size:{xs:12},children:(0,i.jsx)(n.A,{})}),(0,i.jsx)(r.A,{size:{xs:12},children:(0,i.jsx)(m.H,{label:a?"Users in ".concat(a):"Select a tenant first",formControl:e,name:"Users",multiple:!0,addedField:{userPrincipalName:"userPrincipalName",displayName:"displayName"},validators:{required:"Picking a user is required"},required:!0,disabled:!a})}),(0,i.jsx)(r.A,{size:{xs:12},children:(0,i.jsx)(u.A,{type:"autoComplete",label:a?"Conditional Access Policies in ".concat(a):"Select a tenant first",name:"PolicyId",api:a?{queryKey:"ListConditionalAccessPolicies-".concat(a),url:"/api/ListConditionalAccessPolicies",data:{tenantFilter:a},labelField:e=>"".concat(e.displayName),valueField:"id"}:null,multiple:!1,formControl:e,validators:{validate:e=>null!=e&&!!e.value||"Picking a policy is required"},required:!0,disabled:!a})}),(0,i.jsx)(r.A,{size:{md:6,xs:12},children:(0,i.jsx)(u.A,{type:"datePicker",label:"Scheduled Start Date",name:"startDate",dateTimeType:"dateTime",formControl:e,required:!0,validators:{validate:e=>!!e||"Start date is required"}})}),(0,i.jsx)(r.A,{size:{md:6,xs:12},children:(0,i.jsx)(u.A,{type:"datePicker",label:"Scheduled End Date",name:"endDate",dateTimeType:"dateTime",formControl:e,required:!0,validators:{validate:t=>{let a=e.getValues("startDate");return t?!(a&&t&&new Date(1e3*t)<new Date(1e3*a))||"End date must be after start date":"End date is required"}}})})]})]})})})};p.getLayout=e=>(0,i.jsx)(c.P,{children:e});let h=p},90240:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});var i=a(37876),l=a(89099),s=a(67578),n=a(86650),r=a(22474),d=a(47737),c=a(94810),o=a(77018),u=a(54538),m=a(24933),x=a(17675),p=a(42120),h=a(22322),j=a(68723),y=a(14232),v=a(88992),A=a(2303);let f=e=>{let{title:t,backButtonTitle:a,titleButton:f,formPageType:b="Add",children:g,queryKey:C,formControl:F,postUrl:P,customDataformatter:N,resetForm:q=!1,hideBackButton:E=!1,hidePageType:k=!1,hideTitle:S=!1,hideSubmit:w=!1,allowResubmit:D=!1,addedButtons:T,..._}=e,z=(0,l.useRouter)(),V=(0,h.nN)({datafromUrl:!0,relatedQueryKeys:C}),{isValid:U,isDirty:L}=(0,v.lN)({control:F.control});return(0,y.useEffect)(()=>{if(delete z.query.tenantFilter,z.query){let e={...F.getValues(),...z.query};F.reset(e)}},[z]),(0,y.useEffect)(()=>{V.isSuccess&&q&&F.reset()},[V.isSuccess]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(A.v,{title:t}),(0,i.jsx)(s.A,{sx:{flexGrow:1,py:4},children:(0,i.jsx)(n.A,{maxWidth:"lg",children:(0,i.jsxs)(r.A,{spacing:4,children:[!S&&(0,i.jsxs)(r.A,{spacing:2,children:[!E&&(0,i.jsx)("div",{children:(0,i.jsx)(d.A,{color:"inherit",onClick:()=>{z.back()},startIcon:(0,i.jsx)(c.A,{fontSize:"small",children:(0,i.jsx)(p.A,{})}),children:a})}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)(o.A,{variant:"h4",children:[!k&&(0,i.jsxs)(i.Fragment,{children:[b," - "]}),t]}),f&&f]})]}),(0,i.jsxs)(u.A,{children:[(0,i.jsxs)(m.A,{children:[g,(0,i.jsx)(j.v,{apiObject:V})]}),!w&&(0,i.jsx)(x.A,{sx:{justifyContent:"flex-end"},children:(0,i.jsxs)(r.A,{spacing:2,direction:"row",children:[T&&T,(0,i.jsx)(d.A,{disabled:V.isPending||!U||!D&&!L,onClick:F.handleSubmit(()=>{if(F.trigger(),!U)return;let e=N?N(F.getValues()):F.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),V.mutate({url:P,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(24448)),_N_E=e.O()}]);