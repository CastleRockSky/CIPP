(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7828],{25551:e=>{"use strict";e.exports=JSON.parse('[{"label":"Application Administrator","value":"9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3"},{"label":"Authentication Policy Administrator","value":"0526716b-113d-4c15-b2c8-68e3c22b9f80"},{"label":"Cloud App Security Administrator","value":"892c5842-a9a6-463a-8041-72aa08ca3cf6"},{"label":"Cloud Device Administrator","value":"7698a772-787b-4ac8-901f-60d6b08affd2"},{"label":"Exchange Administrator","value":"29232cdf-9323-42fd-ade2-1d097af3e4de"},{"label":"Intune Administrator","value":"3a2c62db-5318-420d-8d74-23affee5d9d5"},{"label":"Privileged Authentication Administrator","value":"7be44c8a-adaf-4e2a-84d6-ab2649e08a13"},{"label":"Privileged Role Administrator","value":"e8611ab8-c189-46e8-94e1-60213ab1f814"},{"label":"Security Administrator","value":"194ae4cb-b126-40b2-bd5b-6091b380977d"},{"label":"SharePoint Administrator","value":"f28a1f50-f6e7-4571-818b-6a12f2af6b6c"},{"label":"Teams Administrator","value":"69091246-20e8-4a56-aa4d-066075b2a7a8"},{"label":"User Administrator","value":"fe930be7-5e62-47db-91af-98c3a49a38b1"}]')},26490:(e,i,t)=>{"use strict";t.d(i,{A:()=>n});var a=t(93944),l=t(37876);let n=(0,a.A)((0,l.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l4 4 4-4H6c0-3.86 3.14-7 7-7s7 3.14 7 7-3.14 7-7 7c-1.9 0-3.62-.76-4.88-1.99L6.7 18.42C8.32 20.01 10.55 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m2 8v-1c0-1.1-.9-2-2-2s-2 .9-2 2v1c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-3c0-.55-.45-1-1-1m-1 0h-2v-1c0-.55.45-1 1-1s1 .45 1 1z"}),"LockReset")},27493:(e,i,t)=>{"use strict";t.r(i),t.d(i,{default:()=>D});var a=t(37876),l=t(12435),n=t(89099),s=t(22322),o=t(86508),r=t(50387),d=t(64431),c=t(89037),u=t(82179),h=t(59568),p=t(43225),v=t(41412),m=t(5419),x=t(35936),A=t(31540),f=t(46061),g=t(94760),b=t(25551),j=t(84177),y=t(99913),R=t(14232),w=t(77759);let T=()=>{var e,i,t,l,T,D,P,I,C,S,M,L,E,k,G,O,z,N,_,q,F,H;let{id:V}=(0,n.useRouter)().query,[W,B]=(0,R.useState)([]),[U,K]=(0,R.useState)({}),$=(0,s.R_)({url:"/api/ListGraphRequest?Endpoint=tenantRelationships/delegatedAdminRelationships/".concat(V),queryKey:"ListRelationships-".concat(V)}),J=e=>e.startsWith("MLT_")?"Microsoft-Led Transition (MLT)":e.startsWith("CIPP_")||e.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/)?"CIPP":e.startsWith("LHSetup_")?"Lighthouse":"Manual",X=$.isSuccess?(null!==(H=null===(l=$.data)||void 0===l?void 0:null===(t=l.Results)||void 0===t?void 0:null===(i=t[0])||void 0===i?void 0:null===(e=i.customer)||void 0===e?void 0:e.displayName)&&void 0!==H?H:"No Customer Set")+" - "+(null===(P=$.data)||void 0===P?void 0:null===(D=P.Results)||void 0===D?void 0:null===(T=D[0])||void 0===T?void 0:T.displayName):"Loading...",Q=$.isSuccess?[{icon:(0,a.jsx)(y.A,{}),text:(0,a.jsxs)(a.Fragment,{children:["Created"," ",(0,a.jsx)(p.z,{data:new Date(null===(S=$.data)||void 0===S?void 0:null===(C=S.Results)||void 0===C?void 0:null===(I=C[0])||void 0===I?void 0:I.createdDateTime)})," "]})}]:[];return(0,R.useEffect)(()=>{if($.isSuccess){let r=null==$?void 0:null===(i=$.data)||void 0===i?void 0:null===(e=i.Results)||void 0===e?void 0:e[0];K(r);var e,i,t,l,n,s,o=[{label:"Customer",value:null!==(n=null==r?void 0:null===(t=r.customer)||void 0===t?void 0:t.displayName)&&void 0!==n?n:"N/A"},{label:"Tenant ID",value:null!==(s=null==r?void 0:null===(l=r.customer)||void 0===l?void 0:l.tenantId)&&void 0!==s?s:"N/A"},{label:"Relationship Type",value:J(null==r?void 0:r.displayName)},{label:"Relationship ID",value:(0,a.jsxs)(a.Fragment,{children:[null==r?void 0:r.id,(0,a.jsx)(j.R,{text:null==r?void 0:r.id})]})},{label:"Status",value:(0,v.i)(null==r?void 0:r.status,"status")},{label:"Auto Extend Duration",value:(null==r?void 0:r.autoExtendDuration)=="PT0S"?"Not eligible for auto-extend":(0,x.i)(null==r?void 0:r.autoExtendDuration,"autoExtendDuration","text")},{label:"Activated Date",value:(0,x.i)(null==r?void 0:r.activatedDateTime,"activatedDateTime","date")},{label:"Last Modified Date",value:(0,x.i)(null==r?void 0:r.lastModifiedDateTime,"lastModifiedDateTime","date")},{label:"End Date",value:(0,x.i)(null==r?void 0:r.endDateTime,"endDateTime","date")}];(null==r?void 0:r.status)==="approvalPending"&&o.push({label:"Invite URL",value:(0,x.i)("https://admin.microsoft.com/AdminPortal/Home#/partners/invitation/granularAdminRelationships/"+(null==r?void 0:r.id),"InviteUrl","url")}),B(o)}},[$.isSuccess]),(0,a.jsxs)(r.f,{tabOptions:d,title:X,subtitle:Q,isFetching:$.isLoading,actions:(0,w.A)(),actionsData:U,backUrl:"/tenant/gdap-management/relationships",children:[$.isLoading&&(0,a.jsx)(o.A,{layout:[2,1,2,2]}),$.isSuccess&&(0,a.jsx)(c.A,{sx:{flexGrow:1,pt:2},children:(0,a.jsxs)(u.A,{spacing:3,children:[(null==$?void 0:null===(E=$.data)||void 0===E?void 0:null===(L=E.Results)||void 0===L?void 0:null===(M=L[0])||void 0===M?void 0:M.displayName.startsWith("MLT_"))&&(0,a.jsx)(f.A,{severity:"warning",children:"This relationship is a Microsoft-Led Transition (MLT) relationship and only has Read permissions."}),(null==$?void 0:null===(N=$.data)||void 0===N?void 0:null===(z=N.Results)||void 0===z?void 0:null===(O=z[0])||void 0===O?void 0:null===(G=O.accessDetails)||void 0===G?void 0:null===(k=G.unifiedRoles)||void 0===k?void 0:k.find(e=>"62e90394-69f5-4237-9190-012177145e10"===e.roleDefinitionId))&&(0,a.jsx)(f.A,{severity:"warning",children:"This relationship has Global Administrator access and is not eligible for automatic extension."}),b.every(e=>{var i,t,a,l,n;return null==$?void 0:null===(n=$.data)||void 0===n?void 0:null===(l=n.Results)||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:null===(t=a.accessDetails)||void 0===t?void 0:null===(i=t.unifiedRoles)||void 0===i?void 0:i.some(i=>i.roleDefinitionId===e.value)})?(0,a.jsx)(f.A,{severity:"success",children:"This relationship has all the CIPP recommended roles."}):(0,a.jsxs)(f.A,{severity:"warning",children:["This relationship does not have all the CIPP recommended roles. See the"," ",(0,a.jsx)(g.A,{href:"https://docs.cipp.app/setup/gdap/recommended-roles",target:"_blank",rel:"noreferrer",children:"Recommended Roles"})," ","documentation for more information."]}),(0,a.jsxs)(h.A,{container:!0,spacing:2,children:[(0,a.jsx)(h.A,{size:{xs:12,md:8},children:(0,a.jsx)(m.a,{layout:"double",title:"Relationship Details",showDivider:!1,propertyItems:W})}),(0,a.jsx)(h.A,{size:{xs:12,md:4},children:(0,a.jsx)(A.x,{title:"Approved Roles",simple:!0,data:null==$?void 0:null===(F=$.data)||void 0===F?void 0:null===(q=F.Results)||void 0===q?void 0:null===(_=q[0])||void 0===_?void 0:_.accessDetails.unifiedRoles,simpleColumns:["roleDefinitionId"]})})]})]})})]})};T.getLayout=e=>(0,a.jsx)(l.P,{children:e});let D=T},46041:(e,i,t)=>{"use strict";t.d(i,{A:()=>l});var a=t(14232);let l=a.forwardRef(function(e,i){let{title:t,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":l},n),t?a.createElement("title",{id:l},t):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))})},46091:(e,i,t)=>{"use strict";t.d(i,{A:()=>n});var a=t(93944),l=t(37876);let n=(0,a.A)((0,l.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"OpenInNew")},46950:(e,i,t)=>{"use strict";t.d(i,{A:()=>n});var a=t(93944),l=t(37876);let n=(0,a.A)([(0,l.jsx)("path",{d:"M17 11c.34 0 .67.04 1 .09V6.27L10.5 3 3 6.27v4.91c0 4.54 3.2 8.79 7.5 9.82.55-.13 1.08-.32 1.6-.55-.69-.98-1.1-2.17-1.1-3.45 0-3.31 2.69-6 6-6"},"0"),(0,l.jsx)("path",{d:"M17 13c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 1.38c.62 0 1.12.51 1.12 1.12s-.51 1.12-1.12 1.12-1.12-.51-1.12-1.12.5-1.12 1.12-1.12m0 5.37c-.93 0-1.74-.46-2.24-1.17.05-.72 1.51-1.08 2.24-1.08s2.19.36 2.24 1.08c-.5.71-1.31 1.17-2.24 1.17"},"1")],"AdminPanelSettings")},50387:(e,i,t)=>{"use strict";t.d(i,{f:()=>y});var a=t(37876),l=t(14232),n=t(14e3),s=t(89099),o=t(95062),r=t.n(o),d=t(46041),c=t(67578),u=t(86650),h=t(22474),p=t(47737),v=t(94810),m=t(77018),x=t(76776),A=t(8578),f=t(76626),g=t(71538),b=t(95449),j=t(89273);let y=e=>{let{children:i,tabOptions:t,title:o,subtitle:r,actions:y,actionsData:R,isFetching:w=!1,backUrl:T}=e,D=(0,j.A)(e=>e.breakpoints.down("md")),P=(0,s.useRouter)(),I=(0,n.usePathname)(),C=P.query,S=(0,l.useCallback)((e,i)=>{P.push({pathname:i,query:C},void 0,{shallow:!0})},[P]),M=t.find(e=>e.path===I);return(0,a.jsx)(c.A,{sx:{flexGrow:1,py:4},children:(0,a.jsx)(u.A,{maxWidth:"xl",sx:{height:"100%"},children:(0,a.jsxs)(h.A,{spacing:1,sx:{height:"100%"},children:[(0,a.jsxs)(h.A,{spacing:2,children:[(0,a.jsx)("div",{children:(0,a.jsx)(p.A,{color:"inherit",onClick:()=>T?P.push(T):P.back(),startIcon:(0,a.jsx)(v.A,{fontSize:"small",children:(0,a.jsx)(d.A,{})}),children:"Back to previous page"})}),(0,a.jsxs)(h.A,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:1,children:[(0,a.jsxs)(h.A,{spacing:1,children:[(0,a.jsx)(h.A,{alignItems:"center",direction:"row",spacing:1,justifyContent:"space-between",children:(0,a.jsx)(m.A,{variant:D?"h6":"h4",children:o})}),w?(0,a.jsx)(x.A,{variant:"text",width:200}):r&&(0,a.jsx)(h.A,{alignItems:"center",flexWrap:"wrap",direction:"row",spacing:2,children:r.map((e,i)=>(0,a.jsxs)(h.A,{alignItems:"center",direction:"row",spacing:1,children:[(0,a.jsx)(v.A,{fontSize:"small",children:e.icon}),(0,a.jsx)(m.A,{color:"text.secondary",variant:"body2",children:e.text})]},i))})]}),y&&y.length>0&&(0,a.jsx)(b.$,{actions:y,data:R,disabled:w})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(A.A,{onChange:S,value:null==M?void 0:M.path,variant:"scrollable",children:t.map(e=>(0,a.jsx)(f.A,{label:e.label,value:e.path},e.path))}),(0,a.jsx)(g.A,{})]})]}),(0,a.jsx)(c.A,{sx:!D&&{flexGrow:1,overflow:"auto",height:"calc(100vh - 400px)"},children:i})]})})})};y.propTypes={children:r().node,tabOptions:r().arrayOf(r().shape({label:r().string.isRequired,path:r().string.isRequired})).isRequired,title:r().string.isRequired,subtitle:r().arrayOf(r().shape({icon:r().node.isRequired,text:r().string.isRequired})),actions:r().arrayOf(r().shape({label:r().string.isRequired,handler:r().func.isRequired})),isFetching:r().bool}},64431:e=>{"use strict";e.exports=JSON.parse('[{"label":"Overview","path":"/tenant/gdap-management/relationships/relationship"},{"label":"Mappings","path":"/tenant/gdap-management/relationships/relationship/mappings"}]')},76465:(e,i,t)=>{"use strict";t.d(i,{A:()=>n});var a=t(93944),l=t(37876);let n=(0,a.A)((0,l.jsx)("path",{d:"m18 22-.01-6L14 12l3.99-4.01L18 2H6v6l4 4-4 3.99V22zM8 7.5V4h8v3.5l-4 4z"}),"HourglassBottom")},77759:(e,i,t)=>{"use strict";t.d(i,{A:()=>p});var a=t(37876),l=t(22875),n=t(7159),s=t(46091),o=t(76465),r=t(46950),d=t(26490);let c=(0,t(93944).A)((0,a.jsx)("path",{d:"M12 2 4 5v6.09c0 5.05 3.41 9.76 8 10.91 4.59-1.15 8-5.86 8-10.91V5zm3.5 12.09-1.41 1.41L12 13.42 9.91 15.5 8.5 14.09 10.59 12 8.5 9.91 9.91 8.5 12 10.59l2.09-2.09 1.41 1.41L13.42 12z"}),"GppBad");var u=t(77018),h=t(46061);let p=()=>[{label:"View Relationship",link:"/tenant/gdap-management/relationships/relationship?id=[id]",color:"primary",icon:(0,a.jsx)(l.A,{})},{label:"Start Onboarding",link:"/tenant/gdap-management/onboarding/start?id=[id]",color:"primary",icon:(0,a.jsx)(n.A,{}),showInActionsMenu:!0},{label:"Open Relationship in Partner Center",link:"https://partner.microsoft.com/en-us/dashboard/commerce2/customers/[customer.tenantId]/adminrelationships/[id]",color:"info",icon:(0,a.jsx)(s.A,{}),showInActionsMenu:!0},{label:"Enable automatic extension",type:"GET",url:"/api/ExecAutoExtendGDAP",data:{ID:"id"},confirmText:"Are you sure you want to enable auto-extend for this relationship?",color:"info",icon:(0,a.jsx)(o.A,{})},{label:"Remove Global Administrator from Relationship",type:"GET",url:"/api/ExecGDAPRemoveGArole",data:{GDAPID:"id"},confirmText:"Are you sure you want to remove Global Administrator from this relationship?",color:"danger",icon:(0,a.jsx)(r.A,{})},{label:"Reset Role Mapping",type:"POST",url:"/api/ExecGDAPAccessAssignment",icon:(0,a.jsx)(d.A,{}),data:{Id:"id",Action:"ResetMappings"},fields:[{name:"RoleTemplateId",label:"Role Template",placeholder:"Select a role template to apply to this relationship.",type:"select",api:{url:"/api/ExecGDAPRoleTemplate",queryKey:"GDAPRoleTemplate",dataKey:"Results",valueField:"TemplateId",labelField:"TemplateId",showRefresh:!0},required:!0,validators:{validate:e=>!!e||"Role Template is required"}}],confirmText:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{variant:"body1",children:"Are you sure you want to reset the role mappings for [customer.displayName]?"}),(0,a.jsxs)(h.A,{severity:"warning",children:["Resetting GDAP role mappings will perform the following actions:",(0,a.jsxs)("ul",{style:{paddingLeft:"15px"},children:[(0,a.jsx)("li",{children:"Remove groups assignments that are not part of the Role Template"}),(0,a.jsx)("li",{children:"Update existing group assignments to match the Role Template"}),(0,a.jsx)("li",{children:"Create new group assignments based on the Role Template"})]})]}),(0,a.jsx)(h.A,{severity:"info",children:"This is useful for fixing GDAP relationships that have overlapping roles or incorrect group assignments (e.g. using AdminAgents or HelpdeskAgents)."})]})},{label:"Terminate Relationship",type:"GET",url:"/api/ExecDeleteGDAPRelationship",data:{GDAPID:"id"},confirmText:"Are you sure you want to terminate this relationship?",color:"error",icon:(0,a.jsx)(c,{})}]},79743:(e,i,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/gdap-management/relationships/relationship",function(){return t(27493)}])},86508:(e,i,t)=>{"use strict";t.d(i,{A:()=>o});var a=t(37876),l=t(67578),n=t(76776),s=t(59568);let o=e=>{let{layout:i}=e;return(0,a.jsx)(l.A,{sx:{width:"100%",my:2},children:i.map((e,i)=>(0,a.jsx)(s.A,{container:!0,spacing:2,sx:{mb:2},children:Array.from({length:e}).map((t,l)=>(0,a.jsx)(s.A,{size:{xs:12/e},children:(0,a.jsx)(n.A,{variant:"rectangular",width:"100%"})},"skeleton-".concat(i,"-").concat(l)))},"row-".concat(i)))})}},95449:(e,i,t)=>{"use strict";t.d(i,{$:()=>x});var a=t(37876),l=t(54550),n=t(95062),s=t.n(n),o=t(47737),r=t(94810),d=t(52808),c=t(6003),u=t(93256),h=t(50221),p=t(14232),v=t(82836),m=t(79803);let x=e=>{var i;let{actions:t=[],label:n="Actions",data:s,queryKeys:x,...A}=e,f=(0,h.f)(),[g,b]=(0,p.useState)({data:{},action:{},ready:!1}),j=(0,v.s)(),y=(e,i)=>!e||null!=i&&!!i.condition&&!(null==i?void 0:i.condition(e));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.A,{onClick:f.handleOpen,ref:f.anchorRef,startIcon:(0,a.jsx)(r.A,{fontSize:"small",children:(0,a.jsx)(l.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap"},children:"Actions"}),(0,a.jsx)(d.A,{anchorEl:f.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:f.handleClose,open:f.open,transformOrigin:{horizontal:"right",vertical:"top"},children:null==t?void 0:t.filter(e=>!e.link||e.showInActionsMenu).map((e,i)=>(0,a.jsxs)(c.A,{disabled:y(s,e),onClick:()=>{b({data:s,action:e,ready:!0}),(null==e?void 0:e.noConfirm)&&e.customFunction?e.customFunction(s,e,{}):(j.handleOpen(),f.handleClose())},children:[(0,a.jsx)(r.A,{fontSize:"small",sx:{minWidth:"30px"},children:e.icon}),(0,a.jsx)(u.A,{children:e.label})]},i))}),g.ready&&(0,a.jsx)(m.B,{createDialog:j,title:"Confirmation",fields:null===(i=g.action)||void 0===i?void 0:i.fields,api:g.action,row:g.data,relatedQueryKeys:x})]})};x.propTypes={actions:s().array,label:s().string}},99913:(e,i,t)=>{"use strict";t.d(i,{A:()=>n});var a=t(93944),l=t(37876);let n=(0,a.A)([(0,l.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,l.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"Schedule")}},e=>{var i=i=>e(e.s=i);e.O(0,[636,6593,8792],()=>i(79743)),_N_E=e.O()}]);