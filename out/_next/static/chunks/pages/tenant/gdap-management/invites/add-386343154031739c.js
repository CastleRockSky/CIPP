(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7904],{36577:(e,t,i)=>{"use strict";i.d(t,{A:()=>A});var l=i(37876),n=i(89099),s=i(67578),a=i(86650),r=i(22474),o=i(47737),d=i(94810),c=i(77018),u=i(54538),h=i(42120),x=i(2303);let A=e=>{let{title:t,backButtonTitle:i="Back",children:A,cardSize:p="xl",hideTitleText:m=!1,hideBackButton:v=!1,noTenantInHead:j=!1,infoBar:g}=e,f=(0,n.useRouter)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.v,{title:t,noTenant:j}),(0,l.jsx)(s.A,{sx:{flexGrow:1,py:4},children:(0,l.jsx)(a.A,{maxWidth:p,children:(0,l.jsxs)(r.A,{spacing:2,children:[(0,l.jsxs)(r.A,{spacing:2,children:[(0,l.jsx)("div",{children:!v&&(0,l.jsx)(o.A,{color:"inherit",onClick:()=>{f.back()},startIcon:(0,l.jsx)(d.A,{fontSize:"small",children:(0,l.jsx)(h.A,{})}),children:i})}),!0!==m&&(0,l.jsx)("div",{children:(0,l.jsx)(c.A,{variant:"h4",children:t})})]}),g,(0,l.jsx)(u.A,{children:A})]})})})]})}},42120:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var l=i(93944),n=i(37876);let s=(0,l.A)((0,n.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},51232:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/gdap-management/invites/add",function(){return i(53934)}])},53934:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>S});var l=i(37876),n=i(12435),s=i(88992),a=i(58105),r=i(59568),o=i(36577),d=i(22322),c=i(31540),u=i(68723),h=i(24933),x=i(46061),A=i(77018),p=i(63009),m=i(34126),v=i(94760),j=i(47737),g=i(94810),f=i(7881),y=i(88326),P=i(37746),b=i(7957),I=i(17675),C=i(44681),D=i(14232),T=i(33862),R=i(87505),G=i(48230),k=i.n(G);let w=()=>{var e;let[t,i]=(0,D.useState)([]),[n,G]=(0,D.useState)(!1),w=(0,s.mN)({mode:"onChange",defaultValues:{inviteCount:1}}),S=(0,d.nN)({urlFromData:!0,relatedQueryKeys:["ListGDAPRoleTemplatesAutocomplete","ListGDAPRoleTemplates"]}),z=(0,d.R_)({url:"/api/ExecGDAPRoleTemplate",queryKey:"ListGDAPRoleTemplates"}),_=(0,s.FH)({control:w.control,name:"roleMappings"});(0,D.useEffect)(()=>{var e,t;(null==z?void 0:null===(t=z.data)||void 0===t?void 0:null===(e=t.Results)||void 0===e?void 0:e.length)===0?G(!0):G(!1)},[z.isSuccess]);let E=(0,d.nN)({urlFromData:!0,relatedQueryKeys:["GDAPInvite"]});return(0,D.useEffect)(()=>{var e;(null==E?void 0:null===(e=E.data)||void 0===e?void 0:e.length)>0&&i(e=>[...e,...E.data.map(e=>({...e.data.Invite,Message:e.data.Message}))].filter((e,t,i)=>t===i.findIndex(t=>t.InviteUrl===e.InviteUrl)))},[null==E?void 0:null===(e=E.data)||void 0===e?void 0:e.length]),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(o.A,{title:"GDAP Invite",backButtonTitle:"GDAP Invites",children:[(0,l.jsx)(h.A,{sx:{mb:2},children:(0,l.jsxs)(r.A,{container:!0,spacing:2,children:[(0,l.jsx)(r.A,{size:12,children:(0,l.jsxs)(x.A,{severity:"info",children:[(0,l.jsx)(A.A,{variant:"body2",children:"Use this form to generate invites for the selected GDAP Role Template. After generating the invite, you will receive two URLs:"}),(0,l.jsxs)(p.A,{dense:!0,sx:{listStyleType:"disc",listStylePosition:"inside"},children:[(0,l.jsx)(m.Ay,{sx:{display:"list-item"},children:"The Invite link is to send to a client or accept as a Global Administrator on the customer tenant."}),(0,l.jsx)(m.Ay,{sx:{display:"list-item"},children:"The Onboarding link is for a CIPP Administrator to complete the onboarding process."})]}),(0,l.jsxs)(A.A,{variant:"body2",children:["The onboarding process will also run on a nightly schedule. For automated onboardings, please check out"," ",(0,l.jsx)(v.A,{component:k(),href:"/cipp/settings/partner-webhooks",children:"Partner Webhooks"})," ","in Application Settings."]})]})}),n&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.A,{size:12,children:(0,l.jsxs)(x.A,{severity:"warning",children:["The CIPP Defaults template is missing from the GDAP Role Templates. Create it now?",(0,l.jsx)(j.A,{size:"small",variant:"outlined",onClick:()=>S.mutate({url:"/api/ExecAddGDAPRole",data:{TemplateId:"CIPP Defaults"}}),sx:{ml:2},startIcon:(0,l.jsx)(g.A,{fontSize:"small",children:(0,l.jsx)(C.A,{})}),children:"Create CIPP Defaults"})]})}),(0,l.jsx)(r.A,{size:12,children:(0,l.jsx)(u.v,{apiObject:S})})]}),(0,l.jsx)(r.A,{size:{xs:12,md:6},children:(0,l.jsx)(a.A,{formControl:w,name:"roleMappings",label:"Select GDAP Role Template",type:"autoComplete",api:{url:"/api/ExecGDAPRoleTemplate",queryKey:"ListGDAPRoleTemplatesAutocomplete",dataKey:"Results",labelField:e=>e.TemplateId,valueField:e=>e.RoleMappings},multiple:!1,creatable:!1,required:!0,validators:{validate:e=>!!e||"Please select a GDAP Role Template"}})}),(0,l.jsx)(r.A,{size:{xs:12,md:6},children:(0,l.jsx)(a.A,{type:"number",name:"inviteCount",label:"Number of Invites to generate",formControl:w,required:!0})}),(null==_?void 0:_.value)&&(0,l.jsx)(r.A,{size:12,children:(0,l.jsxs)(f.A,{variant:"outlined",children:[(0,l.jsx)(y.A,{expandIcon:(0,l.jsx)(R.A,{}),children:"Selected Role Mappings"}),(0,l.jsx)(P.A,{children:(0,l.jsx)(T.E,{layout:"double",showDivider:!1,propertyItems:_.value.map(e=>({label:"".concat(e.RoleName),value:"Mapped to '".concat(e.GroupName,"'")}))})})]})}),E.isPending&&(0,l.jsx)(x.A,{variant:"outlined",severity:"info",children:(0,l.jsxs)(A.A,{variant:"body2",children:[(0,l.jsx)(b.A,{size:20})," Generating invites..."]})}),(null==t?void 0:t.length)>0&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(r.A,{size:12,children:(0,l.jsx)(c.x,{title:"Invites",data:t,noCard:!0,simpleColumns:["Message","InviteUrl","OnboardingUrl"]})})})]})}),(0,l.jsx)(I.A,{sx:{justifyContent:"flex-end"},children:(0,l.jsx)(j.A,{variant:"contained",disabled:!w.formState.isValid||E.isPending,onClick:w.handleSubmit(e=>{if(w.trigger(),!w.formState.isValid)return;let t=Array.from({length:e.inviteCount},(t,i)=>({roleMappings:e.roleMappings.value}));E.mutate({url:"/api/ExecGDAPInvite",bulkRequest:!0,data:t})}),startIcon:(0,l.jsx)(g.A,{fontSize:"small",children:(0,l.jsx)(C.A,{})}),children:"Add Invites"})})]})})};w.getLayout=e=>(0,l.jsx)(n.P,{children:e});let S=w}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(51232)),_N_E=e.O()}]);