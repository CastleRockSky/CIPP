(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3809],{25551:e=>{"use strict";e.exports=JSON.parse('[{"label":"Application Administrator","value":"9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3"},{"label":"Authentication Policy Administrator","value":"0526716b-113d-4c15-b2c8-68e3c22b9f80"},{"label":"Cloud App Security Administrator","value":"892c5842-a9a6-463a-8041-72aa08ca3cf6"},{"label":"Cloud Device Administrator","value":"7698a772-787b-4ac8-901f-60d6b08affd2"},{"label":"Exchange Administrator","value":"29232cdf-9323-42fd-ade2-1d097af3e4de"},{"label":"Intune Administrator","value":"3a2c62db-5318-420d-8d74-23affee5d9d5"},{"label":"Privileged Authentication Administrator","value":"7be44c8a-adaf-4e2a-84d6-ab2649e08a13"},{"label":"Privileged Role Administrator","value":"e8611ab8-c189-46e8-94e1-60213ab1f814"},{"label":"Security Administrator","value":"194ae4cb-b126-40b2-bd5b-6091b380977d"},{"label":"SharePoint Administrator","value":"f28a1f50-f6e7-4571-818b-6a12f2af6b6c"},{"label":"Teams Administrator","value":"69091246-20e8-4a56-aa4d-066075b2a7a8"},{"label":"User Administrator","value":"fe930be7-5e62-47db-91af-98c3a49a38b1"}]')},41055:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var a=l(14232);let r=a.forwardRef(function(e,t){let{title:l,titleId:r,...i}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},i),l?a.createElement("title",{id:r},l):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})},42120:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var a=l(93944),r=l(37876);let i=(0,a.A)((0,r.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},59768:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/gdap-management/roles/add",function(){return l(94289)}])},63817:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var a=l(93944),r=l(37876);let i=(0,a.A)((0,r.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings")},78750:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var a=l(14232);let r=a.forwardRef(function(e,t){let{title:l,titleId:r,...i}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},i),l?a.createElement("title",{id:r},l):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m6-6H6"}))})},81514:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var a=l(14232);let r=a.forwardRef(function(e,t){let{title:l,titleId:r,...i}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},i),l?a.createElement("title",{id:r},l):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))})},90240:(e,t,l)=>{"use strict";l.d(t,{A:()=>g});var a=l(37876),r=l(89099),i=l(67578),n=l(86650),s=l(22474),o=l(47737),d=l(94810),c=l(77018),u=l(54538),m=l(24933),p=l(17675),h=l(42120),f=l(22322),x=l(68723),A=l(14232),b=l(88992),j=l(2303);let g=e=>{let{title:t,backButtonTitle:l,titleButton:g,formPageType:v="Add",children:y,queryKey:w,formControl:C,postUrl:R,customDataformatter:P,resetForm:I=!1,hideBackButton:G=!1,hidePageType:D=!1,hideTitle:k=!1,hideSubmit:S=!1,allowResubmit:E=!1,addedButtons:M,...O}=e,L=(0,r.useRouter)(),N=(0,f.nN)({datafromUrl:!0,relatedQueryKeys:w}),{isValid:V,isDirty:_}=(0,b.lN)({control:C.control});return(0,A.useEffect)(()=>{if(delete L.query.tenantFilter,L.query){let e={...C.getValues(),...L.query};C.reset(e)}},[L]),(0,A.useEffect)(()=>{N.isSuccess&&I&&C.reset()},[N.isSuccess]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.v,{title:t}),(0,a.jsx)(i.A,{sx:{flexGrow:1,py:4},children:(0,a.jsx)(n.A,{maxWidth:"lg",children:(0,a.jsxs)(s.A,{spacing:4,children:[!k&&(0,a.jsxs)(s.A,{spacing:2,children:[!G&&(0,a.jsx)("div",{children:(0,a.jsx)(o.A,{color:"inherit",onClick:()=>{L.back()},startIcon:(0,a.jsx)(d.A,{fontSize:"small",children:(0,a.jsx)(h.A,{})}),children:l})}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)(c.A,{variant:"h4",children:[!D&&(0,a.jsxs)(a.Fragment,{children:[v," - "]}),t]}),g&&g]})]}),(0,a.jsxs)(u.A,{children:[(0,a.jsxs)(m.A,{children:[y,(0,a.jsx)(x.v,{apiObject:N})]}),!S&&(0,a.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,a.jsxs)(s.A,{spacing:2,direction:"row",children:[M&&M,(0,a.jsx)(o.A,{disabled:N.isPending||!V||!E&&!_,onClick:C.handleSubmit(()=>{if(C.trigger(),!V)return;let e=P?P(C.getValues()):C.getValues();Object.keys(e).forEach(t=>{(""===e[t]||null===e[t])&&delete e[t]}),N.mutate({url:R,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}},94289:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>k});var a=l(37876),r=l(14232),i=l(77018),n=l(22430),s=l(94810),o=l(46061),d=l(94760),c=l(47737),u=l(90240),m=l(12435),p=l(88992),h=l(58105),f=l(46402),x=l(62964),A=l(89037),b=l(82179),j=l(59568),g=l(81514),v=l(78750),y=l(33862),w=l(25551),C=l(22322),R=l(63817),P=l(39802),I=l(31540),G=l(41055);let D=()=>{var e,t;let l=(0,p.mN)({mode:"onChange",defaultValues:{advancedMode:!1}}),m=(0,p.FH)({control:l.control,name:"gdapRoles"}),D=(0,p.FH)({control:l.control,name:"customSuffix"}),[k,S]=(0,r.useState)([]),E=(0,C.R_)({url:"/api/ExecAddGDAPRole?Action=ListGroups",queryKey:"ListGroups"});return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(u.A,{queryKey:"ListGDAPRoles",formControl:l,title:"GDAP Roles",backButtonTitle:"GDAP Roles",postUrl:"/api/ExecAddGDAPRole",customDataformatter:e=>e.advancedMode?{Action:"AddRoleAdvanced",Mappings:k}:e,children:[(0,a.jsxs)(A.A,{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center",mb:2,children:[(0,a.jsx)(i.A,{variant:"h5",width:"100%",children:"GDAP Roles"}),(0,a.jsx)(n.A,{title:"Advanced Mode",children:(0,a.jsxs)(b.A,{direction:"row",alignItems:"center",children:[(0,a.jsx)(s.A,{fontSize:"small",children:(0,a.jsx)(R.A,{})}),(0,a.jsx)(h.o,{formControl:l,name:"advancedMode",type:"switch"})]})})]}),(0,a.jsxs)(b.A,{spacing:2,children:[(0,a.jsxs)(f.A,{formControl:l,field:"advancedMode",compareType:"is",compareValue:!1,children:[(0,a.jsx)(o.A,{severity:"info",children:(0,a.jsx)(i.A,{variant:"subtitle",children:'For each role you select a new group will be created inside of your partner tenant called "M365 GDAP RoleName". Add your users to these new groups to set their GDAP permissions. If you need to segment your groups for different teams or to define custom permissions, use the Custom Suffix to create additional group mappings per role.'})}),(0,a.jsxs)(o.A,{severity:"warning",children:[(0,a.jsx)("b",{children:"Certain roles may not be compatible with GDAP"}),". See the"," ",(0,a.jsx)(d.A,{href:"https://learn.microsoft.com/en-us/partner-center/customers/gdap-least-privileged-roles-by-task",children:"Microsoft Documentation"})," ","on GDAP Role Guidance."]}),(0,a.jsx)(A.A,{children:(0,a.jsx)(h.o,{formControl:l,name:"customSuffix",label:"Custom Suffix (optional)",type:"textField"})}),(0,a.jsx)(A.A,{children:(0,a.jsx)(c.A,{onClick:()=>{l.setValue("gdapRoles",w,{shouldDirty:!0}),l.trigger()},startIcon:(0,a.jsx)(s.A,{fontSize:"small",children:(0,a.jsx)(g.A,{})}),children:"Add CIPP Default Roles"})}),(0,a.jsx)(h.o,{formControl:l,name:"gdapRoles",label:"Select GDAP Roles",type:"autoComplete",options:x.filter(e=>"7495fdc4-34c4-4d15-a289-98788ce399fd"!==e.ObjectId&&"aaf43236-0c0d-4d5f-883a-6955382ac081"!==e.ObjectId).map(e=>({label:e.Name,value:e.ObjectId})),multiple:!0,creatable:!1,required:!0,validators:{validate:e=>!!e&&0!==e.length||"Please select at least one GDAP Role"},sortOptions:!0}),(0,a.jsxs)(f.A,{formControl:l,field:"gdapRoles",compareType:"arrayLength",compareValue:1,children:[(0,a.jsx)(o.A,{severity:"info",children:"The following groups will be created in your partner tenant if they do not already exist:"}),(0,a.jsx)(y.E,{propertyItems:null==m?void 0:m.map(e=>({label:"M365 GDAP ".concat(e.label).concat(D?" - ".concat(D):""),value:x.find(t=>t.ObjectId===e.value).Description}))})]}),(0,a.jsx)(f.A,{formControl:l,field:"gdapRoles",compareType:"valueEq",compareValue:"62e90394-69f5-4237-9190-012177145e10",children:(0,a.jsx)(o.A,{severity:"warning",children:"The Company Administrator role is a highly privileged role that should be used with caution. GDAP Relationships with this role will not be eligible for auto-extend."})})]}),(0,a.jsxs)(f.A,{formControl:l,field:"advancedMode",compareType:"is",compareValue:!0,children:[(0,a.jsxs)(o.A,{severity:"warning",children:[(0,a.jsx)(i.A,{variant:"subtitle",children:"In Advanced Mode, you can manually map existing groups to GDAP roles. This functionality is designed to help map existing groups to GDAP roles that do not match the default naming convention. Use extreme caution when mapping roles in this mode."}),(0,a.jsx)(i.A,{variant:"h6",sx:{mt:2},children:"Limitations"}),(0,a.jsxs)("ul",{style:{paddingLeft:"15px"},children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("b",{children:"Reserved groups and roles are unavailable for mapping"}),", this is to prevent misconfigurations due to permission overlap."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("b",{children:"Only one role can be mapped per group"}),". If your current configuration maps more than one, use the Reset Role Mapping action on the Relationship."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("b",{children:"Certain roles may not be compatible with GDAP"}),". See the"," ",(0,a.jsx)(d.A,{href:"https://learn.microsoft.com/en-us/partner-center/customers/gdap-least-privileged-roles-by-task",children:"Microsoft Documentation"})," ","on GDAP Role Guidance."]})]})]}),(0,a.jsxs)(j.A,{container:!0,spacing:2,alignItems:"center",children:[(0,a.jsx)(j.A,{size:{md:5,xs:12},children:(0,a.jsx)(h.o,{formControl:l,name:"selectedGroup",label:"Select Group",type:"autoComplete",options:null===(t=E.data)||void 0===t?void 0:null===(e=t.Results)||void 0===e?void 0:e.map(e=>({label:e.displayName,value:e.id})),isFetching:E.isFetching,multiple:!1,required:!0,creatable:!1,sortOptions:!0})}),(0,a.jsx)(j.A,{children:(0,a.jsx)(A.A,{sx:{my:"auto"},children:(0,a.jsx)(s.A,{children:(0,a.jsx)(P.A,{})})})}),(0,a.jsx)(j.A,{size:{md:5,xs:12},children:(0,a.jsx)(h.o,{formControl:l,name:"selectedRole",label:"Select GDAP Role",type:"autoComplete",options:x.filter(e=>"62e90394-69f5-4237-9190-012177145e10"!==e.ObjectId&&"17315797-102d-40b4-93e0-432062caca18"!==e.ObjectId).map(e=>({label:e.Name,value:e.ObjectId})),multiple:!1,required:!0,creatable:!1,sortOptions:!0})}),(0,a.jsx)(j.A,{size:{md:1,xs:12},children:(0,a.jsx)(n.A,{title:"Add Mapping",children:(0,a.jsx)(c.A,{size:"small",onClick:()=>{let e=l.getValues("selectedGroup"),t=l.getValues("selectedRole");if(!e||!t)return;let a={groupName:e.label,groupId:e.value,roleName:t.label,roleId:t.value};!k.some(e=>e.groupId===a.groupId&&e.roleId===a.roleId)&&(S([...k,a]),l.setValue("selectedGroup",null),l.setValue("selectedRole",null))},variant:"contained",children:(0,a.jsx)(s.A,{fontSize:"small",children:(0,a.jsx)(v.A,{})})})})})]}),(0,a.jsx)(I.x,{title:"Role Mappings",data:null!=k?k:[],simpleColumns:["groupName","roleName"],cardProps:{variant:"outlined"},actions:[{label:"Remove",icon:(0,a.jsx)(s.A,{fontSize:"small",children:(0,a.jsx)(G.A,{})}),customFunction:e=>{S(k.filter(t=>t.groupId!==e.groupId||t.roleId!==e.roleId))},noConfirm:!0}]})]})]})]})})};D.getLayout=e=>(0,a.jsx)(m.P,{children:e});let k=D}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(59768)),_N_E=e.O()}]);