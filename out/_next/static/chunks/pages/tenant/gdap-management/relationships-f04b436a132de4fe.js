(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9311],{16881:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/gdap-management/relationships",function(){return a(86680)}])},17055:(e,t,a)=>{"use strict";a.d(t,{L:()=>d});var i=a(37876),n=a(14e3),s=a(67578),l=a(22474),o=a(8578),r=a(76626),p=a(71538);let d=e=>{let{tabOptions:t,children:a}=e,d=(0,n.useRouter)(),c=(0,n.usePathname)(),m=t.find(e=>e.path===c);return(0,i.jsxs)(s.A,{sx:{flexGrow:1,py:4},children:[(0,i.jsx)(l.A,{spacing:2,children:(0,i.jsxs)("div",{children:[(0,i.jsx)(o.A,{onChange:(e,t)=>{d.push(t)},value:null==m?void 0:m.path,variant:"scrollable",children:t.map(e=>(0,i.jsx)(r.A,{label:e.label,value:e.path},e.path))}),(0,i.jsx)(p.A,{})]})}),a]})}},26490:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var i=a(93944),n=a(37876);let s=(0,i.A)((0,n.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l4 4 4-4H6c0-3.86 3.14-7 7-7s7 3.14 7 7-3.14 7-7 7c-1.9 0-3.62-.76-4.88-1.99L6.7 18.42C8.32 20.01 10.55 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m2 8v-1c0-1.1-.9-2-2-2s-2 .9-2 2v1c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-3c0-.55-.45-1-1-1m-1 0h-2v-1c0-.55.45-1 1-1s1 .45 1 1z"}),"LockReset")},46091:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var i=a(93944),n=a(37876);let s=(0,i.A)((0,n.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"OpenInNew")},46950:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var i=a(93944),n=a(37876);let s=(0,i.A)([(0,n.jsx)("path",{d:"M17 11c.34 0 .67.04 1 .09V6.27L10.5 3 3 6.27v4.91c0 4.54 3.2 8.79 7.5 9.82.55-.13 1.08-.32 1.6-.55-.69-.98-1.1-2.17-1.1-3.45 0-3.31 2.69-6 6-6"},"0"),(0,n.jsx)("path",{d:"M17 13c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 1.38c.62 0 1.12.51 1.12 1.12s-.51 1.12-1.12 1.12-1.12-.51-1.12-1.12.5-1.12 1.12-1.12m0 5.37c-.93 0-1.74-.46-2.24-1.17.05-.72 1.51-1.08 2.24-1.08s2.19.36 2.24 1.08c-.5.71-1.31 1.17-2.24 1.17"},"1")],"AdminPanelSettings")},76465:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var i=a(93944),n=a(37876);let s=(0,i.A)((0,n.jsx)("path",{d:"m18 22-.01-6L14 12l3.99-4.01L18 2H6v6l4 4-4 3.99V22zM8 7.5V4h8v3.5l-4 4z"}),"HourglassBottom")},77759:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var i=a(37876),n=a(22875),s=a(7159),l=a(46091),o=a(76465),r=a(46950),p=a(26490);let d=(0,a(93944).A)((0,i.jsx)("path",{d:"M12 2 4 5v6.09c0 5.05 3.41 9.76 8 10.91 4.59-1.15 8-5.86 8-10.91V5zm3.5 12.09-1.41 1.41L12 13.42 9.91 15.5 8.5 14.09 10.59 12 8.5 9.91 9.91 8.5 12 10.59l2.09-2.09 1.41 1.41L13.42 12z"}),"GppBad");var c=a(77018),m=a(46061);let u=()=>[{label:"View Relationship",link:"/tenant/gdap-management/relationships/relationship?id=[id]",color:"primary",icon:(0,i.jsx)(n.A,{})},{label:"Start Onboarding",link:"/tenant/gdap-management/onboarding/start?id=[id]",color:"primary",icon:(0,i.jsx)(s.A,{}),showInActionsMenu:!0},{label:"Open Relationship in Partner Center",link:"https://partner.microsoft.com/en-us/dashboard/commerce2/customers/[customer.tenantId]/adminrelationships/[id]",color:"info",icon:(0,i.jsx)(l.A,{}),showInActionsMenu:!0},{label:"Enable automatic extension",type:"GET",url:"/api/ExecAutoExtendGDAP",data:{ID:"id"},confirmText:"Are you sure you want to enable auto-extend for this relationship?",color:"info",icon:(0,i.jsx)(o.A,{})},{label:"Remove Global Administrator from Relationship",type:"GET",url:"/api/ExecGDAPRemoveGArole",data:{GDAPID:"id"},confirmText:"Are you sure you want to remove Global Administrator from this relationship?",color:"danger",icon:(0,i.jsx)(r.A,{})},{label:"Reset Role Mapping",type:"POST",url:"/api/ExecGDAPAccessAssignment",icon:(0,i.jsx)(p.A,{}),data:{Id:"id",Action:"ResetMappings"},fields:[{name:"RoleTemplateId",label:"Role Template",placeholder:"Select a role template to apply to this relationship.",type:"select",api:{url:"/api/ExecGDAPRoleTemplate",queryKey:"GDAPRoleTemplate",dataKey:"Results",valueField:"TemplateId",labelField:"TemplateId",showRefresh:!0},required:!0,validators:{validate:e=>!!e||"Role Template is required"}}],confirmText:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.A,{variant:"body1",children:"Are you sure you want to reset the role mappings for [customer.displayName]?"}),(0,i.jsxs)(m.A,{severity:"warning",children:["Resetting GDAP role mappings will perform the following actions:",(0,i.jsxs)("ul",{style:{paddingLeft:"15px"},children:[(0,i.jsx)("li",{children:"Remove groups assignments that are not part of the Role Template"}),(0,i.jsx)("li",{children:"Update existing group assignments to match the Role Template"}),(0,i.jsx)("li",{children:"Create new group assignments based on the Role Template"})]})]}),(0,i.jsx)(m.A,{severity:"info",children:"This is useful for fixing GDAP relationships that have overlapping roles or incorrect group assignments (e.g. using AdminAgents or HelpdeskAgents)."})]})},{label:"Terminate Relationship",type:"GET",url:"/api/ExecDeleteGDAPRelationship",data:{GDAPID:"id"},confirmText:"Are you sure you want to terminate this relationship?",color:"error",icon:(0,i.jsx)(d,{})}]},86680:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var i=a(37876),n=a(17055),s=a(12435),l=a(96724),o=a(29390);let r=(0,a(77759).A)(),p=["customer.displayName","displayName","status","createdDateTime","activatedDateTime","endDateTime","autoExtendDuration","accessDetails.unifiedRoles"],d=[{filterName:"Active",value:[{id:"status",value:"active"}],type:"column"},{filterName:"Approval Pending",value:[{id:"status",value:"approvalPending"}],type:"column"},{filterName:"Terminating",value:[{id:"status",value:"terminating"}],type:"column"},{filterName:"Terminated",value:[{id:"status",value:"terminated"}],type:"column"}],c={actions:r,extendedInfoFields:p},m={Endpoint:"tenantRelationships/delegatedAdminRelationships",tenantFilter:"",$top:300},u=()=>(0,i.jsx)(o.A,{title:"GDAP Relationships",tenantInTitle:!1,apiUrl:"/api/ListGraphRequest",apiData:m,apiDataKey:"Results",queryKey:"ListGDAPRelationships",actions:r,offCanvas:c,simpleColumns:p,maxHeightOffset:"460px",filters:d,defaultSorting:[{id:"customer.displayName",desc:!1}]});u.getLayout=e=>(0,i.jsx)(s.P,{children:(0,i.jsx)(n.L,{tabOptions:l,children:e})});let h=u},96724:e=>{"use strict";e.exports=JSON.parse('[{"label":"Overview","path":"/tenant/gdap-management"},{"label":"Relationships","path":"/tenant/gdap-management/relationships"},{"label":"Role Mappings","path":"/tenant/gdap-management/roles"},{"label":"Role Templates","path":"/tenant/gdap-management/role-templates"},{"label":"Invites","path":"/tenant/gdap-management/invites"},{"label":"Onboarding","path":"/tenant/gdap-management/onboarding"},{"label":"Offboarding","path":"/tenant/gdap-management/offboarding"}]')}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(16881)),_N_E=e.O()}]);