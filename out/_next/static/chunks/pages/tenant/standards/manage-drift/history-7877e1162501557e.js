(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4016],{14304:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(93944),a=n(37876);let r=(0,i.A)((0,a.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning")},46041:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(14232);let a=i.forwardRef(function(e,t){let{title:n,titleId:a,...r}=e;return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))})},50387:(e,t,n)=>{"use strict";n.d(t,{f:()=>w});var i=n(37876),a=n(14232),r=n(14e3),s=n(89099),o=n(95062),l=n.n(o),c=n(46041),d=n(67578),h=n(86650),u=n(22474),x=n(47737),p=n(94810),m=n(77018),f=n(76776),g=n(8578),A=n(76626),j=n(71538),y=n(95449),v=n(89273);let w=e=>{let{children:t,tabOptions:n,title:o,subtitle:l,actions:w,actionsData:b,isFetching:S=!1,backUrl:C}=e,T=(0,v.A)(e=>e.breakpoints.down("md")),k=(0,s.useRouter)(),R=(0,r.usePathname)(),z=k.query,D=(0,a.useCallback)((e,t)=>{k.push({pathname:t,query:z},void 0,{shallow:!0})},[k]),I=n.find(e=>e.path===R);return(0,i.jsx)(d.A,{sx:{flexGrow:1,py:4},children:(0,i.jsx)(h.A,{maxWidth:"xl",sx:{height:"100%"},children:(0,i.jsxs)(u.A,{spacing:1,sx:{height:"100%"},children:[(0,i.jsxs)(u.A,{spacing:2,children:[(0,i.jsx)("div",{children:(0,i.jsx)(x.A,{color:"inherit",onClick:()=>C?k.push(C):k.back(),startIcon:(0,i.jsx)(p.A,{fontSize:"small",children:(0,i.jsx)(c.A,{})}),children:"Back to previous page"})}),(0,i.jsxs)(u.A,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:1,children:[(0,i.jsxs)(u.A,{spacing:1,children:[(0,i.jsx)(u.A,{alignItems:"center",direction:"row",spacing:1,justifyContent:"space-between",children:(0,i.jsx)(m.A,{variant:T?"h6":"h4",children:o})}),S?(0,i.jsx)(f.A,{variant:"text",width:200}):l&&(0,i.jsx)(u.A,{alignItems:"center",flexWrap:"wrap",direction:"row",spacing:2,children:l.map((e,t)=>(0,i.jsxs)(u.A,{alignItems:"center",direction:"row",spacing:1,children:[(0,i.jsx)(p.A,{fontSize:"small",children:e.icon}),(0,i.jsx)(m.A,{color:"text.secondary",variant:"body2",children:e.text})]},t))})]}),w&&w.length>0&&(0,i.jsx)(y.$,{actions:w,data:b,disabled:S})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(g.A,{onChange:D,value:null==I?void 0:I.path,variant:"scrollable",children:n.map(e=>(0,i.jsx)(A.A,{label:e.label,value:e.path},e.path))}),(0,i.jsx)(j.A,{})]})]}),(0,i.jsx)(d.A,{sx:!T&&{flexGrow:1,overflow:"auto",height:"calc(100vh - 400px)"},children:t})]})})})};w.propTypes={children:l().node,tabOptions:l().arrayOf(l().shape({label:l().string.isRequired,path:l().string.isRequired})).isRequired,title:l().string.isRequired,subtitle:l().arrayOf(l().shape({icon:l().node.isRequired,text:l().string.isRequired})),actions:l().arrayOf(l().shape({label:l().string.isRequired,handler:l().func.isRequired})),isFetching:l().bool}},50834:e=>{"use strict";e.exports=JSON.parse('[{"label":"Manage Drift","path":"/tenant/standards/manage-drift"},{"label":"Policies and Settings Deployed","path":"/tenant/standards/manage-drift/policies-deployed"},{"label":"History","path":"/tenant/standards/manage-drift/history"},{"label":"Tenant Report","path":"/tenant/standards/manage-drift/compare"}]')},51476:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/standards/manage-drift/history",function(){return n(86030)}])},86030:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>X});var i=n(37876),a=n(14232),r=n(67578),s=n(22474),o=n(77018),l=n(7957),c=n(46061),d=n(54538),h=n(24933),u=n(59017),x=n(94760),p=n(47737),m=n(24890),f=n(7407),g=n(69241),A=n(54773),j=n(76180),y=n(4697),v=n(28340),w=n(60227),b=n(10714);let S=e=>{let{position:t,classes:n}=e,i={root:["root",(0,b.A)(t)]};return(0,y.A)(i,w.Y,n)},C=(0,A.Ay)(o.A,{name:"MuiTimelineOppositeContent",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[(0,b.A)(n.position)]]}})(({ownerState:e})=>({padding:"6px 16px",marginRight:"auto",textAlign:"right",flex:1,..."left"===e.position&&{textAlign:"left"}})),T=a.forwardRef(function(e,t){let n=(0,j.A)({props:e,name:"MuiTimelineOppositeContent"}),{className:r,...s}=n,{position:o}=a.useContext(v.A),l={...n,position:o||"left"},c=S(l);return(0,i.jsx)(C,{component:"div",className:(0,g.A)(c.root,r),ownerState:l,ref:t,...s})});T.muiName="TimelineOppositeContent";var k=n(21468),R=n(48611),z=n(24021),D=n(77377),I=n(12435),O=n(50387),P=n(22322),E=n(89099),L=n(83198),M=n(14304),_=n(29468),q=n(14628),N=n(79259),W=n(7159),F=n(90950),U=n(87505),G=n(50834),B=n(17825);let K=()=>{let{templateId:e}=(0,E.useRouter)().query,[t,n]=(0,a.useState)(5),g=(0,B.t)().currentTenant,[A,j]=(0,a.useState)(new Set),y=e=>{let t=new Set(A);t.has(e)?t.delete(e):t.add(e),j(t)},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256;return!e||e.length<=t?{text:e,isTruncated:!1}:{text:e.substring(0,t)+"...",fullText:e,isTruncated:!0}},{startDate:w,endDate:b}=(e=>{let t=new Date,n=new Date;return n.setDate(t.getDate()-e),{startDate:n.toISOString().split("T")[0].replace(/-/g,""),endDate:t.toISOString().split("T")[0].replace(/-/g,"")}})(t),S=(0,P.R_)({url:"/api/Listlogs?tenant=".concat(g,"&StartDate=").concat(w,"&EndDate=").concat(b,"&Filter=true"),queryKey:"Listlogs-".concat(g,"-").concat(w,"-").concat(b)}),C=e=>{switch(null==e?void 0:e.toLowerCase()){case"error":return{icon:(0,i.jsx)(L.A,{}),color:"error",chipColor:"error"};case"warning":return{icon:(0,i.jsx)(M.A,{}),color:"warning",chipColor:"warning"};case"info":return{icon:(0,i.jsx)(_.A,{}),color:"info",chipColor:"info"};case"success":return{icon:(0,i.jsx)(q.A,{}),color:"success",chipColor:"success"};default:return{icon:(0,i.jsx)(_.A,{}),color:"grey",chipColor:"default"}}},I=e=>{let t=new Date(e);return{time:t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),date:t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}},K=[{label:"Refresh Data",icon:(0,i.jsx)(N.A,{}),noConfirm:!0,customFunction:()=>{S.refetch()}},...e?[{label:"Run Standard Now (Currently Selected Tenant only)",type:"GET",url:"/api/ExecStandardsRun",icon:(0,i.jsx)(W.A,{}),data:{TemplateId:e},confirmText:"Are you sure you want to force a run of this standard?",multiPost:!1},{label:"Run Standard Now (All Tenants in Template)",type:"GET",url:"/api/ExecStandardsRun",icon:(0,i.jsx)(W.A,{}),data:{TemplateId:e,tenantFilter:"allTenants"},confirmText:"Are you sure you want to force a run of this standard?",multiPost:!1}]:[]],X=[{icon:(0,i.jsx)(F.A,{}),text:"Template ID: ".concat(e||"Loading...")}],$=S.data?[...S.data].sort((e,t)=>new Date(t.DateTime)-new Date(e.DateTime)):[];return(0,i.jsx)(O.f,{tabOptions:G,title:"Manage Drift",subtitle:X,backUrl:"/tenant/standards/list-standards",actions:K,actionsData:{},isFetching:S.isLoading,children:(0,i.jsx)(r.A,{sx:{py:2},children:(0,i.jsxs)(s.A,{spacing:4,children:[(0,i.jsx)(o.A,{variant:"h6",children:"Activity Timeline"}),(0,i.jsxs)(o.A,{variant:"body1",color:"text.secondary",children:["This timeline shows the history of actions taken on this tenant, by CIPP for the last"," ",t," days."]}),S.isLoading&&(0,i.jsx)(r.A,{display:"flex",justifyContent:"center",py:4,children:(0,i.jsx)(l.A,{})}),S.isError&&(0,i.jsx)(c.A,{severity:"error",children:"Failed to load activity logs. Please try again."}),S.data&&0===$.length&&(0,i.jsx)(c.A,{severity:"info",children:"No activity logs found for the selected time period."}),S.data&&$.length>0&&(0,i.jsx)(d.A,{sx:{mr:2},children:(0,i.jsxs)(h.A,{children:[(0,i.jsx)(m.A,{sx:{"& .MuiTimelineOppositeContent-root":{flex:.2,minWidth:100},"& .MuiTimelineContent-root":{flex:.8}},children:$.map((e,t)=>{let{icon:n,color:a,chipColor:l}=C(e.Severity),{time:c,date:d}=I(e.DateTime),{text:h,fullText:p,isTruncated:m}=v(e.Message),g=A.has(t);return(0,i.jsxs)(f.A,{children:[(0,i.jsxs)(T,{sx:{m:"auto 0",minWidth:100,maxWidth:100},align:"right",variant:"body2",color:"text.secondary",children:[(0,i.jsx)(o.A,{variant:"caption",display:"block",fontSize:"0.7rem",children:d}),(0,i.jsx)(o.A,{variant:"caption",display:"block",fontWeight:"bold",fontSize:"0.75rem",children:c})]}),(0,i.jsxs)(k.A,{children:[(0,i.jsx)(R.A,{color:a,variant:"outlined",size:"small",children:n}),t<$.length-1&&(0,i.jsx)(z.A,{})]}),(0,i.jsx)(D.A,{sx:{py:"8px",px:2},children:(0,i.jsxs)(s.A,{spacing:1,children:[(0,i.jsxs)(r.A,{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",children:[(0,i.jsx)(u.A,{label:e.Severity,color:l,size:"small",variant:"outlined",sx:{fontSize:"0.7rem",height:20}}),(0,i.jsx)(u.A,{label:e.API,size:"small",variant:"outlined",sx:{fontSize:"0.7rem",height:20}}),e.IP&&(0,i.jsx)(u.A,{label:"IP: ".concat(e.IP),size:"small",variant:"outlined",sx:{fontSize:"0.7rem",height:20}})]}),(0,i.jsxs)(r.A,{children:[(0,i.jsx)(o.A,{variant:"body2",fontWeight:"medium",sx:{fontSize:"0.875rem"},children:g?p:h}),m&&(0,i.jsx)(x.A,{component:"button",variant:"caption",onClick:()=>y(t),sx:{mt:.5,display:"block",textAlign:"left",fontSize:"0.75rem"},children:g?"Show less":"Show more"})]}),e.User&&(0,i.jsxs)(o.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:["User: ",e.User]})]})})]},t)})}),(0,i.jsx)(r.A,{display:"flex",justifyContent:"center",mt:3,children:(0,i.jsxs)(p.A,{variant:"outlined",startIcon:(0,i.jsx)(U.A,{}),onClick:()=>{n(e=>e+7)},disabled:S.isLoading,children:["Load More (Show ",t+7," days)"]})})]})})]})})})};K.getLayout=e=>(0,i.jsx)(I.P,{children:e});let X=K},90950:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(93944),a=n(37876);let r=(0,i.A)([(0,a.jsx)("path",{d:"m21 5-9-4-9 4v6c0 5.55 3.84 10.74 9 12 2.3-.56 4.33-1.9 5.88-3.71l-3.12-3.12c-1.94 1.29-4.58 1.07-6.29-.64-1.95-1.95-1.95-5.12 0-7.07s5.12-1.95 7.07 0c1.71 1.71 1.92 4.35.64 6.29l2.9 2.9C20.29 15.69 21 13.38 21 11z"},"0"),(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3"},"1")],"Policy")},95449:(e,t,n)=>{"use strict";n.d(t,{$:()=>f});var i=n(37876),a=n(54550),r=n(95062),s=n.n(r),o=n(47737),l=n(94810),c=n(52808),d=n(6003),h=n(93256),u=n(50221),x=n(14232),p=n(82836),m=n(79803);let f=e=>{var t;let{actions:n=[],label:r="Actions",data:s,queryKeys:f,...g}=e,A=(0,u.f)(),[j,y]=(0,x.useState)({data:{},action:{},ready:!1}),v=(0,p.s)(),w=(e,t)=>!e||null!=t&&!!t.condition&&!(null==t?void 0:t.condition(e));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.A,{onClick:A.handleOpen,ref:A.anchorRef,startIcon:(0,i.jsx)(l.A,{fontSize:"small",children:(0,i.jsx)(a.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap"},children:"Actions"}),(0,i.jsx)(c.A,{anchorEl:A.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:A.handleClose,open:A.open,transformOrigin:{horizontal:"right",vertical:"top"},children:null==n?void 0:n.filter(e=>!e.link||e.showInActionsMenu).map((e,t)=>(0,i.jsxs)(d.A,{disabled:w(s,e),onClick:()=>{y({data:s,action:e,ready:!0}),(null==e?void 0:e.noConfirm)&&e.customFunction?e.customFunction(s,e,{}):(v.handleOpen(),A.handleClose())},children:[(0,i.jsx)(l.A,{fontSize:"small",sx:{minWidth:"30px"},children:e.icon}),(0,i.jsx)(h.A,{children:e.label})]},t))}),j.ready&&(0,i.jsx)(m.B,{createDialog:v,title:"Confirmation",fields:null===(t=j.action)||void 0===t?void 0:t.fields,api:j.action,row:j.data,relatedQueryKeys:f})]})};f.propTypes={actions:s().array,label:s().string}}},e=>{var t=t=>e(e.s=t);e.O(0,[3131,636,6593,8792],()=>t(51476)),_N_E=e.O()}]);