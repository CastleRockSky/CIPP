(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8619],{7884:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/standards/manage-drift/recover-policies",function(){return a(91823)}])},46041:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var i=a(14232);let n=i.forwardRef(function(e,t){let{title:a,titleId:n,...s}=e;return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),a?i.createElement("title",{id:n},a):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))})},50387:(e,t,a)=>{"use strict";a.d(t,{f:()=>b});var i=a(37876),n=a(14232),s=a(14e3),r=a(89099),l=a(95062),o=a.n(l),c=a(46041),d=a(67578),p=a(86650),u=a(22474),h=a(47737),x=a(94810),m=a(77018),j=a(76776),A=a(8578),g=a(76626),f=a(71538),y=a(95449),v=a(89273);let b=e=>{let{children:t,tabOptions:a,title:l,subtitle:o,actions:b,actionsData:w,isFetching:k=!1,backUrl:C}=e,P=(0,v.A)(e=>e.breakpoints.down("md")),R=(0,r.useRouter)(),S=(0,s.usePathname)(),T=R.query,I=(0,n.useCallback)((e,t)=>{R.push({pathname:t,query:T},void 0,{shallow:!0})},[R]),q=a.find(e=>e.path===S);return(0,i.jsx)(d.A,{sx:{flexGrow:1,py:4},children:(0,i.jsx)(p.A,{maxWidth:"xl",sx:{height:"100%"},children:(0,i.jsxs)(u.A,{spacing:1,sx:{height:"100%"},children:[(0,i.jsxs)(u.A,{spacing:2,children:[(0,i.jsx)("div",{children:(0,i.jsx)(h.A,{color:"inherit",onClick:()=>C?R.push(C):R.back(),startIcon:(0,i.jsx)(x.A,{fontSize:"small",children:(0,i.jsx)(c.A,{})}),children:"Back to previous page"})}),(0,i.jsxs)(u.A,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:1,children:[(0,i.jsxs)(u.A,{spacing:1,children:[(0,i.jsx)(u.A,{alignItems:"center",direction:"row",spacing:1,justifyContent:"space-between",children:(0,i.jsx)(m.A,{variant:P?"h6":"h4",children:l})}),k?(0,i.jsx)(j.A,{variant:"text",width:200}):o&&(0,i.jsx)(u.A,{alignItems:"center",flexWrap:"wrap",direction:"row",spacing:2,children:o.map((e,t)=>(0,i.jsxs)(u.A,{alignItems:"center",direction:"row",spacing:1,children:[(0,i.jsx)(x.A,{fontSize:"small",children:e.icon}),(0,i.jsx)(m.A,{color:"text.secondary",variant:"body2",children:e.text})]},t))})]}),b&&b.length>0&&(0,i.jsx)(y.$,{actions:b,data:w,disabled:k})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(A.A,{onChange:I,value:null==q?void 0:q.path,variant:"scrollable",children:a.map(e=>(0,i.jsx)(g.A,{label:e.label,value:e.path},e.path))}),(0,i.jsx)(f.A,{})]})]}),(0,i.jsx)(d.A,{sx:!P&&{flexGrow:1,overflow:"auto",height:"calc(100vh - 400px)"},children:t})]})})})};b.propTypes={children:o().node,tabOptions:o().arrayOf(o().shape({label:o().string.isRequired,path:o().string.isRequired})).isRequired,title:o().string.isRequired,subtitle:o().arrayOf(o().shape({icon:o().node.isRequired,text:o().string.isRequired})),actions:o().arrayOf(o().shape({label:o().string.isRequired,handler:o().func.isRequired})),isFetching:o().bool}},50834:e=>{"use strict";e.exports=JSON.parse('[{"label":"Manage Drift","path":"/tenant/standards/manage-drift"},{"label":"Policies and Settings Deployed","path":"/tenant/standards/manage-drift/policies-deployed"},{"label":"History","path":"/tenant/standards/manage-drift/history"},{"label":"Tenant Report","path":"/tenant/standards/manage-drift/compare"}]')},90950:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var i=a(93944),n=a(37876);let s=(0,i.A)([(0,n.jsx)("path",{d:"m21 5-9-4-9 4v6c0 5.55 3.84 10.74 9 12 2.3-.56 4.33-1.9 5.88-3.71l-3.12-3.12c-1.94 1.29-4.58 1.07-6.29-.64-1.95-1.95-1.95-5.12 0-7.07s5.12-1.95 7.07 0c1.71 1.71 1.92 4.35.64 6.29l2.9 2.9C20.29 15.69 21 13.38 21 11z"},"0"),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3"},"1")],"Policy")},91823:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var i=a(37876),n=a(12435);a(17825);var s=a(89099),r=a(79259),l=a(7159),o=a(90950),c=a(87505),d=a(92226),p=a(67578),u=a(22474),h=a(7881),x=a(88326),m=a(77018),j=a(37746),A=a(59017),g=a(47737),f=a(59568),y=a(14232),v=a(88992),b=a(50387),w=a(50834),k=a(31540),C=a(2303),P=a(58105),R=a(22322),S=a(68723);let T=()=>{let{templateId:e}=(0,s.useRouter)().query,[t,a]=(0,y.useState)([]),n=(0,v.mN)({mode:"onChange"}),T=n.watch("backupDateTime"),I=[{id:1,name:"Multi-Factor Authentication Policy",type:"Conditional Access",lastModified:"2024-01-15",settings:"Require MFA for all users"},{id:2,name:"Password Policy Standard",type:"Security Standard",lastModified:"2024-01-10",settings:"14 character minimum, complexity required"},{id:3,name:"Device Compliance Policy",type:"Intune Policy",lastModified:"2024-01-08",settings:"Require encryption, PIN/Password"}],q=(0,R.nN)({relatedQueryKeys:["ListBackupPolicies","ListPolicyBackups"]}),D=[{label:"Refresh Data",icon:(0,i.jsx)(r.A,{}),noConfirm:!0,customFunction:()=>{}},...e?[{label:"Run Standard Now (Currently Selected Tenant only)",type:"GET",url:"/api/ExecStandardsRun",icon:(0,i.jsx)(l.A,{}),data:{TemplateId:e},confirmText:"Are you sure you want to force a run of this standard?",multiPost:!1},{label:"Run Standard Now (All Tenants in Template)",type:"GET",url:"/api/ExecStandardsRun",icon:(0,i.jsx)(l.A,{}),data:{TemplateId:e,tenantFilter:"allTenants"},confirmText:"Are you sure you want to force a run of this standard?",multiPost:!1}]:[]],E=[{icon:(0,i.jsx)(o.A,{}),text:"Template ID: ".concat(e||"Loading...")}];return(0,i.jsxs)(b.f,{tabOptions:w,title:"Manage Drift",subtitle:E,backUrl:"/tenant/standards/list-standards",actions:D,actionsData:{},isFetching:q.isPending,children:[(0,i.jsx)(C.v,{title:"Recover Policies"}),(0,i.jsx)(p.A,{sx:{py:2},children:(0,i.jsxs)(u.A,{spacing:3,children:[(0,i.jsxs)(h.A,{defaultExpanded:!0,children:[(0,i.jsx)(x.A,{expandIcon:(0,i.jsx)(c.A,{}),children:(0,i.jsxs)(p.A,{display:"flex",alignItems:"center",gap:1,children:[(0,i.jsx)(d.A,{color:"primary"}),(0,i.jsx)(m.A,{variant:"h6",children:"Select Backup Date & Time"})]})}),(0,i.jsx)(j.A,{children:(0,i.jsx)(f.A,{container:!0,spacing:2,children:(0,i.jsx)(f.A,{size:6,children:(0,i.jsx)(P.o,{type:"autoComplete",label:"Backup Date & Time",name:"backupDateTime",formControl:n,api:{url:"/api/ExecListBackup",queryKey:"PolicyBackups-".concat(e),labelField:e=>{let t=new Date(e.dateTime);return"".concat(t.toLocaleDateString()," @ ").concat(t.toLocaleTimeString()," (").concat(e.policyCount," policies)")},valueField:"dateTime"},required:!0,validators:{validate:e=>!!e||"Please select a backup date & time"}})})})})]}),(0,i.jsx)(S.v,{apiObject:q}),T&&(0,i.jsxs)(h.A,{defaultExpanded:!0,children:[(0,i.jsx)(x.A,{expandIcon:(0,i.jsx)(c.A,{}),children:(0,i.jsxs)(p.A,{display:"flex",alignItems:"center",gap:1,children:[(0,i.jsx)(o.A,{color:"primary"}),(0,i.jsx)(m.A,{variant:"h6",children:"Policies in Selected Backup"}),(0,i.jsx)(A.A,{label:I.length,size:"small",color:"primary"})]})}),(0,i.jsx)(j.A,{children:(0,i.jsxs)(u.A,{spacing:2,children:[(0,i.jsxs)(p.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,i.jsxs)(m.A,{variant:"body2",color:"text.secondary",children:["Select policies to recover from backup:"," ",new Date(T).toLocaleString()]}),(0,i.jsxs)(g.A,{variant:"contained",color:"primary",onClick:()=>{0!==t.length&&T&&q.mutate({url:"/api/RecoverPolicies",data:{templateId:e,backupDateTime:T,policyIds:t.map(e=>e.id)}})},disabled:0===t.length||q.isPending,startIcon:(0,i.jsx)(d.A,{}),children:["Recover Selected Policies (",t.length,")"]})]}),(0,i.jsx)(k.x,{title:"Backup Policies",data:I,simpleColumns:["name","type","lastModified","settings"],noCard:!0,enableRowSelection:!0,onChange:e=>a(e)})]})})]})]})})]})};T.getLayout=e=>(0,i.jsx)(n.P,{children:e});let I=T},92226:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var i=a(93944),n=a(37876);let s=(0,i.A)((0,n.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"Restore")},95449:(e,t,a)=>{"use strict";a.d(t,{$:()=>j});var i=a(37876),n=a(54550),s=a(95062),r=a.n(s),l=a(47737),o=a(94810),c=a(52808),d=a(6003),p=a(93256),u=a(50221),h=a(14232),x=a(82836),m=a(79803);let j=e=>{var t;let{actions:a=[],label:s="Actions",data:r,queryKeys:j,...A}=e,g=(0,u.f)(),[f,y]=(0,h.useState)({data:{},action:{},ready:!1}),v=(0,x.s)(),b=(e,t)=>!e||null!=t&&!!t.condition&&!(null==t?void 0:t.condition(e));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.A,{onClick:g.handleOpen,ref:g.anchorRef,startIcon:(0,i.jsx)(o.A,{fontSize:"small",children:(0,i.jsx)(n.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap"},children:"Actions"}),(0,i.jsx)(c.A,{anchorEl:g.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:g.handleClose,open:g.open,transformOrigin:{horizontal:"right",vertical:"top"},children:null==a?void 0:a.filter(e=>!e.link||e.showInActionsMenu).map((e,t)=>(0,i.jsxs)(d.A,{disabled:b(r,e),onClick:()=>{y({data:r,action:e,ready:!0}),(null==e?void 0:e.noConfirm)&&e.customFunction?e.customFunction(r,e,{}):(v.handleOpen(),g.handleClose())},children:[(0,i.jsx)(o.A,{fontSize:"small",sx:{minWidth:"30px"},children:e.icon}),(0,i.jsx)(p.A,{children:e.label})]},t))}),f.ready&&(0,i.jsx)(m.B,{createDialog:v,title:"Confirmation",fields:null===(t=f.action)||void 0===t?void 0:t.fields,api:f.action,row:f.data,relatedQueryKeys:j})]})};j.propTypes={actions:r().array,label:r().string}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(7884)),_N_E=e.O()}]);