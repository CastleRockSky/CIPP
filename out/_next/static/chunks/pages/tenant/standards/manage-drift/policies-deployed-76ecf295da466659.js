(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6021],{46041:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var n=a(14232);let i=n.forwardRef(function(e,t){let{title:a,titleId:i,...l}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},l),a?n.createElement("title",{id:i},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))})},46950:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(93944),i=a(37876);let l=(0,n.A)([(0,i.jsx)("path",{d:"M17 11c.34 0 .67.04 1 .09V6.27L10.5 3 3 6.27v4.91c0 4.54 3.2 8.79 7.5 9.82.55-.13 1.08-.32 1.6-.55-.69-.98-1.1-2.17-1.1-3.45 0-3.31 2.69-6 6-6"},"0"),(0,i.jsx)("path",{d:"M17 13c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 1.38c.62 0 1.12.51 1.12 1.12s-.51 1.12-1.12 1.12-1.12-.51-1.12-1.12.5-1.12 1.12-1.12m0 5.37c-.93 0-1.74-.46-2.24-1.17.05-.72 1.51-1.08 2.24-1.08s2.19.36 2.24 1.08c-.5.71-1.31 1.17-2.24 1.17"},"1")],"AdminPanelSettings")},50387:(e,t,a)=>{"use strict";a.d(t,{f:()=>T});var n=a(37876),i=a(14232),l=a(14e3),s=a(89099),r=a(95062),d=a.n(r),o=a(46041),c=a(67578),u=a(86650),p=a(22474),h=a(47737),m=a(94810),v=a(77018),x=a(76776),f=a(8578),A=a(76626),g=a(71538),j=a(95449),y=a(89273);let T=e=>{let{children:t,tabOptions:a,title:r,subtitle:d,actions:T,actionsData:b,isFetching:w=!1,backUrl:C}=e,S=(0,y.A)(e=>e.breakpoints.down("md")),I=(0,s.useRouter)(),L=(0,l.usePathname)(),R=I.query,F=(0,i.useCallback)((e,t)=>{I.push({pathname:t,query:R},void 0,{shallow:!0})},[I]),k=a.find(e=>e.path===L);return(0,n.jsx)(c.A,{sx:{flexGrow:1,py:4},children:(0,n.jsx)(u.A,{maxWidth:"xl",sx:{height:"100%"},children:(0,n.jsxs)(p.A,{spacing:1,sx:{height:"100%"},children:[(0,n.jsxs)(p.A,{spacing:2,children:[(0,n.jsx)("div",{children:(0,n.jsx)(h.A,{color:"inherit",onClick:()=>C?I.push(C):I.back(),startIcon:(0,n.jsx)(m.A,{fontSize:"small",children:(0,n.jsx)(o.A,{})}),children:"Back to previous page"})}),(0,n.jsxs)(p.A,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:1,children:[(0,n.jsxs)(p.A,{spacing:1,children:[(0,n.jsx)(p.A,{alignItems:"center",direction:"row",spacing:1,justifyContent:"space-between",children:(0,n.jsx)(v.A,{variant:S?"h6":"h4",children:r})}),w?(0,n.jsx)(x.A,{variant:"text",width:200}):d&&(0,n.jsx)(p.A,{alignItems:"center",flexWrap:"wrap",direction:"row",spacing:2,children:d.map((e,t)=>(0,n.jsxs)(p.A,{alignItems:"center",direction:"row",spacing:1,children:[(0,n.jsx)(m.A,{fontSize:"small",children:e.icon}),(0,n.jsx)(v.A,{color:"text.secondary",variant:"body2",children:e.text})]},t))})]}),T&&T.length>0&&(0,n.jsx)(j.$,{actions:T,data:b,disabled:w})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(f.A,{onChange:F,value:null==k?void 0:k.path,variant:"scrollable",children:a.map(e=>(0,n.jsx)(A.A,{label:e.label,value:e.path},e.path))}),(0,n.jsx)(g.A,{})]})]}),(0,n.jsx)(c.A,{sx:!S&&{flexGrow:1,overflow:"auto",height:"calc(100vh - 400px)"},children:t})]})})})};T.propTypes={children:d().node,tabOptions:d().arrayOf(d().shape({label:d().string.isRequired,path:d().string.isRequired})).isRequired,title:d().string.isRequired,subtitle:d().arrayOf(d().shape({icon:d().node.isRequired,text:d().string.isRequired})),actions:d().arrayOf(d().shape({label:d().string.isRequired,handler:d().func.isRequired})),isFetching:d().bool}},50834:e=>{"use strict";e.exports=JSON.parse('[{"label":"Manage Drift","path":"/tenant/standards/manage-drift"},{"label":"Policies and Settings Deployed","path":"/tenant/standards/manage-drift/policies-deployed"},{"label":"History","path":"/tenant/standards/manage-drift/history"},{"label":"Tenant Report","path":"/tenant/standards/manage-drift/compare"}]')},67606:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(93944),i=a(37876);let l=(0,n.A)((0,i.jsx)("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"}),"Security")},86478:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/standards/manage-drift/policies-deployed",function(){return a(91981)}])},90950:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(93944),i=a(37876);let l=(0,n.A)([(0,i.jsx)("path",{d:"m21 5-9-4-9 4v6c0 5.55 3.84 10.74 9 12 2.3-.56 4.33-1.9 5.88-3.71l-3.12-3.12c-1.94 1.29-4.58 1.07-6.29-.64-1.95-1.95-1.95-5.12 0-7.07s5.12-1.95 7.07 0c1.71 1.71 1.92 4.35.64 6.29l2.9 2.9C20.29 15.69 21 13.38 21 11z"},"0"),(0,i.jsx)("circle",{cx:"12",cy:"12",r:"3"},"1")],"Policy")},91981:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>L});var n=a(37876),i=a(12435),l=a(17825),s=a(89099),r=a(79259),d=a(7159),o=a(90950),c=a(87505),u=a(67606);let p=(0,a(93944).A)((0,n.jsx)("path",{d:"M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1m-1 9h-4v-7h4z"}),"Devices");var h=a(46950),m=a(67578),v=a(22474),x=a(7881),f=a(88326),A=a(77018),g=a(59017),j=a(37746),y=a(50387),T=a(50834),b=a(31540),w=a(2303),C=a(22322),S=a(75069);let I=()=>{var e;let t=(0,l.t)(),a=(0,s.useRouter)(),{templateId:i}=a.query,I=a.query.tenantFilter||t.tenantFilter,L=(0,C.R_)({url:"/api/listStandardTemplates",queryKey:"ListStandardsTemplates-Drift"}),R=(0,C.R_)({url:"/api/ListStandardsCompare",data:{TemplateId:i,TenantFilter:I,CompareToStandard:!0},queryKey:"StandardsCompare-".concat(i,"-").concat(I),enabled:!!i&&!!I}),F=(0,C.R_)({url:"/api/listTenantDrift",data:{tenantFilter:I,standardsId:i},queryKey:"TenantDrift-".concat(i,"-").concat(I),enabled:!!i&&!!I}),k=(L.data||[]).find(e=>e.GUID===i),N=(null==k?void 0:k.standards)||{},D=(null===(e=R.data)||void 0===e?void 0:e[0])||{},M=function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!0===(null===(t=D["standards.".concat(e)])||void 0===t?void 0:t.Value))return"Deployed";{let t=F.data||[],i=[e,"standards.".concat(e)];a&&n&&i.push("standards.".concat(n,".").concat(a),"".concat(n,".").concat(a),a);let l=t.find(e=>i.some(t=>{var a,n;return e.standardName===t||e.policyName===t||(null===(a=e.standardName)||void 0===a?void 0:a.includes(t))||(null===(n=e.policyName)||void 0===n?void 0:n.includes(t))}));return l&&l.Status?"Deviation - ".concat(l.Status):"Deviation - New"}},E=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=F.data||[],i=[e,"standards.".concat(e)];t&&a&&i.push("standards.".concat(a,".").concat(t),"".concat(a,".").concat(t),t);let l=n.find(e=>i.some(t=>{var a,n;return e.standardName===t||e.policyName===t||(null===(a=e.standardName)||void 0===a?void 0:a.includes(t))||(null===(n=e.policyName)||void 0===n?void 0:n.includes(t))}));return(null==l?void 0:l.standardDisplayName)||null},q=e=>{var t;let a=null===(t=D["standards.".concat(e)])||void 0===t?void 0:t.LastRefresh;return a?new Date(a).toLocaleDateString():"N/A"},O=e=>{let t="standards.".concat(e),a=S.find(e=>e.name===t);return(null==a?void 0:a.label)||e.replace(/([A-Z])/g," $1").trim()},P=(e,t)=>{var a,n;if(!e||!k)return"Unknown Template";let i=k.standards||{};if(i[t]&&Array.isArray(i[t])){let n=i[t].find(t=>{var a;return(null===(a=t.TemplateList)||void 0===a?void 0:a.value)===e});if(null==n?void 0:null===(a=n.TemplateList)||void 0===a?void 0:a.label)return n.TemplateList.label}for(let[t,a]of Object.entries(i))if(Array.isArray(a)){let t=a.find(t=>{var a;return(null===(a=t.TemplateList)||void 0===a?void 0:a.value)===e});if(null==t?void 0:null===(n=t.TemplateList)||void 0===n?void 0:n.label)return t.TemplateList.label}return"Unknown Template"},_=Object.entries(N).filter(e=>{let[t]=e;return"IntuneTemplate"!==t&&"ConditionalAccessTemplate"!==t}).map((e,t)=>{let[a,n]=e;return{id:t+1,name:O(a),category:"Security Standard",status:M(a),lastModified:q(a),standardKey:a}}),z=(N.IntuneTemplate||[]).map((e,t)=>{var a,n,i,l,s;let r="IntuneTemplate.".concat(null===(a=e.TemplateList)||void 0===a?void 0:a.value),d=E(r,null===(n=e.TemplateList)||void 0===n?void 0:n.value,"IntuneTemplate"),o=P(null===(i=e.TemplateList)||void 0===i?void 0:i.value,"IntuneTemplate");return{id:t+1,name:d||"Intune - ".concat(o),category:"Intune Template",platform:"Multi-Platform",status:M(r,null===(l=e.TemplateList)||void 0===l?void 0:l.value,"IntuneTemplate"),lastModified:q(r),assignedGroups:e.AssignTo||"N/A",templateValue:null===(s=e.TemplateList)||void 0===s?void 0:s.value}}),V=(N.ConditionalAccessTemplate||[]).map((e,t)=>{var a,n,i,l,s;let r="ConditionalAccessTemplate.".concat(null===(a=e.TemplateList)||void 0===a?void 0:a.value),d=E(r,null===(n=e.TemplateList)||void 0===n?void 0:n.value,"ConditionalAccessTemplate"),o=P(null===(i=e.TemplateList)||void 0===i?void 0:i.value,"ConditionalAccessTemplate");return{id:t+1,name:d||"Conditional Access - ".concat(o),state:e.state||"Unknown",conditions:"Conditional Access Policy",controls:"Access Control",lastModified:q(r),status:M(r,null===(l=e.TemplateList)||void 0===l?void 0:l.value,"ConditionalAccessTemplate"),templateValue:null===(s=e.TemplateList)||void 0===s?void 0:s.value}}),G=[{label:"Refresh Data",icon:(0,n.jsx)(r.A,{}),noConfirm:!0,customFunction:()=>{L.refetch(),R.refetch(),F.refetch()}},...i?[{label:"Run Standard Now (Currently Selected Tenant only)",type:"GET",url:"/api/ExecStandardsRun",icon:(0,n.jsx)(d.A,{}),data:{TemplateId:i},confirmText:"Are you sure you want to force a run of this standard?",multiPost:!1},{label:"Run Standard Now (All Tenants in Template)",type:"GET",url:"/api/ExecStandardsRun",icon:(0,n.jsx)(d.A,{}),data:{TemplateId:i,tenantFilter:"allTenants"},confirmText:"Are you sure you want to force a run of this standard?",multiPost:!1}]:[]],H=[{icon:(0,n.jsx)(o.A,{}),text:"Template ID: ".concat(i||"Loading...")}];return(0,n.jsxs)(y.f,{tabOptions:T,title:"Manage Drift",subtitle:H,actions:G,actionsData:{},backUrl:"/tenant/standards/list-standards",children:[(0,n.jsx)(w.v,{title:"Policies and Settings Deployed"}),(0,n.jsx)(m.A,{sx:{py:2},children:(0,n.jsxs)(v.A,{spacing:3,children:[(0,n.jsxs)(x.A,{defaultExpanded:!0,children:[(0,n.jsx)(f.A,{expandIcon:(0,n.jsx)(c.A,{}),children:(0,n.jsxs)(m.A,{display:"flex",alignItems:"center",gap:1,children:[(0,n.jsx)(u.A,{color:"primary"}),(0,n.jsx)(A.A,{variant:"h6",children:"Security Standards"}),(0,n.jsx)(g.A,{label:_.length,size:"small",color:"primary"})]})}),(0,n.jsx)(j.A,{children:(0,n.jsx)(b.x,{title:"Security Standards",data:_,simpleColumns:["name","category","status","lastModified"],noCard:!0,isFetching:L.isFetching||R.isFetching||F.isFetching})})]}),(0,n.jsxs)(x.A,{defaultExpanded:!0,children:[(0,n.jsx)(f.A,{expandIcon:(0,n.jsx)(c.A,{}),children:(0,n.jsxs)(m.A,{display:"flex",alignItems:"center",gap:1,children:[(0,n.jsx)(p,{color:"primary"}),(0,n.jsx)(A.A,{variant:"h6",children:"Intune Policies"}),(0,n.jsx)(g.A,{label:z.length,size:"small",color:"primary"})]})}),(0,n.jsx)(j.A,{children:(0,n.jsx)(b.x,{title:"Intune Templates",data:z,simpleColumns:["name","category","platform","status","lastModified","assignedGroups"],noCard:!0,isFetching:L.isFetching||R.isFetching||F.isFetching})})]}),(0,n.jsxs)(x.A,{defaultExpanded:!0,children:[(0,n.jsx)(f.A,{expandIcon:(0,n.jsx)(c.A,{}),children:(0,n.jsxs)(m.A,{display:"flex",alignItems:"center",gap:1,children:[(0,n.jsx)(h.A,{color:"primary"}),(0,n.jsx)(A.A,{variant:"h6",children:"Conditional Access Policies"}),(0,n.jsx)(g.A,{label:V.length,size:"small",color:"primary"})]})}),(0,n.jsx)(j.A,{children:(0,n.jsx)(b.x,{title:"Conditional Access Templates",data:V,simpleColumns:["name","state","status","conditions","controls","lastModified"],noCard:!0,isFetching:L.isFetching||R.isFetching||F.isFetching})})]})]})})]})};I.getLayout=e=>(0,n.jsx)(i.P,{children:e});let L=I},95449:(e,t,a)=>{"use strict";a.d(t,{$:()=>x});var n=a(37876),i=a(54550),l=a(95062),s=a.n(l),r=a(47737),d=a(94810),o=a(52808),c=a(6003),u=a(93256),p=a(50221),h=a(14232),m=a(82836),v=a(79803);let x=e=>{var t;let{actions:a=[],label:l="Actions",data:s,queryKeys:x,...f}=e,A=(0,p.f)(),[g,j]=(0,h.useState)({data:{},action:{},ready:!1}),y=(0,m.s)(),T=(e,t)=>!e||null!=t&&!!t.condition&&!(null==t?void 0:t.condition(e));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.A,{onClick:A.handleOpen,ref:A.anchorRef,startIcon:(0,n.jsx)(d.A,{fontSize:"small",children:(0,n.jsx)(i.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap"},children:"Actions"}),(0,n.jsx)(o.A,{anchorEl:A.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:A.handleClose,open:A.open,transformOrigin:{horizontal:"right",vertical:"top"},children:null==a?void 0:a.filter(e=>!e.link||e.showInActionsMenu).map((e,t)=>(0,n.jsxs)(c.A,{disabled:T(s,e),onClick:()=>{j({data:s,action:e,ready:!0}),(null==e?void 0:e.noConfirm)&&e.customFunction?e.customFunction(s,e,{}):(y.handleOpen(),A.handleClose())},children:[(0,n.jsx)(d.A,{fontSize:"small",sx:{minWidth:"30px"},children:e.icon}),(0,n.jsx)(u.A,{children:e.label})]},t))}),g.ready&&(0,n.jsx)(v.B,{createDialog:y,title:"Confirmation",fields:null===(t=g.action)||void 0===t?void 0:t.fields,api:g.action,row:g.data,relatedQueryKeys:x})]})};x.propTypes={actions:s().array,label:s().string}}},e=>{var t=t=>e(e.s=t);e.O(0,[5069,636,6593,8792],()=>t(86478)),_N_E=e.O()}]);