(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3301],{19346:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(93944),a=n(37876);let r=(0,i.A)((0,a.jsx)("path",{fillRule:"evenodd",d:"M20 3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M10 17H5v-2h5zm0-4H5v-2h5zm0-4H5V7h5zm4.82 6L12 12.16l1.41-1.41 1.41 1.42L17.99 9l1.42 1.42z"}),"FactCheck")},46041:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(14232);let a=i.forwardRef(function(e,t){let{title:n,titleId:a,...r}=e;return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},r),n?i.createElement("title",{id:a},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))})},50387:(e,t,n)=>{"use strict";n.d(t,{f:()=>y});var i=n(37876),a=n(14232),r=n(14e3),l=n(89099),s=n(95062),o=n.n(s),d=n(46041),c=n(67578),u=n(86650),h=n(22474),p=n(47737),m=n(94810),x=n(77018),v=n(76776),g=n(8578),j=n(76626),f=n(71538),A=n(95449),b=n(89273);let y=e=>{let{children:t,tabOptions:n,title:s,subtitle:o,actions:y,actionsData:w,isFetching:C=!1,backUrl:T}=e,S=(0,b.A)(e=>e.breakpoints.down("md")),V=(0,l.useRouter)(),I=(0,r.usePathname)(),R=V.query,N=(0,a.useCallback)((e,t)=>{V.push({pathname:t,query:R},void 0,{shallow:!0})},[V]),L=n.find(e=>e.path===I);return(0,i.jsx)(c.A,{sx:{flexGrow:1,py:4},children:(0,i.jsx)(u.A,{maxWidth:"xl",sx:{height:"100%"},children:(0,i.jsxs)(h.A,{spacing:1,sx:{height:"100%"},children:[(0,i.jsxs)(h.A,{spacing:2,children:[(0,i.jsx)("div",{children:(0,i.jsx)(p.A,{color:"inherit",onClick:()=>T?V.push(T):V.back(),startIcon:(0,i.jsx)(m.A,{fontSize:"small",children:(0,i.jsx)(d.A,{})}),children:"Back to previous page"})}),(0,i.jsxs)(h.A,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:1,children:[(0,i.jsxs)(h.A,{spacing:1,children:[(0,i.jsx)(h.A,{alignItems:"center",direction:"row",spacing:1,justifyContent:"space-between",children:(0,i.jsx)(x.A,{variant:S?"h6":"h4",children:s})}),C?(0,i.jsx)(v.A,{variant:"text",width:200}):o&&(0,i.jsx)(h.A,{alignItems:"center",flexWrap:"wrap",direction:"row",spacing:2,children:o.map((e,t)=>(0,i.jsxs)(h.A,{alignItems:"center",direction:"row",spacing:1,children:[(0,i.jsx)(m.A,{fontSize:"small",children:e.icon}),(0,i.jsx)(x.A,{color:"text.secondary",variant:"body2",children:e.text})]},t))})]}),y&&y.length>0&&(0,i.jsx)(A.$,{actions:y,data:w,disabled:C})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(g.A,{onChange:N,value:null==L?void 0:L.path,variant:"scrollable",children:n.map(e=>(0,i.jsx)(j.A,{label:e.label,value:e.path},e.path))}),(0,i.jsx)(f.A,{})]})]}),(0,i.jsx)(c.A,{sx:!S&&{flexGrow:1,overflow:"auto",height:"calc(100vh - 400px)"},children:t})]})})})};y.propTypes={children:o().node,tabOptions:o().arrayOf(o().shape({label:o().string.isRequired,path:o().string.isRequired})).isRequired,title:o().string.isRequired,subtitle:o().arrayOf(o().shape({icon:o().node.isRequired,text:o().string.isRequired})),actions:o().arrayOf(o().shape({label:o().string.isRequired,handler:o().func.isRequired})),isFetching:o().bool}},50834:e=>{"use strict";e.exports=JSON.parse('[{"label":"Manage Drift","path":"/tenant/standards/manage-drift"},{"label":"Policies and Settings Deployed","path":"/tenant/standards/manage-drift/policies-deployed"},{"label":"History","path":"/tenant/standards/manage-drift/history"},{"label":"Tenant Report","path":"/tenant/standards/manage-drift/compare"}]')},74235:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>H});var i=n(37876),a=n(14232),r=n(22474),l=n(59017),s=n(67578),o=n(76776),d=n(54538),c=n(71538),u=n(68284),h=n(75720),p=n(22430),m=n(70946),x=n(66741),v=n(47737),g=n(46061),j=n(77018),f=n(12435),A=n(50387),b=n(19346),y=n(79259),w=n(7159),C=n(16652),T=n(48504),S=n(30753),V=n(14628),I=n(29468),R=n(27418);let N=(0,n(93944).A)((0,i.jsx)("path",{d:"M2 3h9v9H2V3m9 19H2v-9h9v9M21 3v9h-9V3h9m0 19h-9v-9h9v9Z"}),"Microsoft");var L=n(75069),k=n(79803),D=n(94810),O=n(88992),z=n(17825),E=n(22322),M=n(89099),W=n(82836),F=n(59568),_=n(12227);let q=a.forwardRef(function(e,t){let{title:n,titleId:i,...r}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},r),n?a.createElement("title",{id:i},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});var G=n(29720),P=n(50834);let J=()=>{var e,t,n,f,J,H,U,B,K;let{templateId:Q}=(0,M.useRouter)().query,[X,Z]=(0,a.useState)(null),$=(0,z.t)(),Y=null==$?void 0:$.currentTenant,ee=(0,O.mN)({mode:"onBlur",defaultValues:{comparisonMode:"standard"}}),et=(0,W.s)(),[en,ei]=(0,a.useState)("all"),[ea,er]=(0,a.useState)(""),el=(0,E.R_)({url:"/api/listStandardTemplates",queryKey:"listStandardTemplates-reports"});(0,E.nN)({relatedQueryKeys:["ListStandardsCompare"]});let es={type:"GET",url:"/api/ExecStandardsRun",data:{TemplateId:Q},confirmText:"Are you sure you want to run this standard report?"},eo=(0,E.R_)({url:"/api/ListStandardsCompare",data:{TemplateId:Q,tenantFilter:Y,CompareToStandard:!0},queryKey:"ListStandardsCompare-".concat(Q,"-").concat(ee.watch("compareTenantId")||"standard","-").concat(Y),enabled:!!Q});(0,a.useEffect)(()=>{if(Q&&el.isSuccess&&el.data){let e=el.data.find(e=>e.GUID===Q);if(e&&eo.isSuccess&&eo.data){let t=eo.data.find(e=>e.tenantFilter===Y),n=t&&t.standardsResults||[],i=[];e.standards&&Object.entries(e.standards).forEach(a=>{let[r,l]=a;if("IntuneTemplate"===r&&Array.isArray(l))l.forEach((a,r)=>{var l,s,o;let d=null===(l=a.TemplateList)||void 0===l?void 0:l.value;if(d){let r="standards.IntuneTemplate.".concat(d),l=L.find(e=>"standards.IntuneTemplate"===e.name),c=n.find(e=>e.standardId===r),u=null==t?void 0:t[r],h=null==u?void 0:u.Value,p=!1;!0===h?p=!0:void 0!==h&&"object"!=typeof h?p=!0:c&&(p=!0===c.value);let m={templateId:d,Template:(null===(s=a.TemplateList)||void 0===s?void 0:s.label)||"Unknown Template","Assign to":a.AssignTo||"On","Excluded Group":a.excludeGroup||"","Included Group":a.customGroup||""};i.push({standardId:r,standardName:"Intune Template: ".concat((null===(o=a.TemplateList)||void 0===o?void 0:o.label)||d),currentTenantValue:void 0!==u?{Value:h,LastRefresh:null==u?void 0:u.LastRefresh}:null==c?void 0:c.value,standardValue:m,complianceStatus:p?"Compliant":"Non-Compliant",complianceDetails:(null==l?void 0:l.docsDescription)||(null==l?void 0:l.helpText)||"",standardDescription:(null==l?void 0:l.helpText)||"",standardImpact:(null==l?void 0:l.impact)||"Medium Impact",standardImpactColour:(null==l?void 0:l.impactColour)||"warning",templateName:(null==e?void 0:e.templateName)||"Standard Template",templateActions:a.action||[]})}});else if("ConditionalAccessTemplate"===r&&Array.isArray(l))l.forEach((a,r)=>{var l,s,o;let d=null===(l=a.TemplateList)||void 0===l?void 0:l.value;if(d){let r="standards.ConditionalAccessTemplate.".concat(d),l=L.find(e=>"standards.ConditionalAccessTemplate"===e.name),c=n.find(e=>e.standardId===r),u=null==t?void 0:t[r],h=null==u?void 0:u.Value,p=!1;p=!0===h;let m={templateId:d,Template:(null===(s=a.TemplateList)||void 0===s?void 0:s.label)||"Unknown Template"};i.push({standardId:r,standardName:"Conditional Access Template: ".concat((null===(o=a.TemplateList)||void 0===o?void 0:o.label)||d),currentTenantValue:void 0!==u?{Value:h,LastRefresh:null==u?void 0:u.LastRefresh}:null==c?void 0:c.value,standardValue:m,complianceStatus:p?"Compliant":"Non-Compliant",complianceDetails:(null==l?void 0:l.docsDescription)||(null==l?void 0:l.helpText)||"",standardDescription:(null==l?void 0:l.helpText)||"",standardImpact:(null==l?void 0:l.impact)||"Medium Impact",standardImpactColour:(null==l?void 0:l.impactColour)||"warning",templateName:(null==e?void 0:e.templateName)||"Standard Template",templateActions:a.action||[]})}});else{var s,o;let a="standards.".concat(r),d=L.find(e=>e.name===a),c=(null===(s=l.standards)||void 0===s?void 0:s[r])||{},u=(null!==(o=null==l?void 0:l.action)&&void 0!==o?o:[]).filter(e=>(null==e?void 0:e.value.toLowerCase())==="report"||(null==e?void 0:e.value.toLowerCase())==="remediate").length>0,h=n.find(e=>e.standardId===a),p=!1,m=!u;a.replace("standards.","");let x=null==t?void 0:t[a],v=null==x?void 0:x.Value;!0===v?p=!0:void 0!==v?p=JSON.stringify(v)===JSON.stringify(c):h&&(p="boolean"==typeof c&&!0===c?!0===h.value:JSON.stringify(h.value)===JSON.stringify(c));let g=m?"Reporting Disabled":p?"Compliant":"Non-Compliant";i.push({standardId:a,standardName:(null==d?void 0:d.label)||r,currentTenantValue:void 0!==x?{Value:v,LastRefresh:null==x?void 0:x.LastRefresh}:null==h?void 0:h.value,standardValue:c,complianceStatus:g,reportingDisabled:m,complianceDetails:(null==d?void 0:d.docsDescription)||(null==d?void 0:d.helpText)||"",standardDescription:(null==d?void 0:d.helpText)||"",standardImpact:(null==d?void 0:d.impact)||"Medium Impact",standardImpactColour:(null==d?void 0:d.impactColour)||"warning",templateName:e.templateName||"Standard Template",templateActions:l.action||[]})}}),Z(i)}else Z([])}else eo.isError&&Z([])},[Q,el.isSuccess,el.data,eo.isSuccess,eo.data,eo.isError]);let ed=(0,a.useMemo)(()=>{if(!X)return{};let e={};return X.forEach(t=>{let n=L.find(e=>t.standardId.includes(e.name)),i=(null==n?void 0:n.cat)||"Other Standards";e[i]||(e[i]=[]),e[i].push(t)}),Object.keys(e).forEach(t=>{e[t].sort((e,t)=>e.standardName.localeCompare(t.standardName))}),e},[X]),ec=(0,a.useMemo)(()=>{if(!ed)return{};if(!ea&&"all"===en)return ed;let e={},t=ea.toLowerCase();return Object.keys(ed).forEach(n=>{let i=!ea||n.toLowerCase().includes(t),a=ed[n].filter(e=>{var n;let a=(null===(n=e.currentTenantValue)||void 0===n?void 0:n.Value)||e.currentTenantValue,r="string"==typeof a&&a.startsWith("License Missing:"),l="all"===en||"compliant"===en&&"Compliant"===e.complianceStatus||"nonCompliant"===en&&"Non-Compliant"===e.complianceStatus||"nonCompliantWithLicense"===en&&"Non-Compliant"===e.complianceStatus&&!r||"nonCompliantWithoutLicense"===en&&"Non-Compliant"===e.complianceStatus&&r,s=!ea||i||e.standardName.toLowerCase().includes(t)||e.standardDescription.toLowerCase().includes(t);return l&&s});a.length>0&&(e[n]=a)}),e},[ed,ea,en]),eu=(null==X?void 0:X.length)||0,eh=(null==X?void 0:X.filter(e=>"Compliant"===e.complianceStatus).length)||0,ep=(null==X?void 0:X.filter(e=>"Non-Compliant"===e.complianceStatus).length)||0,em=(null==X?void 0:X.filter(e=>"Reporting Disabled"===e.complianceStatus).length)||0,ex=(null==X?void 0:X.filter(e=>{var t;let n=(null===(t=e.currentTenantValue)||void 0===t?void 0:t.Value)||e.currentTenantValue;return"string"==typeof n&&n.startsWith("License Missing:")}).length)||0,ev=(null==X?void 0:X.filter(e=>{var t;let n=(null===(t=e.currentTenantValue)||void 0===t?void 0:t.Value)||e.currentTenantValue;return"Non-Compliant"===e.complianceStatus&&!("string"==typeof n&&n.startsWith("License Missing:"))}).length)||0,eg=(null==X?void 0:X.filter(e=>{var t;let n=(null===(t=e.currentTenantValue)||void 0===t?void 0:t.Value)||e.currentTenantValue;return"Non-Compliant"===e.complianceStatus&&"string"==typeof n&&n.startsWith("License Missing:")}).length)||0,ej=eu>0?Math.round(eh/(eu-em||1)*100):0,ef=eu>0?Math.round(ex/(eu-em||1)*100):0,eA=ej+ef,eb=(null==el?void 0:null===(n=el.data)||void 0===n?void 0:null===(t=n.filter(e=>e.GUID===Q))||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.templateName)||"Tenant Report",ey=[...(null==el?void 0:null===(J=el.data)||void 0===J?void 0:null===(f=J.filter(e=>e.GUID===Q))||void 0===f?void 0:f[0])?[{component:(0,i.jsxs)(r.A,{alignItems:"center",flexWrap:"wrap",direction:"row",spacing:2,children:[(0,i.jsx)(l.A,{icon:(0,i.jsx)(D.A,{fontSize:"small",children:(0,i.jsx)(b.A,{})}),label:"".concat(ej,"% Compliant"),variant:"outlined",size:"small",color:100===ej?"success":ej>=50?"warning":"error"}),(0,i.jsx)(l.A,{label:"".concat(ef,"% Missing Required License"),variant:"outlined",size:"small",color:0===ef?"success":ef<=25?"warning":"error"}),(0,i.jsx)(l.A,{label:"".concat(eA,"% Combined Score"),variant:"outlined",size:"small",color:eA>=80?"success":eA>=60?"warning":"error"})]})}]:[],...(null==el?void 0:null===(B=el.data)||void 0===B?void 0:null===(U=B.filter(e=>e.GUID===Q))||void 0===U?void 0:null===(H=U[0])||void 0===H?void 0:H.description)?[{component:(0,i.jsx)(s.A,{sx:{"& a":{color:e=>e.palette.primary.main,textDecoration:"underline"},color:"text.secondary",fontSize:"0.875rem","& p":{my:0},mt:1},dangerouslySetInnerHTML:{__html:_.default.sanitize(null==el?void 0:null===(K=el.data)||void 0===K?void 0:K.filter(e=>e.GUID===Q)[0].description)}})}]:[]],ew=[{label:"Refresh Data",icon:(0,i.jsx)(y.A,{}),noConfirm:!0,customFunction:()=>{eo.refetch(),el.refetch()}},...Q?[{label:"Run Standard Now (Currently Selected Tenant only)",type:"GET",url:"/api/ExecStandardsRun",icon:(0,i.jsx)(w.A,{}),data:{TemplateId:Q},confirmText:"Are you sure you want to force a run of this standard?",multiPost:!1},{label:"Run Standard Now (All Tenants in Template)",type:"GET",url:"/api/ExecStandardsRun",icon:(0,i.jsx)(w.A,{}),data:{TemplateId:Q,tenantFilter:"allTenants"},confirmText:"Are you sure you want to force a run of this standard?",multiPost:!1}]:[]];return(0,i.jsx)(A.f,{tabOptions:P,title:eb,subtitle:ey,backUrl:"/tenant/standards/list-standards",actions:ew,actionsData:{},isFetching:eo.isFetching||el.isFetching,children:(0,i.jsxs)(s.A,{sx:{py:2},children:[eo.isFetching&&(0,i.jsx)(i.Fragment,{children:[1,2,3].map(e=>(0,i.jsxs)(F.A,{container:!0,spacing:3,sx:{mb:4},children:[(0,i.jsx)(F.A,{size:12,children:(0,i.jsxs)(r.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2,px:1},children:[(0,i.jsxs)(r.A,{direction:{xs:"column",sm:"row"},alignItems:"center",spacing:2,children:[(0,i.jsx)(o.A,{variant:"circular",width:40,height:40}),(0,i.jsx)(o.A,{variant:"text",width:200,height:32})]}),(0,i.jsx)(o.A,{variant:"text",width:100,height:24})]})}),(0,i.jsx)(F.A,{size:{xs:12,md:6},children:(0,i.jsxs)(d.A,{sx:{height:"100%"},children:[(0,i.jsx)(r.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{p:3},children:(0,i.jsxs)(r.A,{direction:{xs:"column",sm:"row"},alignItems:"center",spacing:3,children:[(0,i.jsx)(o.A,{variant:"circular",width:40,height:40}),(0,i.jsxs)(r.A,{children:[(0,i.jsx)(o.A,{variant:"text",width:150,height:32}),(0,i.jsx)(o.A,{variant:"text",width:120,height:24,sx:{mt:1}})]})]})}),(0,i.jsx)(c.A,{}),(0,i.jsxs)(s.A,{sx:{p:3},children:[(0,i.jsx)(o.A,{variant:"text",width:"100%",height:20}),(0,i.jsx)(o.A,{variant:"text",width:"90%",height:20}),(0,i.jsx)(o.A,{variant:"text",width:"95%",height:20})]})]})}),(0,i.jsx)(F.A,{size:{xs:12,md:6},children:(0,i.jsxs)(d.A,{sx:{height:"100%"},children:[(0,i.jsx)(r.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{p:3},children:(0,i.jsxs)(r.A,{direction:"row",alignItems:"center",spacing:3,children:[(0,i.jsx)(o.A,{variant:"circular",width:40,height:40}),(0,i.jsxs)(r.A,{children:[(0,i.jsx)(o.A,{variant:"text",width:150,height:32}),(0,i.jsx)(o.A,{variant:"text",width:120,height:24,sx:{mt:1}})]})]})}),(0,i.jsx)(c.A,{}),(0,i.jsxs)(s.A,{sx:{p:3},children:[(0,i.jsx)(o.A,{variant:"text",width:"100%",height:20}),(0,i.jsx)(o.A,{variant:"text",width:"85%",height:20}),(0,i.jsx)(o.A,{variant:"text",width:"90%",height:20})]})]})})]},e))}),!eo.isFetching&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.A,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mt:2,alignItems:{xs:"flex-start",sm:"center"},displayPrint:"none"},children:[(0,i.jsx)(r.A,{direction:"row",alignItems:"center",spacing:1,sx:{flexGrow:1},children:(0,i.jsx)(u.A,{size:"small",variant:"filled",fullWidth:{xs:!0,sm:!1},sx:{width:{xs:"100%",sm:350}},placeholder:"Search...",value:ea,onChange:e=>er(e.target.value),slotProps:{input:{startAdornment:(0,i.jsx)(h.A,{position:"start",sx:{margin:"0 !important"},children:(0,i.jsx)(C.A,{})}),endAdornment:ea&&(0,i.jsx)(h.A,{position:"end",children:(0,i.jsx)(p.A,{title:"Clear search",children:(0,i.jsx)(m.A,{size:"small",onClick:()=>er(""),"aria-label":"Clear search",children:(0,i.jsx)(T.A,{})})})})}}})}),(0,i.jsxs)(x.A,{variant:"outlined",color:"primary",size:"small",children:[(0,i.jsx)(v.A,{disabled:!0,color:"primary",children:(0,i.jsx)(D.A,{fontSize:"small",children:(0,i.jsx)(S.A,{})})}),(0,i.jsxs)(v.A,{variant:"all"===en?"contained":"outlined",onClick:()=>ei("all"),children:["All (",eu,")"]}),(0,i.jsxs)(v.A,{variant:"compliant"===en?"contained":"outlined",onClick:()=>ei("compliant"),children:["Compliant (",eh,")"]}),(0,i.jsxs)(v.A,{variant:"nonCompliant"===en?"contained":"outlined",onClick:()=>ei("nonCompliant"),children:["Non-Compliant (",ep,")"]}),(0,i.jsxs)(v.A,{variant:"nonCompliantWithLicense"===en?"contained":"outlined",onClick:()=>ei("nonCompliantWithLicense"),children:["Non-Compliant (License available) (",ev,")"]}),(0,i.jsxs)(v.A,{variant:"nonCompliantWithoutLicense"===en?"contained":"outlined",onClick:()=>ei("nonCompliantWithoutLicense"),children:["Non-Compliant (License not available) (",eg,")"]})]})]}),eo.isError&&(0,i.jsxs)(d.A,{sx:{mb:4,p:3,borderRadius:2,boxShadow:2},children:[(0,i.jsx)(g.A,{severity:"error",sx:{mb:2},children:"Error fetching comparison data"}),(0,i.jsx)(j.A,{variant:"body2",children:'There was an error retrieving the comparison data. Please try running the report again by clicking the "Run Report Once" button above.'}),eo.error&&(0,i.jsx)(s.A,{sx:{mt:2,p:2,bgcolor:"background.default",borderRadius:1,border:"1px solid",borderColor:"divider"},children:(0,i.jsx)(j.A,{variant:"caption",component:"pre",sx:{whiteSpace:"pre-wrap"},children:eo.error.message||JSON.stringify(eo.error,null,2)})})]}),eo.isSuccess&&(!eo.data||0===eo.data.length)&&(0,i.jsxs)(d.A,{sx:{mb:4,p:3,borderRadius:2,boxShadow:2},children:[(0,i.jsx)(g.A,{severity:"info",sx:{mb:2},children:"No comparison data is available. This might be because:"}),(0,i.jsxs)(s.A,{sx:{pl:2},children:[(0,i.jsx)(j.A,{variant:"body2",sx:{mb:1},children:"• The tenant has not been scanned yet"}),(0,i.jsx)(j.A,{variant:"body2",sx:{mb:1},children:"• The template has no standards configured"}),(0,i.jsx)(j.A,{variant:"body2",sx:{mb:2},children:"• There was an issue with the comparison"})]}),(0,i.jsx)(j.A,{variant:"body2",children:'Try running the report by clicking the "Run Report Once" button above.'})]}),ec&&0===Object.keys(ec).length&&(0,i.jsxs)(d.A,{sx:{mb:4,p:3,borderRadius:2,boxShadow:2},children:[(0,i.jsx)(g.A,{severity:"info",sx:{mb:2},children:"No standards match the selected filter criteria or search query."}),(0,i.jsx)(j.A,{variant:"body2",children:"Try selecting a different filter or modifying the search query."})]}),Object.keys(ec).map(e=>(0,i.jsxs)(a.Fragment,{children:[(0,i.jsx)(j.A,{variant:"h6",sx:{mb:2,mt:3},children:e}),ec[e].map((e,t)=>{var n,a,o,u,h,p,m,x,v;return(0,i.jsxs)(F.A,{container:!0,spacing:3,sx:{mb:4},children:[(0,i.jsx)(F.A,{size:{xs:12,md:6},children:(0,i.jsxs)(d.A,{sx:{height:"100%",borderRadius:2,boxShadow:2},children:[(0,i.jsx)(r.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{p:3},children:(0,i.jsx)(r.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{width:"100%"},children:(0,i.jsxs)(r.A,{direction:"row",alignItems:"center",spacing:3,children:[(0,i.jsx)(s.A,{sx:{width:40,height:40,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"Compliant"===e.complianceStatus?"success.main":"Reporting Disabled"===e.complianceStatus?"grey.500":"error.main"},children:"Compliant"===e.complianceStatus?(0,i.jsx)(V.A,{sx:{color:"white"}}):"Reporting Disabled"===e.complianceStatus?(0,i.jsx)(I.A,{sx:{color:"white"}}):(0,i.jsx)(R.A,{sx:{color:"white"}})}),(0,i.jsxs)(r.A,{children:[(0,i.jsx)(j.A,{variant:"h6",children:null==e?void 0:e.standardName}),(0,i.jsx)(s.A,{children:(0,i.jsx)(l.A,{label:"Standard",size:"small",color:"info",variant:"outlined",sx:{mt:1,px:2}})})]})]})})}),(0,i.jsx)(c.A,{}),(0,i.jsxs)(s.A,{sx:{p:3},children:[e.standardValue?(0,i.jsx)(s.A,{children:(0,i.jsx)(s.A,{children:(0,i.jsx)(s.A,{sx:{p:2,bgcolor:"background.default",borderRadius:1,border:"1px solid",borderColor:"divider"},children:e.standardValue&&"object"==typeof e.standardValue&&Object.keys(e.standardValue).length>0?Object.entries(e.standardValue).map(e=>{let[t,n]=e;return(0,i.jsxs)(s.A,{sx:{display:"flex",mb:.5},children:[(0,i.jsxs)(j.A,{variant:"body2",sx:{fontWeight:"medium",mr:1},children:[t,":"]}),(0,i.jsx)(j.A,{variant:"body2",children:"object"==typeof n&&null!==n?(null==n?void 0:n.label)||JSON.stringify(n):!0===n?"Enabled":!1===n?"Disabled":String(n)})]},t)}):(0,i.jsx)(j.A,{variant:"body2",children:!0===e.standardValue?(0,i.jsx)(g.A,{severity:"success",sx:{mt:1},children:"This setting is configured correctly"}):!1===e.standardValue?(0,i.jsx)(g.A,{severity:"warning",sx:{mt:1},children:"This setting is not configured correctly"}):void 0!==e.standardValue?"object"==typeof e.standardValue?"No settings configured":String(e.standardValue):(0,i.jsx)(g.A,{severity:"info",sx:{mt:1},children:"This setting is not configured, or data has not been collected. If you are getting this after data collection, the tenant might not be licensed for this feature"})})})})}):(0,i.jsx)(g.A,{severity:"info",sx:{mb:2},children:"This data has not yet been collected. Collect the data by pressing the report button on the top of the page."}),(0,i.jsx)(s.A,{sx:{mt:2,display:"flex",alignItems:"center"},children:(0,i.jsx)(l.A,{label:e.standardImpact||"Medium Impact",size:"small",color:"info"===e.standardImpactColour?"info":"warning"===e.standardImpactColour?"warning":"error",sx:{mr:1}})})]})]})}),(0,i.jsx)(F.A,{size:{xs:12,md:6},children:(0,i.jsxs)(d.A,{sx:{height:"100%",borderRadius:2,boxShadow:2},children:[(0,i.jsx)(r.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{p:3},children:(0,i.jsxs)(r.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{width:"100%"},children:[(0,i.jsxs)(r.A,{direction:"row",alignItems:"center",spacing:3,children:[(0,i.jsx)(s.A,{sx:{width:40,height:40,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main"},children:(0,i.jsx)(N,{sx:{color:"white"}})}),(0,i.jsxs)(r.A,{children:[(0,i.jsx)(j.A,{variant:"h6",children:Y}),(0,i.jsx)(s.A,{children:(0,i.jsx)(l.A,{label:"Current Tenant",size:"small",color:"primary",variant:"outlined",sx:{mt:1,px:2}})})]})]}),(0,i.jsxs)(r.A,{spacing:1,children:[(0,i.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},children:[(0,i.jsx)(s.A,{sx:{backgroundColor:"Compliant"===e.complianceStatus?"success.main":"Reporting Disabled"===e.complianceStatus?"grey.500":"error.main",borderRadius:"50%",width:8,height:8,mr:1}}),(0,i.jsx)(j.A,{variant:"body2",sx:{mr:1},children:e.complianceStatus})]}),(null===(n=e.currentTenantValue)||void 0===n?void 0:n.LastRefresh)&&(0,i.jsx)(l.A,{icon:(0,i.jsx)(D.A,{fontSize:"small",children:(0,i.jsx)(q,{})}),size:"small",label:"".concat(new Date(e.currentTenantValue.LastRefresh).toLocaleString()),variant:"outlined"})]})]})}),(0,i.jsx)(c.A,{}),(0,i.jsx)(s.A,{sx:{p:3},children:"object"==typeof(null===(a=e.currentTenantValue)||void 0===a?void 0:a.Value)&&(null===(o=e.currentTenantValue)||void 0===o?void 0:o.Value)!==null?(0,i.jsx)(s.A,{sx:{p:2,bgcolor:"background.default",borderRadius:1,border:"1px solid",borderColor:"divider"},children:"Reporting Disabled"===e.complianceStatus?(0,i.jsx)(g.A,{severity:"info",sx:{mt:1},children:"Reporting is disabled for this standard in the template configuration."}):(0,i.jsxs)(i.Fragment,{children:["Compliant"===e.complianceStatus?(0,i.jsx)(g.A,{severity:"success",sx:{mb:2},children:"This setting is configured correctly"}):(null===(u=e.currentTenantValue)||void 0===u?void 0:u.Value)===!1?(0,i.jsx)(g.A,{severity:"warning",sx:{mb:2},children:"This setting is not configured correctly"}):null,("Compliant"!==e.complianceStatus||(null===(h=e.currentTenantValue)||void 0===h?void 0:h.Value)!==!0&&(null===(p=e.currentTenantValue)||void 0===p?void 0:p.Value)!==!1)&&Object.entries(e.currentTenantValue).filter(t=>{var n,i;let[a]=t;return"LastRefresh"!==a&&("Value"!==a||(null===(n=e.currentTenantValue)||void 0===n?void 0:n.Value)!==!0&&(null===(i=e.currentTenantValue)||void 0===i?void 0:i.Value)!==!1)}).map(t=>{let[n,a]=t,r=e.standardValue&&"object"==typeof e.standardValue?e.standardValue[n]:void 0,l=void 0!==r&&JSON.stringify(a)!==JSON.stringify(r);return(0,i.jsxs)(s.A,{sx:{display:"flex",mb:.5},children:[(0,i.jsxs)(j.A,{variant:"body2",sx:{fontWeight:"medium",mr:1},children:[n,":"]})," ",(0,i.jsx)(j.A,{variant:"body2",sx:{color:"Compliant"===e.complianceStatus?"success.main":l?"error.main":"inherit",fontWeight:"Non-Compliant"===e.complianceStatus&&l?"medium":"inherit"},children:"object"==typeof a&&null!==a?(null==a?void 0:a.label)||JSON.stringify(a):!0===a?"Enabled":!1===a?"Disabled":String(a)})]},n)})]})}):(0,i.jsx)(j.A,{variant:"body1",sx:{whiteSpace:"pre-wrap",color:"Compliant"===e.complianceStatus?"success.main":"Reporting Disabled"===e.complianceStatus?"text.secondary":"error.main",fontWeight:"Non-Compliant"===e.complianceStatus?"medium":"inherit"},children:"Reporting Disabled"===e.complianceStatus?(0,i.jsx)(g.A,{severity:"info",sx:{mt:1},children:"Reporting is disabled for this standard in the template configuration."}):"Compliant"===e.complianceStatus?(0,i.jsx)(g.A,{severity:"success",sx:{mt:1},children:"This setting is configured correctly"}):(null===(m=e.currentTenantValue)||void 0===m?void 0:m.Value)===!1||!1===e.currentTenantValue?(0,i.jsx)(g.A,{severity:"warning",sx:{mt:1},children:"This setting is not configured correctly"}):void 0!==e.currentTenantValue?String((null===(x=e.currentTenantValue)||void 0===x?void 0:x.Value)!==void 0?null===(v=e.currentTenantValue)||void 0===v?void 0:v.Value:e.currentTenantValue):(0,i.jsx)(g.A,{severity:"info",sx:{mt:1},children:"This setting is not configured, or data has not been collected. If you are getting this after data collection, the tenant might not be licensed for this feature"})})})]})}),e.complianceDetails&&(0,i.jsx)(F.A,{size:12,children:(0,i.jsx)(d.A,{sx:{borderRadius:2,boxShadow:1},children:(0,i.jsxs)(r.A,{direction:"row",alignItems:"flex-start",spacing:2,sx:{p:3},children:[(0,i.jsx)(s.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",color:"info.main"},children:(0,i.jsx)(I.A,{})}),(0,i.jsx)(s.A,{sx:{"& a":{color:e=>e.palette.primary.main,textDecoration:"underline","&:hover":{textDecoration:"none"}},fontSize:"0.875rem",lineHeight:1.43,"& p":{my:0},flex:1},children:(0,i.jsx)(G.oz,{components:{a:e=>{let{href:t,children:n,...a}=e;return(0,i.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",...a,children:n})},p:e=>{let{children:t}=e;return(0,i.jsx)("span",{children:t})}},children:e.complianceDetails})})]})})})]},t)})]},e))]}),(0,i.jsx)(k.B,{createDialog:et,title:"Run Standard Report",api:{...es,data:{...es.data,TemplateId:Q}},relatedQueryKeys:["ListStandardsCompare"]})]})})};J.getLayout=e=>(0,i.jsx)(f.P,{children:e});let H=J},95449:(e,t,n)=>{"use strict";n.d(t,{$:()=>v});var i=n(37876),a=n(54550),r=n(95062),l=n.n(r),s=n(47737),o=n(94810),d=n(52808),c=n(6003),u=n(93256),h=n(50221),p=n(14232),m=n(82836),x=n(79803);let v=e=>{var t;let{actions:n=[],label:r="Actions",data:l,queryKeys:v,...g}=e,j=(0,h.f)(),[f,A]=(0,p.useState)({data:{},action:{},ready:!1}),b=(0,m.s)(),y=(e,t)=>!e||null!=t&&!!t.condition&&!(null==t?void 0:t.condition(e));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.A,{onClick:j.handleOpen,ref:j.anchorRef,startIcon:(0,i.jsx)(o.A,{fontSize:"small",children:(0,i.jsx)(a.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap"},children:"Actions"}),(0,i.jsx)(d.A,{anchorEl:j.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:j.handleClose,open:j.open,transformOrigin:{horizontal:"right",vertical:"top"},children:null==n?void 0:n.filter(e=>!e.link||e.showInActionsMenu).map((e,t)=>(0,i.jsxs)(c.A,{disabled:y(l,e),onClick:()=>{A({data:l,action:e,ready:!0}),(null==e?void 0:e.noConfirm)&&e.customFunction?e.customFunction(l,e,{}):(b.handleOpen(),j.handleClose())},children:[(0,i.jsx)(o.A,{fontSize:"small",sx:{minWidth:"30px"},children:e.icon}),(0,i.jsx)(u.A,{children:e.label})]},t))}),f.ready&&(0,i.jsx)(x.B,{createDialog:b,title:"Confirmation",fields:null===(t=f.action)||void 0===t?void 0:t.fields,api:f.action,row:f.data,relatedQueryKeys:v})]})};v.propTypes={actions:l().array,label:l().string}},97550:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/standards/manage-drift/compare",function(){return n(74235)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[2412,5069,636,6593,8792],()=>t(97550)),_N_E=e.O()}]);