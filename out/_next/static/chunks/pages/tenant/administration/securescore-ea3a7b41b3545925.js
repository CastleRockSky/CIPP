(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9747],{5613:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(14232);let r=a.forwardRef(function(e,t){let{title:n,titleId:r,...i}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},i),n?a.createElement("title",{id:r},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))})},9218:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(93944),r=n(37876);let i=(0,a.A)((0,r.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 2h1.5v3l2-3h1.7l-2 3 2 3h-1.7l-2-3v3H12zM7 7.25h2.5V6.5H7V5h4v3.75H8.5v.75H11V11H7zM19 13l-6 6-4-4-4 4v-2.5l4-4 4 4 6-6z"}),"Score")},10928:e=>{"use strict";e.exports=JSON.parse('[{"label":"Tenant Overview","path":"/tenant/administration/securescore"},{"label":"Table Overview","path":"/tenant/administration/securescore/table"}]')},17055:(e,t,n)=>{"use strict";n.d(t,{L:()=>d});var a=n(37876),r=n(14e3),i=n(67578),o=n(22474),s=n(8578),l=n(76626),c=n(71538);let d=e=>{let{tabOptions:t,children:n}=e,d=(0,r.useRouter)(),u=(0,r.usePathname)(),h=t.find(e=>e.path===u);return(0,a.jsxs)(i.A,{sx:{flexGrow:1,py:4},children:[(0,a.jsx)(o.A,{spacing:2,children:(0,a.jsxs)("div",{children:[(0,a.jsx)(s.A,{onChange:(e,t)=>{d.push(t)},value:null==h?void 0:h.path,variant:"scrollable",children:t.map(e=>(0,a.jsx)(l.A,{label:e.label,value:e.path},e.path))}),(0,a.jsx)(c.A,{})]})}),n]})}},41422:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(93944),r=n(37876);let i=(0,a.A)((0,r.jsx)("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"}),"Map")},45297:(e,t,n)=>{"use strict";n.d(t,{s:()=>m});var a=n(37876),r=n(14232),i=n(54538),o=n(22474),s=n(94810),l=n(22430),c=n(67578),d=n(77018),u=n(76776),h=n(59568),p=n(57016),x=n(5419);let m=e=>{let{data:t,isFetching:n}=e,[m,v]=(0,r.useState)(null);return(0,a.jsx)(i.A,{children:(0,a.jsx)(h.A,{container:!0,children:t.map((e,t)=>{var r,i,f,g,j;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{size:{md:3,sm:6,xs:12},onClick:e.offcanvas?()=>v(t):void 0,sx:{cursor:e.offcanvas?"pointer":"default",borderBottom:e=>({xs:"1px solid ".concat(e.palette.divider),md:"none"}),borderRight:e=>({md:"1px solid ".concat(e.palette.divider)}),"&:nth-of-type(3)":{borderBottom:e=>({xs:"1px solid ".concat(e.palette.divider),sm:"none"})},"&:nth-of-type(4)":{borderBottom:"none",borderRight:"none"}},children:(0,a.jsxs)(o.A,{alignItems:"center",direction:"row",spacing:2,sx:{p:2},children:[(null==e?void 0:e.icon)&&(0,a.jsx)(s.A,{color:e.color?e.color:"primary",fontSize:"small",children:e.icon}),(null==e?void 0:e.toolTip)?(0,a.jsx)(l.A,{title:e.toolTip,children:(0,a.jsxs)(c.A,{sx:()=>{if(!(null==e?void 0:e.icon))return{pl:2}},children:[(0,a.jsx)(d.A,{color:"text.secondary",variant:"overline",children:e.name}),(0,a.jsx)(d.A,{variant:"h6",children:n?(0,a.jsx)(u.A,{width:"100%"}):e.data})]})}):(0,a.jsxs)(c.A,{sx:()=>{if(!(null==e?void 0:e.icon))return{pl:2}},children:[(0,a.jsx)(d.A,{color:"text.secondary",variant:"overline",children:e.name}),(0,a.jsx)(d.A,{variant:"h6",children:n?(0,a.jsx)(u.A,{width:"100%"}):e.data})]})]})},e.name),e.offcanvas&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(p.w,{title:(null==e?void 0:null===(r=e.offcanvas)||void 0===r?void 0:r.title)||"Details",size:"md",visible:m===t,onClose:()=>v(null),children:(0,a.jsx)(c.A,{sx:{overflowY:"auto",maxHeight:"100%",display:"flex",flexDirection:"column"},children:(0,a.jsx)(h.A,{container:!0,spacing:1,children:(0,a.jsx)(h.A,{size:{xs:12},children:(null==e?void 0:null===(f=e.offcanvas)||void 0===f?void 0:null===(i=f.propertyItems)||void 0===i?void 0:i.length)>0&&(0,a.jsx)(x.a,{isFetching:n,align:"vertical",title:null==e?void 0:null===(g=e.offcanvas)||void 0===g?void 0:g.title,propertyItems:null!==(j=e.offcanvas.propertyItems)&&void 0!==j?j:[]})})})})})})]})})})})}},57093:(e,t,n)=>{"use strict";n.d(t,{D:()=>s});var a=n(14232),r=n(22322),i=n(17825),o=n(75069);function s(){let e=(0,i.t)().currentTenant;if("AllTenants"===e)return{controlScore:{isFetching:!1,isSuccess:!1,data:{Results:[]}},secureScore:{isFetching:!1,isSuccess:!1,data:{Results:[]}},translatedData:[],isFetching:!0,isSuccess:!1};let[t,n]=(0,a.useState)([]),[s,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),u=(0,r.R_)({url:"/api/ListGraphRequest",data:{Endpoint:"security/secureScoreControlProfiles",tenantFilter:e,$count:!0,$top:999},queryKey:"controlScore-".concat(e)}),h=(0,r.R_)({url:"/api/ListGraphRequest",data:{Endpoint:"security/secureScores",tenantFilter:e,$count:!0,noPagination:!0,$top:7},queryKey:"secureScore-".concat(e)});return(0,a.useEffect)(()=>{u.isFetching||h.isFetching?d(!0):d(!1)},[u.isFetching,h.isFetching]),(0,a.useEffect)(()=>{if(u.isSuccess&&h.isSuccess){var e,t,a,r;let i=h.data.Results[0],s=i.controlScores.map(e=>{var t;let n=null===(t=u.data.Results)||void 0===t?void 0:t.find(t=>t.id===e.controlName),a=o.find(t=>{var n;return null===(n=t.tag)||void 0===n?void 0:n.includes(e.controlName)});return{...e,title:null==n?void 0:n.title,threats:null==n?void 0:n.threats,complianceInformation:null==n?void 0:n.complianceInformation,actionUrl:a?"/tenant/standards/list-standards":null==n?void 0:n.actionUrl,remediation:a?"1. Enable the CIPP Standard: ".concat(a.label):null==n?void 0:n.remediation,remediationImpact:null==n?void 0:n.remediationImpact,implementationCost:null==n?void 0:n.implementationCost,tier:null==n?void 0:n.tier,userImpact:null==n?void 0:n.userImpact,vendorInformation:null==n?void 0:n.vendorInformation,controlStateUpdates:(null==n?void 0:n.controlStateUpdates)?n.controlStateUpdates.filter(e=>"Default"!==e.state):[]}});s.sort((e,t)=>t.scoreInPercentage-e.scoreInPercentage),n({...i,percentageCurrent:Math.round(i.currentScore/i.maxScore*100),percentageVsAllTenants:Math.round(null===(t=i.averageComparativeScores)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.averageScore),percentageVsSimilar:Math.round(null===(r=i.averageComparativeScores)||void 0===r?void 0:null===(a=r[1])||void 0===a?void 0:a.averageScore),controlScores:s}),l(!0)}},[u.isSuccess,h.isSuccess,u.data,h.data]),{controlScore:u,secureScore:h,translatedData:t,isFetching:c,isSuccess:s}}},74852:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>R});var a=n(37876),r=n(17055),i=n(12435),o=n(10928),s=n(57093),l=n(45297),c=n(86650),d=n(47737),u=n(67578),h=n(59017),p=n(77018),x=n(59568),m=n(5613),v=n(80581),f=n(41422),g=n(9218),j=n(85496),A=n(59808),y=n(84064),S=n(12227),b=n(79803),w=n(82836),C=n(14232),T=n(59919),k=n(12003),I=n(17825),F=n(14e3);let z=()=>{let e=(0,I.t)().currentTenant,t=(0,w.s)(),n=(0,s.D)(),[r,i]=(0,C.useState)({data:{},action:{},ready:!1}),[o,z]=(0,C.useState)({data:{},ready:!1}),R=(0,w.s)(),P=(0,F.useRouter)(),D=new A.A("en-US"),_=e=>{e.startsWith("https")?window.open(e,"_blank"):P.push(e)};return(0,a.jsx)(c.A,{sx:{flexGrow:1,py:2},maxWidth:!1,children:(0,a.jsxs)(x.A,{container:!0,spacing:2,children:["AllTenants"===e&&(0,a.jsx)(x.A,{size:{md:4,xs:12},children:(0,a.jsx)(k.k,{title:"Not supported",imageUrl:"/assets/illustrations/undraw_website_ij0l.svg",text:"The Tenant Overview does not support all Tenants, please select a different tenant using the tenant selector. Would you like to see the scores for all tenants? Check out the Best Practices report instead."})}),"AllTenants"!==e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{size:{md:12,xs:12},children:(0,a.jsx)(l.s,{isFetching:n.isFetching,data:[{icon:(0,a.jsx)(m.A,{}),data:n.translatedData.percentageCurrent+"%",name:"Current Score",color:"secondary"},{icon:(0,a.jsx)(v.A,{}),data:n.translatedData.percentageVsAllTenants+"%",name:"Compared score (All Tenants)",color:"green"},{icon:(0,a.jsx)(f.A,{}),data:n.translatedData.percentageVsSimilar+"%",name:"Compared score (Similar Tenants)"},{icon:(0,a.jsx)(g.A,{}),data:"".concat(n.translatedData.currentScore," of ").concat(n.translatedData.maxScore),name:"Score in points"}]})}),(0,a.jsx)(x.A,{size:{md:3,xs:12},children:(0,a.jsx)(j.b,{isFetching:n.isFetching,title:"Secure Score",chartSeries:n.secureScore.isSuccess?[{name:"Secure Score",data:n.secureScore.data.Results.map(e=>({x:D.format(new Date(e.createdDateTime)),y:e.currentScore})).reverse()}]:[],chartType:"area"})}),"AllTenants"!==e&&n.isSuccess&&n.translatedData.controlScores.map(e=>{var r,o,s,l,c,m;return(0,a.jsx)(x.A,{size:{md:3,xs:12},children:(0,a.jsx)(y.A,{title:e.title,isFetching:n.isFetching,cardSx:{display:"flex",flexDirection:"column",height:"100%"},CardButton:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{size:"small",onClick:()=>{i({data:e,ready:!0}),t.handleOpen()},variant:"contained",children:"Change Status"}),(0,a.jsx)(d.A,{size:"small",variant:"outlined",onClick:()=>_(e.actionUrl),children:"Remediate"}),(null===(r=e.controlStateUpdates)||void 0===r?void 0:r.length)>0&&(0,a.jsxs)(d.A,{size:"small",onClick:()=>{z({data:e,ready:!0}),R.handleOpen()},variant:"outlined",children:["Updates ","(".concat(null===(o=e.controlStateUpdates)||void 0===o?void 0:o.length,")")]})]}),children:(0,a.jsxs)(u.A,{sx:{flexGrow:1},children:[(0,a.jsx)(h.A,{variant:"outlined",label:"".concat(e.scoreInPercentage,"% ").concat((null===(l=e.controlStateUpdates)||void 0===l?void 0:null===(s=l[0])||void 0===s?void 0:s.state)==="ThirdParty"?"- Resolved by Third Party":""),size:"small",color:100===e.scoreInPercentage?"success":e.scoreInPercentage>50?"warning":"error"}),e.description&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{variant:"subtitle2",color:"textSecondary",sx:{mt:2},children:"Description"}),(0,a.jsx)(p.A,{variant:"body2",color:"textPrimary",sx:{"& a":{color:e=>e.palette.primary.main,textDecoration:"underline"}},dangerouslySetInnerHTML:{__html:S.default.sanitize(e.description)}})]}),e.remediation&&100!==e.scoreInPercentage&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{variant:"subtitle2",color:"textSecondary",sx:{mt:2},children:"Remediation Recommendation"}),(0,a.jsx)(p.A,{variant:"body2",color:"textPrimary",sx:{"& a":{color:e=>e.palette.primary.main,textDecoration:"underline"}},dangerouslySetInnerHTML:{__html:S.default.sanitize(e.remediation)}})]}),(null===(c=e.threats)||void 0===c?void 0:c.length)>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{variant:"subtitle2",color:"textSecondary",sx:{mt:2},children:"Threats"}),(0,a.jsx)(u.A,{sx:{display:"flex",flexWrap:"wrap",mt:1},children:e.threats.map((e,t)=>(0,a.jsx)(h.A,{label:e,size:"small",color:"info",sx:{mr:1,mt:1}},t))})]}),(null===(m=e.complianceInformation)||void 0===m?void 0:m.length)>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{variant:"subtitle2",color:"textSecondary",sx:{mt:2},children:"Compliance Frameworks"}),(0,a.jsx)(u.A,{sx:{display:"flex",flexWrap:"wrap",mt:1},children:e.complianceInformation.map((e,t)=>{var n;return(0,a.jsx)(h.A,{label:"".concat(e.certificationName," - ").concat(null===(n=e.certificationControls[0])||void 0===n?void 0:n.name),size:"small",color:"info",sx:{mr:1,mt:1}},t)})})]})]})})},e.controlName)}),o.ready&&(0,a.jsx)(T.X,{createDialog:R,title:"Updates for ".concat(o.data.title),data:o.data.controlStateUpdates,simpleColumns:["state","assignedTo","comment","updatedBy","updatedDateTime"]}),(0,a.jsx)(b.B,{createDialog:t,title:"Confirmation",fields:[{type:"autoComplete",name:"resolutionType",options:[{value:"ThirdParty",label:"Resolved by Third Party (Mark as completed, receive points)"},{value:"Ignored",label:"Ignored / Risk Accepted (Mark as completed, do not receive points)"},{value:"Default",label:"Mark as default (Receive points if Microsoft detects as completed)"}],label:"Resolution Type"},{type:"textField",name:"reason",label:"Reason for change (Mandatory)"}],api:{url:"/api/ExecUpdateSecureScore",type:"POST",data:{controlName:"controlName",vendorInformation:"vendorInformation"}},row:r.data})]})]})})};z.getLayout=e=>(0,a.jsx)(i.P,{children:(0,a.jsx)(r.L,{tabOptions:o,children:e})});let R=z},85496:(e,t,n)=>{"use strict";n.d(t,{b:()=>y});var a=n(37876),r=n(14232),i=n(54538),o=n(1073),s=n(71538),l=n(24933),c=n(76776),d=n(22474),u=n(77018),h=n(67578),p=n(30566),x=n(95449),m=n(18847),v=n.n(m),f=n(54773);let g=v()(()=>Promise.all([n.e(7144),n.e(1352)]).then(n.bind(n,21352)),{loadableGenerated:{webpack:()=>[21352]},ssr:!1,loading:()=>null}),j=(0,f.Ay)(g)({}),A=(e,t)=>{let n=(0,p.A)();return{chart:{background:"transparent",toolbar:{show:!1,tools:{download:!0,selection:!1,zoom:!1,zoomin:!1,zoomout:!1,pan:!1,reset:1}}},colors:[n.palette.success.main,n.palette.warning.main,n.palette.error.main,n.palette.neutral[200]],dataLabels:{enabled:!1},xaxis:{labels:{show:!0,rotate:0,style:{fontSize:"12px"}},tickPlacement:"on"},labels:e,legend:{show:!1},plotOptions:{pie:{expandOnClick:!1}},states:{active:{filter:{type:"none"}},hover:{filter:{type:"none"}}},stroke:{width:"line"===t?2:1},theme:{mode:n.palette.mode},tooltip:{fillSeriesColor:!1}}},y=e=>{let{isFetching:t,chartSeries:n=[],labels:p=[],chartType:m="donut",title:v,actions:f,onClick:g}=e,[y,S]=(0,r.useState)("Last 7 days"),[b,w]=(0,r.useState)([]),C=A(p,m),T=(n=n.filter(e=>null!==e)).reduce((e,t)=>e+t,0);return(0,r.useEffect)(()=>{"bar"===m&&w(p.map((e,t)=>({data:[{x:e,y:n[t]}]})))},[m,n.length,p]),(0,a.jsxs)(i.A,{style:{width:"100%",height:"100%"},onClick:g,sx:{cursor:g?"pointer":"default",transition:"all 0.2s ease-in-out","&:hover":g?{boxShadow:e=>e.shadows[8],transform:"translateY(-2px)"}:{}},children:[(0,a.jsx)(o.A,{action:f?(0,a.jsx)(x.$,{color:"inherit",actions:f,label:y,size:"small",variant:"text"}):null,title:v}),(0,a.jsx)(s.A,{}),(0,a.jsxs)(l.A,{children:[void 0===m||t||0===n.length?(0,a.jsx)(c.A,{variant:"rounded",sx:{height:280}}):(0,a.jsx)(j,{height:280,options:C,series:b&&"bar"===m?b:n,type:m}),(0,a.jsx)(d.A,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:1,sx:{py:1},children:p.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{variant:"h5",children:"Total"}),(0,a.jsx)(u.A,{variant:"h5",children:t?"0":T})]})}),(0,a.jsx)(d.A,{spacing:1,children:t?(0,a.jsx)(c.A,{height:30}):(0,a.jsx)(a.Fragment,{children:p.length>0&&n.map((e,t)=>(0,a.jsxs)(d.A,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:1,sx:{py:1},children:[(0,a.jsxs)(d.A,{alignItems:"center",direction:"row",spacing:1,sx:{flexGrow:1},children:[(0,a.jsx)(h.A,{sx:{backgroundColor:C.colors[t],borderRadius:"50%",height:8,width:8}}),(0,a.jsx)(u.A,{color:"text.secondary",variant:"body2",children:p[t]})]}),(0,a.jsx)(u.A,{color:"text.secondary",variant:"body2",children:e})]},p[t]))})})]})]})}},90737:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/administration/securescore",function(){return n(74852)}])},95449:(e,t,n)=>{"use strict";n.d(t,{$:()=>v});var a=n(37876),r=n(54550),i=n(95062),o=n.n(i),s=n(47737),l=n(94810),c=n(52808),d=n(6003),u=n(93256),h=n(50221),p=n(14232),x=n(82836),m=n(79803);let v=e=>{var t;let{actions:n=[],label:i="Actions",data:o,queryKeys:v,...f}=e,g=(0,h.f)(),[j,A]=(0,p.useState)({data:{},action:{},ready:!1}),y=(0,x.s)(),S=(e,t)=>!e||null!=t&&!!t.condition&&!(null==t?void 0:t.condition(e));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.A,{onClick:g.handleOpen,ref:g.anchorRef,startIcon:(0,a.jsx)(l.A,{fontSize:"small",children:(0,a.jsx)(r.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap"},children:"Actions"}),(0,a.jsx)(c.A,{anchorEl:g.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:g.handleClose,open:g.open,transformOrigin:{horizontal:"right",vertical:"top"},children:null==n?void 0:n.filter(e=>!e.link||e.showInActionsMenu).map((e,t)=>(0,a.jsxs)(d.A,{disabled:S(o,e),onClick:()=>{A({data:o,action:e,ready:!0}),(null==e?void 0:e.noConfirm)&&e.customFunction?e.customFunction(o,e,{}):(y.handleOpen(),g.handleClose())},children:[(0,a.jsx)(l.A,{fontSize:"small",sx:{minWidth:"30px"},children:e.icon}),(0,a.jsx)(u.A,{children:e.label})]},t))}),j.ready&&(0,a.jsx)(m.B,{createDialog:y,title:"Confirmation",fields:null===(t=j.action)||void 0===t?void 0:t.fields,api:j.action,row:j.data,relatedQueryKeys:v})]})};v.propTypes={actions:o().array,label:o().string}}},e=>{var t=t=>e(e.s=t);e.O(0,[5069,636,6593,8792],()=>t(90737)),_N_E=e.O()}]);