(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8868],{55210:(e,a,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/administration/alert-configuration/alert",function(){return l(84002)}])},84002:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>k});var n=l(37876),t=l(14232),r=l(67578),i=l(86650),o=l(22474),s=l(47737),u=l(94810),d=l(76776),b=l(77018),m=l(54538),v=l(91557),c=l(24933),p=l(22430),A=l(70946),g=l(59568),h=l(88917),f=l(89099),y=l(88992),S=l(58105),M=l(35764),I=l(84064);let x=JSON.parse('[{"name":"MFAAlertUsers","label":"Alert on users without any form of MFA","recommendedRunInterval":"1d"},{"name":"MFAAdmins","label":"Alert on admins without any form of MFA","recommendedRunInterval":"1d"},{"name":"LicenseAssignmentErrors","label":"Alert on license assignment errors","recommendedRunInterval":"1d"},{"name":"NoCAConfig","label":"Alert on tenants without a Conditional Access policy, while having Conditional Access licensing available.","recommendedRunInterval":"1d"},{"name":"AdminPassword","label":"Alert on changed admin Passwords","recommendedRunInterval":"30m"},{"name":"InactiveLicensedUsers","label":"Alert on licensed users that have not logged in for 90 days","requiresInput":true,"inputType":"switch","inputLabel":"Exclude disabled users?","inputName":"InactiveLicensedUsersExcludeDisabled","recommendedRunInterval":"1d"},{"name":"EntraConnectSyncStatus","label":"Alert if Entra Connect sync is enabled and has not run in the last X hours","requiresInput":true,"inputType":"number","inputLabel":"Hours(Default:72)","inputName":"EntraConnectSyncStatusHours","recommendedRunInterval":"1d"},{"name":"QuotaUsed","label":"Alert on % mailbox quota used","requiresInput":true,"inputType":"textField","inputLabel":"Enter quota percentage","inputName":"QuotaUsedQuota","recommendedRunInterval":"4h"},{"name":"SharePointQuota","label":"Alert on % SharePoint quota used","requiresInput":true,"inputType":"textField","inputLabel":"Enter quota percentage","inputName":"SharePointQuota","recommendedRunInterval":"4h"},{"name":"OneDriveQuota","label":"Alert on % OneDrive quota used","requiresInput":true,"inputType":"textField","inputLabel":"Enter quota percentage (default: 90)","inputName":"OneDriveQuota","recommendedRunInterval":"4h"},{"name":"ExpiringLicenses","label":"Alert on licenses expiring in 30 days","recommendedRunInterval":"7d"},{"name":"NewAppApproval","label":"Alert on new apps in the application approval list","recommendedRunInterval":"30m"},{"name":"SecDefaultsUpsell","label":"Alert on Security Defaults automatic enablement","recommendedRunInterval":"1d"},{"name":"DefenderStatus","label":"Alert if Defender is not running (Tenant must be on-boarded in Lighthouse)","recommendedRunInterval":"4h"},{"name":"DefenderMalware","label":"Alert on Defender Malware found  (Tenant must be on-boarded in Lighthouse)","recommendedRunInterval":"4h"},{"name":"DefenderIncidents","label":"Alert on new Defender Incidents found","recommendedRunInterval":"4h"},{"name":"Vulnerabilities","label":"Alert on vulnerabilities older than X hours","requiresInput":true,"inputType":"number","inputLabel":"Alert on vulnerabilities first seen more than X hours ago (default: 24)","inputName":"AgeInHours","recommendedRunInterval":"4h","description":"Monitors for software vulnerabilities that were first discovered more than the specified number of hours ago. This helps identify lingering vulnerabilities that may have been missed or not yet remediated. Requires Defender for Endpoint/Business."},{"name":"UnusedLicenses","label":"Alert on unused licenses","recommendedRunInterval":"1d"},{"name":"OverusedLicenses","label":"Alert on overused licenses","recommendedRunInterval":"7d"},{"name":"EntraLicenseUtilization","label":"Alert on Entra ID P1/P2 license over-utilization","recommendedRunInterval":"7d","requiresInput":true,"inputType":"textField","inputLabel":"Alert when utilization exceeds % (default: 110)","inputName":"EntraLicenseUtilizationThreshold"},{"name":"AppSecretExpiry","label":"Alert on expiring application secrets","recommendedRunInterval":"1d"},{"name":"AppleTerms","label":"Alert on new Apple Business Manager terms","recommendedRunInterval":"30d"},{"name":"AppCertificateExpiry","label":"Alert on expiring application certificates","recommendedRunInterval":"1d"},{"name":"ApnCertExpiry","label":"Alert on expiring APN certificates","recommendedRunInterval":"1d"},{"name":"VppTokenExpiry","label":"Alert on expiring VPP tokens","recommendedRunInterval":"1d"},{"name":"DepTokenExpiry","label":"Alert on expiring DEP tokens","recommendedRunInterval":"1d"},{"name":"SoftDeletedMailboxes","label":"Alert on soft deleted mailboxes","recommendedRunInterval":"1d"},{"name":"DeviceCompliance","label":"Alert on device compliance issues","recommendedRunInterval":"4h"},{"name":"BreachAlert","label":"Alert on (new) potentially breached passwords. Generates an alert if a password is found to be breached.","recommendedRunInterval":"7d"},{"name":"HuntressRogueApps","label":"Alert on Huntress Rogue Apps detected","recommendedRunInterval":"4h","description":"Huntress has provided a repository of known rogue apps that are commonly used in BEC, data exfiltration and other Microsoft 365 attacks. This alert will notify you if any of these apps are detected in the selected tenant(s). For more information, see <a href=\'https://huntresslabs.github.io/rogueapps/\' target=\'_blank\'>https://huntresslabs.github.io/rogueapps/</a>.","requiresInput":true,"inputType":"switch","inputLabel":"Ignore Disabled Apps?","inputName":"IgnoreDisabledApps"},{"name":"TERRL","label":"Alert when Tenant External Recipient Rate Limit exceeds X %","requiresInput":true,"inputType":"number","inputLabel":"Alert % (default: 80)","inputName":"TERRLThreshold","recommendedRunInterval":"1h","description":"Monitors tenant outbound email volume against Microsoft\'s TERRL limits. Tenant data is updated every hour."},{"name":"LowDomainScore","label":"Alert on domains with low security score","requiresInput":true,"inputType":"number","inputLabel":"Alert when score is below % (default: 70)","inputName":"InputValue","recommendedRunInterval":"7d","description":"Monitors domain security scores from the DomainAnalyser and alerts when scores fall below the specified threshold."},{"name":"GlobalAdminNoAltEmail","label":"Alert on Global Admin accounts without alternate email address","recommendedRunInterval":"7d","description":"Monitors Global Admin accounts and alerts when they don\'t have an alternate email address set, which is important for password recovery of key accounts."},{"name":"NewRiskyUsers","label":"Alert on new risky users (P2 License Required)","recommendedRunInterval":"30m","description":"Monitors for new risky users in the tenant. Risky users are defined as users who have performed actions that are considered risky, such as password resets, MFA failures, or suspicious activity."},{"name":"LowTenantAlignment","label":"Alert on low tenant alignment percentage","requiresInput":true,"inputType":"number","inputLabel":"Alert when alignment is below % (default: 99)","inputName":"InputValue","recommendedRunInterval":"1d","description":"Monitors tenant alignment scores against standards templates and alerts when the alignment percentage falls below the specified threshold. This helps ensure compliance across all managed tenants."}]'),P=JSON.parse('[{"value":"New-InboxRule","name":"A new Inbox rule is created","template":{"preset":{"value":"New-InboxRule","label":"A new Inbox rule is created"},"logbook":{"value":"Audit.Exchange","label":"Exchange"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"New-InboxRule","label":"created new inbox rule in outlook web app"}}]}},{"value":"New-InboxRuleRSS","name":"A new Inbox rule is created that forwards e-mails to the RSS feeds folder","template":{"preset":{"value":"New-InboxRuleRSS","label":"A new Inbox rule is created that forwards e-mails to the RSS feeds folder"},"logbook":{"value":"Audit.Exchange","label":"Exchange"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"New-InboxRule","label":"created new inbox rule in outlook web app"}},{"Property":{"value":"String","label":"MoveToFolder"},"Operator":{"value":"like","label":"Like"},"Input":{"value":"*RSS*"}}]}},{"value":"New-InboxRuleForward","name":"A new Inbox rule is created that forwards e-mails to a different email address","template":{"preset":{"value":"New-InboxRuleForward","label":"A new Inbox rule is created that forwards e-mails to a different email address"},"logbook":{"value":"Audit.Exchange","label":"Exchange"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"New-InboxRule","label":"created new inbox rule in outlook web app"}},{"Property":{"value":"String","label":"ForwardTo"},"Operator":{"value":"like","label":"Like"},"Input":{"value":"*@*"}}]}},{"value":"New-InboxRuleRedirect","name":"A new Inbox rule is created that redirects e-mails to a different email address","template":{"preset":{"value":"New-InboxRuleRedirect","label":"A new Inbox rule is created that redirects e-mails to a different email address"},"logbook":{"value":"Audit.Exchange","label":"Exchange"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"New-InboxRule","label":"created new inbox rule in outlook web app"}},{"Property":{"value":"String","label":"RedirectTo"},"Operator":{"value":"like","label":"Like"},"Input":{"value":"*@*"}}]}},{"value":"Set-InboxRule","name":"A existing Inbox rule is edited","template":{"preset":{"value":"Set-InboxRule","label":"A existing Inbox rule is edited"},"logbook":{"value":"Audit.Exchange","label":"Exchange"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Set-InboxRule","label":"Updated inbox rule in outlook web app"}}]}},{"value":"Set-InboxRuleRSS","name":"A existing Inbox rule is edited that forwards e-mails to the RSS feeds folder","template":{"preset":{"value":"Set-InboxRuleRSS","label":"A existing Inbox rule is edited that forwards e-mails to the RSS feeds folder"},"logbook":{"value":"Audit.Exchange","label":"Exchange"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Set-InboxRule","label":"Updated inbox rule in outlook web app"}},{"Property":{"value":"String","label":"MoveToFolder"},"Operator":{"value":"like","label":"Like"},"Input":{"value":"*RSS*"}}]}},{"value":"Set-InboxRuleForward","name":"A existing Inbox rule is edited that forwards e-mails to a different email address","template":{"preset":{"value":"Set-InboxRuleForward","label":"A existing Inbox rule is edited that forwards e-mails to a different email address"},"logbook":{"value":"Audit.Exchange","label":"Exchange"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Set-InboxRule","label":"Updated inbox rule in outlook web app"}},{"Property":{"value":"String","label":"ForwardTo"},"Operator":{"value":"like","label":"Like"},"Input":{"value":"*@*"}}]}},{"value":"Set-InboxRuleRedirect","name":"A existing Inbox rule is edited that redirects e-mails to a different email address","template":{"preset":{"value":"Set-InboxRuleRedirect","label":"A existing Inbox rule is edited that redirects e-mails to a different email address"},"logbook":{"value":"Audit.Exchange","label":"Exchange"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Set-InboxRule","label":"Updated inbox rule in outlook web app"}},{"Property":{"value":"String","label":"RedirectTo"},"Operator":{"value":"like","label":"Like"},"Input":{"value":"*@*"}}]}},{"value":"Add member to role.","name":"A user has been added to an admin role","template":{"preset":{"value":"Add member to role.","label":"A user has been added to an admin role"},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Add member to role.","label":"Add member to role."}}]}},{"value":"Update StsRefreshTokenValidFrom Timestamp.","name":"A user sessions have been revoked","template":{"preset":{"value":"Update StsRefreshTokenValidFrom Timestamp.","label":"A user sessions have been revoked"},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Update StsRefreshTokenValidFrom Timestamp.","label":"Update StsRefreshTokenValidFrom Timestamp."}}]}},{"value":"Disable Strong Authentication.","name":"A users MFA has been disabled","template":{"preset":{"value":"Disable Strong Authentication.","label":"A users MFA has been disabled"},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Disable Strong Authentication.","label":"Disable Strong Authentication."}}]}},{"value":"Remove Member from a role.","name":"A user has been removed from a role","template":{"preset":{"value":"Remove Member from a role.","label":"A user has been removed from a role"},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Remove Member from a role.","label":"Remove Member from a role."}}]}},{"value":"Reset user password.","name":"A user password has been reset","template":{"preset":{"value":"A user password has been reset","label":"Reset user password."},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Reset user password.","label":"Reset user password."}}]}},{"value":"UserLoggedInFromUnknownLocation","name":"A user has logged in from a location not in the input list","template":{"preset":{"value":"UserLoggedInFromUnknownLocation","label":"A user has logged in from a location not in the input list"},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"UserLoggedIn","label":"A user logged in"}},{"Property":{"value":"List:countryList","label":"CIPPGeoLocation","multi":true},"Operator":{"value":"NotIn","label":"Not In"}}]}},{"value":"Add service principal.","name":"A service principal has been created","template":{"preset":{"value":"Add service principal.","label":"A service principal has been created"},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Add service principal.","label":"Add service principal."}}]}},{"value":"Remove service principal.","name":"A service principal has been removed","template":{"preset":{"value":"Remove service principal.","label":"A service principal has been removed"},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"Remove service principal.","label":"Remove service principal."}}]}},{"value":"badRepIP","name":"A user has logged in a using a known VPN, Proxy, Or anonymizer","template":{"preset":{"value":"badRepIP","label":"A user has logged in a using a known VPN, Proxy, Or anonymizer"},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"UserLoggedIn","label":"A user logged in"}},{"Property":{"value":"String","label":"CIPPBadRepIP"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"true","label":"true"}}]}},{"value":"HostedIP","name":"A user has logged in a using a known hosting provider IP","template":{"preset":{"value":"HostedIP","label":"A user has logged in a using a known hosting provider IP"},"logbook":{"value":"Audit.AzureActiveDirectory","label":"Azure AD"},"conditions":[{"Property":{"value":"List:Operation","label":"Operation"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"UserLoggedIn","label":"A user logged in"}},{"Property":{"value":"String","label":"CIPPHostedIP"},"Operator":{"value":"EQ","label":"Equals to"},"Input":{"value":"true","label":"true"}}]}}]'),E=JSON.parse('{"Common":{"Id":"String","RecordType":"List:AuditLogRecordType","CreationTime":"String","Operation":"List:Operation","OrganizationId":"String","UserType":"List:UserType","UserKey":"String","Workload":"String","ResultStatus":"String","ObjectId":"String","UserId":"String","ClientIP":"String","Username":"String","CIPPGeoLocation":"List:countryList","CIPPBadRepIP":"String","CIPPHostedIP":"String","CIPPIPDetected":"String","CIPPUserId":"String","CIPPUserKey":"String","CIPPUsername":"String"},"Audit.Exchange":{"Id":"Combination GUID","RecordType":"List:AuditLogRecordType","CreationTime":"String","Operation":"List:Operation","OrganizationId":"Guid","UserType":"List:UserType","UserKey":"String","Workload":"String","ResultStatus":"String","ObjectId":"String","UserId":"String","ClientIP":"String","Scope":"List:AuditLogScope","ModifiedObjectResolvedname":"String","Parameters":"Common.namevaluePair","ExternalAccess":"Boolean","OriginatingServer":"String","Organizationname":"String","LogonType":"LogonType","InternalLogonType":"List:LogonType","MailboxGuid":"String","MailboxOwnerUPN":"String","MailboxOwnerSid":"String","MailboxOwnerMasterAccountSid":"String","LogonUserSid":"String","LogonUserDisplayname":"String","ClientInfoString":"String","ClientIPAddress":"String","ClientMachinename":"String","ClientProcessname":"String","ClientVersion":"String","MoveToFolder":"String","ForwardTo":"String","RedirectTo":"String"},"Audit.AzureActiveDirectory":{"AzureActiveDirectoryEventType":"List:AzureActiveDirectoryEventType","AccountEnabled":"String","Actor":"List:IdentityTypevaluePair","ActorContextId":"String","ActorIpAddress":"String","InterSystemsId":"String","IntraSystemsId":"String","SupportTicketId":"String","Target":"List:IdentityTypevaluePair","TargetContextId":"String","ApplicationId":"String","Client":"String","Errorvalue":"String","LogonError":"String"},"List:Operation":[{"value":"UserLoggedIn","label":"A user logged in"},{"value":"mailitemsaccessed","label":"accessed mailbox items"},{"value":"add delegation entry.","label":"added delegation entry"},{"value":"add domain to company.","label":"added domain to company"},{"value":"add group.","label":"added group"},{"value":"add member to group.","label":"added member to group"},{"value":"add-mailboxpermission","label":"added delegate mailbox permissions"},{"value":"add member to role.","label":"added member to role"},{"value":"add partner to company.","label":"added a partner to the directory"},{"value":"add service principal.","label":"added service principal"},{"value":"add service principal credentials.","label":"added credentials to a service principal"},{"value":"add user.","label":"added user"},{"value":"addfolderpermissions","label":"added permissions to folder"},{"value":"applyrecordlabel","label":"labeled message as a record"},{"value":"change user license.","label":"changed user license"},{"value":"change user password.","label":"changed user password"},{"value":"copy","label":"copied messages to another folder"},{"value":"create","label":"created mailbox item"},{"value":"delete group.","label":"deleted group"},{"value":"delete user.","label":"deleted user"},{"value":"harddelete","label":"purged messages from the mailbox"},{"value":"mailboxlogin","label":"user signed in to mailbox"},{"value":"move","label":"moved messages to another folder"},{"value":"movetodeleteditems","label":"moved messages to deleted items folder"},{"value":"new-inboxrule","label":"created new inbox rule in outlook web app"},{"value":"remove delegation entry.","label":"removed delegation entry"},{"value":"remove domain from company.","label":"removed domain from company"},{"value":"remove member from group.","label":"removed member from group"},{"value":"remove member from a role.","label":"remove member from a role"},{"value":"Disable Strong Authentication.","label":"Disable Strong Authentication."},{"value":"remove service principal.","label":"removed a service principal from the directory"},{"value":"remove service principal credentials.","label":"removed credentials from a service principal"},{"value":"remove-mailboxpermission","label":"removed delegate mailbox permissions"},{"value":"remove member from role.","label":"removed a user from a directory role"},{"value":"remove partner from company.","label":"removed a partner from the directory"},{"value":"removefolderpermissions","label":"removed permissions from folder"},{"value":"reset user password.","label":"reset user password"},{"value":"send","label":"sent message"},{"value":"sendas","label":"sent message using send as permissions"},{"value":"sendonbehalf","label":"sent message using send on behalf permissions"},{"value":"set company contact information.","label":"set company contact information"},{"value":"set company information.","label":"set company information"},{"value":"set delegation entry.","label":"set delegation entry"},{"value":"set dirsyncenabled flag.","label":"turned on azure ad sync"},{"value":"set domain authentication.","label":"set domain authentication"},{"value":"set federation settings on domain.","label":"updated the federation settings for a domain"},{"value":"set force change user password.","label":"set property that forces user to change password"},{"value":"set-inboxrule","label":"modified inbox rule from outlook web app"},{"value":"set license properties.","label":"set license properties"},{"value":"set password policy.","label":"set password policy"},{"value":"softdelete","label":"deleted messages from deleted items folder"},{"value":"update","label":"updated message"},{"value":"update user.","label":"updated user"},{"value":"update group.","label":"updated group"},{"value":"update domain.","label":"updated domain"},{"value":"updatecalendardelegation","label":"added or removed user with delegate access to calendar folder"},{"value":"updatefolderpermissions","label":"modified folder permission"},{"value":"updateinboxrules","label":"updated inbox rules from outlook client"},{"value":"verify domain.","label":"verified domain"},{"value":"verify email verified domain.","label":"verified email verified domain"},{"value":"Update StsRefreshTokenValidFrom Timestamp.","label":"Update StsRefreshTokenValidFrom Timestamp."}],"List:LogonType":[{"value":0,"Membername":"Owner","label":"The mailbox owner."},{"value":1,"Membername":"Admin","label":"A person with administrative privileges for someone\'s mailbox."},{"value":2,"Membername":"Delegated","label":"A person with delegate privileges for someone\'s mailbox."},{"value":3,"Membername":"Transport","label":"A transport service in the Microsoft datacenter."},{"value":4,"Membername":"SystemService","label":"A service account in the Microsoft datacenter"},{"value":5,"Membername":"BestAccess","label":"Reserved for internal use."},{"value":6,"Membername":"DelegatedAdmin","label":"A delegated administrator."}],"List:UserType":[{"value":0,"Membername":"Regular","label":"A regular user."},{"value":1,"Membername":"Reserved","label":"A reserved user."},{"value":2,"Membername":"Admin","label":"An administrator."},{"value":3,"Membername":"DcAdmin","label":"A Microsoft datacenter operator."},{"value":4,"Membername":"System","label":"A system account."},{"value":5,"Membername":"Application","label":"An application."},{"value":6,"Membername":"ServicePrincipal","label":"A service principal."},{"value":7,"Membername":"CustomPolicy","label":"A custom policy."},{"value":8,"Membername":"SystemPolicy","label":"A system policy."}],"List:AuditLogRecordType":[{"value":1,"Membername":"ExchangeAdmin","label":"Events from the Exchange admin audit log."},{"value":2,"Membername":"ExchangeItem","label":"Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message."},{"value":3,"Membername":"ExchangeItemGroup","label":"Events from an Exchange mailbox audit log for actions that can be performed on multiple items, such as moving or deleted one or more email messages."},{"value":4,"Membername":"SharePoint","label":"SharePoint events."},{"value":6,"Membername":"SharePointFileOperation","label":"SharePoint file operation events."},{"value":7,"Membername":"OneDrive","label":"OneDrive for Business events."},{"value":8,"Membername":"AzureActiveDirectory","label":"Microsoft Entra ID events."},{"value":9,"Membername":"AzureActiveDirectoryAccountLogon","label":"Microsoft Entra ID OrgId logon events (deprecated)."},{"value":10,"Membername":"DataCenterSecurityCmdlet","label":"Data Center security cmdlet events."},{"value":11,"Membername":"ComplianceDLPSharePoint","label":"Data loss protection (DLP) events in SharePoint and OneDrive for Business."},{"value":13,"Membername":"ComplianceDLPExchange","label":"Data loss protection (DLP) events in Exchange, when configured via Unified DLP Policy. DLP events based on Exchange Transport Rules are not supported."},{"value":14,"Membername":"SharePointSharingOperation","label":"SharePoint sharing events."},{"value":15,"Membername":"AzureActiveDirectoryStsLogon","label":"Secure Token Service (STS) logon events in Microsoft Entra ID."},{"value":16,"Membername":"SkypeForBusinessPSTNUsage","label":"Public Switched Telephone Network (PSTN) events from Skype for Business."},{"value":17,"Membername":"SkypeForBusinessUsersBlocked","label":"Blocked user events from Skype for Business."},{"value":18,"Membername":"SecurityComplianceCenterEOPCmdlet","label":"Admin actions from the Security & Compliance Center."},{"value":19,"Membername":"ExchangeAggregatedOperation","label":"Aggregated Exchange mailbox auditing events."},{"value":20,"Membername":"PowerBIAudit","label":"Power BI events."},{"value":21,"Membername":"CRM","label":"Dynamics 365 events."},{"value":22,"Membername":"Yammer","label":"Yammer events."},{"value":23,"Membername":"SkypeForBusinessCmdlets","label":"Skype for Business events."},{"value":24,"Membername":"Discovery","label":"Events for eDiscovery activities performed by running content searches and managing eDiscovery cases in the Security & Compliance Center."},{"value":25,"Membername":"MicrosoftTeams","label":"Events from Microsoft Teams."},{"value":28,"Membername":"ThreatIntelligence","label":"Phishing and malware events from Exchange Online Protection and Microsoft Defender for Office 365."},{"value":29,"Membername":"MailSubmission","label":"Submission events from Exchange Online Protection and Microsoft Defender for Office 365."},{"value":30,"Membername":"MicrosoftFlow","label":"Microsoft Power Automate (formerly called Microsoft Flow) events."},{"value":31,"Membername":"AeD","label":"Advanced eDiscovery events."},{"value":32,"Membername":"MicrosoftStream","label":"Microsoft Stream events."},{"value":33,"Membername":"ComplianceDLPSharePointClassification","label":"Events related to DLP classification in SharePoint."},{"value":34,"Membername":"ThreatFinder","label":"Campaign-related events from Microsoft Defender for Office 365."},{"value":35,"Membername":"Project","label":"Microsoft Project events."},{"value":36,"Membername":"SharePointListOperation","label":"SharePoint List events."},{"value":37,"Membername":"SharePointCommentOperation","label":"SharePoint comment events."},{"value":38,"Membername":"DataGovernance","label":"Events related to retention policies and retention labels in the Security & Compliance Center"},{"value":39,"Membername":"Kaizala","label":"Kaizala events."},{"value":40,"Membername":"SecurityComplianceAlerts","label":"Security and compliance alert signals."},{"value":41,"Membername":"ThreatIntelligenceUrl","label":"Safe links time-of-block and block override events from Microsoft Defender for Office 365."},{"value":42,"Membername":"SecurityComplianceInsights","label":"Events related to insights and reports in the Office 365 security and compliance center."},{"value":43,"Membername":"MIPLabel","label":"Events related to the detection in the Transport pipeline of email messages that have been tagged (manually or automatically) with sensitivity labels."},{"value":44,"Membername":"WorkplaceAnalytics","label":"Workplace Analytics events."},{"value":45,"Membername":"PowerAppsApp","label":"Power Apps events."},{"value":46,"Membername":"PowerAppsPlan","label":"Subscription plan events for Power Apps."},{"value":47,"Membername":"ThreatIntelligenceAtpContent","label":"Phishing and malware events for files in SharePoint, OneDrive for Business, and Microsoft Teams from Microsoft Defender for Office 365."},{"value":48,"Membername":"LabelContentExplorer","label":"Events related to data classification content explorer."},{"value":49,"Membername":"TeamsHealthcare","label":"Events related to the Patients application in Microsoft Teams for Healthcare."},{"value":50,"Membername":"ExchangeItemAggregated","label":"Events related to the MailItemsAccessed mailbox auditing action."},{"value":51,"Membername":"HygieneEvent","label":"Events related to outbound spam protection."},{"value":52,"Membername":"DataInsightsRestApiAudit","label":"Data Insights REST API events."},{"value":53,"Membername":"InformationBarrierPolicyApplication","label":"Events related to the application of information barrier policies."},{"value":54,"Membername":"SharePointListItemOperation","label":"SharePoint list item events."},{"value":55,"Membername":"SharePointContentTypeOperation","label":"SharePoint list content type events."},{"value":56,"Membername":"SharePointFieldOperation","label":"SharePoint list field events."},{"value":57,"Membername":"MicrosoftTeamsAdmin","label":"Teams admin events."},{"value":58,"Membername":"HRSignal","label":"Events related to HR data signals that support the Insider risk management solution."},{"value":59,"Membername":"MicrosoftTeamsDevice","label":"Teams device events."},{"value":60,"Membername":"MicrosoftTeamsAnalytics","label":"Teams analytics events."},{"value":61,"Membername":"InformationWorkerProtection","label":"Events related to compromised user alerts."},{"value":62,"Membername":"Campaign","label":"Email campaign events from Microsoft Defender for Office 365."},{"value":63,"Membername":"DLPEndpoint","label":"Endpoint DLP events."},{"value":64,"Membername":"AirInvestigation","label":"Automated incident response (AIR) events."},{"value":65,"Membername":"Quarantine","label":"Quarantine events."},{"value":66,"Membername":"MicrosoftForms","label":"Microsoft Forms events."},{"value":67,"Membername":"ApplicationAudit","label":"Application audit events."},{"value":68,"Membername":"ComplianceSupervisionExchange","label":"Events tracked by the Communication compliance offensive language model."},{"value":69,"Membername":"CustomerKeyServiceEncryption","label":"Events related to the customer key encryption service."},{"value":70,"Membername":"OfficeNative","label":"Events related to sensitivity labels applied to Office documents."},{"value":71,"Membername":"MipAutoLabelSharePointItem","label":"Auto-labeling events in SharePoint."},{"value":72,"Membername":"MipAutoLabelSharePointPolicyLocation","label":"Auto-labeling policy events in SharePoint."},{"value":73,"Membername":"MicrosoftTeamsShifts","label":"Teams Shifts events."},{"value":75,"Membername":"MipAutoLabelExchangeItem","label":"Auto-labeling events in Exchange."},{"value":76,"Membername":"CortanaBriefing","label":"Briefing email events."},{"value":78,"Membername":"WDATPAlerts","label":"Events related to alerts generated by Windows Defender for Endpoint."},{"value":82,"Membername":"SensitivityLabelPolicyMatch","label":"Events generated when the file labeled with a sensitivity label is opened or renamed."},{"value":83,"Membername":"SensitivityLabelAction","label":"Event generated when sensitivity labels are applied, upStringd, or removed from a file."},{"value":84,"Membername":"SensitivityLabeledFileAction","label":"Events generated when a file labeled with a sensitivity label is opened or renamed."},{"value":85,"Membername":"AttackSim","label":"Events related to user activities in Attack Simulation & Training in Microsoft Defender for Office 365."},{"value":86,"Membername":"AirManualInvestigation","label":"Events related to manual investigations in Automated investigation and response (AIR)."},{"value":87,"Membername":"SecurityComplianceRBAC","label":"Security and compliance RBAC events."},{"value":88,"Membername":"UserTraining","label":"Events related to user training in Attack Simulation & Training in Microsoft Defender for Office 365."},{"value":89,"Membername":"AirAdminActionInvestigation","label":"Events related to admin actions in Automated investigation and response (AIR)."},{"value":90,"Membername":"MSTIC","label":"Threat intelligence events in Microsoft Defender for Office 365."},{"value":91,"Membername":"PhysicalBadgingSignal","label":"Events related to physical badging signals that support the Insider risk management solution."},{"value":93,"Membername":"AipDiscover","label":"AIP scanner events"},{"value":94,"Membername":"AipSensitivityLabelAction","label":"AIP sensitivity label events"},{"value":95,"Membername":"AipProtectionAction","label":"AIP protection events"},{"value":96,"Membername":"AipFileDeleted","label":"AIP file deletion events"},{"value":97,"Membername":"AipHeartBeat","label":"AIP heartbeat events"},{"value":98,"Membername":"MCASAlerts","label":"Events corresponding to alerts triggered by Microsoft Cloud App Security."},{"value":99,"Membername":"OnPremisesFileShareScannerDlp","label":"Events related to scanning for sensitive data on file shares."},{"value":100,"Membername":"OnPremisesSharePointScannerDlp","label":"Events related to scanning for sensitive data in SharePoint."},{"value":101,"Membername":"ExchangeSearch","label":"Events related to using Outlook on the web (OWA) to search for mailbox items."},{"value":102,"Membername":"SharePointSearch","label":"Events related to searching an organization\'s SharePoint home site."},{"value":103,"Membername":"PrivacyInsights","label":"Privacy insight events."},{"value":105,"Membername":"MyAnalyticsSettings","label":"MyAnalytics events."},{"value":106,"Membername":"SecurityComplianceUserChange","label":"Events related to modifying or deleting a user."},{"value":107,"Membername":"ComplianceDLPExchangeClassification","label":"Exchange DLP classification events."},{"value":109,"Membername":"MipExactDataMatch","label":"Exact Data Match (EDM) classification events."},{"value":113,"Membername":"MS365DCustomDetection","label":"Events related to custom detection actions in Microsoft 365 Defender."},{"value":147,"Membername":"CoreReportingSettings","label":"Reports settings events."},{"value":148,"Membername":"ComplianceConnector","label":"Events related to importing non-Microsoft data using data connectors in the Microsoft Purview compliance portal."},{"value":154,"Membername":"OMEPortal","label":"Encrypted message portal event logs generated by external recipients."},{"value":174,"Membername":"DataShareOperation","label":"Events related to sharing of data ingested via SystemSync."},{"value":181,"Membername":"EduDataLakeDownloadOperation","label":"Events related to the export of SystemSync ingested data from the lake."},{"value":183,"Membername":"MicrosoftGraphDataConnectOperation","label":"Events related to extractions done by Microsoft Graph Data Connect."},{"value":186,"Membername":"PowerPagesSite","label":"Activities related to Power Pages site."},{"value":188,"Membername":"PlannerPlan","label":"Microsoft Planner plan events."},{"value":189,"Membername":"PlannerCopyPlan","label":"Microsoft Planner copy plan events."},{"value":190,"Membername":"PlannerTask","label":"Microsoft Planner task events."},{"value":191,"Membername":"PlannerRoster","label":"Microsoft Planner roster and roster membership events."},{"value":192,"Membername":"PlannerPlanList","label":"Microsoft Planner plan list events."},{"value":193,"Membername":"PlannerTaskList","label":"Microsoft Planner task list events."},{"value":194,"Membername":"PlannerTenantSettings","label":"Microsoft Planner tenant settings events."},{"value":195,"Membername":"ProjectForThewebProject","label":"Microsoft Project for the web project events."},{"value":196,"Membername":"ProjectForThewebTask","label":"Microsoft Project for the web task events."},{"value":197,"Membername":"ProjectForThewebRoadmap","label":"Microsoft Project for the web roadmap events."},{"value":198,"Membername":"ProjectForThewebRoadmapItem","label":"Microsoft Project for the web roadmap item events."},{"value":199,"Membername":"ProjectForThewebProjectSettings","label":"Microsoft Project for the web project tenant settings events."},{"value":200,"Membername":"ProjectForThewebRoadmapSettings","label":"Microsoft Project for the web roadmap tenant settings events."},{"value":216,"Membername":"Viva Goals","label":"Viva Goals events."},{"value":217,"Membername":"MicrosoftGraphDataConnectConsent","label":"Events for consent actions performed by tenant admins for Microsoft Graph Data Connect applications."},{"value":218,"Membername":"AttackSimAdmin","label":"Events related to admin activities in Attack Simulation & Training in Microsoft Defender for Office 365."},{"value":230,"Membername":"TeamsUpStrings","label":"Teams UpStrings App Events."},{"value":231,"Membername":"PlannerRosterSensitivityLabel","label":"Microsoft Planner roster sensitivity label events."},{"value":237,"Membername":"DefenderExpertsforXDRAdmin","label":"Microsoft Defender Experts Administrator action events."},{"value":251,"Membername":"VfamCreatePolicy","label":"Viva Access Management policy create events."},{"value":252,"Membername":"VfamUpStringPolicy","label":"Viva Access Management policy upString events."},{"value":253,"Membername":"VfamDeletePolicy","label":"Viva Access Management policy delete events."},{"value":261,"Membername":"CopilotInteraction","label":"Copilot interaction events."}],"List:countryList":[{"value":"AF","label":"Afghanistan"},{"value":"AX","label":"\xc5land Islands"},{"value":"AL","label":"Albania"},{"value":"DZ","label":"Algeria"},{"value":"AS","label":"American Samoa"},{"value":"AD","label":"Andorra"},{"value":"AO","label":"Angola"},{"value":"AI","label":"Anguilla"},{"value":"AQ","label":"Antarctica"},{"value":"AG","label":"Antigua and Barbuda"},{"value":"AR","label":"Argentina"},{"value":"AM","label":"Armenia"},{"value":"AW","label":"Aruba"},{"value":"AC","label":"Ascension Island"},{"value":"AU","label":"Australia"},{"value":"AT","label":"Austria"},{"value":"AZ","label":"Azerbaijan"},{"value":"BS","label":"Bahamas"},{"value":"BH","label":"Bahrain"},{"value":"BD","label":"Bangladesh"},{"value":"BB","label":"Barbados"},{"value":"BY","label":"Belarus"},{"value":"BE","label":"Belgium"},{"value":"BZ","label":"Belize"},{"value":"BJ","label":"Benin"},{"value":"BM","label":"Bermuda"},{"value":"BT","label":"Bhutan"},{"value":"BO","label":"Bolivia, Plurinational State of"},{"value":"BQ","label":"Bonaire, Sint Eustatius and Saba"},{"value":"BA","label":"Bosnia and Herzegovina"},{"value":"BW","label":"Botswana"},{"value":"BV","label":"Bouvet Island"},{"value":"BR","label":"Brazil"},{"value":"IO","label":"British Indian Ocean Territory"},{"value":"BN","label":"Brunei Darussalam"},{"value":"BG","label":"Bulgaria"},{"value":"BF","label":"Burkina Faso"},{"value":"BI","label":"Burundi"},{"value":"KH","label":"Cambodia"},{"value":"CM","label":"Cameroon"},{"value":"CA","label":"Canada"},{"value":"CV","label":"Cape Verde"},{"value":"KY","label":"Cayman Islands"},{"value":"CF","label":"Central African Republic"},{"value":"TD","label":"Chad"},{"value":"CL","label":"Chile"},{"value":"CN","label":"China"},{"value":"CX","label":"Christmas Island"},{"value":"CC","label":"Cocos (Keeling) Islands"},{"value":"CO","label":"Colombia"},{"value":"KM","label":"Comoros"},{"value":"CG","label":"Congo"},{"value":"CD","label":"Congo, the Democratic Republic of the"},{"value":"CK","label":"Cook Islands"},{"value":"CR","label":"Costa Rica"},{"value":"CI","label":"C\xf4te d\'Ivoire"},{"value":"HR","label":"Croatia"},{"value":"CU","label":"Cuba"},{"value":"CW","label":"Cura\xe7ao"},{"value":"CY","label":"Cyprus"},{"value":"CZ","label":"Czech Republic"},{"value":"DK","label":"Denmark"},{"value":"DG","label":"Diego Garcia"},{"value":"DJ","label":"Djibouti"},{"value":"DM","label":"Dominica"},{"value":"DO","label":"Dominican Republic"},{"value":"EC","label":"Ecuador"},{"value":"EG","label":"Egypt"},{"value":"SV","label":"El Salvador"},{"value":"GQ","label":"Equatorial Guinea"},{"value":"ER","label":"Eritrea"},{"value":"EE","label":"Estonia"},{"value":"ET","label":"Ethiopia"},{"value":"FK","label":"Falkland Islands (Malvinas)"},{"value":"FO","label":"Faroe Islands"},{"value":"FJ","label":"Fiji"},{"value":"FI","label":"Finland"},{"value":"FR","label":"France"},{"value":"GF","label":"French Guiana"},{"value":"PF","label":"French Polynesia"},{"value":"TF","label":"French Southern Territories"},{"value":"GA","label":"Gabon"},{"value":"GM","label":"Gambia"},{"value":"GE","label":"Georgia"},{"value":"DE","label":"Germany"},{"value":"GH","label":"Ghana"},{"value":"GI","label":"Gibraltar"},{"value":"GR","label":"Greece"},{"value":"GL","label":"Greenland"},{"value":"GD","label":"Grenada"},{"value":"GP","label":"Guadeloupe"},{"value":"GU","label":"Guam"},{"value":"GT","label":"Guatemala"},{"value":"GG","label":"Guernsey"},{"value":"GN","label":"Guinea"},{"value":"GW","label":"Guinea-Bissau"},{"value":"GY","label":"Guyana"},{"value":"HT","label":"Haiti"},{"value":"HM","label":"Heard Island and McDonald Islands"},{"value":"VA","label":"Holy See (Vatican City State)"},{"value":"HN","label":"Honduras"},{"value":"HK","label":"Hong Kong"},{"value":"HU","label":"Hungary"},{"value":"IS","label":"Iceland"},{"value":"IN","label":"India"},{"value":"ID","label":"Indonesia"},{"value":"IR","label":"Iran, Islamic Republic of"},{"value":"IQ","label":"Iraq"},{"value":"IE","label":"Ireland"},{"value":"IM","label":"Isle of Man"},{"value":"IL","label":"Israel"},{"value":"IT","label":"Italy"},{"value":"JM","label":"Jamaica"},{"value":"JP","label":"Japan"},{"value":"JE","label":"Jersey"},{"value":"JO","label":"Jordan"},{"value":"KZ","label":"Kazakhstan"},{"value":"KE","label":"Kenya"},{"value":"KI","label":"Kiribati"},{"value":"KP","label":"Korea, Democratic People\'s Republic of"},{"value":"KR","label":"Korea, Republic of"},{"value":"XK","label":"Kosovo"},{"value":"KW","label":"Kuwait"},{"value":"KG","label":"Kyrgyzstan"},{"value":"LA","label":"Lao People\'s Democratic Republic"},{"value":"LV","label":"Latvia"},{"value":"LB","label":"Lebanon"},{"value":"LS","label":"Lesotho"},{"value":"LR","label":"Liberia"},{"value":"LY","label":"Libya"},{"value":"LI","label":"Liechtenstein"},{"value":"LT","label":"Lithuania"},{"value":"LU","label":"Luxembourg"},{"value":"MO","label":"Macao"},{"value":"MK","label":"Macedonia, the Former Yugoslav Republic of"},{"value":"MG","label":"Madagascar"},{"value":"MW","label":"Malawi"},{"value":"MY","label":"Malaysia"},{"value":"MV","label":"Maldives"},{"value":"ML","label":"Mali"},{"value":"MT","label":"Malta"},{"value":"MH","label":"Marshall Islands"},{"value":"MQ","label":"Martinique"},{"value":"MR","label":"Mauritania"},{"value":"MU","label":"Mauritius"},{"value":"YT","label":"Mayotte"},{"value":"MX","label":"Mexico"},{"value":"FM","label":"Micronesia, Federated States of"},{"value":"MD","label":"Moldova, Republic of"},{"value":"MC","label":"Monaco"},{"value":"MN","label":"Mongolia"},{"value":"ME","label":"Montenegro"},{"value":"MS","label":"Montserrat"},{"value":"MA","label":"Morocco"},{"value":"MZ","label":"Mozambique"},{"value":"MM","label":"Myanmar"},{"value":"NA","label":"Namibia"},{"value":"NR","label":"Nauru"},{"value":"NP","label":"Nepal"},{"value":"NL","label":"Netherlands"},{"value":"NC","label":"New Caledonia"},{"value":"NZ","label":"New Zealand"},{"value":"NI","label":"Nicaragua"},{"value":"NE","label":"Niger"},{"value":"NG","label":"Nigeria"},{"value":"NU","label":"Niue"},{"value":"NF","label":"Norfolk Island"},{"value":"MP","label":"Northern Mariana Islands"},{"value":"NO","label":"Norway"},{"value":"OM","label":"Oman"},{"value":"PK","label":"Pakistan"},{"value":"PW","label":"Palau"},{"value":"PS","label":"Palestine, State of"},{"value":"PA","label":"Panama"},{"value":"PG","label":"Papua New Guinea"},{"value":"PY","label":"Paraguay"},{"value":"PE","label":"Peru"},{"value":"PH","label":"Philippines"},{"value":"PN","label":"Pitcairn"},{"value":"PL","label":"Poland"},{"value":"PT","label":"Portugal"},{"value":"PR","label":"Puerto Rico"},{"value":"QA","label":"Qatar"},{"value":"RE","label":"R\xe9union"},{"value":"RO","label":"Romania"},{"value":"RU","label":"Russian Federation"},{"value":"RW","label":"Rwanda"},{"value":"BL","label":"Saint Barth\xe9lemy"},{"value":"SH","label":"Saint Helena, Ascension and Tristan da Cunha"},{"value":"KN","label":"Saint Kitts and Nevis"},{"value":"LC","label":"Saint Lucia"},{"value":"MF","label":"Saint Martin (French part)"},{"value":"PM","label":"Saint Pierre and Miquelon"},{"value":"VC","label":"Saint Vincent and the Grenadines"},{"value":"WS","label":"Samoa"},{"value":"SM","label":"San Marino"},{"value":"ST","label":"Sao Tome and Principe"},{"value":"SA","label":"Saudi Arabia"},{"value":"SN","label":"Senegal"},{"value":"RS","label":"Serbia"},{"value":"SC","label":"Seychelles"},{"value":"SL","label":"Sierra Leone"},{"value":"SG","label":"Singapore"},{"value":"SX","label":"Sint Maarten (Dutch part)"},{"value":"SK","label":"Slovakia"},{"value":"SI","label":"Slovenia"},{"value":"SB","label":"Solomon Islands"},{"value":"SO","label":"Somalia"},{"value":"ZA","label":"South Africa"},{"value":"GS","label":"South Georgia and the South Sandwich Islands"},{"value":"SS","label":"South Sudan"},{"value":"ES","label":"Spain"},{"value":"LK","label":"Sri Lanka"},{"value":"SD","label":"Sudan"},{"value":"SR","label":"Suriname"},{"value":"SJ","label":"Svalbard and Jan Mayen"},{"value":"SZ","label":"Swaziland"},{"value":"SE","label":"Sweden"},{"value":"CH","label":"Switzerland"},{"value":"SY","label":"Syrian Arab Republic"},{"value":"TW","label":"Taiwan, Province of China"},{"value":"TJ","label":"Tajikistan"},{"value":"TZ","label":"Tanzania, United Republic of"},{"value":"TH","label":"Thailand"},{"value":"TL","label":"Timor-Leste"},{"value":"TG","label":"Togo"},{"value":"TK","label":"Tokelau"},{"value":"TO","label":"Tonga"},{"value":"TT","label":"Trinidad and Tobago"},{"value":"TN","label":"Tunisia"},{"value":"TR","label":"Turkey"},{"value":"TM","label":"Turkmenistan"},{"value":"TC","label":"Turks and Caicos Islands"},{"value":"TV","label":"Tuvalu"},{"value":"UG","label":"Uganda"},{"value":"UA","label":"Ukraine"},{"value":"AE","label":"United Arab Emirates"},{"value":"GB","label":"United Kingdom"},{"value":"US","label":"United States"},{"value":"UM","label":"United States Minor Outlying Islands"},{"value":"UY","label":"Uruguay"},{"value":"UZ","label":"Uzbekistan"},{"value":"VU","label":"Vanuatu"},{"value":"VE","label":"Venezuela, Bolivarian Republic of"},{"value":"VN","label":"Viet Nam"},{"value":"VG","label":"Virgin Islands, British"},{"value":"VI","label":"Virgin Islands, U.S."},{"value":"WF","label":"Wallis and Futuna"},{"value":"EH","label":"Western Sahara"},{"value":"YE","label":"Yemen"},{"value":"ZM","label":"Zambia"},{"value":"ZW","label":"Zimbabwe"}]}');var w=l(60455),T=l(12435),R=l(68723),C=l(22322),L=l(44681),D=l(46402);let O=()=>{var e,a,l,T;let O=(0,C.nN)({relatedQueryKeys:["ListAlertsQueue","ListCurrentAlerts"]}),k=(0,f.useRouter)(),[j,N]=(0,t.useState)(!1);(0,t.useEffect)(()=>{k.query.id&&N(!0)},[k]);let F=(0,C.R_)({url:"/api/ListAlertsQueue",relatedQueryKeys:"ListAlertsQueue",queryKey:"ListCurrentAlerts"}),[G,B]=(0,t.useState)([{value:"30m",label:"Every 30 minutes"},{value:"1h",label:"Every hour"},{value:"4h",label:"Every 4 hours"},{value:"1d",label:"Every 1 day"},{value:"7d",label:"Every 7 days"},{value:"30d",label:"Every 30 days"},{value:"365d",label:"Every 365 days"}]),z=[{label:"Webhook",value:"Webhook"},{label:"Email",value:"Email"},{label:"PSA",value:"PSA"}],U=[{value:"Audit.AzureActiveDirectory",label:"Azure AD"},{value:"Audit.Exchange",label:"Exchange"}];(0,t.useEffect)(()=>{if(F.isSuccess&&j){var e,a;let l=null==F?void 0:null===(e=F.data)||void 0===e?void 0:e.find(e=>e.RowKey===k.query.id);if((null==l?void 0:l.LogType)==="Scripted"){let e;V("script");let a=Array.isArray(l.excludedTenants)?l.excludedTenants.map(e=>({value:e,label:e})):[],n=null==x?void 0:x.find(e=>e.name===l.RawAlert.Command.replace("Get-CIPPAlert","")),t=null==G?void 0:G.find(e=>e.value===l.RawAlert.Recurrence),r=z.filter(e=>l.RawAlert.PostExecution.split(",").includes(e.value));if(l.RawAlert.TenantGroup)try{let a=JSON.parse(l.RawAlert.TenantGroup);e={value:a.value,label:a.label,type:"Group",addedFields:a}}catch(a){console.error("Error parsing tenant group:",a),e={value:l.RawAlert.Tenant,label:l.RawAlert.Tenant,type:"Tenant"}}else e={value:l.RawAlert.Tenant,label:l.RawAlert.Tenant,type:"Tenant"};let i={tenantFilter:e,excludedTenants:a,command:{value:n,label:n.label},recurrence:t,postExecution:r};if((null==n?void 0:n.requiresInput)&&l.RawAlert.Parameters)try{let e="string"==typeof l.RawAlert.Parameters?JSON.parse(l.RawAlert.Parameters):l.RawAlert.Parameters;e.InputValue&&(i[n.inputName]=e.InputValue)}catch(e){console.error("Error parsing parameters:",e)}Q.reset(i,{keepDirty:!1})}if((null==l?void 0:l.PartitionKey)==="Webhookv2"){V("audit");let e=null==U?void 0:U.find(e=>e.value===l.RawAlert.type);H(l.RawAlert.Conditions.map((e,a)=>({id:a})));let n=l.RawAlert.Conditions.map(e=>{let a={Property:e.Property,Operator:e.Operator};return"String"===e.Property.value?a.Input={value:e.Input.value}:a.Input=e.Input,a}),t={RowKey:k.query.clone?void 0:k.query.id?k.query.id:void 0,tenantFilter:l.RawAlert.Tenants,excludedTenants:(null===(a=l.excludedTenants)||void 0===a?void 0:a.filter(e=>null!==e))||[],Actions:l.RawAlert.Actions,conditions:n,logbook:e};Q.reset(t),setTimeout(()=>{n.forEach((e,a)=>{"String"===e.Property.value?Q.setValue("conditions.".concat(a,".Input.value"),e.Input.value):Q.setValue("conditions.".concat(a,".Input"),e.Input)}),Q.trigger()},100)}}},[F.isSuccess,k,j]);let[q,V]=(0,t.useState)("none"),[K,H]=(0,t.useState)([{id:1}]),Q=(0,y.mN)({mode:"onChange"}),W=(0,y.FH)({control:Q.control,name:"preset"}),J=(0,y.FH)({control:Q.control,name:"command"}),Z=(0,y.FH)({control:Q.control,name:"logbook"}),Y=(0,y.FH)({control:Q.control,name:"conditions"});(0,t.useEffect)(()=>{Q.reset()},[q]),(0,t.useEffect)(()=>{var e;if(J&&(null===(e=J.value)||void 0===e?void 0:e.recommendedRunInterval)){let e=G.map(e=>({...e,label:e.label.replace(" (Recommended)","")})),a=null==e?void 0:e.find(e=>e.value===J.value.recommendedRunInterval);a&&(a.label+=" (Recommended)"),B(e),j||Q.setValue("recurrence",a)}},[J,j]),(0,t.useEffect)(()=>{if(W){let e=null==P?void 0:P.find(e=>e.value===W.value);if(e){let a=e.template.conditions||[];a.forEach((e,a)=>{Q.setValue("conditions.".concat(a,".Property"),e.Property||""),Q.setValue("conditions.".concat(a,".Operator"),e.Operator||""),Q.setValue("String"===e.Property.value?"conditions.".concat(a,".Input.value"):"conditions.".concat(a,".Input"),"String"===e.Property.value?e.Input.value:e.Input)}),e.template.logbook&&Q.setValue("logbook",e.template.logbook),H(a.map((e,a)=>({id:a})))}}},[W]);let _=e=>{let a=E.Common,l=E[e],n={...a,...l};return Object.keys(n).map(e=>({label:e,value:n[e]}))},X=()=>{H([...K,{id:K.length+1}])},$=e=>{let a=(Q.getValues("conditions")||[]).filter((a,l)=>l!==e);Q.setValue("conditions",a),H(K.filter(a=>a.id!==e))},{isValid:ee}=(0,y.lN)({control:Q.control});return(0,n.jsx)(r.A,{sx:{flexGrow:1,py:4},children:(0,n.jsx)(i.A,{maxWidth:"xl",children:(0,n.jsxs)(o.A,{spacing:4,children:[(0,n.jsx)(o.A,{direction:"row",justifyContent:"space-between",alignItems:"center",children:(0,n.jsx)(s.A,{color:"inherit",onClick:()=>k.back(),startIcon:(0,n.jsx)(u.A,{fontSize:"small",children:(0,n.jsx)(h.A6,{})}),children:"Back to Alerts"})}),F.isLoading&&(0,n.jsx)(d.A,{}),(0,n.jsx)(o.A,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:(0,n.jsxs)(b.A,{variant:"h4",children:[j?"Edit":"Add"," Alert"]})}),(0,n.jsxs)(g.A,{container:!0,spacing:1,children:[(0,n.jsx)(g.A,{size:{xs:12,md:6},children:(0,n.jsx)(m.A,{children:(0,n.jsx)(v.A,{onClick:()=>V("audit"),children:(0,n.jsxs)(c.A,{children:[(0,n.jsx)(b.A,{variant:"h6",children:"Audit Log Alert"}),(0,n.jsx)(b.A,{variant:"body2",children:"Select this option to create an alert based on a received Microsoft Audit log."})]})})})}),(0,n.jsx)(g.A,{size:{xs:12,md:6},children:(0,n.jsx)(m.A,{children:(0,n.jsx)(v.A,{onClick:()=>V("script"),children:(0,n.jsxs)(c.A,{children:[(0,n.jsx)(b.A,{variant:"h6",children:"Scripted CIPP Alert"}),(0,n.jsx)(b.A,{variant:"body2",children:"Select this option to set up an alert based on data processed by CIPP."})]})})})}),"audit"===q&&(0,n.jsx)(g.A,{container:!0,spacing:4,sx:{mt:2,width:"100%"},justifyContent:"space-around",children:(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)("form",{id:"auditAlertForm",onSubmit:Q.handleSubmit(e=>{e.conditions=e.conditions.filter(e=>null==e?void 0:e.Property),O.mutate({url:"/api/AddAlert",data:e})}),children:(0,n.jsxs)(g.A,{container:!0,spacing:3,justifyContent:"space-around",children:[(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(I.A,{title:"Tenant Selector",sx:{mb:3},children:(0,n.jsxs)(g.A,{container:!0,spacing:3,children:[(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(M.w,{multiple:!0,formControl:Q,allTenants:!0,label:"Included Tenants for alert",includeGroups:!0})}),(0,n.jsx)(D.A,{field:"tenantFilter",formControl:Q,compareType:"valueContains",compareValue:"AllTenants",children:(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(M.w,{multiple:!0,label:"Excluded Tenants for alert",formControl:Q,allTenants:!1,name:"excludedTenants"})})})]})})}),(0,n.jsx)(g.A,{size:12,children:(0,n.jsxs)(I.A,{title:"Alert Criteria",CardButton:(0,n.jsx)(s.A,{disabled:!ee,type:"submit",children:"Save Alert"}),sx:{mb:3},children:[(0,n.jsxs)(g.A,{container:!0,spacing:3,sx:{mb:2},children:[(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(S.A,{type:"autoComplete",multiple:!1,name:"preset",formControl:Q,label:"Select an alert preset, or customize your own",options:P.map(e=>({value:e.value,label:e.name}))})}),(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(S.A,{type:"autoComplete",name:"logbook",multiple:!1,creatable:!1,formControl:Q,validators:{required:{value:!0,message:"This field is required"}},label:"Select the log source",options:U})})]}),(0,n.jsx)(g.A,{size:12,sx:{mb:2},children:(0,n.jsx)(s.A,{color:"primary",onClick:()=>X(),startIcon:(0,n.jsx)(u.A,{children:(0,n.jsx)(L.A,{})}),children:"Add a condition"})}),K.map(e=>{var a,l,t,r,i;return(0,n.jsxs)(g.A,{container:!0,spacing:2,justifyContent:"space-around",sx:{mb:2},children:[(0,n.jsx)(g.A,{size:4,children:(0,n.jsx)(S.A,{type:"autoComplete",multiple:!1,name:"conditions.".concat(e.id,".Property"),formControl:Q,label:"Select property",options:_(null==Z?void 0:Z.value),creatable:!0,onCreateOption:e=>({label:e.label||e,value:"String"})})}),(0,n.jsx)(g.A,{size:4,children:(0,n.jsx)(S.A,{type:"autoComplete",multiple:!1,name:"conditions.".concat(e.id,".Operator"),formControl:Q,label:"is",options:[{value:"eq",label:"Equals to"},{value:"ne",label:"Not Equals to"},{value:"like",label:"Like"},{value:"notlike",label:"Not like"},{value:"notmatch",label:"Does not match"},{value:"gt",label:"Greater than"},{value:"lt",label:"Less than"},{value:"in",label:"In"},{value:"notIn",label:"Not In"}]})}),(0,n.jsxs)(g.A,{size:3,children:[(0,n.jsx)(D.A,{field:"conditions.".concat(e.id,".Property"),formControl:Q,compareType:"contains",compareValue:"String",children:(0,n.jsx)(S.A,{type:"textField",name:"conditions.".concat(e.id,".Input.value"),formControl:Q,label:"Input"})}),(0,n.jsx)(D.A,{field:"conditions.".concat(e.id,".Property"),formControl:Q,compareType:"contains",compareValue:"List:",children:(0,n.jsx)(S.A,{type:"autoComplete",multiple:null!==(i=null==Y?void 0:null===(l=Y[e.id])||void 0===l?void 0:null===(a=l.Property)||void 0===a?void 0:a.multi)&&void 0!==i&&i,name:"conditions.".concat(e.id,".Input"),formControl:Q,label:"Input",options:E[null==Y?void 0:null===(r=Y[e.id])||void 0===r?void 0:null===(t=r.Property)||void 0===t?void 0:t.value]})})]}),(0,n.jsx)(g.A,{size:1,children:(0,n.jsx)(p.A,{title:"Remove condition",children:(0,n.jsx)(A.A,{color:"error",onClick:()=>$(e.id),children:(0,n.jsx)(w.A,{})})})})]},e.id)}),(0,n.jsx)(g.A,{size:12,sx:{mt:2},children:(0,n.jsx)(S.A,{type:"autoComplete",name:"Actions",label:"Actions to take",validators:{required:{value:!0,message:"This field is required"}},formControl:Q,multiple:!0,creatable:!1,options:[{value:"becremediate",label:"Execute a BEC Remediate"},{value:"disableuser",label:"Disable the user in the log entry"},{value:"generatemail",label:"Generate an email"},{value:"generatePSA",label:"Generate a PSA ticket"},{value:"generateWebhook",label:"Generate a webhook"}]})}),(0,n.jsx)(g.A,{size:12,sx:{mt:2},children:(0,n.jsx)(R.v,{apiObject:O})})]})})]})})})}),"script"===q&&(0,n.jsx)(g.A,{container:!0,spacing:3,sx:{mt:2,width:"100%"},children:(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)("form",{id:"scriptAlertForm",onSubmit:Q.handleSubmit(e=>{var a,l;let n={RowKey:k.query.clone?void 0:k.query.id?k.query.id:void 0,tenantFilter:e.tenantFilter,excludedTenants:e.excludedTenants,Name:"".concat((null===(a=e.tenantFilter)||void 0===a?void 0:a.label)||(null===(l=e.tenantFilter)||void 0===l?void 0:l.value),": ").concat(e.command.label),Command:{value:"Get-CIPPAlert".concat(e.command.value.name)},Parameters:e.command.value.requiresInput?{InputValue:e[e.command.value.inputName]}:{},ScheduledTime:Math.floor(new Date().getTime()/1e3)+60,Recurrence:e.recurrence,PostExecution:e.postExecution};O.mutate({url:"/api/AddScheduledItem?hidden=true",data:n})}),disabled:!1===ee,children:(0,n.jsxs)(g.A,{container:!0,spacing:3,children:[(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(I.A,{title:"Tenant Selector",children:(0,n.jsxs)(g.A,{container:!0,spacing:3,children:[(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(M.w,{allTenants:!0,multiple:!1,formControl:Q,label:"Included Tenants for alert",includeGroups:!0,validators:{required:{value:!0,message:"This field is required"}}})}),(0,n.jsx)(D.A,{field:"tenantFilter",formControl:Q,compareType:"contains",compareValue:"AllTenants",children:(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(M.w,{multiple:!0,label:"Excluded Tenants for alert",formControl:Q,allTenants:!1,name:"excludedTenants"})})})]})})}),(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(I.A,{title:"Alert Criteria",CardButton:(0,n.jsx)(s.A,{disabled:!ee,type:"submit",children:"Save Alert"}),children:(0,n.jsxs)(g.A,{spacing:2,container:!0,children:[(0,n.jsx)(g.A,{size:{xs:12,md:6},children:(0,n.jsx)(S.A,{type:"autoComplete",validators:{required:!0},multiple:!1,creatable:!1,name:"command",formControl:Q,label:"What alerting script should run",validation:{required:"This field is required"},options:x.map(e=>({value:e,label:e.label}))})}),(0,n.jsx)(g.A,{size:{xs:12,md:6},children:(0,n.jsx)(S.A,{type:"autoComplete",multiple:!1,creatable:!1,name:"recurrence",validators:{required:{value:!0,message:"This field is required"}},formControl:Q,label:"When should the alert run",options:G})}),(0,n.jsx)(g.A,{size:12,children:(null==J?void 0:null===(e=J.value)||void 0===e?void 0:e.requiresInput)&&(0,n.jsx)(S.A,{type:null===(a=J.value)||void 0===a?void 0:a.inputType,name:null===(l=J.value)||void 0===l?void 0:l.inputName,formControl:Q,label:null===(T=J.value)||void 0===T?void 0:T.inputLabel})}),(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(S.A,{type:"autoComplete",name:"postExecution",label:"Alert via",validators:{required:{value:!0,message:"This field is required"}},formControl:Q,multiple:!0,creatable:!1,options:z})}),(0,n.jsx)(g.A,{size:12,children:(0,n.jsx)(R.v,{apiObject:O})})]})})})]})})})})]})]})})})};O.getLayout=e=>(0,n.jsx)(T.P,{children:e});let k=O}},e=>{var a=a=>e(e.s=a);e.O(0,[636,6593,8792],()=>a(55210)),_N_E=e.O()}]);