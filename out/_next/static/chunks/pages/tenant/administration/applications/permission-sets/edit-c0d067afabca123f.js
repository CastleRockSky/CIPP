(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7108],{49492:(e,i,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/administration/applications/permission-sets/edit",function(){return s(60458)}])},60458:(e,i,s)=>{"use strict";s.r(i),s.d(i,{default:()=>A});var t=s(37876),a=s(89099),n=s(12435),o=s(88992),r=s(22322),l=s(94861),m=s(36577),p=s(24933),d=s(46061),c=s(22474),u=s(76776),h=s(77018),x=s(14232),P=s(48230),v=s.n(P),f=s(47737),y=s(58105);let N=()=>{var e;let{template:i,name:s}=(0,a.useRouter)().query,[n,P]=(0,x.useState)(null),N=(0,o.mN)({mode:"onBlur"}),[A,T]=(0,x.useState)(0),{data:j,isFetching:w,refetch:_}=(0,r.R_)({url:i?"/api/ExecAppPermissionTemplate?TemplateId=".concat(i):null,queryKey:i?["execAppPermissionTemplate",i,A]:null,enabled:!!i}),S=(0,r.nN)({urlFromData:!0,relatedQueryKeys:["ExecAppPermissionTemplate","execAppPermissionTemplate"]});return((0,x.useEffect)(()=>{j&&j[0]&&(P({TemplateId:j[0].TemplateId,Permissions:j[0].Permissions,TemplateName:j[0].TemplateName}),N.setValue("templateName",j[0].TemplateName,{shouldValidate:!0,shouldDirty:!1}))},[j]),i)?(0,t.jsx)(m.A,{hideBackButton:!1,title:"Edit Permission Set: ".concat((null==n?void 0:n.TemplateName)||(null==j?void 0:null===(e=j[0])||void 0===e?void 0:e.TemplateName)||s||""),children:(0,t.jsx)(p.A,{children:(0,t.jsxs)(c.A,{spacing:2,children:[w&&(0,t.jsx)(u.A,{variant:"rectangular",width:"100%",height:200,animation:"wave"}),!w&&n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.A,{variant:"body2",children:"Modify the permissions in this permission set. Any changes will affect all applications using this permission set."}),(0,t.jsx)(d.A,{severity:"info",children:"Permission sets allow you to define collections of permissions that can be applied to applications consistently."}),(0,t.jsx)(y.o,{formControl:N,name:"templateName",label:"Permission Set Name",type:"textField",required:!0,validators:{required:"Permission set name is required"}}),(0,t.jsx)(d.A,{severity:"info",children:"Choose the permissions you want to assign to this permission set. Microsoft Graph is the default Service Principal added and you can choose to add additional Service Principals as needed. Note that some Service Principals do not have any published permissions to choose from."}),(0,t.jsx)(l.A,{formControl:N,currentPermissions:n,onSubmit:e=>{let s={...e,TemplateId:i};s.TemplateName=N.getValues("templateName"),S.mutate({url:"/api/ExecAppPermissionTemplate?Action=Save",data:s,queryKey:"execAppPermissionTemplate"},{onSuccess:()=>{T(e=>e+1),_()}})},updatePermissions:S,removePermissionConfirm:!0,appDisplayName:N.watch("templateName")||(null==n?void 0:n.TemplateName)},A)]})]})})}):(0,t.jsx)(m.A,{hideBackButton:!1,title:"Permission Set Not Found",children:(0,t.jsxs)(p.A,{children:[(0,t.jsx)(d.A,{severity:"error",sx:{mb:2},children:"The requested permission set does not exist or was not specified. Please select a valid permission set from the list."}),(0,t.jsx)(f.A,{variant:"contained",component:v(),href:"/tenant/administration/applications/permission-sets",children:"Back to Permission Sets"})]})})};N.getLayout=e=>(0,t.jsx)(n.P,{children:e});let A=N}},e=>{var i=i=>e(e.s=i);e.O(0,[888,8520,1949,636,6593,8792],()=>i(49492)),_N_E=e.O()}]);