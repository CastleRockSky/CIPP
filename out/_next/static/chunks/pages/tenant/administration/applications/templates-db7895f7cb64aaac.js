(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6169],{15099:(e,a,t)=>{"use strict";t.d(a,{A:()=>i}),t(14232);var p=t(93944),l=t(37876);let i=(0,p.A)((0,l.jsx)("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"}),"GitHub")},17055:(e,a,t)=>{"use strict";t.d(a,{L:()=>m});var p=t(37876),l=t(14e3),i=t(67578),n=t(22474),s=t(8578),r=t(76626),o=t(71538);let m=e=>{let{tabOptions:a,children:t}=e,m=(0,l.useRouter)(),d=(0,l.usePathname)(),c=a.find(e=>e.path===d);return(0,p.jsxs)(i.A,{sx:{flexGrow:1,py:4},children:[(0,p.jsx)(n.A,{spacing:2,children:(0,p.jsxs)("div",{children:[(0,p.jsx)(s.A,{onChange:(e,a)=>{m.push(a)},value:null==c?void 0:c.path,variant:"scrollable",children:a.map(e=>(0,p.jsx)(r.A,{label:e.label,value:e.path},e.path))}),(0,p.jsx)(o.A,{})]})}),t]})}},63390:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>h});var p=t(37876),l=t(12435),i=t(17055),n=t(29390),s=t(68396),r=t(97216),o=t(45852),m=t(15099),d=t(60455),c=t(95339),u=t(98114),A=t(47737),y=t(48230),T=t.n(y),b=t(22322);let f=()=>{let e=(0,b.R_)({url:"/api/ListExtensionsConfig",queryKey:"Integrations",refetchOnMount:!1,refetchOnReconnect:!1}),a=[{icon:(0,p.jsx)(r.A,{}),label:"Edit Template",color:"warning",link:"/tenant/administration/applications/templates/edit?template=[TemplateId]&name=[TemplateName]"},{icon:(0,p.jsx)(o.A,{}),label:"Copy Template",color:"info",link:"/tenant/administration/applications/templates/add?template=[TemplateId]&copy=true&name=[TemplateName]"},{icon:(0,p.jsx)(m.A,{}),label:"Save to GitHub",type:"POST",url:"/api/ExecCommunityRepo",data:{Action:"UploadTemplate",GUID:"TemplateId",TemplateType:"AppApproval"},fields:[{label:"Repository",name:"FullName",type:"select",api:{url:"/api/ListCommunityRepos",data:{WriteAccess:!0},queryKey:"CommunityRepos-Write",dataKey:"Results",valueField:"FullName",labelField:"FullName"},multiple:!1,creatable:!1,required:!0,validators:{required:{value:!0,message:"This field is required"}}},{label:"Commit Message",placeholder:"Enter a commit message for adding this file to GitHub",name:"Message",type:"textField",multiline:!0,required:!0,rows:4}],confirmText:"Are you sure you want to save this template to the selected repository?",condition:()=>{var a,t;return e.isSuccess&&(null==e?void 0:null===(t=e.data)||void 0===t?void 0:null===(a=t.GitHub)||void 0===a?void 0:a.Enabled)}},{icon:(0,p.jsx)(d.A,{}),label:"Delete Template",color:"danger",url:"/api/ExecAppApprovalTemplate",data:{Action:"Delete",TemplateId:"TemplateId"},type:"POST",confirmText:"Are you sure you want to delete [TemplateName]?"}],t=[{name:"TemplateName",label:"Template Name",sortable:!0},{name:"AppType",label:"Type",sortable:!0,formatter:e=>{let a=e.AppType||"EnterpriseApp";return"GalleryTemplate"===a?"Gallery Template":"ApplicationManifest"===a?"Application Manifest":"Enterprise App"}},{name:"AppId",label:"App ID",sortable:!0},{name:"AppName",label:"App Name",sortable:!0},{name:"PermissionSetName",label:"Permission Set",sortable:!0,formatter:e=>{let a=e.AppType||"EnterpriseApp";return"GalleryTemplate"===a?"Auto-Consent":"ApplicationManifest"===a?"Manifest-Defined":e.PermissionSetName||"-"}},{name:"UpdatedBy",label:"Updated By",sortable:!0},{name:"Timestamp",label:"Last Updated",sortable:!0}];return(0,p.jsx)(n.a,{title:"Templates",apiUrl:"/api/ListAppApprovalTemplates",queryKey:"ListAppApprovalTemplates",columns:t,simpleColumns:["TemplateName","AppType","AppId","AppName","PermissionSetName","UpdatedBy","Timestamp"],tableProps:{keyField:"TemplateId"},actions:a,offCanvas:{extendedInfoFields:["TemplateName","AppType","AppId","AppName","UpdatedBy","Timestamp"],actions:a,children:e=>{let a=e.AppType||"EnterpriseApp",t="Permission Preview";return"GalleryTemplate"===a?t="Gallery Template Info":"ApplicationManifest"===a&&(t="Application Manifest"),(0,p.jsx)(s.A,{permissions:"EnterpriseApp"===a?e.Permissions:null,title:t,galleryTemplate:"GalleryTemplate"===a?{label:e.AppName||"Unknown App",value:e.GalleryTemplateId||e.AppId,addedFields:{displayName:e.AppName,applicationId:e.AppId,...e.GalleryInformation||{description:"Gallery template for ".concat(e.AppName||"application"),publisher:"Microsoft Gallery",categories:["Application"],supportedSingleSignOnModes:["saml","password","oidc"],supportedProvisioningTypes:["sync"]}}}:null,applicationManifest:"ApplicationManifest"===a?e.ApplicationManifest:null,maxHeight:"800px",showAppIds:!0})}},cardButton:(0,p.jsx)(A.A,{component:T(),href:"/tenant/administration/applications/templates/add",startIcon:(0,p.jsx)(c.A,{}),children:"Add App Approval Template"})})};f.getLayout=e=>(0,p.jsx)(l.P,{children:(0,p.jsx)(i.L,{tabOptions:u,children:e})});let h=f},70241:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/tenant/administration/applications/templates",function(){return t(63390)}])},98114:e=>{"use strict";e.exports=JSON.parse('[{"label":"Enterprise Apps","path":"/tenant/administration/applications/enterprise-apps"},{"label":"App Registrations","path":"/tenant/administration/applications/app-registrations"},{"label":"Permission Sets","path":"/tenant/administration/applications/permission-sets"},{"label":"Templates","path":"/tenant/administration/applications/templates"}]')}},e=>{var a=a=>e(e.s=a);e.O(0,[8396,636,6593,8792],()=>a(70241)),_N_E=e.O()}]);