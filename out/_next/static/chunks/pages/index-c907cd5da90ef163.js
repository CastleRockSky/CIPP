(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3332],{4259:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eR});var i=n(37876),s=n(77328),l=n.n(s),a=n(14232),r=n(67578),o=n(86650),c=n(54538),d=n(24933),u=n(22430),x=n(47737),h=n(59568),m=n(45297),g=n(85496),y=n(5419),p=n(12435),j=n(17825),v=n(35936);let f=JSON.parse('[{"label":"M365 Portal","name":"M365_Portal","url":"https://admin.cloud.microsoft/?delegatedOrg=initialDomainName","variable":"initialDomainName","target":"_blank","external":true,"icon":"GlobeAltIcon"},{"label":"Exchange Portal","name":"Exchange_Portal","url":"https://admin.cloud.microsoft/exchange?landingpage=homepage&form=mac_sidebar&delegatedOrg=initialDomainName#","variable":"initialDomainName","target":"_blank","external":true,"icon":"Mail"},{"label":"Entra Portal","name":"Entra_Portal","url":"https://entra.microsoft.com/defaultDomainName","variable":"defaultDomainName","target":"_blank","external":true,"icon":"UsersIcon"},{"label":"Teams Portal","name":"Teams_Portal","url":"https://admin.teams.microsoft.com/?delegatedOrg=initialDomainName","variable":"initialDomainName","target":"_blank","external":true,"icon":"FilePresent"},{"label":"Azure Portal","name":"Azure_Portal","url":"https://portal.azure.com/defaultDomainName","variable":"defaultDomainName","target":"_blank","external":true,"icon":"ServerIcon"},{"label":"Intune Portal","name":"Intune_Portal","url":"https://intune.microsoft.com/defaultDomainName","variable":"defaultDomainName","target":"_blank","external":true,"icon":"Laptop"},{"label":"SharePoint Admin","name":"SharePoint_Admin","url":"/api/ListSharePointAdminUrl?tenantFilter=defaultDomainName","variable":"defaultDomainName","target":"_blank","external":true,"icon":"Share"},{"label":"Security Portal","name":"Security_Portal","url":"https://security.microsoft.com/?tid=customerId","variable":"customerId","target":"_blank","external":true,"icon":"Shield"},{"label":"Compliance Portal","name":"Compliance_Portal","url":"https://purview.microsoft.com/?tid=customerId","variable":"customerId","target":"_blank","external":true,"icon":"ShieldMoon"}]');var b=n(95062),T=n.n(b),A=n(54550),S=n(94810),w=n(52808),C=n(6003),F=n(94760),D=n(93256),I=n(50221),k=n(86795),L=n(16785),z=n(58188),N=n(8307),V=n(1297),R=n(12312),P=n(80581),B=n(74197),E=n(76670);function W(e){switch(e){case"GlobeAltIcon":return(0,i.jsx)(P.A,{});case"Mail":return(0,i.jsx)(k.A,{});case"UsersIcon":return(0,i.jsx)(B.A,{});case"FilePresent":return(0,i.jsx)(L.A,{});case"ServerIcon":return(0,i.jsx)(E.A,{});case"Laptop":return(0,i.jsx)(z.A,{});case"Share":return(0,i.jsx)(N.A,{});case"Shield":return(0,i.jsx)(V.A,{});case"ShieldMoon":return(0,i.jsx)(R.A,{});default:return null}}let M=e=>{let{buttonName:t,sx:n,row:s,actions:l=[],...a}=e,r=(0,I.f)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.A,{onClick:r.handleOpen,ref:r.anchorRef,startIcon:(0,i.jsx)(S.A,{fontSize:"small",children:(0,i.jsx)(A.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap",...n},...a,children:t}),(0,i.jsx)(w.A,{anchorEl:r.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:r.handleClose,open:r.open,transformOrigin:{horizontal:"right",vertical:"top"},children:l.map((e,t)=>e.link?(0,i.jsxs)(C.A,{onClick:r.handleClose,component:F.A,href:e.link,target:"_blank",rel:"noreferrer",children:[(0,i.jsx)(S.A,{sx:{mr:1},children:W(e.icon)}),(0,i.jsx)(D.A,{primary:e.label})]},t):(0,i.jsxs)(C.A,{onClick:e.onClick,children:[(0,i.jsx)(S.A,{sx:{mr:1},children:W(e.icon)}),(0,i.jsx)(D.A,{primary:e.label})]},t))})]})};M.propTypes={onArchive:T().func,onDelete:T().func,selectedCount:T().number};var U=n(68284),H=n(76776),_=n(77018),O=n(22322);let G=a.forwardRef((e,t)=>{var n;let{onConfirm:s=()=>{},onChange:l=()=>{},maxResults:o=7,value:c=""}=e,[d,u]=(0,a.useState)(c),x=(0,O.R_)({url:"/api/ExecUniversalSearch?name=".concat(d),queryKey:"search-".concat(d),waiting:!1}),h=async e=>{"Enter"===e.key&&x.refetch()};return(0,i.jsxs)(r.A,{sx:{p:.5},children:[(0,i.jsx)(U.A,{ref:t,fullWidth:!0,type:"text",label:"Search users in any tenant by UPN or Display Name. Requires Lighthouse onboarding",onKeyDown:h,onChange:e=>{let t=e.target.value;u(t),l(t)},value:d}),x.isFetching&&(0,i.jsx)(r.A,{display:"flex",justifyContent:"center",mt:2,children:(0,i.jsx)(H.A,{width:"100%"})}),x.isSuccess&&(null==x?void 0:null===(n=x.data)||void 0===n?void 0:n.length)>0?(0,i.jsx)(q,{items:x.data,searchValue:d}):x.isSuccess&&"No results found."]})});G.displayName="CippUniversalSearch";let q=e=>{let{items:t=[],searchValue:n}=e,[s,l]=(0,a.useState)(1),o=t.length,c=Math.ceil(o/9),d=(s-1)*9,u=t.slice(d,d+9);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(_.A,{variant:"body2",color:"textSecondary",mt:2,children:[o," results (Page ",s," of ",c,")"]}),(0,i.jsx)(h.A,{container:!0,spacing:2,mt:2,children:u.map((e,t)=>(0,i.jsx)(h.A,{size:{md:4,sm:6,xs:12},children:(0,i.jsx)(K,{match:e,searchValue:n})},t))}),(0,i.jsxs)(r.A,{display:"flex",justifyContent:"space-between",mt:2,children:[(0,i.jsx)(x.A,{variant:"outlined",disabled:1===s,onClick:()=>{s>1&&l(s-1)},children:"Previous"}),(0,i.jsx)(x.A,{variant:"outlined",disabled:s===c,onClick:()=>{s<c&&l(s+1)},children:"Next"})]})]})},K=e=>{var t,n,s,l,a,o;let{match:u,searchValue:h}=e,m=e=>{let t=null==e?void 0:e.split(RegExp("(".concat(h,")"),"gi"));return null==t?void 0:t.map((e,t)=>e.toLowerCase()===h.toLowerCase()?(0,i.jsx)(_.A,{component:"span",fontWeight:"bold",children:e},t):e)},g=(0,O.R_)({url:"/api/ListTenants",queryKey:"ListTenants"});return(0,i.jsx)(c.A,{variant:"outlined",sx:{height:"100%"},children:(0,i.jsxs)(d.A,{children:[(0,i.jsx)(_.A,{variant:"h6",children:m(u.displayName)}),(0,i.jsx)(_.A,{variant:"body2",color:"textSecondary",children:m(u.userPrincipalName)}),(0,i.jsxs)(_.A,{variant:"caption",color:"textSecondary",sx:{display:"flex",alignItems:"center"},children:["Found in tenant"," ",(null===(n=g.data)||void 0===n?void 0:null===(t=n.find(e=>e.customerId===u._tenantId))||void 0===t?void 0:t.defaultDomainName)||u._tenantId,(0,i.jsxs)(r.A,{ml:2,display:"inline-flex",gap:1,children:[(0,i.jsx)(x.A,{component:F.A,href:"identity/administration/users/user?tenantFilter=".concat((null===(l=g.data)||void 0===l?void 0:null===(s=l.find(e=>e.customerId===u._tenantId))||void 0===s?void 0:s.defaultDomainName)||u._tenantId,"&userId=").concat(u.id),variant:"outlined",color:"primary",size:"small",children:"View User"}),(0,i.jsx)(x.A,{component:F.A,href:"identity/administration/users?tenantFilter=".concat((null===(o=g.data)||void 0===o?void 0:null===(a=o.find(e=>e.customerId===u._tenantId))||void 0===a?void 0:a.defaultDomainName)||u._tenantId),variant:"outlined",color:"primary",size:"small",children:"View Tenant"})]})]})]})})};var Y=n(84177),$=n(5596),Q=n(47866),Z=n(70946),J=n(3034),X=n(50694),ee=n(64410),et=n(35656),en=n(57212),ei=n(78523),es=n(19736),el=n(48504),ea=n(63817),er=n(80580),eo=n(85273),ec=n(57093);let ed=e=>{var t,s,l,a,r,o,c,d,u,x,h,m,g,y;let{tenantName:p,userStats:j,brandingSettings:v,secureScoreData:f,licensingData:b,deviceData:T,conditionalAccessData:A,standardsCompareData:S,sectionConfig:w={executiveSummary:!0,securityStandards:!0,secureScore:!0,licenseManagement:!0,deviceManagement:!0,conditionalAccess:!0,infographics:!0}}=e,C=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),F=(null==v?void 0:v.colour)||"#F77F00",D=eo.StyleSheet.create({page:{flexDirection:"column",backgroundColor:"#FFFFFF",fontFamily:"Helvetica",fontSize:10,lineHeight:1.4,color:"#2D3748",padding:40},coverPage:{flexDirection:"column",backgroundColor:"#FFFFFF",fontFamily:"Helvetica",padding:60,justifyContent:"space-between",minHeight:"100%"},coverHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:80},logoSection:{flexDirection:"row",alignItems:"center"},logo:{height:100,marginRight:12},headerLogo:{height:30},brandName:{fontSize:12,fontWeight:"bold",color:F,letterSpacing:1,textTransform:"uppercase"},dateStamp:{fontSize:9,color:"#000000",textTransform:"uppercase",letterSpacing:.5},coverHero:{flex:1,justifyContent:"flex-start",alignItems:"flex-start",paddingTop:40},coverLabel:{backgroundColor:F,color:"#FFFFFF",fontSize:10,fontWeight:"bold",textTransform:"uppercase",letterSpacing:1,paddingHorizontal:16,paddingVertical:8,borderRadius:20,marginBottom:30,alignSelf:"flex-start"},mainTitle:{fontSize:48,fontWeight:"bold",color:"#1A202C",lineHeight:1.1,marginBottom:20,letterSpacing:-1,textTransform:"uppercase"},titleAccent:{color:F},subtitle:{fontSize:14,color:"#000000",fontWeight:"normal",lineHeight:1.5,marginBottom:40,maxWidth:400},tenantCard:{backgroundColor:"transparent",padding:0,maxWidth:400},tenantName:{fontSize:18,fontWeight:"bold",color:"#000000",marginBottom:8,textAlign:"center"},tenantMeta:{fontSize:11,color:"#333333",textAlign:"center"},coverFooter:{textAlign:"center",marginTop:60},confidential:{fontSize:9,color:"#A0AEC0",textTransform:"uppercase",letterSpacing:1},pageHeader:{borderBottom:"1px solid ".concat(F),paddingBottom:12,marginBottom:24,flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",pageBreakAfter:"avoid",breakAfter:"avoid"},pageHeaderContent:{flex:1},pageTitle:{fontSize:20,fontWeight:"bold",color:"#1A202C",marginBottom:8},pageSubtitle:{fontSize:11,color:"#4A5568",fontWeight:"normal"},section:{marginBottom:24,pageBreakInside:"avoid",breakInside:"avoid"},sectionTitle:{fontSize:14,fontWeight:"bold",color:F,marginBottom:12,pageBreakAfter:"avoid",breakAfter:"avoid",orphans:3,widows:3},bodyText:{fontSize:9,color:"#2D3748",lineHeight:1.5,marginBottom:12,textAlign:"justify"},statsGrid:{flexDirection:"row",gap:12,marginBottom:20,pageBreakInside:"avoid",breakInside:"avoid"},statCard:{flex:1,backgroundColor:"#FFFFFF",border:"1px solid #E2E8F0",borderRadius:6,padding:16,alignItems:"center",borderTop:"3px solid ".concat(F)},statNumber:{fontSize:16,fontWeight:"bold",color:F,marginBottom:4},statLabel:{fontSize:7,color:"#4A5568",textTransform:"uppercase",letterSpacing:.5,textAlign:"center",fontWeight:"bold"},complianceList:{gap:8},complianceItem:{flexDirection:"row",alignItems:"center",backgroundColor:"#FFFFFF",padding:10,borderRadius:4,border:"1px solid #F0F0F0"},complianceLabel:{fontSize:8,color:"#2D3748",width:80,fontWeight:"bold"},complianceBarContainer:{flex:1,height:6,backgroundColor:"#E2E8F0",marginHorizontal:10,borderRadius:3,overflow:"hidden"},complianceBar:{height:6,backgroundColor:F,borderRadius:3},complianceValue:{fontSize:8,color:"#2D3748",width:25,textAlign:"right",fontWeight:"bold"},scoreGrid:{flexDirection:"row",gap:12,marginBottom:20,pageBreakInside:"avoid",breakInside:"avoid"},scoreCard:{flex:1,backgroundColor:"#FFFFFF",border:"1px solid #E2E8F0",borderRadius:6,padding:16,alignItems:"center",borderTop:"3px solid ".concat(F)},scoreNumber:{fontSize:20,fontWeight:"bold",color:F,marginBottom:8},scoreLabel:{fontSize:7,color:"#4A5568",textTransform:"uppercase",letterSpacing:.5,textAlign:"center",fontWeight:"bold"},chartContainer:{backgroundColor:"#FFFFFF",border:"1px solid #E2E8F0",borderRadius:6,padding:16,marginBottom:20,alignItems:"center",pageBreakInside:"avoid",breakInside:"avoid"},chartTitle:{fontSize:10,fontWeight:"bold",color:"#2D3748",marginBottom:12},chartData:{fontSize:9,color:"#4A5568",textAlign:"center",lineHeight:1.4},controlsTable:{border:"1px solid #E2E8F0",borderRadius:6,overflow:"hidden",pageBreakInside:"avoid",breakInside:"avoid"},tableHeader:{flexDirection:"row",backgroundColor:F,paddingVertical:10,paddingHorizontal:12},headerCell:{fontSize:7,fontWeight:"bold",color:"#FFFFFF",textTransform:"uppercase",letterSpacing:.5},headerName:{width:100},headerDesc:{flex:1,marginLeft:12},headerStatus:{width:60,textAlign:"center",marginLeft:12},tableRow:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"#F7FAFC",paddingVertical:8,paddingHorizontal:12,alignItems:"center"},cellName:{width:100,fontSize:8,fontWeight:"bold",color:"#2D3748"},cellDesc:{flex:1,marginLeft:12,fontSize:7,color:"#4A5568",lineHeight:1.3},cellStatus:{width:60,marginLeft:12,alignItems:"center",justifyContent:"center"},statusText:{fontSize:7,fontWeight:"bold",textAlign:"center",textTransform:"uppercase",letterSpacing:.3},statusCompliant:{color:"#22543D"},statusPartial:{color:"#744210"},statusReview:{color:"#742A2A"},infoBox:{backgroundColor:"#FFFFFF",border:"1px solid #E2E8F0",borderLeft:"4px solid ".concat(F),borderRadius:4,padding:12,marginBottom:12,pageBreakInside:"avoid",breakInside:"avoid",orphans:3,widows:3},infoTitle:{fontSize:9,fontWeight:"bold",color:"#2D3748",marginBottom:6},infoText:{fontSize:8,color:"#4A5568",lineHeight:1.4},recommendationsList:{gap:8,pageBreakInside:"avoid",breakInside:"avoid"},recommendationItem:{flexDirection:"row",alignItems:"flex-start"},recommendationBullet:{fontSize:8,color:F,marginRight:6,fontWeight:"bold",marginTop:1},recommendationText:{fontSize:8,color:"#2D3748",lineHeight:1.4,flex:1},recommendationLabel:{fontWeight:"bold"},footer:{position:"absolute",bottom:20,left:40,right:40,flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderTop:"1px solid #E2E8F0",paddingTop:8},footerText:{fontSize:7,color:"#718096"},pageNumber:{fontSize:7,color:"#718096",fontWeight:"bold"},statPage:{flexDirection:"column",backgroundColor:"#000000",fontFamily:"Helvetica",padding:0,justifyContent:"center",alignItems:"flex-start",minHeight:"100%",position:"relative"},statOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,padding:60,justifyContent:"center",alignItems:"flex-start",zIndex:10,backgroundColor:"rgba(0, 0, 0, 0.7)"},statMainText:{fontSize:18,color:"#FFFFFF",fontWeight:"bold",lineHeight:1.4,marginBottom:8},statHighlight:{fontSize:72,color:F,fontWeight:"900",lineHeight:1,marginBottom:8},statBackground:{position:"absolute",top:0,left:0,right:0,bottom:0,opacity:.5},statSubText:{fontSize:14,color:"#FFFFFF",fontWeight:"bold",lineHeight:1.3,marginBottom:40},statFooterText:{position:"absolute",bottom:60,right:60,fontSize:12,color:"#FFFFFF",fontWeight:"bold",textAlign:"right",lineHeight:1.3},statBrandFooter:{position:"absolute",bottom:60,left:60,fontSize:8,color:"#666666",textTransform:"uppercase",letterSpacing:1},centeredImage:{width:300,height:200,alignSelf:"center",marginVertical:20,borderRadius:8},svgChartContainer:{alignItems:"center",marginVertical:12},svgChart:{width:400,height:200,marginBottom:8},chartSummaryText:{fontSize:8,fontWeight:"bold",color:F,textAlign:"center",marginTop:8}}),I=(e=>{let t=null;try{t=n(75069)}catch(e){}if(!e||!Array.isArray(e)||0===e.length)return[];let i=[],s=e[0];return Object.keys(s).forEach(e=>{if(e.startsWith("standards.")&&"tenantFilter"!==e){let n=s[e],l=null==t?void 0:t.find(t=>t.name===e);if(l){let e="Review";n&&"object"==typeof n&&!0===n.Value?e="Compliant":n&&!0===n.Value&&(e="Compliant");let t=l.tag&&Array.isArray(l.tag)&&l.tag.length>0?l.tag.slice(0,2).join(", "):"No tags";i.push({name:l.label,description:l.executiveText||l.helpText||"No description available",status:e,tags:t})}else{let t="Review";n&&"object"==typeof n&&!0===n.Value?t="Compliant":n&&!0===n.Value&&(t="Compliant");let s=e.replace("standards.","").replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim();i.push({name:s,description:"Security standard implementation",status:t,tags:"No tags"})}}}),i})(S),k=e=>{switch(e){case"Compliant":return[D.statusText,D.statusCompliant];case"Partial":return[D.statusText,D.statusPartial];case"Review":case"Review Required":return[D.statusText,D.statusReview];default:return D.statusText}};return(0,i.jsxs)(eo.Document,{children:[(0,i.jsxs)(eo.Page,{size:"A4",style:D.coverPage,children:[(0,i.jsx)(eo.Image,{style:D.statBackground,src:"/reportImages/soc.jpg"}),(0,i.jsxs)(eo.View,{style:D.coverHeader,children:[(0,i.jsx)(eo.View,{style:D.logoSection,children:(null==v?void 0:v.logo)&&(0,i.jsx)(eo.Image,{style:D.logo,src:v.logo,cache:!1})}),(0,i.jsx)(eo.Text,{style:D.dateStamp,children:C})]}),(0,i.jsxs)(eo.View,{style:D.coverHero,children:[(0,i.jsx)(eo.Text,{style:D.coverLabel,children:"SECURITY ASSESSMENT"}),(0,i.jsxs)(eo.Text,{style:D.mainTitle,children:["Executive","\n",(0,i.jsx)(eo.Text,{style:D.titleAccent,children:"Summary"})]}),(0,i.jsxs)(eo.Text,{style:D.subtitle,children:["Security & Compliance Assessment for ",p||"your organization"]}),(0,i.jsx)(eo.View,{style:D.tenantCard,children:(0,i.jsx)(eo.Text,{style:D.tenantName,children:p||"Organization Name"})})]}),(0,i.jsx)(eo.View,{style:D.coverFooter,children:(0,i.jsx)(eo.Text,{style:D.confidential,children:"Confidential & Proprietary"})})]}),w.executiveSummary&&(0,i.jsxs)(eo.Page,{size:"A4",style:D.page,children:[(0,i.jsxs)(eo.View,{style:D.pageHeader,children:[(0,i.jsxs)(eo.View,{style:D.pageHeaderContent,children:[(0,i.jsx)(eo.Text,{style:D.pageTitle,children:"Executive Summary"}),(0,i.jsx)(eo.Text,{style:D.pageSubtitle,children:"Strategic overview of your Microsoft 365 security posture"})]}),(null==v?void 0:v.logo)&&(0,i.jsx)(eo.Image,{style:D.headerLogo,src:v.logo,cache:!1})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsxs)(eo.Text,{style:D.bodyText,children:["This security assessment for"," ",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:p||"your organization"})," ","provides a clear picture of your organization's cybersecurity posture and readiness against modern threats. We've evaluated your current security measures against industry best practices to identify strengths and opportunities for improvement."]}),(0,i.jsx)(eo.Text,{style:D.bodyText,children:"Our assessment follows globally recognized security standards to ensure your organization meets regulatory requirements and industry benchmarks. This approach helps protect your business assets, maintain customer trust, and reduce operational risks from cyber threats."})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Environment Overview"}),(0,i.jsxs)(eo.View,{style:D.statsGrid,children:[(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:(null==j?void 0:j.licensedUsers)||"0"}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Licensed Users"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:(null==j?void 0:j.unlicensedUsers)||"0"}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Unlicensed Users"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:(null==j?void 0:j.guests)||"0"}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Guest Users"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:(null==j?void 0:j.globalAdmins)||"0"}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Global Admins"})]})]})]}),(0,i.jsx)(eo.View,{style:D.footer,children:(0,i.jsx)(eo.Text,{style:D.pageNumber,render:e=>{let{pageNumber:t,totalPages:n}=e;return"Page ".concat(t," of ").concat(n)}})})]}),w.infographics&&(0,i.jsxs)(eo.Page,{size:"A4",style:D.statPage,children:[(0,i.jsx)(eo.Image,{style:D.statBackground,src:"/reportImages/board.jpg"}),(0,i.jsxs)(eo.View,{style:D.statOverlay,children:[(0,i.jsx)(eo.Text,{style:D.statHighlight,children:"83%"}),(0,i.jsxs)(eo.Text,{style:D.statSubText,children:["of organizations experienced","\n","more than one ",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"cyberattack"}),"\n","in the past year"]})]}),(0,i.jsxs)(eo.Text,{style:D.statFooterText,children:[(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"Proactive security"})," prevents","\n",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"repeated attacks"})]})]}),w.securityStandards&&I&&I.length>0&&(0,i.jsxs)(eo.Page,{size:"A4",style:D.page,children:[(0,i.jsxs)(eo.View,{style:D.pageHeader,children:[(0,i.jsxs)(eo.View,{style:D.pageHeaderContent,children:[(0,i.jsx)(eo.Text,{style:D.pageTitle,children:"Security Standards Assessment"}),(0,i.jsx)(eo.Text,{style:D.pageSubtitle,children:"Detailed evaluation of implemented security standards"})]}),(null==v?void 0:v.logo)&&(0,i.jsx)(eo.Image,{style:D.headerLogo,src:v.logo,cache:!1})]}),(0,i.jsx)(eo.View,{style:D.section,children:(0,i.jsx)(eo.Text,{style:D.bodyText,children:"Your security standards have been carefully evaluated against industry best practices to protect your business from cyber threats while ensuring smooth daily operations. These standards help maintain business continuity, protect sensitive data, and meet regulatory requirements that are essential for your industry."})}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Security Standards Status"}),(0,i.jsxs)(eo.View,{style:D.controlsTable,children:[(0,i.jsxs)(eo.View,{style:D.tableHeader,children:[(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:80}],children:"Standard"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{flex:1,marginLeft:8}],children:"Description"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:80,marginLeft:8}],children:"Tags"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:60,textAlign:"center",marginLeft:8}],children:"Status"})]}),I.map((e,t)=>(0,i.jsxs)(eo.View,{style:D.tableRow,children:[(0,i.jsx)(eo.Text,{style:[D.cellName,{width:80,marginLeft:0}],children:e.name}),(0,i.jsx)(eo.Text,{style:[D.cellDesc,{flex:1,marginLeft:8}],children:e.description}),(0,i.jsx)(eo.Text,{style:[D.cellDesc,{width:80,marginLeft:8,fontSize:6}],children:("object"==typeof e.tags&&console.log("DEBUG: control.tags is an object:",e.tags,"for control:",e.name),e.tags)}),(0,i.jsx)(eo.View,{style:[D.cellStatus,{width:60,marginLeft:8}],children:(0,i.jsx)(eo.Text,{style:k(e.status),children:e.status})})]},t))]})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Key Recommendations"}),(0,i.jsxs)(eo.View,{style:D.recommendationsList,children:[(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Immediate Actions:"}),' Address standards marked as "Review" to enhance security posture']})]}),(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Compliance:"})," Ensure all security standards are properly implemented and maintained"]})]}),(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Monitoring:"})," Establish regular review cycles for all security standards"]})]}),(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Training:"})," Implement security awareness programs to reduce human risk factors"]})]})]})]}),(0,i.jsx)(eo.View,{style:D.footer,children:(0,i.jsx)(eo.Text,{style:D.pageNumber,render:e=>{let{pageNumber:t,totalPages:n}=e;return"Page ".concat(t," of ").concat(n)}})})]}),w.infographics&&w.secureScore&&f&&(null==f?void 0:f.isSuccess)&&(null==f?void 0:f.translatedData)&&(0,i.jsxs)(eo.Page,{size:"A4",style:D.statPage,children:[(0,i.jsx)(eo.Image,{style:D.statBackground,src:"/reportImages/glasses.jpg"}),(0,i.jsxs)(eo.View,{style:D.statOverlay,children:[(0,i.jsx)(eo.Text,{style:D.statHighlight,children:"95%"}),(0,i.jsxs)(eo.Text,{style:D.statSubText,children:["of successful cyber attacks","\n","could have been prevented with","\n",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"proactive security measures"})]})]}),(0,i.jsxs)(eo.Text,{style:D.statFooterText,children:["Your ",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"security resilience"})," is","\n","our ",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"primary mission"})]})]}),w.secureScore&&f&&(null==f?void 0:f.isSuccess)&&(null==f?void 0:f.translatedData)&&(0,i.jsxs)(eo.Page,{size:"A4",style:D.page,children:[(0,i.jsxs)(eo.View,{style:D.pageHeader,children:[(0,i.jsxs)(eo.View,{style:D.pageHeaderContent,children:[(0,i.jsx)(eo.Text,{style:D.pageTitle,children:"Microsoft Secure Score"}),(0,i.jsx)(eo.Text,{style:D.pageSubtitle,children:"Comprehensive security posture measurement and benchmarking"})]}),(null==v?void 0:v.logo)&&(0,i.jsx)(eo.Image,{style:D.headerLogo,src:v.logo,cache:!1})]}),(0,i.jsx)(eo.View,{style:D.section,children:(0,i.jsx)(eo.Text,{style:D.bodyText,children:"Microsoft Secure Score measures how well your organization is protected against cyber threats. This score reflects the effectiveness of your current security measures and helps identify areas where additional protection could strengthen your business resilience."})}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Score Comparison"}),(0,i.jsxs)(eo.View,{style:D.scoreGrid,children:[(0,i.jsxs)(eo.View,{style:D.scoreCard,children:[(0,i.jsx)(eo.Text,{style:D.scoreNumber,children:(null==f?void 0:null===(t=f.translatedData)||void 0===t?void 0:t.currentScore)||"N/A"}),(0,i.jsx)(eo.Text,{style:D.scoreLabel,children:"Current Score"})]}),(0,i.jsxs)(eo.View,{style:D.scoreCard,children:[(0,i.jsx)(eo.Text,{style:D.scoreNumber,children:(null==f?void 0:null===(s=f.translatedData)||void 0===s?void 0:s.maxScore)||"N/A"}),(0,i.jsx)(eo.Text,{style:D.scoreLabel,children:"Max Score"})]}),(0,i.jsxs)(eo.View,{style:D.scoreCard,children:[(0,i.jsxs)(eo.Text,{style:D.scoreNumber,children:[(null==f?void 0:null===(l=f.translatedData)||void 0===l?void 0:l.percentageVsSimilar)||"N/A","%"]}),(0,i.jsx)(eo.Text,{style:D.scoreLabel,children:"vs Similar Orgs"})]}),(0,i.jsxs)(eo.View,{style:D.scoreCard,children:[(0,i.jsxs)(eo.Text,{style:D.scoreNumber,children:[(null==f?void 0:null===(a=f.translatedData)||void 0===a?void 0:a.percentageVsAllTenants)||"N/A","%"]}),(0,i.jsx)(eo.Text,{style:D.scoreLabel,children:"vs All Orgs"})]})]})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"7-Day Score Trend"}),(0,i.jsxs)(eo.View,{style:D.chartContainer,children:[(0,i.jsx)(eo.Text,{style:D.chartTitle,children:"Secure Score Progress"}),(null==f?void 0:null===(o=f.secureScore)||void 0===o?void 0:null===(r=o.data)||void 0===r?void 0:r.Results)&&f.secureScore.data.Results.length>0?(0,i.jsxs)(eo.View,{style:D.svgChartContainer,children:[(0,i.jsxs)(eo.Svg,{style:D.svgChart,viewBox:"0 0 400 200",children:[(0,i.jsx)(eo.Rect,{x:"40",y:"20",width:"320",height:"140",fill:"#F7FAFC",stroke:"#E2E8F0",strokeWidth:"1"}),[0,1,2,3,4].map(e=>(0,i.jsx)(eo.Line,{x1:"40",y1:20+35*e,x2:"360",y2:20+35*e,stroke:"#E2E8F0",strokeWidth:"0.5"},"grid-".concat(e))),(()=>{var e;let t=f.secureScore.data.Results.slice().reverse(),n=(null==f?void 0:null===(e=f.translatedData)||void 0===e?void 0:e.maxScore)||100,s=320/Math.max(t.length-1,1),l="M 40 ".concat(160-t[0].currentScore/n*140);t.forEach((e,t)=>{if(t>0){let i=160-e.currentScore/n*140;l+=" L ".concat(40+t*s," ").concat(i)}}),l+=" L ".concat(40+(t.length-1)*s," 160 L 40 160 Z");let a="M 40 ".concat(160-t[0].currentScore/n*140);return t.forEach((e,t)=>{if(t>0){let i=160-e.currentScore/n*140;a+=" L ".concat(40+t*s," ").concat(i)}}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eo.Path,{d:l,fill:F,fillOpacity:"0.3"}),(0,i.jsx)(eo.Path,{d:a,fill:"none",stroke:F,strokeWidth:"2"}),t.map((e,t)=>{let l=160-e.currentScore/n*140;return(0,i.jsx)(eo.Circle,{cx:40+t*s,cy:l,r:"3",fill:F},t)}),t.map((e,t)=>{let n=new Date(e.createdDateTime).toLocaleDateString("en-US",{month:"short",day:"numeric"});return(0,i.jsx)(eo.Text,{x:40+t*s,y:"180",textAnchor:"middle",fontSize:"8",fill:"#4A5568",children:n},"label-".concat(t))}),[0,Math.round(.25*n),Math.round(.5*n),Math.round(.75*n),n].map((e,t)=>(0,i.jsx)(eo.Text,{x:"35",y:165-35*t,textAnchor:"end",fontSize:"8",fill:"#4A5568",children:e},"y-label-".concat(t)))]})})()]}),(0,i.jsxs)(eo.Text,{style:D.chartSummaryText,children:["Current: ",(null==f?void 0:null===(c=f.translatedData)||void 0===c?void 0:c.currentScore)||"N/A"," /"," ",(null==f?void 0:null===(d=f.translatedData)||void 0===d?void 0:d.maxScore)||"N/A","(",(null==f?void 0:null===(u=f.translatedData)||void 0===u?void 0:u.percentageCurrent)||"N/A","%)"]})]}):(0,i.jsxs)(eo.Text,{style:D.chartData,children:["Current Score: ",(null==f?void 0:null===(x=f.translatedData)||void 0===x?void 0:x.currentScore)||"N/A"," /"," ",(null==f?void 0:null===(h=f.translatedData)||void 0===h?void 0:h.maxScore)||"N/A","\n","Achievement Rate: ",(null==f?void 0:null===(m=f.translatedData)||void 0===m?void 0:m.percentageCurrent)||"N/A","%","\n","Historical data not available"]})]})]}),(0,i.jsxs)(eo.View,{style:D.infoBox,children:[(0,i.jsx)(eo.Text,{style:D.infoTitle,children:"What Your Score Means"}),(0,i.jsxs)(eo.Text,{style:D.infoText,children:["Your current score of ",(null==f?void 0:null===(g=f.translatedData)||void 0===g?void 0:g.currentScore)||"N/A"," ","represents ",(null==f?void 0:null===(y=f.translatedData)||void 0===y?void 0:y.percentageCurrent)||"N/A","% of the maximum protection level available. This indicates how well your organization is currently defended against common cyber threats and data breaches."]})]}),(0,i.jsxs)(eo.View,{style:D.infoBox,children:[(0,i.jsx)(eo.Text,{style:D.infoTitle,children:"Why Scores Change"}),(0,i.jsxs)(eo.Text,{style:D.infoText,children:["• Business growth and new employees may temporarily lower scores until security measures are applied","\n","• Changes in software licenses can affect available security features","\n","• New security threats require updated protections, which may impact scores","\n","• Regular security improvements help maintain and increase your protection level"]})]}),(0,i.jsx)(eo.View,{style:D.footer,children:(0,i.jsx)(eo.Text,{style:D.pageNumber,render:e=>{let{pageNumber:t,totalPages:n}=e;return"Page ".concat(t," of ").concat(n)}})})]}),w.licenseManagement&&b&&Array.isArray(b)&&b.length>0&&(0,i.jsxs)(i.Fragment,{children:[w.infographics&&(0,i.jsxs)(eo.Page,{size:"A4",style:D.statPage,children:[(0,i.jsx)(eo.Image,{style:D.statBackground,src:"/reportImages/working.jpg"}),(0,i.jsxs)(eo.View,{style:D.statOverlay,children:[(0,i.jsx)(eo.Text,{style:D.statMainText,children:"Every"}),(0,i.jsx)(eo.Text,{style:D.statHighlight,children:"39"}),(0,i.jsx)(eo.Text,{style:D.statMainText,children:"seconds"}),(0,i.jsxs)(eo.Text,{style:D.statSubText,children:["a business falls victim to","\n",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"ransomware attacks"})]})]}),(0,i.jsxs)(eo.Text,{style:D.statFooterText,children:[(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"Proactive defense"})," beats","\n",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"reactive recovery"})]})]}),(0,i.jsxs)(eo.Page,{size:"A4",style:D.page,children:[(0,i.jsxs)(eo.View,{style:D.pageHeader,children:[(0,i.jsxs)(eo.View,{style:D.pageHeaderContent,children:[(0,i.jsx)(eo.Text,{style:D.pageTitle,children:"License Management"}),(0,i.jsx)(eo.Text,{style:D.pageSubtitle,children:"Microsoft 365 license allocation and utilization analysis"})]}),(null==v?void 0:v.logo)&&(0,i.jsx)(eo.Image,{style:D.headerLogo,src:v.logo,cache:!1})]}),(0,i.jsx)(eo.View,{style:D.section,children:(0,i.jsx)(eo.Text,{style:D.bodyText,children:"Smart license management helps control costs while ensuring your team has the tools they need to be productive. This analysis shows how your current licenses are being used and identifies opportunities to optimize spending without compromising business operations."})}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"License Allocation Summary"}),(0,i.jsxs)(eo.View,{style:D.controlsTable,children:[(0,i.jsxs)(eo.View,{style:D.tableHeader,children:[(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:200}],children:"License Type"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:60,textAlign:"center"}],children:"Used"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:60,textAlign:"center"}],children:"Available"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:60,textAlign:"center"}],children:"Total"})]}),b.map((e,t)=>(0,i.jsxs)(eo.View,{style:D.tableRow,children:[(0,i.jsx)(eo.Text,{style:[D.cellName,{width:200,fontSize:7,marginLeft:0}],children:(()=>{let t=e.License||e.license||"N/A";return"object"==typeof t&&console.log("DEBUG: license name is an object:",t,"full license:",e),t})()}),(0,i.jsx)(eo.Text,{style:[D.cellName,{width:60,textAlign:"center",fontSize:8,fontWeight:"bold"}],children:(()=>{let t=e.CountUsed||e.countUsed||"0";return"object"==typeof t&&console.log("DEBUG: license.CountUsed is an object:",t,"full license:",e),t})()}),(0,i.jsx)(eo.Text,{style:[D.cellName,{width:60,textAlign:"center",fontSize:8}],children:(()=>{let t=e.CountAvailable||e.countAvailable||"0";return"object"==typeof t&&console.log("DEBUG: license.CountAvailable is an object:",t,"full license:",e),t})()}),(0,i.jsx)(eo.Text,{style:[D.cellName,{width:60,textAlign:"center",fontSize:8,fontWeight:"bold"}],children:(()=>{let t=e.TotalLicenses||e.totalLicenses||"0";return"object"==typeof t&&console.log("DEBUG: license.TotalLicenses is an object:",t,"full license:",e),t})()})]},t))]})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"License Optimization Recommendations"}),(0,i.jsxs)(eo.View,{style:D.recommendationsList,children:[(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Usage Monitoring:"})," Track how licenses are being used to identify cost-saving opportunities"]})]}),(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Cost Control:"})," Review unused licenses to reduce unnecessary spending"]})]}),(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Growth Planning:"})," Ensure you have enough licenses for business expansion without overspending"]})]}),(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Regular Reviews:"})," Conduct quarterly reviews to maintain cost-effective license allocation"]})]})]})]}),(0,i.jsx)(eo.View,{style:D.footer,children:(0,i.jsx)(eo.Text,{style:D.pageNumber,render:e=>{let{pageNumber:t,totalPages:n}=e;return"Page ".concat(t," of ").concat(n)}})})]})]}),w.deviceManagement&&T&&Array.isArray(T)&&T.length>0&&(0,i.jsxs)(i.Fragment,{children:[w.infographics&&(0,i.jsxs)(eo.Page,{size:"A4",style:D.statPage,children:[(0,i.jsx)(eo.Image,{style:D.statBackground,src:"/reportImages/laptop.jpg"}),(0,i.jsxs)(eo.View,{style:D.statOverlay,children:[(0,i.jsx)(eo.Text,{style:D.statHighlight,children:"$4.45M"}),(0,i.jsxs)(eo.Text,{style:D.statSubText,children:["average cost of a","\n",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"data breach in 2024"})]})]}),(0,i.jsxs)(eo.Text,{style:D.statFooterText,children:[(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"Investment in security"}),"\n","saves ",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"millions in recovery"})]})]}),(0,i.jsxs)(eo.Page,{size:"A4",style:D.page,children:[(0,i.jsxs)(eo.View,{style:D.pageHeader,children:[(0,i.jsxs)(eo.View,{style:D.pageHeaderContent,children:[(0,i.jsx)(eo.Text,{style:D.pageTitle,children:"Device Management"}),(0,i.jsx)(eo.Text,{style:D.pageSubtitle,children:"Device compliance status and management overview"})]}),(null==v?void 0:v.logo)&&(0,i.jsx)(eo.Image,{style:D.headerLogo,src:v.logo,cache:!1})]}),(0,i.jsx)(eo.View,{style:D.section,children:(0,i.jsx)(eo.Text,{style:D.bodyText,children:"Managing employee devices is essential for protecting your business data and maintaining productivity. This analysis shows which devices meet your security standards and identifies any that may need attention to prevent data breaches or operational disruptions."})}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Device Compliance Overview"}),(0,i.jsxs)(eo.View,{style:D.statsGrid,children:[(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:T.length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Total Devices"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:T.filter(e=>"compliant"===e.complianceState||"compliant"===e.ComplianceState).length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Compliant"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:T.filter(e=>"compliant"!==e.complianceState&&"compliant"!==e.ComplianceState).length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Non-Compliant"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsxs)(eo.Text,{style:D.statNumber,children:[Math.round(T.filter(e=>"Compliant"===e.complianceState||"Compliant"===e.ComplianceState).length/T.length*100),"%"]}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Compliance Rate"})]})]})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Device Management Summary"}),(0,i.jsxs)(eo.View,{style:D.controlsTable,children:[(0,i.jsxs)(eo.View,{style:D.tableHeader,children:[(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:120}],children:"Device Name"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:70}],children:"OS"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:70}],children:"Compliance"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{flex:1}],children:"Last Sync"})]}),T.slice(0,8).map((e,t)=>{let n=e.lastSyncDateTime?new Date(e.lastSyncDateTime).toLocaleDateString():"N/A";return(0,i.jsxs)(eo.View,{style:D.tableRow,children:[(0,i.jsx)(eo.Text,{style:[D.cellName,{width:120,fontSize:7,marginLeft:0}],children:(()=>{let t=e.deviceName||"N/A";return"object"==typeof t&&console.log("DEBUG: device.deviceName is an object:",t,"full device:",e),t})()}),(0,i.jsx)(eo.Text,{style:[D.cellName,{width:70,fontSize:7}],children:(()=>{let t=e.operatingSystem||"N/A";return"object"==typeof t&&console.log("DEBUG: device.operatingSystem is an object:",t,"full device:",e),t})()}),(0,i.jsx)(eo.View,{style:[D.cellStatus,{width:70,marginLeft:0}],children:(0,i.jsx)(eo.Text,{style:[D.statusText,"compliant"===e.complianceState?D.statusCompliant:D.statusReview],children:(()=>{let t=e.complianceState||"Unknown";return"object"==typeof t&&console.log("DEBUG: device.complianceState is an object:",t,"full device:",e),t})()})}),(0,i.jsx)(eo.Text,{style:[D.cellName,{flex:1,fontSize:7}],children:n})]},t)})]})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Device Insights"}),(0,i.jsxs)(eo.View,{style:D.statsGrid,children:[(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:T.filter(e=>"Windows"===e.operatingSystem).length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Windows Devices"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:T.filter(e=>"iOS"===e.operatingSystem).length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"iOS Devices"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:T.filter(e=>"Android"===e.operatingSystem).length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Android Devices"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:T.filter(e=>!0===e.isEncrypted).length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Encrypted"})]})]})]}),(0,i.jsxs)(eo.View,{style:D.infoBox,children:[(0,i.jsx)(eo.Text,{style:D.infoTitle,children:"Device Management Recommendations"}),(0,i.jsx)(eo.Text,{style:D.infoText,children:"Keep devices updated and secure to protect business data. Regularly check that all employee devices meet security standards and address any issues promptly. Consider automated policies to maintain consistent security across all devices and conduct regular reviews to identify potential risks."})]}),(0,i.jsx)(eo.View,{style:D.footer,children:(0,i.jsx)(eo.Text,{style:D.pageNumber,render:e=>{let{pageNumber:t,totalPages:n}=e;return"Page ".concat(t," of ").concat(n)}})})]})]}),w.conditionalAccess&&A&&Array.isArray(A)&&A.length>0&&(0,i.jsxs)(i.Fragment,{children:[w.infographics&&(0,i.jsxs)(eo.Page,{size:"A4",style:D.statPage,children:[(0,i.jsx)(eo.Image,{style:D.statBackground,src:"/reportImages/city.jpg"}),(0,i.jsxs)(eo.View,{style:D.statOverlay,children:[(0,i.jsx)(eo.Text,{style:D.statHighlight,children:"277"}),(0,i.jsx)(eo.Text,{style:D.statMainText,children:"days"}),(0,i.jsxs)(eo.Text,{style:D.statSubText,children:["average time to identify and","\n","contain a ",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"data breach"})]})]}),(0,i.jsxs)(eo.Text,{style:D.statFooterText,children:[(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"Early detection"})," minimizes","\n",(0,i.jsx)(eo.Text,{style:{fontWeight:"bold"},children:"business impact"})]})]}),(0,i.jsxs)(eo.Page,{size:"A4",style:D.page,children:[(0,i.jsxs)(eo.View,{style:D.pageHeader,children:[(0,i.jsxs)(eo.View,{style:D.pageHeaderContent,children:[(0,i.jsx)(eo.Text,{style:D.pageTitle,children:"Conditional Access Policies"}),(0,i.jsx)(eo.Text,{style:D.pageSubtitle,children:"Identity and access management security controls"})]}),(null==v?void 0:v.logo)&&(0,i.jsx)(eo.Image,{style:D.headerLogo,src:v.logo,cache:!1})]}),(0,i.jsx)(eo.View,{style:D.section,children:(0,i.jsx)(eo.Text,{style:D.bodyText,children:"Access control policies help protect your business by ensuring only the right people can access sensitive information under appropriate circumstances. These smart security measures automatically evaluate each access request and apply additional verification when needed, balancing security with employee productivity."})}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"How Access Controls Protect Your Business"}),(0,i.jsx)(eo.Text,{style:D.bodyText,children:"These policies work like intelligent security guards, making decisions based on who is trying to access what, from where, and when. For example, accessing email from the office might be seamless, but accessing it from an unusual location might require additional verification. This approach protects your data while minimizing disruption to daily work."})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Current Policy Configuration"}),(0,i.jsxs)(eo.View,{style:D.controlsTable,children:[(0,i.jsxs)(eo.View,{style:D.tableHeader,children:[(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:140}],children:"Policy Name"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:80}],children:"State"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{width:80}],children:"Applications"}),(0,i.jsx)(eo.Text,{style:[D.headerCell,{flex:1}],children:"Controls"})]}),A.slice(0,8).map((e,t)=>(0,i.jsxs)(eo.View,{style:D.tableRow,children:[(0,i.jsx)(eo.Text,{style:[D.cellName,{width:140,fontSize:7,marginLeft:0}],children:(()=>{let t=e.displayName||"N/A";return"object"==typeof t&&console.log("DEBUG: policy.displayName is an object:",t,"full policy:",e),t})()}),(0,i.jsx)(eo.View,{style:[D.cellStatus,{width:80,marginLeft:0}],children:(0,i.jsx)(eo.Text,{style:[D.statusText,(e=>{switch(e){case"enabled":return D.statusCompliant;case"enabledForReportingButNotEnforced":return D.statusPartial;case"disabled":return D.statusReview;default:return D.statusText}})(e.state)],children:(e=>{switch(e){case"enabled":return"Enabled";case"enabledForReportingButNotEnforced":return"Report Only";case"disabled":return"Disabled";default:return e||"Unknown"}})(e.state)})}),(0,i.jsx)(eo.Text,{style:[D.cellName,{width:80,fontSize:7}],children:(()=>{let t=e.includeApplications||"All";return"object"==typeof t&&console.log("DEBUG: policy.includeApplications is an object:",t,"full policy:",e),t})()}),(0,i.jsx)(eo.Text,{style:[D.cellName,{flex:1,fontSize:7}],children:(e=>{let t=[];return e.builtInControls&&(e.builtInControls.includes("mfa")&&t.push("MFA"),e.builtInControls.includes("block")&&t.push("Block"),e.builtInControls.includes("compliantDevice")&&t.push("Compliant Device")),t.length>0?t.join(", "):"Custom"})(e)})]},t))]})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Policy Overview"}),(0,i.jsxs)(eo.View,{style:D.statsGrid,children:[(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:A.length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Total Policies"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:A.filter(e=>"enabled"===e.state).length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Enabled"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:A.filter(e=>"enabledForReportingButNotEnforced"===e.state).length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"Report Only"})]}),(0,i.jsxs)(eo.View,{style:D.statCard,children:[(0,i.jsx)(eo.Text,{style:D.statNumber,children:A.filter(e=>e.builtInControls&&e.builtInControls.includes("mfa")).length}),(0,i.jsx)(eo.Text,{style:D.statLabel,children:"MFA Policies"})]})]})]}),(0,i.jsxs)(eo.View,{style:D.section,children:[(0,i.jsx)(eo.Text,{style:D.sectionTitle,children:"Policy Analysis"}),(0,i.jsxs)(eo.View,{style:D.recommendationsList,children:[(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Policy Coverage:"})," ",A.length," conditional access policies configured"]})]}),(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Enforcement Status:"})," ",A.filter(e=>"enabled"===e.state).length," ","policies actively enforced"]})]}),(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Testing Phase:"})," ",A.filter(e=>"enabledForReportingButNotEnforced"===e.state).length," ","policies in report-only mode"]})]}),(0,i.jsxs)(eo.View,{style:D.recommendationItem,children:[(0,i.jsx)(eo.Text,{style:D.recommendationBullet,children:"•"}),(0,i.jsxs)(eo.Text,{style:D.recommendationText,children:[(0,i.jsx)(eo.Text,{style:D.recommendationLabel,children:"Security Controls:"})," ","Multi-factor authentication and access blocking implemented"]})]})]})]}),(0,i.jsxs)(eo.View,{style:D.infoBox,children:[(0,i.jsx)(eo.Text,{style:D.infoTitle,children:"Access Control Recommendations"}),(0,i.jsxs)(eo.Text,{style:D.infoText,children:[A.filter(e=>"enabledForReportingButNotEnforced"===e.state).length>0?"Consider activating ".concat(A.filter(e=>"enabledForReportingButNotEnforced"===e.state).length," policies currently in testing mode after ensuring they don't disrupt business operations. "):"Your access controls are properly configured. ","Regularly review how these policies affect employee productivity and adjust as needed. Consider additional location-based protections for enhanced security without impacting daily operations."]})]}),(0,i.jsx)(eo.View,{style:D.footer,children:(0,i.jsx)(eo.Text,{style:D.pageNumber,render:e=>{let{pageNumber:t,totalPages:n}=e;return"Page ".concat(t," of ").concat(n)}})})]})]})]})},eu=e=>{let{tenantName:t,tenantId:s,userStats:l,standardsData:o,organizationData:c,...d}=e;console.log(e);let h=(0,j.t)(),m=h.customBranding,[g,y]=(0,a.useState)(!1),[p,v]=(0,a.useState)({executiveSummary:!0,securityStandards:!0,secureScore:!0,licenseManagement:!0,deviceManagement:!0,conditionalAccess:!0,infographics:!0}),f=(0,ec.D)(),b=(0,O.R_)({url:"/api/ListLicenses",data:{tenantFilter:h.currentTenant},queryKey:"licenses-report-".concat(h.currentTenant)}),T=(0,O.R_)({url:"/api/ListDevices",data:{tenantFilter:h.currentTenant},queryKey:"devices-report-".concat(h.currentTenant)}),A=(0,O.R_)({url:"/api/ListConditionalAccessPolicies",data:{tenantFilter:h.currentTenant},queryKey:"ca-policies-report-".concat(h.currentTenant)}),S=(0,O.R_)({url:"/api/ListStandardsCompare",data:{tenantFilter:h.currentTenant},queryKey:"standards-compare-report-".concat(h.currentTenant)}),w=f.isFetching||b.isFetching||T.isFetching||A.isFetching||S.isFetching,C=(f.isSuccess||f.isError)&&(b.isSuccess||b.isError)&&(T.isSuccess||T.isError)&&(A.isSuccess||A.isError)&&(S.isSuccess||S.isError)&&!w,F="Executive_Report_".concat((null==t?void 0:t.replace(/[^a-zA-Z0-9]/g,"_"))||"Tenant","_").concat(new Date().toISOString().split("T")[0],".pdf"),D=(0,a.useMemo)(()=>{console.log("Creating report document with:",{tenantName:t,tenantId:s,userStats:l,standardsData:o,organizationData:c,brandingSettings:m,secureScore:f.isSuccess?f:null,licensingData:b.isSuccess?null==b?void 0:b.data:null,deviceData:T.isSuccess?null==T?void 0:T.data:null,conditionalAccessData:A.isSuccess?null==A?void 0:A.data:null,standardsCompareData:S.isSuccess?null==S?void 0:S.data:null,sectionConfig:p});try{return(0,i.jsx)(ed,{tenantName:t,tenantId:s,userStats:l,standardsData:o,organizationData:c,brandingSettings:m,secureScoreData:f.isSuccess?f:null,licensingData:b.isSuccess?null==b?void 0:b.data:null,deviceData:T.isSuccess?null==T?void 0:T.data:null,conditionalAccessData:A.isSuccess?null==A?void 0:A.data:null,standardsCompareData:S.isSuccess?null==S?void 0:S.data:null,sectionConfig:p})}catch(e){return console.error("Error creating ExecutiveReportDocument:",e),(0,i.jsx)(eo.Document,{children:(0,i.jsx)(eo.Page,{size:"A4",style:{padding:40,fontFamily:"Helvetica"},children:(0,i.jsxs)(eo.Text,{style:{fontSize:14,color:"red"},children:["Error creating document: ",e.message]})})})}},[t,s,l,o,c,m,f,b,T,A,S,p]),I=e=>{v(t=>{let n=Object.values(t).filter(Boolean).length;return t[e]&&1===n?t:{...t,[e]:!t[e]}})},k=[{key:"executiveSummary",label:"Executive Summary",description:"High-level overview and statistics"},{key:"securityStandards",label:"Security Standards",description:"Compliance assessment and standards evaluation"},{key:"secureScore",label:"Microsoft Secure Score",description:"Security posture measurement and trends"},{key:"licenseManagement",label:"License Management",description:"License allocation and optimization"},{key:"deviceManagement",label:"Device Management",description:"Device compliance and insights"},{key:"conditionalAccess",label:"Conditional Access",description:"Access control policies and analysis"},{key:"infographics",label:"Infographic Pages",description:"Statistical pages with visual elements between sections"}];return C?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.A,{title:"Generate Executive Report with preview and configuration",children:(0,i.jsx)(x.A,{variant:"contained",startIcon:(0,i.jsx)(es.A,{}),onClick:()=>y(!0),sx:{fontWeight:"bold",textTransform:"none",borderRadius:2,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",transition:"all 0.2s ease-in-out"},...d,children:"Executive Summary"})}),(0,i.jsxs)($.A,{open:g,onClose:()=>y(!1),maxWidth:"xl",fullWidth:!0,sx:{"& .MuiDialog-paper":{height:"95vh",maxHeight:"95vh"}},children:[(0,i.jsxs)(Q.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1,borderBottom:"1px solid",borderColor:"divider"},children:[(0,i.jsxs)(_.A,{variant:"h6",component:"div",children:["Executive Report - ",t]}),(0,i.jsx)(Z.A,{onClick:()=>y(!1),size:"small",children:(0,i.jsx)(el.A,{})})]}),(0,i.jsxs)(J.A,{sx:{p:0,height:"100%",display:"flex"},children:[(0,i.jsx)(X.A,{sx:{width:320,flexShrink:0,borderRadius:0,borderRight:"1px solid",borderColor:"divider",height:"100%",overflow:"auto"},children:(0,i.jsxs)(r.A,{sx:{p:2},children:[(0,i.jsxs)(_.A,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[(0,i.jsx)(ea.A,{size:20}),"Report Sections"]}),(0,i.jsx)(_.A,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Configure which sections to include in your executive report. Changes are reflected in real-time."}),(0,i.jsx)(ee.Ay,{container:!0,spacing:1.5,children:k.map(e=>(0,i.jsx)(ee.Ay,{item:!0,xs:12,children:(0,i.jsx)(X.A,{sx:{p:1.5,border:"1px solid",borderColor:p[e.key]?"primary.main":"divider",bgcolor:p[e.key]?"primary.50":"background.paper",cursor:"pointer",transition:"all 0.2s ease-in-out","&:hover":{borderColor:"primary.main",bgcolor:p[e.key]?"primary.100":"primary.25"}},children:(0,i.jsx)(et.A,{control:(0,i.jsx)(en.A,{checked:p[e.key],onChange:t=>{t.stopPropagation(),I(e.key)},color:"primary",size:"small",disabled:p[e.key]&&1===Object.values(p).filter(Boolean).length}),label:(0,i.jsxs)(r.A,{onClick:()=>I(e.key),children:[(0,i.jsx)(_.A,{variant:"subtitle2",fontWeight:"bold",sx:{fontSize:"0.875rem"},children:e.label}),(0,i.jsx)(_.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem"},children:e.description})]}),sx:{margin:0,width:"100%"}})})},e.key))}),(0,i.jsxs)(r.A,{sx:{mt:3,p:2,bgcolor:"primary.50",borderRadius:1},children:[(0,i.jsx)(_.A,{variant:"caption",color:"primary.main",fontWeight:"bold",children:"\uD83D\uDCA1 Pro Tip"}),(0,i.jsx)(_.A,{variant:"caption",display:"block",color:"text.secondary",sx:{mt:.5},children:"Enable only the sections relevant to your audience to create focused, impactful reports. At least one section must be enabled."})]})]})}),(0,i.jsx)(r.A,{sx:{flex:1,height:"100%"},children:(0,i.jsx)(eo.PDFViewer,{style:{width:"100%",height:"100%",border:"none"},showToolbar:!0,children:D},JSON.stringify(p))})]}),(0,i.jsxs)(ei.A,{sx:{p:2,borderTop:"1px solid",borderColor:"divider",gap:1},children:[(0,i.jsx)(r.A,{sx:{flex:1,display:"flex",alignItems:"center",gap:1},children:(0,i.jsxs)(_.A,{variant:"caption",color:"text.secondary",children:["Sections enabled: ",Object.values(p).filter(Boolean).length," of"," ",k.length]})}),(0,i.jsx)(x.A,{variant:"contained",startIcon:(0,i.jsx)(er.A,{}),disabled:!C,sx:{minWidth:140},onClick:()=>{let e=(0,i.jsx)(ed,{tenantName:t,tenantId:s,userStats:l,standardsData:o,organizationData:c,brandingSettings:m,secureScoreData:f.isSuccess?f:null,licensingData:b.isSuccess?null==b?void 0:b.data:null,deviceData:T.isSuccess?null==T?void 0:T.data:null,conditionalAccessData:A.isSuccess?null==A?void 0:A.data:null,standardsCompareData:S.isSuccess?null==S?void 0:S.data:null,sectionConfig:p});Promise.resolve().then(n.bind(n,85273)).then(t=>{let{pdf:n}=t;n(e).toBlob().then(e=>{let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=F,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}).catch(e=>{console.error("Error generating PDF:",e)})})},children:"Download PDF"}),(0,i.jsx)(x.A,{onClick:()=>y(!1),variant:"outlined",children:"Close"})]})]})]}):(0,i.jsx)(u.A,{title:"Loading report data...",children:(0,i.jsx)(x.A,{variant:"contained",startIcon:(0,i.jsx)(es.A,{}),disabled:!0,sx:{fontWeight:"bold",textTransform:"none",borderRadius:2,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",transition:"all 0.2s ease-in-out"},...d,children:"Loading Data..."})})};var ex=n(82851),eh=n.n(ex),em=n(22474),eg=n(7881),ey=n(88326),ep=n(59017),ej=n(37746),ev=n(11621),ef=n(98249),eb=n(77e3),eT=n(67606),eA=n(95691),eS=n(95753),ew=n(22112),eC=n(10881),eF=n(29468),eD=n(87505),eI=n(75069);let ek=e=>{switch(e){case"Global Standards":default:return(0,i.jsx)(ev.A,{fontSize:"small"});case"Entra (AAD) Standards":return(0,i.jsx)(ef.A,{fontSize:"small"});case"Exchange Standards":return(0,i.jsx)(eb.A,{fontSize:"small"});case"Defender Standards":return(0,i.jsx)(eT.A,{fontSize:"small"});case"Intune Standards":return(0,i.jsx)(eA.A,{fontSize:"small"})}},eL=e=>{switch(null==e?void 0:e.toLowerCase()){case"report":return(0,i.jsx)(eS.A,{fontSize:"small"});case"alert":case"warn":return(0,i.jsx)(ew.A,{fontSize:"small"});case"remediate":return(0,i.jsx)(eC.A,{fontSize:"small"});default:return(0,i.jsx)(eF.A,{fontSize:"small"})}},ez=e=>{switch(null==e?void 0:e.toLowerCase()){case"low impact":return"info";case"medium impact":return"warning";case"high impact":return"error";default:return"default"}},eN=e=>{let{open:t,onClose:n,standardsData:s,currentTenant:l}=e,[o,u]=(0,a.useState)(!1);if(!s)return null;let h=s.filter(e=>{let t=Array.isArray(null==e?void 0:e.tenantFilter)?e.tenantFilter:[],n=Array.isArray(null==e?void 0:e.excludedTenants)?e.excludedTenants:[],i=t.length>0&&t.some(e=>e.value===l),s=t.some(e=>"AllTenants"===e.value)&&(0===n.length||!n.some(e=>e.value===l));return i||s}),m={};for(let e of h)for(let[t,n]of Object.entries(e.standards))m[t]=n;let g={};Object.entries(m).forEach(e=>{let[t,n]=e,i=eI.find(e=>e.name==="standards.".concat(t));if(i){let e=i.cat;g[e]||(g[e]=[]),g[e].push({key:t,config:n,info:i})}});let y=e=>(t,n)=>{u(!!n&&e)};return(0,i.jsxs)($.A,{open:t,onClose:n,maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{maxHeight:"90vh"}},children:[(0,i.jsxs)(Q.A,{sx:{m:0,p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)(_.A,{variant:"h6",children:"Standards Configuration"}),(0,i.jsx)(Z.A,{"aria-label":"close",onClick:n,sx:{color:e=>e.palette.grey[500]},children:(0,i.jsx)(el.A,{})})]}),(0,i.jsx)(J.A,{dividers:!0,children:(0,i.jsxs)(em.A,{spacing:2,children:[(0,i.jsxs)(r.A,{children:[(0,i.jsxs)(_.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Showing standards configuration for tenant: ",(0,i.jsx)("strong",{children:l})]}),(0,i.jsxs)(_.A,{variant:"body2",color:"text.secondary",children:["Total templates applied: ",(0,i.jsx)("strong",{children:h.length})," | Total standards: ",(0,i.jsx)("strong",{children:Object.keys(m).length})]})]}),Object.entries(g).map((e,t)=>{let[n,s]=e;return(0,i.jsxs)(eg.A,{expanded:o===n,onChange:y(n),sx:{mb:1,borderRadius:2,boxShadow:"none",border:e=>"1px solid ".concat(e.palette.divider),"&:before":{display:"none"}},children:[(0,i.jsx)(ey.A,{expandIcon:(0,i.jsx)(eD.A,{}),"aria-controls":"".concat(n,"-content"),id:"".concat(n,"-header"),sx:{minHeight:48,"& .MuiAccordionSummary-content":{alignItems:"center",m:0}},children:(0,i.jsxs)(em.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,i.jsx)(S.A,{color:"primary",children:ek(n)}),(0,i.jsx)(_.A,{variant:"subtitle1",fontWeight:600,children:n}),(0,i.jsx)(ep.A,{label:"".concat(s.length," standards"),size:"small",variant:"outlined"})]})}),(0,i.jsx)(ej.A,{sx:{pt:1,pb:2},children:(0,i.jsx)(ee.Ay,{container:!0,spacing:1,children:s.map(e=>{let{key:t,config:n,info:s}=e;return(0,i.jsx)(ee.Ay,{item:!0,xs:12,md:6,children:(0,i.jsx)(c.A,{variant:"outlined",sx:{height:"100%",mb:1,p:0},children:(0,i.jsx)(d.A,{sx:{p:1.5,"&:last-child":{pb:1.5}},children:(0,i.jsxs)(em.A,{spacing:1,children:[(0,i.jsxs)(r.A,{children:[(0,i.jsx)(_.A,{variant:"subtitle2",fontWeight:"bold",children:s.label}),(0,i.jsx)(_.A,{variant:"caption",color:"text.secondary",children:s.helpText})]}),(0,i.jsxs)(em.A,{direction:"row",spacing:.5,flexWrap:"wrap",children:[(0,i.jsx)(ep.A,{label:s.impact,size:"small",color:ez(s.impact),variant:"outlined"}),s.tag&&s.tag.length>0&&(0,i.jsx)(ep.A,{label:"".concat(s.tag.length," tags"),size:"small",variant:"outlined"})]}),(0,i.jsxs)(r.A,{children:[(0,i.jsx)(_.A,{variant:"caption",fontWeight:"bold",gutterBottom:!0,children:"Actions:"}),(0,i.jsx)(em.A,{direction:"row",spacing:.5,flexWrap:"wrap",children:n.action&&Array.isArray(n.action)?n.action.map((e,t)=>{var n,s,l;return(0,i.jsx)(ep.A,{icon:eL(e.value),label:e.value,size:"small",variant:"outlined",color:(null===(n=e.value)||void 0===n?void 0:n.toLowerCase())==="remediate"?"error":(null===(s=e.value)||void 0===s?void 0:s.toLowerCase())==="alert"||(null===(l=e.value)||void 0===l?void 0:l.toLowerCase())==="warn"?"warning":"info"},t)}):(0,i.jsx)(_.A,{variant:"caption",color:"text.secondary",children:"No actions configured"})})]}),s.addedComponent&&s.addedComponent.length>0&&(0,i.jsxs)(r.A,{children:[(0,i.jsx)(_.A,{variant:"caption",fontWeight:"bold",gutterBottom:!0,children:"Fields:"}),(0,i.jsx)(em.A,{spacing:.5,children:s.addedComponent.map((e,t)=>{let s=eh().get(n,e.name),l=(null==s?void 0:s.label)||s||"N/A";return(0,i.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[(0,i.jsxs)(_.A,{variant:"caption",color:"text.secondary",children:[e.label||e.name,":"]}),(0,i.jsx)(ep.A,{label:l,size:"small",variant:"outlined"})]},t)})})]})]})})})},t)})})})]},n)}),0===Object.keys(g).length&&(0,i.jsxs)(r.A,{textAlign:"center",py:4,children:[(0,i.jsx)(_.A,{variant:"h6",color:"text.secondary",children:"No standards configured for this tenant"}),(0,i.jsx)(_.A,{variant:"body2",color:"text.secondary",children:"Standards templates may not be applied to this tenant or no standards are currently active."})]})]})}),(0,i.jsx)(ei.A,{children:(0,i.jsx)(x.A,{onClick:n,children:"Close"})})]})},eV=()=>{var e,t,n,s,p,b,T,A,S,w,C,F,D,I,k,L,z,N,V,R,P,B,E,W,U,H,_,q,K,$,Q,Z,J,X,ee,et,en,ei,es,el,ea,er,eo,ec,ed,ex,eh;let{currentTenant:em}=(0,j.t)(),[eg,ey]=(0,a.useState)(!1),[ep,ej]=(0,a.useState)(!1),ev=(0,O.R_)({url:"/api/ListOrg",queryKey:"".concat(em,"-ListOrg"),data:{tenantFilter:em}}),ef=(0,O.R_)({url:"/api/ListuserCounts",data:{tenantFilter:em},queryKey:"".concat(em,"-ListuserCounts")}),eb=(0,O.R_)({url:"/api/ListGraphRequest",queryKey:"".concat(em,"-ListGraphRequest"),data:{tenantFilter:em,Endpoint:"/directoryRoles(roleTemplateId='62e90394-69f5-4237-9190-012177145e10')/members",$select:"displayName,userPrincipalName,accountEnabled"}}),eT=(0,O.R_)({url:"/api/ListSharepointQuota",queryKey:"".concat(em,"-ListSharepointQuota"),data:{tenantFilter:em}}),eA=(0,O.R_)({url:"/api/ListStandardTemplates",queryKey:"".concat(em,"-ListStandardTemplates")}),eS=(0,O.R_)({url:"/api/ListGraphRequest",queryKey:"".concat(em,"-ListPartners"),data:{Endpoint:"policies/crossTenantAccessPolicy/partners",tenantFilter:em,ReverseTenantLookup:!0}}),ew=(0,O.R_)({url:"/api/ListTenants",queryKey:"ListTenants"}),eC=[{name:"Tenant Name",data:null===(e=ev.data)||void 0===e?void 0:e.displayName},{name:"Tenant ID",data:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Y.R,{text:null===(t=ev.data)||void 0===t?void 0:t.id,type:"chip"})})},{name:"Default Domain",data:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Y.R,{text:null===(p=ev.data)||void 0===p?void 0:null===(s=p.verifiedDomains)||void 0===s?void 0:null===(n=s.find(e=>!0===e.isDefault))||void 0===n?void 0:n.name,type:"chip"})})},{name:"AD Sync Enabled",data:(0,v.i)(null===(b=ev.data)||void 0===b?void 0:b.onPremisesSyncEnabled,"dirsync")}],{remediateCount:eF,alertCount:eD,reportCount:eI,total:ek}=function(e,t){if(!e)return{remediateCount:0,alertCount:0,reportCount:0,total:0};let n=e.filter(e=>{let n=Array.isArray(null==e?void 0:e.tenantFilter)?e.tenantFilter:[],i=Array.isArray(null==e?void 0:e.excludedTenants)?e.excludedTenants:[],s=n.length>0&&n.some(e=>e.value===t),l=n.some(e=>"AllTenants"===e.value)&&(0===i.length||!i.some(e=>e.value===t));return s||l}),i={};for(let e of n)for(let[t,n]of Object.entries(e.standards))i[t]=n;let s=0,l=0,a=0;for(let[,e]of Object.entries(i)){let t=e.action||[];Array.isArray(t)||(t=[t]),t.forEach(e=>{(null==e?void 0:e.value)==="Remediate"?s++:(null==e?void 0:e.value)==="Alert"?l++:(null==e?void 0:e.value)==="Report"&&a++})}let r=Object.keys(i).length;return{remediateCount:s,alertCount:l,reportCount:a,total:r}}(eA.data,em),[eL,ez]=(0,a.useState)([]),eV=e=>e>=1024?"".concat((e/1024).toFixed(2),"GB"):"".concat(e,"MB");return(0,a.useEffect)(()=>{if(ew.isSuccess){var e;let t=null===(e=ew.data)||void 0===e?void 0:e.find(e=>e.defaultDomainName===em);ez(f.map(e=>({label:e.label,target:"_blank",link:e.url.replace(e.variable,null==t?void 0:t[e.variable]),icon:e.icon})))}},[ew.isSuccess,em]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l(),{children:(0,i.jsx)("title",{children:"Dashboard"})}),(0,i.jsx)(r.A,{sx:{flexGrow:1,py:4},children:(0,i.jsx)(o.A,{maxWidth:!1,children:(0,i.jsxs)(h.A,{container:!0,spacing:3,children:[(0,i.jsx)(h.A,{size:{md:12,xs:12},children:(0,i.jsx)(c.A,{children:(0,i.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",gap:2,p:2},children:[(0,i.jsx)(M,{buttonName:"Portals",actions:eL,disabled:!ew.isSuccess}),(0,i.jsx)(eu,{tenantName:null===(T=ev.data)||void 0===T?void 0:T.displayName,tenantId:null===(A=ev.data)||void 0===A?void 0:A.id,userStats:{licensedUsers:(null===(S=ef.data)||void 0===S?void 0:S.LicUsers)||0,unlicensedUsers:(null===(w=ef.data)||void 0===w?void 0:w.Users)&&(null===(C=ef.data)||void 0===C?void 0:C.LicUsers)&&(null===(F=eb.data)||void 0===F?void 0:F.Results)&&(null===(D=ef.data)||void 0===D?void 0:D.Guests)?(null===(I=ef.data)||void 0===I?void 0:I.Users)-(null===(k=ef.data)||void 0===k?void 0:k.LicUsers)-(null===(L=ef.data)||void 0===L?void 0:L.Guests)-(null===(N=eb.data)||void 0===N?void 0:null===(z=N.Results)||void 0===z?void 0:z.length):0,guests:(null===(V=ef.data)||void 0===V?void 0:V.Guests)||0,globalAdmins:(null===(P=eb.data)||void 0===P?void 0:null===(R=P.Results)||void 0===R?void 0:R.length)||0},standardsData:eA.data,organizationData:ev.data,disabled:ev.isFetching||ef.isFetching}),(0,i.jsx)(r.A,{sx:{flex:1},children:(0,i.jsx)(G,{})})]})})}),(0,i.jsx)(h.A,{size:{md:12,xs:12},children:(0,i.jsx)(m.s,{data:eC,isFetching:ev.isFetching})}),(0,i.jsx)(h.A,{size:{md:4,xs:12},children:(0,i.jsx)(g.b,{title:"User Statistics",isFetching:ef.isFetching||eb.isFetching,chartType:"pie",chartSeries:[Number((null===(B=ef.data)||void 0===B?void 0:B.LicUsers)||0),(null===(E=ef.data)||void 0===E?void 0:E.Users)&&(null===(W=ef.data)||void 0===W?void 0:W.LicUsers)&&(null===(U=eb.data)||void 0===U?void 0:U.Results)&&(null===(H=ef.data)||void 0===H?void 0:H.Guests)?Number((null===(_=ef.data)||void 0===_?void 0:_.Users)-(null===(q=ef.data)||void 0===q?void 0:q.LicUsers)-(null===(K=ef.data)||void 0===K?void 0:K.Guests)-(null===(Q=eb.data)||void 0===Q?void 0:null===($=Q.Results)||void 0===$?void 0:$.length)):0,Number((null===(Z=ef.data)||void 0===Z?void 0:Z.Guests)||0),Number((null===(X=eb.data)||void 0===X?void 0:null===(J=X.Results)||void 0===J?void 0:J.length)||0)],labels:["Licensed Users","Unlicensed Users","Guests","Global Admins"]})}),(0,i.jsx)(h.A,{size:{md:4,xs:12},children:(0,i.jsx)(u.A,{title:"Click to view standards",children:(0,i.jsx)(g.b,{title:"Standards Set",isFetching:eA.isFetching,chartType:"bar",chartSeries:[eF,eD,eI],labels:["Remediation","Alert","Report"],onClick:()=>ej(!0)})})}),(0,i.jsx)(h.A,{size:{md:4,xs:12},children:(0,i.jsx)(g.b,{title:"SharePoint Quota",isFetching:eT.isFetching,chartType:"donut",chartSeries:[Number((null===(ee=eT.data)||void 0===ee?void 0:ee.TenantStorageMB)-(null===(et=eT.data)||void 0===et?void 0:et.GeoUsedStorageMB))||0,Number(null===(en=eT.data)||void 0===en?void 0:en.GeoUsedStorageMB)||0],labels:["Free (".concat(eV((null===(ei=eT.data)||void 0===ei?void 0:ei.TenantStorageMB)-(null===(es=eT.data)||void 0===es?void 0:es.GeoUsedStorageMB)),")"),"Used (".concat(eV(null===(el=eT.data)||void 0===el?void 0:el.GeoUsedStorageMB),")")]})}),(0,i.jsx)(h.A,{size:{md:4,xs:12},children:(0,i.jsx)(y.a,{title:"Domain Names",showDivider:!1,copyItems:!0,isFetching:ev.isFetching,propertyItems:null===(er=ev.data)||void 0===er?void 0:null===(ea=er.verifiedDomains)||void 0===ea?void 0:ea.slice(0,eg?void 0:3).map((e,t)=>({label:"",value:e.name})),actionButton:(null===(ec=ev.data)||void 0===ec?void 0:null===(eo=ec.verifiedDomains)||void 0===eo?void 0:eo.length)>3&&(0,i.jsx)(x.A,{onClick:()=>ey(!eg),children:eg?"See less":"See more..."})})}),(0,i.jsx)(h.A,{size:{md:4,xs:12},children:(0,i.jsx)(y.a,{showDivider:!1,copyItems:!0,title:"Partner Relationships",isFetching:eS.isFetching,propertyItems:null===(ed=eS.data)||void 0===ed?void 0:ed.Results.map((e,t)=>{var n,i;return{label:null===(n=e.TenantInfo)||void 0===n?void 0:n.displayName,value:null===(i=e.TenantInfo)||void 0===i?void 0:i.defaultDomainName}})})}),(0,i.jsx)(h.A,{size:{md:4,xs:12},children:(0,i.jsx)(y.a,{copyItems:!0,showDivider:!1,title:"Tenant Capabilities",isFetching:ev.isFetching,propertyItems:[{label:"Services",value:null===(eh=ev.data)||void 0===eh?void 0:null===(ex=eh.assignedPlans)||void 0===ex?void 0:ex.filter(e=>"Enabled"===e.capabilityStatus&&["exchange","AADPremiumService","WindowsDefenderATP"].includes(e.service)).reduce((e,t)=>{let n="exchange"===t.service?"Exchange":"AADPremiumService"===t.service?"AAD Premium":"Windows Defender"===t.service?"Windows Defender":t.service;return e.includes(n)||e.push(n),e},[]).join(", ")}]})})]})})}),(0,i.jsx)(eN,{open:ep,onClose:()=>ej(!1),standardsData:eA.data,currentTenant:em})]})};eV.getLayout=e=>(0,i.jsx)(p.P,{allTenantsSupport:!1,children:e});let eR=eV},42936:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4259)}])},45297:(e,t,n)=>{"use strict";n.d(t,{s:()=>g});var i=n(37876),s=n(14232),l=n(54538),a=n(22474),r=n(94810),o=n(22430),c=n(67578),d=n(77018),u=n(76776),x=n(59568),h=n(57016),m=n(5419);let g=e=>{let{data:t,isFetching:n}=e,[g,y]=(0,s.useState)(null);return(0,i.jsx)(l.A,{children:(0,i.jsx)(x.A,{container:!0,children:t.map((e,t)=>{var s,l,p,j,v;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.A,{size:{md:3,sm:6,xs:12},onClick:e.offcanvas?()=>y(t):void 0,sx:{cursor:e.offcanvas?"pointer":"default",borderBottom:e=>({xs:"1px solid ".concat(e.palette.divider),md:"none"}),borderRight:e=>({md:"1px solid ".concat(e.palette.divider)}),"&:nth-of-type(3)":{borderBottom:e=>({xs:"1px solid ".concat(e.palette.divider),sm:"none"})},"&:nth-of-type(4)":{borderBottom:"none",borderRight:"none"}},children:(0,i.jsxs)(a.A,{alignItems:"center",direction:"row",spacing:2,sx:{p:2},children:[(null==e?void 0:e.icon)&&(0,i.jsx)(r.A,{color:e.color?e.color:"primary",fontSize:"small",children:e.icon}),(null==e?void 0:e.toolTip)?(0,i.jsx)(o.A,{title:e.toolTip,children:(0,i.jsxs)(c.A,{sx:()=>{if(!(null==e?void 0:e.icon))return{pl:2}},children:[(0,i.jsx)(d.A,{color:"text.secondary",variant:"overline",children:e.name}),(0,i.jsx)(d.A,{variant:"h6",children:n?(0,i.jsx)(u.A,{width:"100%"}):e.data})]})}):(0,i.jsxs)(c.A,{sx:()=>{if(!(null==e?void 0:e.icon))return{pl:2}},children:[(0,i.jsx)(d.A,{color:"text.secondary",variant:"overline",children:e.name}),(0,i.jsx)(d.A,{variant:"h6",children:n?(0,i.jsx)(u.A,{width:"100%"}):e.data})]})]})},e.name),e.offcanvas&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(h.w,{title:(null==e?void 0:null===(s=e.offcanvas)||void 0===s?void 0:s.title)||"Details",size:"md",visible:g===t,onClose:()=>y(null),children:(0,i.jsx)(c.A,{sx:{overflowY:"auto",maxHeight:"100%",display:"flex",flexDirection:"column"},children:(0,i.jsx)(x.A,{container:!0,spacing:1,children:(0,i.jsx)(x.A,{size:{xs:12},children:(null==e?void 0:null===(p=e.offcanvas)||void 0===p?void 0:null===(l=p.propertyItems)||void 0===l?void 0:l.length)>0&&(0,i.jsx)(m.a,{isFetching:n,align:"vertical",title:null==e?void 0:null===(j=e.offcanvas)||void 0===j?void 0:j.title,propertyItems:null!==(v=e.offcanvas.propertyItems)&&void 0!==v?v:[]})})})})})})]})})})})}},50477:()=>{},57093:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});var i=n(14232),s=n(22322),l=n(17825),a=n(75069);function r(){let e=(0,l.t)().currentTenant;if("AllTenants"===e)return{controlScore:{isFetching:!1,isSuccess:!1,data:{Results:[]}},secureScore:{isFetching:!1,isSuccess:!1,data:{Results:[]}},translatedData:[],isFetching:!0,isSuccess:!1};let[t,n]=(0,i.useState)([]),[r,o]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),u=(0,s.R_)({url:"/api/ListGraphRequest",data:{Endpoint:"security/secureScoreControlProfiles",tenantFilter:e,$count:!0,$top:999},queryKey:"controlScore-".concat(e)}),x=(0,s.R_)({url:"/api/ListGraphRequest",data:{Endpoint:"security/secureScores",tenantFilter:e,$count:!0,noPagination:!0,$top:7},queryKey:"secureScore-".concat(e)});return(0,i.useEffect)(()=>{u.isFetching||x.isFetching?d(!0):d(!1)},[u.isFetching,x.isFetching]),(0,i.useEffect)(()=>{if(u.isSuccess&&x.isSuccess){var e,t,i,s;let l=x.data.Results[0],r=l.controlScores.map(e=>{var t;let n=null===(t=u.data.Results)||void 0===t?void 0:t.find(t=>t.id===e.controlName),i=a.find(t=>{var n;return null===(n=t.tag)||void 0===n?void 0:n.includes(e.controlName)});return{...e,title:null==n?void 0:n.title,threats:null==n?void 0:n.threats,complianceInformation:null==n?void 0:n.complianceInformation,actionUrl:i?"/tenant/standards/list-standards":null==n?void 0:n.actionUrl,remediation:i?"1. Enable the CIPP Standard: ".concat(i.label):null==n?void 0:n.remediation,remediationImpact:null==n?void 0:n.remediationImpact,implementationCost:null==n?void 0:n.implementationCost,tier:null==n?void 0:n.tier,userImpact:null==n?void 0:n.userImpact,vendorInformation:null==n?void 0:n.vendorInformation,controlStateUpdates:(null==n?void 0:n.controlStateUpdates)?n.controlStateUpdates.filter(e=>"Default"!==e.state):[]}});r.sort((e,t)=>t.scoreInPercentage-e.scoreInPercentage),n({...l,percentageCurrent:Math.round(l.currentScore/l.maxScore*100),percentageVsAllTenants:Math.round(null===(t=l.averageComparativeScores)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.averageScore),percentageVsSimilar:Math.round(null===(s=l.averageComparativeScores)||void 0===s?void 0:null===(i=s[1])||void 0===i?void 0:i.averageScore),controlScores:r}),o(!0)}},[u.isSuccess,x.isSuccess,u.data,x.data]),{controlScore:u,secureScore:x,translatedData:t,isFetching:c,isSuccess:r}}},85496:(e,t,n)=>{"use strict";n.d(t,{b:()=>b});var i=n(37876),s=n(14232),l=n(54538),a=n(1073),r=n(71538),o=n(24933),c=n(76776),d=n(22474),u=n(77018),x=n(67578),h=n(30566),m=n(95449),g=n(18847),y=n.n(g),p=n(54773);let j=y()(()=>Promise.all([n.e(7144),n.e(1352)]).then(n.bind(n,21352)),{loadableGenerated:{webpack:()=>[21352]},ssr:!1,loading:()=>null}),v=(0,p.Ay)(j)({}),f=(e,t)=>{let n=(0,h.A)();return{chart:{background:"transparent",toolbar:{show:!1,tools:{download:!0,selection:!1,zoom:!1,zoomin:!1,zoomout:!1,pan:!1,reset:1}}},colors:[n.palette.success.main,n.palette.warning.main,n.palette.error.main,n.palette.neutral[200]],dataLabels:{enabled:!1},xaxis:{labels:{show:!0,rotate:0,style:{fontSize:"12px"}},tickPlacement:"on"},labels:e,legend:{show:!1},plotOptions:{pie:{expandOnClick:!1}},states:{active:{filter:{type:"none"}},hover:{filter:{type:"none"}}},stroke:{width:"line"===t?2:1},theme:{mode:n.palette.mode},tooltip:{fillSeriesColor:!1}}},b=e=>{let{isFetching:t,chartSeries:n=[],labels:h=[],chartType:g="donut",title:y,actions:p,onClick:j}=e,[b,T]=(0,s.useState)("Last 7 days"),[A,S]=(0,s.useState)([]),w=f(h,g),C=(n=n.filter(e=>null!==e)).reduce((e,t)=>e+t,0);return(0,s.useEffect)(()=>{"bar"===g&&S(h.map((e,t)=>({data:[{x:e,y:n[t]}]})))},[g,n.length,h]),(0,i.jsxs)(l.A,{style:{width:"100%",height:"100%"},onClick:j,sx:{cursor:j?"pointer":"default",transition:"all 0.2s ease-in-out","&:hover":j?{boxShadow:e=>e.shadows[8],transform:"translateY(-2px)"}:{}},children:[(0,i.jsx)(a.A,{action:p?(0,i.jsx)(m.$,{color:"inherit",actions:p,label:b,size:"small",variant:"text"}):null,title:y}),(0,i.jsx)(r.A,{}),(0,i.jsxs)(o.A,{children:[void 0===g||t||0===n.length?(0,i.jsx)(c.A,{variant:"rounded",sx:{height:280}}):(0,i.jsx)(v,{height:280,options:w,series:A&&"bar"===g?A:n,type:g}),(0,i.jsx)(d.A,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:1,sx:{py:1},children:h.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.A,{variant:"h5",children:"Total"}),(0,i.jsx)(u.A,{variant:"h5",children:t?"0":C})]})}),(0,i.jsx)(d.A,{spacing:1,children:t?(0,i.jsx)(c.A,{height:30}):(0,i.jsx)(i.Fragment,{children:h.length>0&&n.map((e,t)=>(0,i.jsxs)(d.A,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:1,sx:{py:1},children:[(0,i.jsxs)(d.A,{alignItems:"center",direction:"row",spacing:1,sx:{flexGrow:1},children:[(0,i.jsx)(x.A,{sx:{backgroundColor:w.colors[t],borderRadius:"50%",height:8,width:8}}),(0,i.jsx)(u.A,{color:"text.secondary",variant:"body2",children:h[t]})]}),(0,i.jsx)(u.A,{color:"text.secondary",variant:"body2",children:e})]},h[t]))})})]})]})}},95449:(e,t,n)=>{"use strict";n.d(t,{$:()=>y});var i=n(37876),s=n(54550),l=n(95062),a=n.n(l),r=n(47737),o=n(94810),c=n(52808),d=n(6003),u=n(93256),x=n(50221),h=n(14232),m=n(82836),g=n(79803);let y=e=>{var t;let{actions:n=[],label:l="Actions",data:a,queryKeys:y,...p}=e,j=(0,x.f)(),[v,f]=(0,h.useState)({data:{},action:{},ready:!1}),b=(0,m.s)(),T=(e,t)=>!e||null!=t&&!!t.condition&&!(null==t?void 0:t.condition(e));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.A,{onClick:j.handleOpen,ref:j.anchorRef,startIcon:(0,i.jsx)(o.A,{fontSize:"small",children:(0,i.jsx)(s.A,{})}),variant:"outlined",sx:{flexShrink:0,whiteSpace:"nowrap"},children:"Actions"}),(0,i.jsx)(c.A,{anchorEl:j.anchorRef.current,anchorOrigin:{horizontal:"right",vertical:"bottom"},MenuListProps:{dense:!0,sx:{p:1}},onClose:j.handleClose,open:j.open,transformOrigin:{horizontal:"right",vertical:"top"},children:null==n?void 0:n.filter(e=>!e.link||e.showInActionsMenu).map((e,t)=>(0,i.jsxs)(d.A,{disabled:T(a,e),onClick:()=>{f({data:a,action:e,ready:!0}),(null==e?void 0:e.noConfirm)&&e.customFunction?e.customFunction(a,e,{}):(b.handleOpen(),j.handleClose())},children:[(0,i.jsx)(o.A,{fontSize:"small",sx:{minWidth:"30px"},children:e.icon}),(0,i.jsx)(u.A,{children:e.label})]},t))}),v.ready&&(0,i.jsx)(g.B,{createDialog:b,title:"Confirmation",fields:null===(t=v.action)||void 0===t?void 0:t.fields,api:v.action,row:v.data,relatedQueryKeys:y})]})};y.propTypes={actions:a().array,label:a().string}}},e=>{var t=t=>e(e.s=t);e.O(0,[888,2591,6341,8005,4155,860,5069,636,6593,8792],()=>t(42936)),_N_E=e.O()}]);