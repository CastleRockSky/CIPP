"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[514],{22816:(e,l,t)=>{t.d(l,{A:()=>u});var i=t(37876),a=t(14232),n=t(77018),o=t(71538),s=t(59568),r=t(58105),c=t(41412),d=t(5918);let u=e=>{let{templateData:l,formControl:t,templateType:u="conditionalAccess"}=e,m=["id","isAssigned","createdDateTime","modifiedDateTime","@odata.*","GUID","Type","times","tenantFilter","*Id","*DateTime"],p={conditionalAccess:{blacklistedFields:[...m,"membershipKind","countryLookupMethod","applicationFilter","includeAuthenticationContextClassReferences"],priorityFields:["displayName","state","DisplayName","Name","displayname"],complexArrayFields:["locationinfo","groupinfo"],schemaFields:{operator:{multiple:!1,options:[{label:"OR",value:"OR"},{label:"AND",value:"AND"}]},builtincontrols:{multiple:!0,options:[{label:"Block",value:"block"},{label:"Multi-factor Authentication",value:"mfa"},{label:"Compliant Device",value:"compliantDevice"},{label:"Domain Joined Device",value:"domainJoinedDevice"},{label:"Approved Application",value:"approvedApplication"},{label:"Compliant Application",value:"compliantApplication"},{label:"Password Change",value:"passwordChange"},{label:"Unknown Future Value",value:"unknownFutureValue"}]},authenticationtype:{multiple:!1,options:[{label:"Primary and Secondary Authentication",value:"primaryAndSecondaryAuthentication"},{label:"Secondary Authentication",value:"secondaryAuthentication"},{label:"Unknown Future Value",value:"unknownFutureValue"}]},frequencyinterval:{multiple:!1,options:[{label:"Time Based",value:"timeBased"},{label:"Every Time",value:"everyTime"},{label:"Unknown Future Value",value:"unknownFutureValue"}]},state:{multiple:!1,options:[{label:"Enabled",value:"enabled"},{label:"Disabled",value:"disabled"},{label:"Enabled for Reporting",value:"enabledForReportingButNotEnforced"}]}}},intune:{blacklistedFields:[...m,"deviceManagementApplicabilityRuleOsEdition","deviceManagementApplicabilityRuleOsVersion","deviceManagementApplicabilityRuleDeviceMode","roleScopeTagIds","supportsScopeTags","deviceSettingStateSummaries","RAWJson"],priorityFields:["displayName","description","DisplayName","Name","displayname"],complexArrayFields:["assignments","devicestatusoverview"],schemaFields:{devicecompliancepolicystate:{multiple:!1,options:[{label:"Unknown",value:"unknown"},{label:"Compliant",value:"compliant"},{label:"Noncompliant",value:"noncompliant"},{label:"Conflict",value:"conflict"},{label:"Error",value:"error"},{label:"In Grace Period",value:"inGracePeriod"},{label:"Config Manager",value:"configManager"}]},applicationguardenabledoptions:{multiple:!1,options:[{label:"Not Configured",value:"notConfigured"},{label:"Enabled for Edge",value:"enabledForEdge"},{label:"Enabled for Office",value:"enabledForOffice"},{label:"Enabled for Edge and Office",value:"enabledForEdgeAndOffice"}]},firewallcertificaterevocationlistcheckmethod:{multiple:!1,options:[{label:"Device Default",value:"deviceDefault"},{label:"None",value:"none"},{label:"Attempt",value:"attempt"},{label:"Require",value:"require"}]},firewallpacketqueueingmethod:{multiple:!1,options:[{label:"Device Default",value:"deviceDefault"},{label:"Disabled",value:"disabled"},{label:"Queue Inbound",value:"queueInbound"},{label:"Queue Outbound",value:"queueOutbound"},{label:"Queue Both",value:"queueBoth"}]},startupmode:{multiple:!1,options:[{label:"Manual",value:"manual"},{label:"Automatic",value:"automatic"},{label:"Disabled",value:"disabled"}]},applicationguardblockclipboardsharing:{multiple:!1,options:[{label:"Not Configured",value:"notConfigured"},{label:"Block Both",value:"blockBoth"},{label:"Block Host to Container",value:"blockHostToContainer"},{label:"Block Container to Host",value:"blockContainerToHost"},{label:"Block None",value:"blockNone"}]},bitlockerrecoverypasswordrotation:{multiple:!1,options:[{label:"Not Configured",value:"notConfigured"},{label:"Disabled",value:"disabled"},{label:"Enabled for Azure AD Joined",value:"enabledForAzureAd"},{label:"Enabled for Azure AD and Hybrid Joined",value:"enabledForAzureAdAndHybrid"}]},bitlockerprebootrecoverymsgurloption:{multiple:!1,options:[{label:"Default",value:"default"},{label:"Use Custom",value:"useCustom"},{label:"No URL",value:"noUrl"}]}}},exchange:{blacklistedFields:[...m,"ExchangeVersion","DistinguishedName","ObjectCategory","WhenChanged","WhenCreated"],priorityFields:["Name","Identity"],complexArrayFields:["accepteddomains","remotedomain"],schemaFields:{}}},{blacklistedFields:b,priorityFields:x,complexArrayFields:A,schemaFields:v}=p[u]||p.conditionalAccess,f=e=>b.some(l=>{if(l.includes("*")){let t=l.replace(/\*/g,".*").replace(/\./g,"\\.");return RegExp("^".concat(t,"$"),"i").test(e)}return l===e}),h=e=>{if("intune"===u&&e.RAWJson)try{let l=JSON.parse(e.RAWJson);return{...e,parsedRAWJson:l}}catch(e){console.warn("Failed to parse RAWJson:",e)}return e};a.useEffect(()=>{if(l&&t){let e=h(l),i={};Object.keys(e).forEach(l=>{f(l)||(i[l]=e[l])}),t.reset(i)}},[l]);let g=function(e,l){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",m=a?"".concat(a,".").concat(e):e;if(f(e))return null;let p=v[e.toLowerCase()];if(p)return(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"autoComplete",label:(0,c.i)(e),name:m,formControl:t,multiple:p.multiple||!1,options:p.options})},m);if("intune"===u&&"parsedRAWJson"===e&&l)return l.added?(0,i.jsx)(s.A,{size:{xs:12},children:(0,i.jsx)(n.A,{variant:"body1",sx:{fontStyle:"italic"},children:"This is a legacy policy and the settings cannot be edited through the form interface."})},m):l.settings&&Array.isArray(l.settings)?(0,i.jsxs)(s.A,{size:{xs:12},children:[(0,i.jsx)(n.A,{variant:"h6",sx:{mt:2,mb:1},children:"Policy Settings"}),(0,i.jsx)(o.A,{sx:{mb:2}}),(0,i.jsx)(s.A,{container:!0,spacing:2,children:l.settings.map((e,l)=>{let a=e.settingInstance;if(!a)return null;if(a.choiceSettingValue){var o;let e=d.find(e=>e.id===a.settingDefinitionId),n=(null==e?void 0:e.displayName)||"Setting ".concat(l+1),c=(null==e?void 0:null===(o=e.options)||void 0===o?void 0:o.map(e=>({label:e.displayName||e.id,value:e.id})))||[];return(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"autoComplete",label:n,name:"".concat(m,".settings.").concat(l,".settingInstance.choiceSettingValue.value"),formControl:t,options:c,multiple:!1,helperText:"Definition ID: ".concat(a.settingDefinitionId)})},"setting-".concat(l))}if(a.simpleSettingValue){let e=d.find(e=>e.id===a.settingDefinitionId),n=(null==e?void 0:e.displayName)||"Setting ".concat(l+1);return(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"textField",label:n,name:"".concat(m,".settings.").concat(l,".settingInstance.simpleSettingValue.value"),formControl:t,helperText:"Definition ID: ".concat(a.settingDefinitionId)})},"setting-".concat(l))}if(a.groupSettingCollectionValue){let e=d.find(e=>e.id===a.settingDefinitionId),t=(null==e?void 0:e.displayName)||"Group Setting Collection ".concat(l+1);return(0,i.jsxs)(s.A,{size:{xs:12},children:[(0,i.jsx)(n.A,{variant:"subtitle2",sx:{mt:1,mb:1},children:t}),(0,i.jsxs)(n.A,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1},children:["Definition ID: ",a.settingDefinitionId]}),(0,i.jsx)(n.A,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:"Complex group setting collection - view in JSON mode for details"})]},"setting-".concat(l))}return null})})]},m):l.omaSettings&&Array.isArray(l.omaSettings)?(0,i.jsxs)(s.A,{size:{xs:12},children:[(0,i.jsx)(n.A,{variant:"h6",sx:{mt:2,mb:1},children:"OMA Settings"}),(0,i.jsx)(o.A,{sx:{mb:2}}),(0,i.jsx)(s.A,{container:!0,spacing:2,children:l.omaSettings.map((e,l)=>(0,i.jsxs)(s.A,{size:{xs:12},children:[(0,i.jsx)(n.A,{variant:"subtitle2",sx:{mt:1,mb:1},children:e.displayName||"OMA Setting ".concat(l+1)}),(0,i.jsxs)(s.A,{container:!0,spacing:2,children:[(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"textField",label:"OMA URI",name:"".concat(m,".omaSettings.").concat(l,".omaUri"),formControl:t,disabled:!0})}),(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"textField",label:"Value",name:"".concat(m,".omaSettings.").concat(l,".value"),formControl:t})})]})]},"oma-".concat(l)))})]},m):l.settings||l.omaSettings||l.added?(0,i.jsxs)(s.A,{size:{xs:12},children:[(0,i.jsx)(n.A,{variant:"h6",sx:{mt:2,mb:1},children:"Policy Configuration"}),(0,i.jsx)(o.A,{sx:{mb:2}}),(0,i.jsx)(n.A,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:"This policy structure is not supported for editing."})]},m):(0,i.jsxs)(s.A,{size:{xs:12},children:[(0,i.jsx)(n.A,{variant:"h6",sx:{mt:2,mb:1},children:"Device Policy Configuration"}),(0,i.jsx)(o.A,{sx:{mb:2}}),(0,i.jsx)(s.A,{container:!0,spacing:2,children:Object.entries(l).filter(e=>{let[l]=e;return!f(l)}).map(e=>{let[l,t]=e;return g(l,t,m)})})]},m);if(A.some(l=>e.toLowerCase().includes(l.toLowerCase())))return!l||Array.isArray(l)&&0===l.length||Array.isArray(l)&&l.every(e=>null==e||"string"==typeof e&&""===e.trim()||"object"==typeof e&&null!==e&&0===Object.keys(e).length)?null:(0,i.jsxs)(s.A,{size:{xs:12},children:[(0,i.jsx)(n.A,{variant:"h6",sx:{mt:2,mb:1},children:(0,c.i)(e)}),(0,i.jsx)(o.A,{sx:{mb:2}}),(0,i.jsx)(s.A,{container:!0,spacing:2,children:Array.isArray(l)?l.filter(e=>null!=e&&("string"!=typeof e||""!==e.trim())&&("object"!=typeof e||null===e||0!==Object.keys(e).length)).map((l,a)=>(0,i.jsxs)(s.A,{size:{xs:12},children:[(0,i.jsxs)(n.A,{variant:"subtitle1",sx:{mt:1,mb:1},children:[(0,c.i)(e)," ",a+1]}),(0,i.jsx)(s.A,{container:!0,spacing:2,children:"object"==typeof l&&null!==l?Object.entries(l).map(e=>{let[l,t]=e;return g(l,t,"".concat(m,".").concat(a))}):(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"textField",label:"".concat((0,c.i)(e)," ").concat(a+1),name:"".concat(m,".").concat(a),formControl:t})})})]},"".concat(m,".").concat(a))):(0,i.jsx)(s.A,{size:{xs:12},children:(0,i.jsxs)(n.A,{variant:"body2",color:"text.secondary",children:["No ",(0,c.i)(e)," data available"]})})})]},m);if("boolean"==typeof l)return(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"autoComplete",label:(0,c.i)(e),name:m,formControl:t,options:[{label:"True",value:!0},{label:"False",value:!1}],multiple:!1})},m);if("string"==typeof l){let a=["displayname","displayName","name","description","identity","title"].some(l=>e.toLowerCase()===l.toLowerCase()),n=["notConfigured","deviceDefault","manual","automatic","disabled","enabled","blocked","allowed","required","none","lockWorkstation"].some(e=>l.toLowerCase().includes(e.toLowerCase()));if(!a&&n){let a=[{label:"Not Configured",value:"notConfigured"},{label:"Device Default",value:"deviceDefault"},{label:"Manual",value:"manual"},{label:"Automatic",value:"automatic"},{label:"Disabled",value:"disabled"},{label:"Enabled",value:"enabled"},{label:"Blocked",value:"blocked"},{label:"Allowed",value:"allowed"},{label:"Required",value:"required"},{label:"None",value:"none"}].filter(t=>t.value===l||e.toLowerCase().includes(t.value.toLowerCase())||"notConfigured"===t.value);return(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"autoComplete",label:(0,c.i)(e),name:m,formControl:t,options:a,multiple:!1,creatable:!0})},m)}return(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"textField",label:(0,c.i)(e),name:m,formControl:t})},m)}return Array.isArray(l)&&l.every(e=>"string"==typeof e)?(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"autoComplete",label:(0,c.i)(e),name:m,formControl:t,multiple:!0,creatable:!0,options:l.map(e=>({label:e,value:e}))})},m):"object"!=typeof l||null===l||Array.isArray(l)?(0,i.jsx)(s.A,{size:{xs:12,md:6},children:(0,i.jsx)(r.A,{type:"textField",label:(0,c.i)(e),name:m,formControl:t})},m):(0,i.jsxs)(s.A,{size:{xs:12},children:[(0,i.jsx)(n.A,{variant:"h6",sx:{mt:2,mb:1},children:(0,c.i)(e)}),(0,i.jsx)(o.A,{sx:{mb:2}}),(0,i.jsx)(s.A,{container:!0,spacing:2,children:Object.entries(l).map(e=>{let[l,t]=e;return g(l,t,m)})})]},m)};if(!l)return null;let y=h(l);return(0,i.jsxs)(s.A,{container:!0,spacing:2,children:[x.map(e=>void 0!==y[e]&&g(e,y[e])),Object.entries(y).filter(e=>{let[l]=e;return!x.includes(l)}).map(e=>{let[l,t]=e;return g(l,t)})]})}},42120:(e,l,t)=>{t.d(l,{A:()=>n});var i=t(93944),a=t(37876);let n=(0,i.A)((0,a.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft")},86508:(e,l,t)=>{t.d(l,{A:()=>s});var i=t(37876),a=t(67578),n=t(76776),o=t(59568);let s=e=>{let{layout:l}=e;return(0,i.jsx)(a.A,{sx:{width:"100%",my:2},children:l.map((e,l)=>(0,i.jsx)(o.A,{container:!0,spacing:2,sx:{mb:2},children:Array.from({length:e}).map((t,a)=>(0,i.jsx)(o.A,{size:{xs:12/e},children:(0,i.jsx)(n.A,{variant:"rectangular",width:"100%"})},"skeleton-".concat(l,"-").concat(a)))},"row-".concat(l)))})}},90240:(e,l,t)=>{t.d(l,{A:()=>g});var i=t(37876),a=t(89099),n=t(67578),o=t(86650),s=t(22474),r=t(47737),c=t(94810),d=t(77018),u=t(54538),m=t(24933),p=t(17675),b=t(42120),x=t(22322),A=t(68723),v=t(14232),f=t(88992),h=t(2303);let g=e=>{let{title:l,backButtonTitle:t,titleButton:g,formPageType:y="Add",children:j,queryKey:C,formControl:D,postUrl:k,customDataformatter:w,resetForm:F=!1,hideBackButton:S=!1,hidePageType:N=!1,hideTitle:z=!1,hideSubmit:E=!1,allowResubmit:O=!1,addedButtons:I,...R}=e,V=(0,a.useRouter)(),T=(0,x.nN)({datafromUrl:!0,relatedQueryKeys:C}),{isValid:q,isDirty:B}=(0,f.lN)({control:D.control});return(0,v.useEffect)(()=>{if(delete V.query.tenantFilter,V.query){let e={...D.getValues(),...V.query};D.reset(e)}},[V]),(0,v.useEffect)(()=>{T.isSuccess&&F&&D.reset()},[T.isSuccess]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.v,{title:l}),(0,i.jsx)(n.A,{sx:{flexGrow:1,py:4},children:(0,i.jsx)(o.A,{maxWidth:"lg",children:(0,i.jsxs)(s.A,{spacing:4,children:[!z&&(0,i.jsxs)(s.A,{spacing:2,children:[!S&&(0,i.jsx)("div",{children:(0,i.jsx)(r.A,{color:"inherit",onClick:()=>{V.back()},startIcon:(0,i.jsx)(c.A,{fontSize:"small",children:(0,i.jsx)(b.A,{})}),children:t})}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)(d.A,{variant:"h4",children:[!N&&(0,i.jsxs)(i.Fragment,{children:[y," - "]}),l]}),g&&g]})]}),(0,i.jsxs)(u.A,{children:[(0,i.jsxs)(m.A,{children:[j,(0,i.jsx)(A.v,{apiObject:T})]}),!E&&(0,i.jsx)(p.A,{sx:{justifyContent:"flex-end"},children:(0,i.jsxs)(s.A,{spacing:2,direction:"row",children:[I&&I,(0,i.jsx)(r.A,{disabled:T.isPending||!q||!O&&!B,onClick:D.handleSubmit(()=>{if(D.trigger(),!q)return;let e=w?w(D.getValues()):D.getValues();Object.keys(e).forEach(l=>{(""===e[l]||null===e[l])&&delete e[l]}),T.mutate({url:k,data:e})}),type:"submit",variant:"contained",children:"Submit"})]})})]})]})})})]})}}}]);