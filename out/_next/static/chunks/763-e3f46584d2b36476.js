"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[763],{763:(e,i,l)=>{l.d(i,{a:()=>O});var t=l(37876),n=l(14232),a=l(22474),s=l(77018),o=l(22430),r=l(70946),d=l(59017),c=l(71538),x=l(68284),u=l(47737),h=l(37224),m=l(35656),v=l(57212),j=l(59568),p=l(16652),f=l(46749),g=l(63817),A=l(14628),R=l(83198),S=l(14304),y=l(3871),F=l(56826),b=l(88992),D=l(22322),C=l(84064),I=l(24921),P=l(57016),N=l(5419),V=l(35936);let w=/[^\0-\x7F]/,M=/[\x2E\u3002\uFF0E\uFF61]/g,T={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=Math.floor,E=String.fromCharCode;function H(e){throw RangeError(T[e])}let z=function(e,i){return e+22+75*(e<26)-((0!=i)<<5)},W=function(e,i,l){let t=0;for(e=l?k(e/700):e>>1,e+=k(e/i);e>455;t+=36)e=k(e/35);return k(t+36*e/(e+38))},_=function(e){let i=[],l=(e=function(e){let i=[],l=0,t=e.length;for(;l<t;){let n=e.charCodeAt(l++);if(n>=55296&&n<=56319&&l<t){let t=e.charCodeAt(l++);(64512&t)==56320?i.push(((1023&n)<<10)+(1023&t)+65536):(i.push(n),l--)}else i.push(n)}return i}(e)).length,t=128,n=0,a=72;for(let l of e)l<128&&i.push(E(l));let s=i.length,o=s;for(s&&i.push("-");o<l;){let l=0x7fffffff;for(let i of e)i>=t&&i<l&&(l=i);let r=o+1;for(let d of(l-t>k((0x7fffffff-n)/r)&&H("overflow"),n+=(l-t)*r,t=l,e))if(d<t&&++n>0x7fffffff&&H("overflow"),d===t){let e=n;for(let l=36;;l+=36){let t=l<=a?1:l>=a+26?26:l-a;if(e<t)break;let n=e-t,s=36-t;i.push(E(z(t+n%s,0))),e=k(n/s)}i.push(E(z(e,0))),a=W(n,r,o===s),n=0,++o}++n,++t}return i.join("")},K={toASCII:function(e){return function(e,i){let l=e.split("@"),t="";return l.length>1&&(t=l[0]+"@",e=l[1]),t+(function(e,i){let l=[],t=e.length;for(;t--;)l[t]=i(e[t]);return l})((e=e.replace(M,".")).split("."),i).join(".")}(e,function(e){return w.test(e)?"xn--"+_(e):e})}},L=e=>{let{passes:i=[],warns:l=[],fails:n=[]}=e;return(0,t.jsxs)(a.A,{direction:"column",sx:{mt:1},children:[i.map((e,i)=>(0,t.jsxs)(s.A,{variant:"body2",sx:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[(0,t.jsx)(A.A,{style:{color:"green",marginRight:"4px"}}),e]},i)),l.map((e,i)=>(0,t.jsxs)(s.A,{variant:"body2",sx:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[(0,t.jsx)(S.A,{style:{color:"orange",marginRight:"4px"}}),e]},i)),n.map((e,i)=>(0,t.jsxs)(s.A,{variant:"body2",sx:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[(0,t.jsx)(R.A,{style:{color:"red",marginRight:"4px"}}),e]},i))]})},B=e=>{var i,l;let{domain:a,mxData:c,isFetching:x}=e,[u,h]=(0,n.useState)(!1),m=(null==c?void 0:null===(i=c.MailProvider)||void 0===i?void 0:i.Name)||"Unknown",v=(null==c?void 0:c.ValidationPasses)||[],j=(null==c?void 0:c.ValidationWarns)||[],p=(null==c?void 0:c.ValidationFails)||[],f=0===p.length&&0===j.length,g=(null==c?void 0:null===(l=c.MailProvider)||void 0===l?void 0:l._MxComment)||"";return(0,t.jsx)(C.A,{title:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[f&&(0,t.jsx)(A.A,{style:{color:"green",marginRight:"8px"}}),"MX Records"]}),cardSx:{display:"flex",flexDirection:"column",height:"100%"},cardActions:(0,t.jsxs)(t.Fragment,{children:[g&&(0,t.jsx)(o.A,{title:"Help",children:(0,t.jsx)(r.A,{href:g,target:"_blank",children:(0,t.jsx)(y.A,{})})}),(0,t.jsx)(o.A,{title:"Details",children:(0,t.jsx)(r.A,{onClick:()=>{h(!0)},children:(0,t.jsx)(F.A,{})})}),(0,t.jsx)(P.w,{visible:u,children:(0,t.jsx)(I.x,{code:JSON.stringify(null==c?void 0:c.Records)}),onClose:()=>h(!1)})]}),isFetching:x,children:!x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.A,{variant:"h6",gutterBottom:!0,children:"Mail Provider:"}),(0,t.jsx)(d.A,{color:"info",className:"mb-2",label:"".concat(m)}),(0,t.jsx)(L,{passes:v,warns:j,fails:p})]})})};function q(e){var i,l,a,d,x,u;let{title:h,data:m,isFetching:v,info:p,type:f}=e,[g,b]=(0,n.useState)(!1),D="whois"===f?{extendedInfoFields:["Domain Name","Creation Date","Updated Date","Registrar Registration Expiration Date","Registrar","Registrar URL","Registrar Abuse Contact Email","Domain Status","Name Server","DNSSEC"],extendedData:m}:"MTA-STS"===f?{children:(0,t.jsx)(j.A,{container:!0,spacing:2,children:(0,t.jsx)(j.A,{size:{xs:12},children:p})})}:"DNSSEC"===f?{children:(0,t.jsx)(I.x,{language:"JSON",code:JSON.stringify(m)})}:"DKIM"===f?{children:null==m?void 0:null===(i=m.Records)||void 0===i?void 0:i.map((e,i)=>(0,t.jsxs)("div",{children:[(0,t.jsxs)(s.A,{variant:"h6",gutterBottom:!0,children:["Selector: ",null==e?void 0:e.Selector]}),(0,t.jsx)(I.x,{code:null==e?void 0:e.Record}),(0,t.jsx)(L,{passes:null==e?void 0:e.ValidationPasses,warns:null==e?void 0:e.ValidationWarns,fails:null==e?void 0:e.ValidationFails})]},i))}:"DMARC"===f?{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.A,{variant:"h6",gutterBottom:!0,children:"Record:"}),(0,t.jsx)(I.x,{code:null==m?void 0:m.Record}),(0,t.jsx)(N.a,{title:"Settings",copyItems:!0,propertyItems:[{label:"Version",value:null==m?void 0:m.Version},{label:"Policy",value:(0,V.i)(null==m?void 0:m.Policy,"DMARCPolicy","text")},{label:"Subdomain Policy",value:(0,V.i)(null==m?void 0:m.SubdomainPolicy,"DMARCPolicy","text")},{label:"Percentage",value:null==m?void 0:m.Percentage},{label:"SPF Alignment",value:(0,V.i)(null==m?void 0:m.SpfAlignment,"DMARCPolicy","text")},{label:"Report Interval",value:(0,V.i)(null==m?void 0:m.ReportInterval,"ReportInterval","text")},{label:"Report Format",value:(0,V.i)(null==m?void 0:m.ReportFormat,"DMARCPolicy","text")}]}),(0,t.jsx)(N.a,{title:"Reporting Emails",copyItems:!0,propertyItems:null==m?void 0:m.ReportingEmails.map(e=>({label:"Reporting Email(s)",value:e}))}),(0,t.jsx)(N.a,{title:"Forensic Emails",copyItems:!0,propertyItems:null==m?void 0:m.ForensicEmails.map(e=>({label:"Forensic Email(s)",value:e}))})]})}:"SPF"===f?{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.A,{variant:"h6",gutterBottom:!0,children:"Record:"}),(0,t.jsx)(I.x,{code:null==m?void 0:m.Record}),(null==m?void 0:m.Recommendations)&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(N.a,{title:"Recommendations",copyItems:!0,propertyItems:null==m?void 0:m.Recommendations.map(e=>({label:"Recommendation",value:e.Message}))})}),(0,t.jsx)(s.A,{variant:"h6",gutterBottom:!0,children:"IP Addresses"}),(0,t.jsx)(I.x,{code:null==m?void 0:m.RecordList.map(e=>e.IPAddresses).join("\n")})]})}:"HTTPS"===f?{children:(0,t.jsx)(t.Fragment,{children:null==m?void 0:null===(l=m.Tests)||void 0===l?void 0:l.map((e,i)=>{var l,n;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.a,{title:"Certificate info for ".concat(e.Hostname),copyItems:!0,showDivider:!1,propertyItems:[{label:"Issuer",value:(null===(l=e.Certificate.Issuer.match(/O=([^,]+)/))||void 0===l?void 0:l[1])||e.Certificate.Issuer},{label:"Subject",value:(null===(n=e.Certificate.Subject.match(/CN=([^,]+)/))||void 0===n?void 0:n[1])||e.Certificate.Subject},{label:"Created",value:(0,V.i)(e.Certificate.NotBefore,"NotBefore")},{label:"Expires",value:(0,V.i)(e.Certificate.NotAfter,"NotAfter")},{label:"Serial Number",value:e.Certificate.SerialNumber},{label:"Thumbprint",value:e.Certificate.Thumbprint},{label:"DNS Names",value:(0,V.i)(e.Certificate.DnsNameList.map(e=>e.Unicode),"DNSName")}]},i),(0,t.jsx)(L,{passes:e.ValidationPasses,warns:e.ValidationWarns,fails:e.ValidationFails}),(0,t.jsx)(c.A,{})]})})})}:{};return(0,t.jsxs)(C.A,{title:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(null==m?void 0:null===(a=m.ValidationFails)||void 0===a?void 0:a.length)===0&&(null==m?void 0:null===(d=m.ValidationWarns)||void 0===d?void 0:d.length)===0&&(0,t.jsx)(A.A,{style:{color:"green",marginRight:"8px"}}),(null==m?void 0:null===(x=m.ValidationFails)||void 0===x?void 0:x.length)>0&&(0,t.jsx)(R.A,{style:{color:"red",marginRight:"8px"}}),(null==m?void 0:null===(u=m.ValidationWarns)||void 0===u?void 0:u.length)>0&&(0,t.jsx)(S.A,{style:{color:"orange",marginRight:"8px"}}),h]}),cardSx:{display:"flex",flexDirection:"column",height:"100%"},cardActions:(0,t.jsxs)(t.Fragment,{children:[(null==m?void 0:m._Comment)&&(0,t.jsx)(o.A,{title:"Help",children:(0,t.jsx)(r.A,{href:null==m?void 0:m._Comment,target:"_blank",children:(0,t.jsx)(y.A,{})})}),(0,t.jsx)(o.A,{title:"Details",children:(0,t.jsx)(r.A,{onClick:()=>b(!0),children:(0,t.jsx)(F.A,{})})})]}),isFetching:v,children:[(0,t.jsx)(j.A,{size:{xs:12},children:p}),(0,t.jsx)(P.w,{visible:g,onClose:()=>b(!1),...D})]})}let O=e=>{var i,l,d;let{domain:c="",fullwidth:A=!1}=e,{control:R,handleSubmit:S,watch:y,setValue:F}=(0,b.mN)({defaultValues:{domain:c,spfRecord:"",dkimSelector:"",subdomains:"",enableHttps:!1}}),[P,N]=(0,n.useState)(!1),[V,w]=(0,n.useState)(c),[M,T]=(0,n.useState)(""),[k,E]=(0,n.useState)(""),[H,z]=(0,n.useState)(""),W=y("enableHttps");(0,n.useEffect)(()=>{c&&(F("domain",c),w(c))},[c,F]);let{data:_,isFetching:O}=(0,D.R_)({url:"/api/ListDomainHealth",queryKey:"whois-".concat(V),data:{Domain:V,Action:"ReadWhoisRecord"},waiting:!!V}),{data:U,isFetching:J}=(0,D.R_)({url:"/api/ListDomainHealth",queryKey:"ns-".concat(V),data:{Domain:V,Action:"ReadNSRecord"},waiting:!!V}),{data:X,isFetching:G}=(0,D.R_)({url:"/api/ListDomainHealth",queryKey:"mx-".concat(V),data:{Domain:V,Action:"ReadMxRecord"},waiting:!!V}),{data:Q,isFetching:Y}=(0,D.R_)({url:"/api/ListDomainHealth",queryKey:"spf-".concat(V,"-").concat(k),data:{Domain:V,Action:"ReadSPFRecord",Record:k},waiting:!!V}),{data:Z,isFetching:$}=(0,D.R_)({url:"/api/ListDomainHealth",queryKey:"dmarc-".concat(V),data:{Domain:V,Action:"ReadDmarcPolicy"},waiting:!!V}),{data:ee,isFetching:ei}=(0,D.R_)({url:"/api/ListDomainHealth",queryKey:"dkim-".concat(V,"-").concat(M),data:{Domain:V,Action:"ReadDkimRecord",Selector:M},waiting:!!V}),{data:el,isFetching:et}=(0,D.R_)({url:"/api/ListDomainHealth",queryKey:"dnssec-".concat(V),data:{Domain:V,Action:"TestDNSSEC"},waiting:!!V}),{data:en,isFetching:ea}=(0,D.R_)({url:"/api/ListDomainHealth",queryKey:"mtasts-".concat(V),data:{Domain:V,Action:"TestMtaSts"},waiting:!!V}),{data:es,isFetching:eo}=(0,D.R_)({url:"/api/ListDomainHealth",queryKey:"https-".concat(V,"-").concat(H),data:{Domain:V,Action:"TestHttpsCertificate",Subdomains:H},waiting:!!V&&W}),er=A?12:4;return(0,t.jsx)("form",{onSubmit:S(e=>{w(K.toASCII(e.domain)),T(e.dkimSelector),E(e.spfRecord),z(e.subdomains)}),children:(0,t.jsxs)(j.A,{container:!0,spacing:3,children:[(0,t.jsx)(j.A,{size:{xs:12,md:er},children:(0,t.jsxs)(C.A,{title:"Domain Check",cardSx:{display:"flex",flexDirection:"column",height:"100%"},cardActions:(0,t.jsx)(o.A,{title:"Settings",children:(0,t.jsx)(r.A,{onClick:()=>N(!P),children:(0,t.jsx)(g.A,{})})}),children:[(0,t.jsxs)(j.A,{container:!0,spacing:2,children:[(0,t.jsx)(j.A,{size:{xs:8},children:(0,t.jsx)(b.xI,{name:"domain",control:R,render:e=>{let{field:i}=e;return(0,t.jsx)(x.A,{...i,fullWidth:!0,placeholder:"Domain Name"})}})}),(0,t.jsx)(j.A,{size:{xs:4},children:(0,t.jsx)(u.A,{type:"submit",variant:"contained",startIcon:(0,t.jsx)(p.A,{}),children:"Check"})})]}),(0,t.jsx)(h.A,{in:P,unmountOnExit:!0,children:(0,t.jsxs)(a.A,{direction:"column",spacing:1,sx:{mt:1},children:[(0,t.jsx)(b.xI,{name:"spfRecord",control:R,render:e=>{let{field:i}=e;return(0,t.jsx)(x.A,{...i,fullWidth:!0,label:"SPF Record",className:"mt-2"})}}),(0,t.jsx)(b.xI,{name:"dkimSelector",control:R,render:e=>{let{field:i}=e;return(0,t.jsx)(x.A,{...i,fullWidth:!0,label:"DKIM Selector",className:"mt-2"})}}),(0,t.jsx)(b.xI,{name:"enableHttps",control:R,render:e=>{let{field:i}=e;return(0,t.jsx)(m.A,{control:(0,t.jsx)(v.A,{...i,checked:i.value}),label:"Enable HTTPS check"})}}),W&&(0,t.jsx)(b.xI,{name:"subdomains",control:R,render:e=>{let{field:i}=e;return(0,t.jsx)(x.A,{...i,fullWidth:!0,label:"HTTPS Subdomains",className:"mt-2"})}}),(0,t.jsx)(u.A,{variant:"outlined",color:"error",startIcon:(0,t.jsx)(f.A,{}),onClick:()=>{F("domain",""),F("spfRecord",""),F("dkimSelector",""),F("subdomains",""),w(""),T(""),E(""),z("")},className:"mt-2",children:"Clear"})]})})]})}),V&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.A,{size:{md:er,xs:12},children:(0,t.jsx)(q,{title:"Whois Results",type:"whois",data:_,isFetching:O,info:(0,t.jsx)("div",{children:(0,t.jsxs)(s.A,{variant:"body2",children:["Registrar: ",null==_?void 0:_.Registrar]})})})}),(0,t.jsx)(j.A,{size:{md:er,xs:12},children:(0,t.jsx)(q,{title:"NS Records",data:U,isFetching:J,info:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"Nameservers:"}),(0,t.jsx)("pre",{children:null==U?void 0:U.Records.join("\n")})]})})}),(0,t.jsx)(j.A,{size:{md:er,xs:12},children:(0,t.jsx)(B,{domain:V,mxData:X,isFetching:G})}),(0,t.jsx)(j.A,{size:{md:er,xs:12},children:(0,t.jsx)(q,{title:"SPF Record",type:"SPF",data:Q,isFetching:Y,info:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:"SPF Record:"}),(0,t.jsx)(I.x,{code:null==Q?void 0:Q.Record}),(0,t.jsx)(L,{passes:null==Q?void 0:Q.ValidationPasses,warns:null==Q?void 0:Q.ValidationWarns,fails:null==Q?void 0:Q.ValidationFails})]})})}),(0,t.jsx)(j.A,{size:{md:er,xs:12},children:(0,t.jsx)(q,{title:"DMARC Policy",type:"DMARC",data:Z,isFetching:$,info:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"DMARC Policy:"}),(0,t.jsx)(I.x,{code:null==Z?void 0:Z.Record}),(0,t.jsx)(L,{passes:null==Z?void 0:Z.ValidationPasses,warns:null==Z?void 0:Z.ValidationWarns,fails:null==Z?void 0:Z.ValidationFails})]})})}),(0,t.jsx)(j.A,{size:{md:er,xs:12},children:(0,t.jsx)(q,{title:"DKIM Record",data:ee,type:"DKIM",isFetching:ei,info:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"DKIM Record:"}),(0,t.jsx)(I.x,{code:null==ee?void 0:null===(l=ee.Records)||void 0===l?void 0:null===(i=l[0])||void 0===i?void 0:i.Record}),(0,t.jsx)(L,{passes:null==ee?void 0:ee.ValidationPasses,warns:null==ee?void 0:ee.ValidationWarns,fails:null==ee?void 0:ee.ValidationFails})]})})}),(0,t.jsx)(j.A,{size:{md:er,xs:12},children:(0,t.jsx)(q,{title:"DNSSEC",type:"DNSSEC",data:el,isFetching:et,info:(0,t.jsx)("div",{children:(0,t.jsx)(L,{passes:null==el?void 0:el.ValidationPasses,warns:null==el?void 0:el.ValidationWarns,fails:null==el?void 0:el.ValidationFails})})})}),(0,t.jsx)(j.A,{size:{md:er,xs:12},children:(0,t.jsx)(q,{title:"MTA-STS",type:"MTA-STS",data:en,isFetching:ea,info:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"MTA-STS Mode:"}),(0,t.jsx)(I.x,{code:(null==en?void 0:null===(d=en.StsPolicy)||void 0===d?void 0:d.Mode)||"No record found"}),(0,t.jsx)(L,{passes:null==en?void 0:en.ValidationPasses,warns:null==en?void 0:en.ValidationWarns,fails:null==en?void 0:en.ValidationFails})]})})}),W&&(0,t.jsx)(j.A,{size:{md:er,xs:12},children:(0,t.jsx)(q,{title:"HTTPS Certificate",type:"HTTPS",data:es,isFetching:eo,info:(0,t.jsx)("div",{children:(0,t.jsx)(L,{passes:null==es?void 0:es.ValidationPasses,warns:null==es?void 0:es.ValidationWarns,fails:null==es?void 0:es.ValidationFails})})})})]})]})})}},14304:(e,i,l)=>{l.d(i,{A:()=>a});var t=l(93944),n=l(37876);let a=(0,t.A)((0,n.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning")},46749:(e,i,l)=>{l.d(i,{A:()=>a});var t=l(93944),n=l(37876);let a=(0,t.A)((0,n.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")},63817:(e,i,l)=>{l.d(i,{A:()=>a});var t=l(93944),n=l(37876);let a=(0,t.A)((0,n.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings")}}]);